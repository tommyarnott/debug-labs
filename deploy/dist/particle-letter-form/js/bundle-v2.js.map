{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./node_modules/axios/index.js","webpack:///./node_modules/axios/lib/adapters/xhr.js","webpack:///./node_modules/axios/lib/axios.js","webpack:///./node_modules/axios/lib/cancel/Cancel.js","webpack:///./node_modules/axios/lib/cancel/CancelToken.js","webpack:///./node_modules/axios/lib/cancel/isCancel.js","webpack:///./node_modules/axios/lib/core/Axios.js","webpack:///./node_modules/axios/lib/core/InterceptorManager.js","webpack:///./node_modules/axios/lib/core/createError.js","webpack:///./node_modules/axios/lib/core/dispatchRequest.js","webpack:///./node_modules/axios/lib/core/enhanceError.js","webpack:///./node_modules/axios/lib/core/settle.js","webpack:///./node_modules/axios/lib/core/transformData.js","webpack:///./node_modules/axios/lib/defaults.js","webpack:///./node_modules/axios/lib/helpers/bind.js","webpack:///./node_modules/axios/lib/helpers/buildURL.js","webpack:///./node_modules/axios/lib/helpers/combineURLs.js","webpack:///./node_modules/axios/lib/helpers/cookies.js","webpack:///./node_modules/axios/lib/helpers/isAbsoluteURL.js","webpack:///./node_modules/axios/lib/helpers/isURLSameOrigin.js","webpack:///./node_modules/axios/lib/helpers/normalizeHeaderName.js","webpack:///./node_modules/axios/lib/helpers/parseHeaders.js","webpack:///./node_modules/axios/lib/helpers/spread.js","webpack:///./node_modules/axios/lib/utils.js","webpack:///./node_modules/delegated-events/dist/index.esm.js","webpack:///./node_modules/fastdom/fastdom.js","webpack:///./node_modules/inversify/lib/annotation/decorator_utils.js","webpack:///./node_modules/inversify/lib/annotation/inject.js","webpack:///./node_modules/inversify/lib/annotation/injectable.js","webpack:///./node_modules/inversify/lib/annotation/multi_inject.js","webpack:///./node_modules/inversify/lib/annotation/named.js","webpack:///./node_modules/inversify/lib/annotation/optional.js","webpack:///./node_modules/inversify/lib/annotation/post_construct.js","webpack:///./node_modules/inversify/lib/annotation/tagged.js","webpack:///./node_modules/inversify/lib/annotation/target_name.js","webpack:///./node_modules/inversify/lib/annotation/unmanaged.js","webpack:///./node_modules/inversify/lib/bindings/binding.js","webpack:///./node_modules/inversify/lib/bindings/binding_count.js","webpack:///./node_modules/inversify/lib/constants/error_msgs.js","webpack:///./node_modules/inversify/lib/constants/literal_types.js","webpack:///./node_modules/inversify/lib/constants/metadata_keys.js","webpack:///./node_modules/inversify/lib/container/container.js","webpack:///./node_modules/inversify/lib/container/container_module.js","webpack:///./node_modules/inversify/lib/container/container_snapshot.js","webpack:///./node_modules/inversify/lib/container/lookup.js","webpack:///./node_modules/inversify/lib/inversify.js","webpack:///./node_modules/inversify/lib/planning/context.js","webpack:///./node_modules/inversify/lib/planning/metadata.js","webpack:///./node_modules/inversify/lib/planning/metadata_reader.js","webpack:///./node_modules/inversify/lib/planning/plan.js","webpack:///./node_modules/inversify/lib/planning/planner.js","webpack:///./node_modules/inversify/lib/planning/queryable_string.js","webpack:///./node_modules/inversify/lib/planning/reflection_utils.js","webpack:///./node_modules/inversify/lib/planning/request.js","webpack:///./node_modules/inversify/lib/planning/target.js","webpack:///./node_modules/inversify/lib/resolution/instantiation.js","webpack:///./node_modules/inversify/lib/resolution/resolver.js","webpack:///./node_modules/inversify/lib/syntax/binding_in_syntax.js","webpack:///./node_modules/inversify/lib/syntax/binding_in_when_on_syntax.js","webpack:///./node_modules/inversify/lib/syntax/binding_on_syntax.js","webpack:///./node_modules/inversify/lib/syntax/binding_to_syntax.js","webpack:///./node_modules/inversify/lib/syntax/binding_when_on_syntax.js","webpack:///./node_modules/inversify/lib/syntax/binding_when_syntax.js","webpack:///./node_modules/inversify/lib/syntax/constraint_helpers.js","webpack:///./node_modules/inversify/lib/utils/binding_utils.js","webpack:///./node_modules/inversify/lib/utils/exceptions.js","webpack:///./node_modules/inversify/lib/utils/id.js","webpack:///./node_modules/inversify/lib/utils/serialization.js","webpack:///./node_modules/is-buffer/index.js","webpack:///./node_modules/navigo/lib/navigo.min.js","webpack:///./node_modules/process/browser.js","webpack:///./node_modules/reflect-metadata/Reflect.js","webpack:///./node_modules/selector-set/selector-set.next.js","webpack:///(webpack)/buildin/global.js","webpack:///./src/app/behaviour/behaviours/scroll/IntersectBehaviour.ts","webpack:///./src/app/behaviour/behaviours/scroll/RegionBehaviour.ts","webpack:///./src/app/behaviour/managers/ScrollBehaviourManager.ts","webpack:///./src/app/controller/AppController.ts","webpack:///./src/app/controller/BackgroundController.ts","webpack:///./src/app/controller/HistoryController.ts","webpack:///./src/app/controller/HomeController.ts","webpack:///./src/app/controller/InfoController.ts","webpack:///./src/app/controller/MouseController.ts","webpack:///./src/app/controller/NavMenuController.ts","webpack:///./src/app/controller/PixiController.ts","webpack:///./src/app/controller/PreloadController.ts","webpack:///./src/app/controller/ProjectController.ts","webpack:///./src/app/controller/ScrollbarController.ts","webpack:///./src/app/controller/UIController.ts","webpack:///./src/app/controller/WorkController.ts","webpack:///./src/app/controller/home/HomeTimelineMain.ts","webpack:///./src/app/data/AppEvents.ts","webpack:///./src/app/data/Enums.ts","webpack:///./src/app/event/AjaxHTMLLoadedEvent.ts","webpack:///./src/app/event/CustomCursorEvent.ts","webpack:///./src/app/event/DebugKeypressEvent.ts","webpack:///./src/app/event/DebugMouseWheelEvent.ts","webpack:///./src/app/event/HomeDepartmentReachedEvent.ts","webpack:///./src/app/event/JSONLoadEvent.ts","webpack:///./src/app/event/PixiResourceLoadEvent.ts","webpack:///./src/app/event/QueProjectEvent.ts","webpack:///./src/app/event/RegionViewportEvent.ts","webpack:///./src/app/event/SidePagingClickEvent.ts","webpack:///./src/app/event/SidebarChangeEvent.ts","webpack:///./src/app/event/UIThemeChangeEvent.ts","webpack:///./src/app/event/ViewReadyEvent.ts","webpack:///./src/app/module/global/DragPanel.ts","webpack:///./src/app/module/global/HitArea.ts","webpack:///./src/app/module/global/LoaderGraphic.ts","webpack:///./src/app/module/global/Paging.ts","webpack:///./src/app/module/home/MaskedText.ts","webpack:///./src/app/module/home/ParticleAttract.ts","webpack:///./src/app/module/home/ParticleField.ts","webpack:///./src/app/module/home/ParticleLamp.ts","webpack:///./src/app/module/home/ParticlePath.ts","webpack:///./src/app/module/home/ParticleRepell.ts","webpack:///./src/app/module/home/RelativeChildren.ts","webpack:///./src/app/module/home/TimelineItem.ts","webpack:///./src/app/module/home/TimelineRegion.ts","webpack:///./src/app/module/home/TimelineRegionManager.ts","webpack:///./src/app/module/home/homeUtil/ConstrainAroundCircle.ts","webpack:///./src/app/module/home/homeUtil/DistanceBetweenTwoPoints.ts","webpack:///./src/app/module/home/homeUtil/RelativeTimelinePosition.ts","webpack:///./src/app/module/home/homeUtil/TextScramble.ts","webpack:///./src/app/module/info/GoogleMap.ts","webpack:///./src/app/module/media/LazyLoadImage.ts","webpack:///./src/app/module/project/SidePaging.ts","webpack:///./src/app/module/project/VideoSwitch.ts","webpack:///./src/app/module/widget/LoadMore.ts","webpack:///./src/app/module/work/WorkTileImagePixi.ts","webpack:///./src/app/module/work/WorkTileParticlePixi.ts","webpack:///./src/app/module/work/WorkTilePixi.ts","webpack:///./src/app/services/debug/ComplexLoggerService.ts","webpack:///./src/app/services/debug/LoggerService.ts","webpack:///./src/debugbase/Debugbase.ts","webpack:///./src/debugbase/DebugbaseApp.ts","webpack:///./src/debugbase/abstract/Controller.ts","webpack:///./src/debugbase/abstract/DebugEvent.ts","webpack:///./src/debugbase/abstract/Module.ts","webpack:///./src/debugbase/events/CoreEvents.ts","webpack:///./src/debugbase/events/EventListener.ts","webpack:///./src/debugbase/events/Events.ts","webpack:///./src/debugbase/helper/DOMHelper.ts","webpack:///./src/debugbase/helper/FrameworkHelper.ts","webpack:///./src/debugbase/helper/MathHelper.ts","webpack:///./src/debugbase/helper/StringHelper.ts","webpack:///./src/debugbase/helper/SystemHelper.ts","webpack:///./src/debugbase/loader/DataLoader.ts","webpack:///./src/debugbase/loader/HTMLLoader.ts","webpack:///./src/debugbase/loader/ImageLoader.ts","webpack:///./src/debugbase/loader/InstanceLoader.ts","webpack:///./src/debugbase/loader/JSONLoader.ts","webpack:///./src/debugbase/loader/Loader.ts","webpack:///./src/debugbase/loader/LoaderGroup.ts","webpack:///./src/debugbase/loader/PixiLoader.ts","webpack:///./src/debugbase/managers/BehaviourManager.ts","webpack:///./src/debugbase/managers/ControllerManager.ts","webpack:///./src/debugbase/managers/ModuleManager.ts","webpack:///./src/debugbase/managers/RouteManager.ts","webpack:///./src/debugbase/managers/StateManager.ts","webpack:///./src/debugbase/tracking/GA.ts","webpack:///./src/debugbase/util/DragBreakpoints.ts","webpack:///./src/debugbase/util/InertiaDrag.ts","webpack:///./src/index.ts","webpack:///./src/inversify.config.ts","webpack:///./src/module.imports.ts","webpack:///./src/types.ts"],"names":[],"mappings":";AAAA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;;AAGA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA,kDAA0C,gCAAgC;AAC1E;AACA;;AAEA;AACA;AACA;AACA,gEAAwD,kBAAkB;AAC1E;AACA,yDAAiD,cAAc;AAC/D;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iDAAyC,iCAAiC;AAC1E,wHAAgH,mBAAmB,EAAE;AACrI;AACA;;AAEA;AACA;AACA;AACA,mCAA2B,0BAA0B,EAAE;AACvD,yCAAiC,eAAe;AAChD;AACA;AACA;;AAEA;AACA,8DAAsD,+DAA+D;;AAErH;AACA;;;AAGA;AACA;;;;;;;;;;;;AClFA,iBAAiB,mBAAO,CAAC,sDAAa,E;;;;;;;;;;;;ACAzB;;AAEb,YAAY,mBAAO,CAAC,qDAAY;AAChC,aAAa,mBAAO,CAAC,iEAAkB;AACvC,eAAe,mBAAO,CAAC,2EAAuB;AAC9C,mBAAmB,mBAAO,CAAC,mFAA2B;AACtD,sBAAsB,mBAAO,CAAC,yFAA8B;AAC5D,kBAAkB,mBAAO,CAAC,yEAAqB;;AAE/C;AACA;AACA;AACA;;AAEA;AACA,4CAA4C;AAC5C;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,oBAAoB,mBAAO,CAAC,yEAAsB;;AAElD;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA,OAAO;AACP;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,OAAO;AACP;;AAEA;AACA;AACA;;AAEA;AACA;AACA,GAAG;AACH;;;;;;;;;;;;;ACjKa;;AAEb,YAAY,mBAAO,CAAC,kDAAS;AAC7B,WAAW,mBAAO,CAAC,gEAAgB;AACnC,YAAY,mBAAO,CAAC,4DAAc;AAClC,eAAe,mBAAO,CAAC,wDAAY;;AAEnC;AACA;AACA;AACA,WAAW,OAAO;AAClB,YAAY,MAAM;AAClB;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA,eAAe,mBAAO,CAAC,kEAAiB;AACxC,oBAAoB,mBAAO,CAAC,4EAAsB;AAClD,iBAAiB,mBAAO,CAAC,sEAAmB;;AAE5C;AACA;AACA;AACA;AACA,eAAe,mBAAO,CAAC,oEAAkB;;AAEzC;;AAEA;AACA;;;;;;;;;;;;;ACnDa;;AAEb;AACA;AACA;AACA;AACA,WAAW,QAAQ;AACnB;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;;;;;;;;;;;;;AClBa;;AAEb,aAAa,mBAAO,CAAC,2DAAU;;AAE/B;AACA;AACA;AACA;AACA,WAAW,SAAS;AACpB;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,GAAG;;AAEH;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,GAAG;AACH;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;;AAEA;;;;;;;;;;;;;ACxDa;;AAEb;AACA;AACA;;;;;;;;;;;;;ACJa;;AAEb,eAAe,mBAAO,CAAC,2DAAe;AACtC,YAAY,mBAAO,CAAC,qDAAY;AAChC,yBAAyB,mBAAO,CAAC,iFAAsB;AACvD,sBAAsB,mBAAO,CAAC,2EAAmB;;AAEjD;AACA;AACA;AACA,WAAW,OAAO;AAClB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,WAAW,OAAO;AAClB;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;;AAEA,kCAAkC,cAAc;AAChD;;AAEA;AACA;AACA;;AAEA;AACA;AACA,GAAG;;AAEH;AACA;AACA,GAAG;;AAEH;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA,gDAAgD;AAChD;AACA;AACA,KAAK;AACL;AACA,CAAC;;AAED;AACA;AACA;AACA,gDAAgD;AAChD;AACA;AACA;AACA,KAAK;AACL;AACA,CAAC;;AAED;;;;;;;;;;;;;AC9Ea;;AAEb,YAAY,mBAAO,CAAC,qDAAY;;AAEhC;AACA;AACA;;AAEA;AACA;AACA;AACA,WAAW,SAAS;AACpB,WAAW,SAAS;AACpB;AACA,YAAY,OAAO;AACnB;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;;AAEA;AACA;AACA;AACA,WAAW,OAAO;AAClB;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,SAAS;AACpB;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;;AAEA;;;;;;;;;;;;;ACnDa;;AAEb,mBAAmB,mBAAO,CAAC,qEAAgB;;AAE3C;AACA;AACA;AACA,WAAW,OAAO;AAClB,WAAW,OAAO;AAClB,WAAW,OAAO;AAClB,WAAW,OAAO;AAClB,WAAW,OAAO;AAClB,aAAa,MAAM;AACnB;AACA;AACA;AACA;AACA;;;;;;;;;;;;;ACjBa;;AAEb,YAAY,mBAAO,CAAC,qDAAY;AAChC,oBAAoB,mBAAO,CAAC,uEAAiB;AAC7C,eAAe,mBAAO,CAAC,uEAAoB;AAC3C,eAAe,mBAAO,CAAC,yDAAa;AACpC,oBAAoB,mBAAO,CAAC,qFAA4B;AACxD,kBAAkB,mBAAO,CAAC,iFAA0B;;AAEpD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,WAAW,OAAO;AAClB,aAAa,QAAQ;AACrB;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,+BAA+B;AAC/B,uCAAuC;AACvC;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,GAAG;AACH;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,GAAG;AACH;;;;;;;;;;;;;ACrFa;;AAEb;AACA;AACA;AACA,WAAW,MAAM;AACjB,WAAW,OAAO;AAClB,WAAW,OAAO;AAClB,WAAW,OAAO;AAClB,WAAW,OAAO;AAClB,aAAa,MAAM;AACnB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;ACpBa;;AAEb,kBAAkB,mBAAO,CAAC,mEAAe;;AAEzC;AACA;AACA;AACA,WAAW,SAAS;AACpB,WAAW,SAAS;AACpB,WAAW,OAAO;AAClB;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;ACzBa;;AAEb,YAAY,mBAAO,CAAC,qDAAY;;AAEhC;AACA;AACA;AACA,WAAW,cAAc;AACzB,WAAW,MAAM;AACjB,WAAW,eAAe;AAC1B,aAAa,EAAE;AACf;AACA;AACA;AACA;AACA;AACA,GAAG;;AAEH;AACA;;;;;;;;;;;;;ACnBA,+CAAa;;AAEb,YAAY,mBAAO,CAAC,kDAAS;AAC7B,0BAA0B,mBAAO,CAAC,8FAA+B;;AAEjE;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,cAAc,mBAAO,CAAC,gEAAgB;AACtC,GAAG;AACH;AACA,cAAc,mBAAO,CAAC,iEAAiB;AACvC;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,wEAAwE;AACxE;AACA;AACA;AACA,uDAAuD;AACvD;AACA;AACA;AACA,GAAG;;AAEH;AACA;AACA;AACA;AACA;AACA,OAAO,YAAY;AACnB;AACA;AACA,GAAG;;AAEH;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,CAAC;;AAED;AACA;AACA,CAAC;;AAED;;;;;;;;;;;;;;AC/Fa;;AAEb;AACA;AACA;AACA,mBAAmB,iBAAiB;AACpC;AACA;AACA;AACA;AACA;;;;;;;;;;;;;ACVa;;AAEb,YAAY,mBAAO,CAAC,qDAAY;;AAEhC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,WAAW,OAAO;AAClB,WAAW,OAAO;AAClB,aAAa,OAAO;AACpB;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,GAAG;AACH;AACA,GAAG;AACH;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA,OAAO;AACP;AACA;;AAEA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA,OAAO;AACP,KAAK;;AAEL;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;;;;;;;;;;;;ACjEa;;AAEb;AACA;AACA;AACA,WAAW,OAAO;AAClB,WAAW,OAAO;AAClB,aAAa,OAAO;AACpB;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;ACba;;AAEb,YAAY,mBAAO,CAAC,qDAAY;;AAEhC;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA,wCAAwC;AACxC,OAAO;;AAEP;AACA,0DAA0D,wBAAwB;AAClF;AACA,OAAO;;AAEP;AACA;AACA;AACA;AACA,GAAG;;AAEH;AACA;AACA;AACA,gCAAgC;AAChC,6BAA6B,aAAa,EAAE;AAC5C;AACA;AACA,GAAG;AACH;;;;;;;;;;;;;ACpDa;;AAEb;AACA;AACA;AACA,WAAW,OAAO;AAClB,aAAa,QAAQ;AACrB;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;ACba;;AAEb,YAAY,mBAAO,CAAC,qDAAY;;AAEhC;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,cAAc,OAAO;AACrB,gBAAgB;AAChB;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA,cAAc,OAAO;AACrB,gBAAgB,QAAQ;AACxB;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;;AAEH;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;;;;;;;;;;;;;ACnEa;;AAEb,YAAY,mBAAO,CAAC,mDAAU;;AAE9B;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;;;;;;;;;;;;;ACXa;;AAEb,YAAY,mBAAO,CAAC,qDAAY;;AAEhC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,OAAO;AAClB,aAAa,OAAO;AACpB;AACA;AACA;AACA;AACA;AACA;;AAEA,iBAAiB,eAAe;;AAEhC;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA,GAAG;;AAEH;AACA;;;;;;;;;;;;;ACpDa;;AAEb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,+BAA+B;AAC/B;AACA;AACA,WAAW,SAAS;AACpB,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;AC1Ba;;AAEb,WAAW,mBAAO,CAAC,gEAAgB;AACnC,eAAe,mBAAO,CAAC,oDAAW;;AAElC;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA,WAAW,OAAO;AAClB,aAAa,QAAQ;AACrB;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,WAAW,OAAO;AAClB,aAAa,QAAQ;AACrB;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,WAAW,OAAO;AAClB,aAAa,QAAQ;AACrB;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,WAAW,OAAO;AAClB,aAAa,QAAQ;AACrB;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,WAAW,OAAO;AAClB,aAAa,QAAQ;AACrB;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,WAAW,OAAO;AAClB,aAAa,QAAQ;AACrB;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,WAAW,OAAO;AAClB,aAAa,QAAQ;AACrB;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,WAAW,OAAO;AAClB,aAAa,QAAQ;AACrB;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,WAAW,OAAO;AAClB,aAAa,QAAQ;AACrB;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,WAAW,OAAO;AAClB,aAAa,QAAQ;AACrB;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,WAAW,OAAO;AAClB,aAAa,QAAQ;AACrB;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,WAAW,OAAO;AAClB,aAAa,QAAQ;AACrB;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,WAAW,OAAO;AAClB,aAAa,QAAQ;AACrB;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,WAAW,OAAO;AAClB,aAAa,QAAQ;AACrB;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,WAAW,OAAO;AAClB,aAAa,OAAO;AACpB;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,aAAa;AACxB,WAAW,SAAS;AACpB;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,mCAAmC,OAAO;AAC1C;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB,SAAS,GAAG,SAAS;AAC5C,2BAA2B;AAC3B;AACA;AACA,WAAW,OAAO;AAClB,aAAa,OAAO;AACpB;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;;AAEA,uCAAuC,OAAO;AAC9C;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,WAAW,OAAO;AAClB,WAAW,OAAO;AAClB,WAAW,OAAO;AAClB,YAAY,OAAO;AACnB;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA,GAAG;AACH;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;AC9SA;AAAA;AAAA;AAAA;AAAA;AAAuC;;AAEvC;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,qBAAqB;AACrB;AACA;AACA,OAAO;AACP;AACA;AACA;AACA,GAAG;;AAEH;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA,GAAG;AACH;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA,sCAAsC,UAAU;AAChD;AACA;AACA;;AAEA,oDAAoD,UAAU;AAC9D;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA,oBAAoB,oDAAW;AAC/B;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;;AAEyB;;;;;;;;;;;;AC/HzB;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA,YAAY;AACZ;AACA,gBAAgB,SAAsC;;AAEtD;AACA;AACA;AACA,UAAU;AACV;AACA;AACA;AACA;AACA;AACA,mBAAmB,2BAA2B;;AAE9C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,2BAA2B;AAC3B;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA,cAAc,SAAS;AACvB,cAAc,OAAO;AACrB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;;AAEH;AACA;AACA;AACA;AACA;AACA,cAAc,SAAS;AACvB,cAAc,OAAO;AACrB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;;AAEH;AACA;AACA;AACA,aAAa,OAAO;AACpB,cAAc,QAAQ;AACtB;AACA;AACA;AACA;AACA;AACA,GAAG;;AAEH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,QAAQ;AACR;AACA;AACA;AACA;AACA;AACA;AACA;AACA,QAAQ;AACR;AACA;AACA,MAAM;AACN;AACA,cAAc,OAAO;AACrB,cAAc;AACd;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA,GAAG;;AAEH;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,GAAG,YAAY,WAAW;;AAE1B;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW;AACX;;AAEA;AACA;AACA;AACA,YAAY,MAAM;AAClB,YAAY,EAAE;AACd,YAAY;AACZ;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,YAAY,OAAO;AACnB,YAAY,OAAO;AACnB;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,2DAA2D;;AAE3D;AACA,IAAI,IAA6B,EAAE,mCAAO,YAAY,gBAAgB,EAAE;AAAA,oGAAC;AACzE,KAAK,EAA0D;;AAE/D,CAAC;;;;;;;;;;;;;ACnPY;AACb,8CAA8C,cAAc;AAC5D,iBAAiB,mBAAO,CAAC,qFAAyB;AAClD,mBAAmB,mBAAO,CAAC,2FAA4B;AACvD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,6EAA6E,uCAAuC;AACpH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mCAAmC,oCAAoC;AACvE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;ACzDa;AACb,8CAA8C,cAAc;AAC5D,mBAAmB,mBAAO,CAAC,qFAAyB;AACpD,mBAAmB,mBAAO,CAAC,2FAA4B;AACvD,iBAAiB,mBAAO,CAAC,+EAAsB;AAC/C,wBAAwB,mBAAO,CAAC,qFAAmB;AACnD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;AC9Ba;AACb,8CAA8C,cAAc;AAC5D,kBAAkB,mBAAO,CAAC,qFAAyB;AACnD,mBAAmB,mBAAO,CAAC,2FAA4B;AACvD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;ACda;AACb,8CAA8C,cAAc;AAC5D,mBAAmB,mBAAO,CAAC,2FAA4B;AACvD,iBAAiB,mBAAO,CAAC,+EAAsB;AAC/C,wBAAwB,mBAAO,CAAC,qFAAmB;AACnD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;AChBa;AACb,8CAA8C,cAAc;AAC5D,mBAAmB,mBAAO,CAAC,2FAA4B;AACvD,iBAAiB,mBAAO,CAAC,+EAAsB;AAC/C,wBAAwB,mBAAO,CAAC,qFAAmB;AACnD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;AChBa;AACb,8CAA8C,cAAc;AAC5D,mBAAmB,mBAAO,CAAC,2FAA4B;AACvD,iBAAiB,mBAAO,CAAC,+EAAsB;AAC/C,wBAAwB,mBAAO,CAAC,qFAAmB;AACnD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;AChBa;AACb,8CAA8C,cAAc;AAC5D,kBAAkB,mBAAO,CAAC,qFAAyB;AACnD,mBAAmB,mBAAO,CAAC,2FAA4B;AACvD,iBAAiB,mBAAO,CAAC,+EAAsB;AAC/C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;ACda;AACb,8CAA8C,cAAc;AAC5D,iBAAiB,mBAAO,CAAC,+EAAsB;AAC/C,wBAAwB,mBAAO,CAAC,qFAAmB;AACnD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;ACfa;AACb,8CAA8C,cAAc;AAC5D,mBAAmB,mBAAO,CAAC,2FAA4B;AACvD,iBAAiB,mBAAO,CAAC,+EAAsB;AAC/C,wBAAwB,mBAAO,CAAC,qFAAmB;AACnD;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;ACXa;AACb,8CAA8C,cAAc;AAC5D,mBAAmB,mBAAO,CAAC,2FAA4B;AACvD,iBAAiB,mBAAO,CAAC,+EAAsB;AAC/C,wBAAwB,mBAAO,CAAC,qFAAmB;AACnD;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;ACXa;AACb,8CAA8C,cAAc;AAC5D,sBAAsB,mBAAO,CAAC,2FAA4B;AAC1D,WAAW,mBAAO,CAAC,6DAAa;AAChC;AACA;AACA;AACA;AACA;AACA;AACA;AACA,8CAA8C,aAAa;AAC3D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACD;;;;;;;;;;;;;ACnCa;AACb,8CAA8C,cAAc;AAC5D;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;ACPa;AACb,8CAA8C,cAAc;AAC5D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oBAAoB,uBAAuB;AAC3C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oBAAoB,uBAAuB;AAC3C;AACA;AACA;AACA;AACA;AACA;AACA,oBAAoB,uBAAuB;AAC3C;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;AC3Da;AACb,8CAA8C,cAAc;AAC5D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;ACxBa;AACb,8CAA8C,cAAc;AAC5D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;ACZa;AACb;AACA;AACA,mCAAmC,MAAM,6BAA6B,EAAE,YAAY,WAAW,EAAE;AACjG,kCAAkC,MAAM,iCAAiC,EAAE,YAAY,WAAW,EAAE;AACpG,+BAA+B,iEAAiE,uBAAuB,EAAE,4BAA4B;AACrJ;AACA,KAAK;AACL;AACA;AACA,aAAa,6BAA6B,0BAA0B,aAAa,EAAE,qBAAqB;AACxG,gBAAgB,qDAAqD,oEAAoE,aAAa,EAAE;AACxJ,sBAAsB,sBAAsB,qBAAqB,GAAG;AACpE;AACA;AACA;AACA;AACA;AACA;AACA,uCAAuC;AACvC,kCAAkC,SAAS;AAC3C,kCAAkC,WAAW,UAAU;AACvD,yCAAyC,cAAc;AACvD;AACA,6GAA6G,OAAO,UAAU;AAC9H,gFAAgF,iBAAiB,OAAO;AACxG,wDAAwD,gBAAgB,QAAQ,OAAO;AACvF,8CAA8C,gBAAgB,gBAAgB,OAAO;AACrF;AACA,iCAAiC;AACjC;AACA;AACA,SAAS,YAAY,aAAa,OAAO,EAAE,UAAU,WAAW;AAChE,mCAAmC,SAAS;AAC5C;AACA;AACA,8CAA8C,cAAc;AAC5D,gBAAgB,mBAAO,CAAC,6EAAqB;AAC7C,iBAAiB,mBAAO,CAAC,qFAAyB;AAClD,sBAAsB,mBAAO,CAAC,2FAA4B;AAC1D,mBAAmB,mBAAO,CAAC,2FAA4B;AACvD,wBAAwB,mBAAO,CAAC,6FAA6B;AAC7D,gBAAgB,mBAAO,CAAC,6EAAqB;AAC7C,iBAAiB,mBAAO,CAAC,mFAAwB;AACjD,0BAA0B,mBAAO,CAAC,6FAA6B;AAC/D,WAAW,mBAAO,CAAC,6DAAa;AAChC,sBAAsB,mBAAO,CAAC,mFAAwB;AACtD,2BAA2B,mBAAO,CAAC,0FAAsB;AACzD,eAAe,mBAAO,CAAC,kEAAU;AACjC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiB;AACjB,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA,wBAAwB,uBAAuB;AAC/C;AACA;AACA;AACA,6CAA6C,uBAAuB;AACpE;AACA;AACA;AACA;AACA;AACA;AACA;AACA,wBAAwB,uBAAuB;AAC/C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb,SAAS;AACT;AACA;AACA;AACA;AACA,wBAAwB,uBAAuB;AAC/C;AACA;AACA,oDAAoD;AACpD;AACA,UAAU;AACV;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gDAAgD,gCAAgC,EAAE;AAClF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,wBAAwB,uBAAuB;AAC/C;AACA;AACA;AACA,qEAAqE,mBAAmB,EAAE;AAC1F;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,+BAA+B;AAC/B;AACA;AACA;AACA;AACA,SAAS,EAAE;AACX;AACA;AACA;AACA;AACA;AACA,oDAAoD,gBAAgB,EAAE;AACtE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACD;;;;;;;;;;;;;ACpUa;AACb,8CAA8C,cAAc;AAC5D,WAAW,mBAAO,CAAC,6DAAa;AAChC;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACD;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACD;;;;;;;;;;;;;AClBa;AACb,8CAA8C,cAAc;AAC5D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACD;;;;;;;;;;;;;ACba;AACb,8CAA8C,cAAc;AAC5D,iBAAiB,mBAAO,CAAC,qFAAyB;AAClD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kEAAkE,0BAA0B,EAAE;AAC9F;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,wCAAwC,iCAAiC,EAAE;AAC3E,SAAS;AACT;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,CAAC;AACD;;;;;;;;;;;;;AC9Ea;AACb,8CAA8C,cAAc;AAC5D,WAAW,mBAAO,CAAC,0FAA2B;AAC9C;AACA,kBAAkB,mBAAO,CAAC,kFAAuB;AACjD;AACA,sBAAsB,mBAAO,CAAC,0FAA2B;AACzD;AACA;AACA;AACA,yBAAyB,mBAAO,CAAC,gGAA8B;AAC/D;AACA;AACA,mBAAmB,mBAAO,CAAC,sFAAyB;AACpD;AACA,eAAe,mBAAO,CAAC,8EAAqB;AAC5C;AACA,cAAc,mBAAO,CAAC,4EAAoB;AAC1C;AACA,eAAe,mBAAO,CAAC,8EAAqB;AAC5C;AACA;AACA,iBAAiB,mBAAO,CAAC,kFAAuB;AAChD;AACA,kBAAkB,mBAAO,CAAC,oFAAwB;AAClD;AACA,qBAAqB,mBAAO,CAAC,0FAA2B;AACxD;AACA,oBAAoB,mBAAO,CAAC,wFAA0B;AACtD;AACA,uBAAuB,mBAAO,CAAC,8FAA6B;AAC5D;AACA,wBAAwB,mBAAO,CAAC,4FAA4B;AAC5D;AACA,WAAW,mBAAO,CAAC,4DAAY;AAC/B;AACA,wBAAwB,mBAAO,CAAC,gGAA8B;AAC9D;AACA,2BAA2B,mBAAO,CAAC,8FAA6B;AAChE;AACA;AACA;AACA;AACA,sBAAsB,mBAAO,CAAC,kFAAuB;AACrD;AACA,sBAAsB,mBAAO,CAAC,kFAAuB;AACrD;;;;;;;;;;;;;AC9Ca;AACb,8CAA8C,cAAc;AAC5D,WAAW,mBAAO,CAAC,6DAAa;AAChC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACD;;;;;;;;;;;;;AChBa;AACb,8CAA8C,cAAc;AAC5D,mBAAmB,mBAAO,CAAC,2FAA4B;AACvD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,6BAA6B,6DAA6D;AAC1F;AACA;AACA;AACA,CAAC;AACD;;;;;;;;;;;;;AClBa;AACb,8CAA8C,cAAc;AAC5D,mBAAmB,mBAAO,CAAC,2FAA4B;AACvD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACD;;;;;;;;;;;;;ACpBa;AACb,8CAA8C,cAAc;AAC5D;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACD;;;;;;;;;;;;;ACTa;AACb,8CAA8C,cAAc;AAC5D,sBAAsB,mBAAO,CAAC,yFAA2B;AACzD,iBAAiB,mBAAO,CAAC,qFAAyB;AAClD,sBAAsB,mBAAO,CAAC,2FAA4B;AAC1D,mBAAmB,mBAAO,CAAC,2FAA4B;AACvD,mBAAmB,mBAAO,CAAC,6EAAqB;AAChD,sBAAsB,mBAAO,CAAC,mFAAwB;AACtD,gBAAgB,mBAAO,CAAC,mEAAW;AACnC,iBAAiB,mBAAO,CAAC,qEAAY;AACrC,aAAa,mBAAO,CAAC,6DAAQ;AAC7B,yBAAyB,mBAAO,CAAC,qFAAoB;AACrD,gBAAgB,mBAAO,CAAC,mEAAW;AACnC,eAAe,mBAAO,CAAC,iEAAU;AACjC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sCAAsC,0BAA0B;AAChE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;AC1Ja;AACb,8CAA8C,cAAc;AAC5D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qCAAqC,qBAAqB;AAC1D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACD;;;;;;;;;;;;;AC1Ba;AACb,8CAA8C,cAAc;AAC5D,eAAe,mBAAO,CAAC,+EAAsB;AAC7C,iBAAiB,mBAAO,CAAC,qFAAyB;AAClD,sBAAsB,mBAAO,CAAC,2FAA4B;AAC1D,mBAAmB,mBAAO,CAAC,2FAA4B;AACvD,sBAAsB,mBAAO,CAAC,mFAAwB;AACtD;AACA,eAAe,mBAAO,CAAC,iEAAU;AACjC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mBAAmB,gBAAgB;AACnC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mCAAmC,oBAAoB;AACvD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;AC3Ha;AACb,8CAA8C,cAAc;AAC5D,WAAW,mBAAO,CAAC,6DAAa;AAChC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACD;;;;;;;;;;;;;ACvBa;AACb,8CAA8C,cAAc;AAC5D,mBAAmB,mBAAO,CAAC,2FAA4B;AACvD,WAAW,mBAAO,CAAC,6DAAa;AAChC,iBAAiB,mBAAO,CAAC,qEAAY;AACrC,yBAAyB,mBAAO,CAAC,qFAAoB;AACrD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,4CAA4C,gBAAgB;AAC5D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA,sDAAsD,yCAAyC,EAAE;AACjG;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iDAAiD,gBAAgB;AACjE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACD;;;;;;;;;;;;;ACzFa;AACb,8CAA8C,cAAc;AAC5D,mBAAmB,mBAAO,CAAC,qFAAyB;AACpD,sBAAsB,mBAAO,CAAC,2FAA4B;AAC1D,mBAAmB,mBAAO,CAAC,2FAA4B;AACvD;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;ACjDa;AACb,8CAA8C,cAAc;AAC5D,iBAAiB,mBAAO,CAAC,qFAAyB;AAClD,sBAAsB,mBAAO,CAAC,2FAA4B;AAC1D,mBAAmB,mBAAO,CAAC,6EAAqB;AAChD,sBAAsB,mBAAO,CAAC,mFAAwB;AACtD,sBAAsB,mBAAO,CAAC,iFAAiB;AAC/C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mGAAmG,sDAAsD,EAAE;AAC3J;AACA;AACA,8FAA8F,iDAAiD,EAAE;AACjJ;AACA;AACA,+FAA+F,kDAAkD,EAAE;AACnJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;ACjGa;AACb,8CAA8C,cAAc;AAC5D,sBAAsB,mBAAO,CAAC,2FAA4B;AAC1D,+BAA+B,mBAAO,CAAC,+FAA0B;AACjE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACD;;;;;;;;;;;;;ACtBa;AACb,8CAA8C,cAAc;AAC5D,0BAA0B,mBAAO,CAAC,qFAAqB;AACvD,0BAA0B,mBAAO,CAAC,qFAAqB;AACvD,4BAA4B,mBAAO,CAAC,yFAAuB;AAC3D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACD;;;;;;;;;;;;;ACvEa;AACb,8CAA8C,cAAc;AAC5D,4BAA4B,mBAAO,CAAC,yFAAuB;AAC3D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACD;;;;;;;;;;;;;ACba;AACb,8CAA8C,cAAc;AAC5D,iBAAiB,mBAAO,CAAC,qFAAyB;AAClD,sBAAsB,mBAAO,CAAC,2FAA4B;AAC1D,kCAAkC,mBAAO,CAAC,qGAA6B;AACvE,+BAA+B,mBAAO,CAAC,+FAA0B;AACjE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,2CAA2C,iDAAiD;AAC5F;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gDAAgD,uCAAuC,EAAE;AACzF;AACA;AACA,CAAC;AACD;;;;;;;;;;;;;ACxEa;AACb,8CAA8C,cAAc;AAC5D,0BAA0B,mBAAO,CAAC,qFAAqB;AACvD,4BAA4B,mBAAO,CAAC,yFAAuB;AAC3D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACD;;;;;;;;;;;;;AC5Da;AACb,8CAA8C,cAAc;AAC5D,0BAA0B,mBAAO,CAAC,qFAAqB;AACvD,2BAA2B,mBAAO,CAAC,uFAAsB;AACzD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACD;;;;;;;;;;;;;ACjGa;AACb,8CAA8C,cAAc;AAC5D,mBAAmB,mBAAO,CAAC,2FAA4B;AACvD,iBAAiB,mBAAO,CAAC,+EAAsB;AAC/C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uCAAuC;AACvC;AACA;AACA;AACA;AACA;AACA,EAAE;AACF;AACA;AACA;AACA,sCAAsC;AACtC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,EAAE;AACF;;;;;;;;;;;;;ACvCa;AACb,8CAA8C,cAAc;AAC5D;AACA;AACA;AACA;AACA,4BAA4B,uBAAuB;AACnD;AACA;AACA,+CAA+C,6CAA6C,EAAE;AAC9F;AACA;AACA;;;;;;;;;;;;;ACZa;AACb,8CAA8C,cAAc;AAC5D,iBAAiB,mBAAO,CAAC,qFAAyB;AAClD;AACA;AACA;AACA;AACA;;;;;;;;;;;;;ACPa;AACb,8CAA8C,cAAc;AAC5D;AACA;AACA;AACA;AACA;;;;;;;;;;;;;ACNa;AACb,8CAA8C,cAAc;AAC5D,iBAAiB,mBAAO,CAAC,qFAAyB;AAClD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gCAAgC,aAAa;AAC7C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;ACtGA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;;;;;;;;;;;ACpBA,eAAe,KAAoD,oBAAoB,SAA4D,CAAC,iBAAiB,aAAa,8EAA8E,gBAAgB,aAAa,qGAAqG,aAAa,gFAAgF,kBAAkB,4gBAA4gB,cAAc,uEAAuE,cAAc,6CAA6C,gBAAgB,iBAAiB,gBAAgB,mBAAmB,kFAAkF,kBAAkB,SAAS,OAAO,qFAAqF,2CAA2C,+GAA+G,wFAAwF,sEAAsE,sBAAsB,kCAAkC,YAAY,MAAM,YAAY,0BAA0B,qBAAqB,SAAS,EAAE,aAAa,gBAAgB,wBAAwB,4EAA4E,SAAS,yCAAyC,kCAAkC,2BAA2B,kBAAkB,oBAAoB,+BAA+B,4FAA4F,kBAAkB,gDAAgD,4CAA4C,wFAAwF,IAAI,gDAAgD,IAAI,oBAAoB,SAAS,oCAAoC,wBAAwB,MAAM,6GAA6G,GAAG,mDAAmD,sNAAsN,eAAe,iDAAiD,IAAI,sBAAsB,iDAAiD,yBAAyB,mCAAmC,WAAW,wDAAwD,sBAAsB,+BAA+B,sEAAsE,gBAAgB,EAAE,YAAY,iBAAiB,4OAA4O,kCAAkC,UAAU,wBAAwB,8BAA8B,kBAAkB,MAAM,qBAAqB,+DAA+D,8DAA8D,kBAAkB,6CAA6C,kDAAkD,qUAAqU,oEAAoE,gCAAgC,aAAa,8FAA8F,yCAAyC,yGAAyG,oBAAoB,wBAAwB,iBAAiB,6BAA6B,4CAA4C,aAAa,qCAAqC,4CAA4C,8BAA8B,0BAA0B,8DAA8D,aAAa,qCAAqC,6CAA6C,+BAA+B,2BAA2B,0BAA0B,oBAAoB,0RAA0R,4BAA4B,WAAW,oEAAoE,+DAA+D,wEAAwE,uBAAuB,wFAAwF,4BAA4B,EAAE,sBAAsB,+DAA+D,qCAAqC,MAAM,sEAAsE,SAAS,KAAK,oCAAoC,kBAAkB,yBAAyB,kBAAkB,iEAAiE,yEAAyE,mBAAmB,eAAe,oCAAoC,kFAAkF,qCAAqC,oBAAoB,8BAA8B,+BAA+B,yBAAyB,8BAA8B,mBAAmB,qBAAqB,kBAAkB,gIAAgI,uGAAuG,kDAAkD,EAAE,0BAA0B,YAAY,qBAAqB,mGAAmG,oBAAoB,WAAW,iFAAiF,yHAAyH,KAAK,qCAAqC,cAAc,4EAA4E,KAAK,kBAAkB,mJAAmJ,uBAAuB,gEAAgE,8BAA8B,eAAe,uBAAuB,8BAA8B,oDAAoD,2LAA2L;AAC5/P;;;;;;;;;;;;ACDA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA,CAAC;AACD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;;;;AAIA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,uBAAuB,sBAAsB;AAC7C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qBAAqB;AACrB;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,qCAAqC;;AAErC;AACA;AACA;;AAEA,2BAA2B;AAC3B;AACA;AACA;AACA,4BAA4B,UAAU;;;;;;;;;;;;ACvLtC;AACA;AACA,+DAA+D;AAC/D;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,0CAA0C;AAC1C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,wDAAwD,mDAAmD;AAC3G;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA,iEAAiE;AACjE,6BAA6B,gBAAgB,kBAAkB;AAC/D;AACA;AACA;AACA;AACA,+BAA+B,4CAA4C;AAC3E;AACA,mCAAmC,wBAAwB,kBAAkB,EAAE;AAC/E,mCAAmC,yBAAyB,EAAE,EAAE;AAChE;AACA,uCAAuC,8BAA8B;AACrE,uCAAuC,mBAAmB,EAAE;AAC5D;AACA,uCAAuC,qDAAqD;AAC5F,uCAAuC,iBAAiB,EAAE;AAC1D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mCAAmC;AACnC,2CAA2C;AAC3C,8BAA8B;AAC9B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,0CAA0C;AAC1C;AACA;AACA;AACA;AACA;AACA,6BAA6B;AAC7B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mCAAmC;AACnC,2CAA2C;AAC3C,8BAA8B;AAC9B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uGAAuG;AACvG;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mCAAmC;AACnC,2CAA2C;AAC3C,8BAA8B;AAC9B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gFAAgF;AAChF;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mCAAmC;AACnC,2CAA2C;AAC3C,8BAA8B;AAC9B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qEAAqE;AACrE;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mCAAmC;AACnC,2CAA2C;AAC3C,8BAA8B;AAC9B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qEAAqE;AACrE;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mCAAmC;AACnC,2CAA2C;AAC3C,8BAA8B;AAC9B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mCAAmC;AACnC,2CAA2C;AAC3C,8BAA8B;AAC9B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mCAAmC;AACnC,2CAA2C;AAC3C,8BAA8B;AAC9B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uEAAuE;AACvE;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mCAAmC;AACnC,2CAA2C;AAC3C,8BAA8B;AAC9B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,+CAA+C,QAAQ;AACvD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,+CAA+C,QAAQ;AACvD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iDAAiD,uBAAuB;AACxE;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uDAAuD,0BAA0B;AACjF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sCAAsC;AACtC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mEAAmE,aAAa;AAChF,qEAAqE,aAAa;AAClF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gCAAgC;AAChC;AACA,4BAA4B;AAC5B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,4BAA4B;AAC5B;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sCAAsC,0BAA0B,EAAE;AAClE;AACA;AACA,iBAAiB;AACjB,oDAAoD,+CAA+C;AACnG;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,+CAA+C,UAAU;AACzD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kDAAkD,0DAA0D;AAC5G,oDAAoD,4DAA4D;AAChH,qDAAqD,4DAA4D;AACjH,2DAA2D,uBAAuB;AAClF,6DAA6D,uBAAuB;AACpF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sCAAsC,uBAAuB,EAAE;AAC/D;AACA;AACA,iBAAiB;AACjB,sDAAsD,6BAA6B;AACnF,sDAAsD,0CAA0C;AAChG,yDAAyD,gCAAgC;AACzF,mDAAmD,mBAAmB;AACtE,kDAAkD,yBAAyB;AAC3E,oDAAoD,2BAA2B;AAC/E,qDAAqD,4BAA4B;AACjF,2DAA2D,oBAAoB;AAC/E,6DAA6D,oBAAoB;AACjF;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,4DAA4D,0BAA0B;AACtF;AACA;AACA;AACA;AACA,+BAA+B,UAAU;AACzC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oCAAoC,oBAAoB;AACxD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL,CAAC,0BAA0B;;;;;;;;;;;;;;AC1mC3B;AAAA;AAAA;AACe;AACf;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA,CAAC;;AAED;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;;AAED;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA,CAAC;;AAED;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA,CAAC;AACD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;;;AAGA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,qBAAqB,WAAW;AAChC;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,mBAAmB,mBAAmB;AACtC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,4BAA4B,uBAAuB;AACnD;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;;AAEH;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,+BAA+B,SAAS;AACxC;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,UAAU,eAAe;AACzB;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA,aAAa,4BAA4B;AACzC;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA,aAAa,4BAA4B;AACzC;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,qBAAqB,yBAAyB;AAC9C;AACA;AACA;AACA;;AAEA,kBAAkB;AAClB;;AAEA;AACA,+BAA+B,SAAS;AACxC;AACA;AACA,gCAAgC,UAAU;AAC1C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA,qBAAqB,eAAe;AACpC;AACA;AACA;AACA;;AAEA;AACA,mDAAmD;;AAEnD,mCAAmC,SAAS;AAC5C;AACA;AACA;AACA,qCAAqC,UAAU;AAC/C;AACA,yCAAyC,UAAU;AACnD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;;;;;;;;;;;ACpZA;;AAEA;AACA;AACA;AACA,CAAC;;AAED;AACA;AACA;AACA,CAAC;AACD;AACA;AACA;;AAEA;AACA;AACA,4CAA4C;;AAE5C;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACnBA;;AAEA;;AACA;;AACA;;AAKA,IAAK,UAAL;;AAAA,WAAK,UAAL,EAAe;AACd;AACA;AACA,CAHD,EAAK,UAAU,KAAV,UAAU,MAAf;AAKA;;;AACA;AAAA;AAAA;AAAwC;;AAOvC,8BAAuB,OAAvB,EAA2D,UAA3D,EAAkF;AAAlF,gBAEC,kBAAM,OAAN,EAAe,UAAf,KAA0B,IAF3B;;AAAuB;AAAoC;AALnD,yBAAwB,KAAxB;AAGA,oCAAkC,CAAlC;AAKP,SAAI,CAAC,OAAL,GAAe,QAAQ,CAAC,aAAT,CAAuB,KAAI,CAAC,OAAL,CAAa,QAApC,CAAf,CAHiF,CAKjF;;AACA,QAAI,KAAI,CAAC,kBAAL,EAAJ,EAAgC;AAC/B,WAAI,CAAC,MAAL;AACA,KAFD,MAEO;AACN,WAAI,CAAC,OAAL;AACA;;;AAED;;AAEM,yCAAP;AACC,qBAAM,OAAN,CAAa,IAAb,CAAa,IAAb;AACA,GAFM;;AAIA,wCAAP;AACC,SAAK,WAAL,GAAmB,KAAK,OAAL,CAAa,qBAAb,EAAnB;;AACA,qBAAM,MAAN,CAAY,IAAZ,CAAY,IAAZ;AACA,GAHM;AAKP;;;;;AAGO,wCAAP,UAAc,MAAd,EAA4B;AAE3B,QAAI,CAAC,KAAK,OAAV,EAAmB;AAClB;AACA;;AAED,qBAAM,MAAN,CAAY,IAAZ,CAAY,IAAZ,EAAa,MAAb,EAN2B,CAQ3B;;;AACA,SAAK,iBAAL;;AAEA,QAAI,CAAC,KAAK,YAAN,IAAsB,KAAK,cAAL,EAA1B,EAAiD;AAChD,WAAK,YAAL;AACA,KAFD,MAEO,IAAI,KAAK,YAAL,IAAqB,CAAC,KAAK,cAAL,EAA1B,EAAiD;AACvD,WAAK,gBAAL;AACA;AACD,GAhBM,CAjCR,CAmDC;AACA;;;AACQ,8CAAR;AAEC;AACA,QAAI,KAAK,OAAL,CAAa,MAAb,KAAwB,UAAU,CAAC,QAAvC,EAAiD;AAChD,sBAAO,QAAP,CAAgB,IAAI,uCAAJ,CAAuB;AACtC,aAAK,EAAE,KAAK,OAAL,CAAa;AADkB,OAAvB,CAAhB;AAGA,KAJD,MAIO,IAAI,KAAK,OAAL,CAAa,MAAb,KAAwB,UAAU,CAAC,OAAvC,EAAgD;AACtD,UAAI,SAAS,GAAkB,KAAK,OAAL,CAAa,IAAb,CAAkB,KAAlB,CAAwB,GAAxB,CAA/B;;AACA,sBAAO,QAAP,CAAgB,IAAI,uCAAJ,CAAuB;AACtC,aAAK,EAAE,SAAS,CAAC,CAAD,CADsB;AAEtC,aAAK,EAAE,QAAQ,CAAC,SAAS,CAAC,CAAD,CAAV,EAAe,EAAf;AAFuB,OAAvB,CAAhB;AAIA;;AAED,SAAK,YAAL,GAAoB,IAApB;AAEA,GAjBO;;AAmBA,kDAAR;AACC,SAAK,YAAL,GAAoB,KAApB;AACA,GAFO;AAIR;;;AACQ,mDAAR;AACC,SAAK,uBAAL;;AACA,QAAI,KAAK,uBAAL,IAAgC,CAApC,EAAuC;AACtC,WAAK,WAAL,GAAmB,KAAK,OAAL,CAAa,qBAAb,EAAnB;AACA,WAAK,uBAAL,GAA+B,CAA/B;AACA;AACD,GANO;AAQR;;;;;AAGQ,gDAAR;AACC,WAAO,EAAE,KAAK,WAAL,CAAiB,KAAjB,GAAyB,KAAK,WAAL,CAAiB,IAA1C,IACK,KAAK,WAAL,CAAiB,IAAjB,GAAwB,KAAK,WAAL,CAAiB,KAD9C,IAEK,KAAK,WAAL,CAAiB,MAAjB,GAA0B,KAAK,WAAL,CAAiB,GAFhD,IAGK,KAAK,WAAL,CAAiB,GAAjB,GAAuB,KAAK,WAAL,CAAiB,MAH/C,CAAP;AAKA,GANO;AAQR;;;AACQ,oDAAR;AAEC,QAAI,CAAC,KAAK,OAAV,EAAmB;AAClB,UAAI;AACH,cAAM,IAAI,KAAJ,CAAU,gDAA8C,IAAI,CAAC,SAAL,CAAe,KAAK,OAApB,CAAxD,CAAN;AACA,OAFD,CAEE,OAAO,CAAP,EAAU;AACX,eAAO,CAAC,GAAR,CAAY,CAAZ;AACA;;AACD,aAAO,KAAP;AACA;;AAED,WAAO,IAAP;AAEA,GAbO;;AAeT;AAAC,CAhHD,CAAwC,iCAAxC;;AAAa,gD;;;;;;;;;;;;;;;;;;ACdb;;AACA;;AACA;AAEA;;;AACA;AAAA;AAAA;AAcC,2BAAuB,OAAvB,EAA2D,UAA3D,EAAkF;AAA3D;AAAoC;AAZpD,oBAAoB,KAApB;AAMG,qBAAqB,IAArB;AACA,wBAAuB,CAAvB;AACA,oBAAmB,CAAnB,CAIwE,CAHlF;;AACQ,8BAA6B,CAA7B,CAE0E,CAFzC;;AAIxC,SAAK,OAAL,GAAe,UAAU,CAAC,aAAX,CAAyB,MAAI,KAAK,OAAL,CAAa,EAA1C,CAAf;;AAEA,QAAI,CAAC,KAAK,gBAAL,EAAL,EAA+B;AAC9B,WAAK,OAAL;AACA;AAED;;AAEM,sCAAP;AACC,SAAK,OAAL,GAAe,IAAf;AACA,SAAK,UAAL,GAAkB,IAAlB;AACA,SAAK,WAAL,GAAmB,IAAnB;AACA,SAAK,QAAL,GAAgB,KAAhB;;AACA,SAAK,OAAL,CAAa,mBAAb,CAAiC,QAAjC,EAA2C,KAAK,MAAL,CAAY,IAAZ,CAAiB,IAAjB,CAA3C;AACA,GANM;;AAQA,qCAAP;AAEC,QAAI,CAAC,KAAK,OAAV,EAAmB;AAClB;AACA;;AAED,SAAK,YAAL,GAAoB,MAAM,CAAC,WAA3B;AACA,SAAK,WAAL,GAAmB,KAAK,OAAL,CAAa,qBAAb,EAAnB;AACA,SAAK,aAAL,GAAsB,KAAK,OAAL,CAAa,YAAnC;AACA,SAAK,gBAAL,GAA0B,KAAK,OAAL,CAAa,SAAvC;AACA,GAVM;;AAYA,qCAAP,UAAc,MAAd,EAA4B;AAC3B,SAAK,QAAL,GAAgB,MAAhB;;AACA,SAAK,eAAL;AACA,GAHM,CA5CR,CAiDC;AACA;;AAEA;;;AACQ,8CAAR;AAEC,QAAI,KAAK,SAAL,KAAmB,KAAK,sBAAL,EAAvB,EAAuD;AAEtD,WAAK,SAAL,GAAiB,CAAC,KAAK,SAAvB,CAFsD,CAItD;;AACA,UAAI,KAAK,OAAL,CAAa,mBAAb,IAAoC,KAAK,OAAL,CAAa,YAAb,KAA8B,qBAAa,MAAnF,EAA2F;AAC1F,aAAK,OAAL,CAAa,KAAb,CAAmB,UAAnB,GAAiC,KAAK,SAAN,GAAmB,SAAnB,GAA+B,QAA/D;AACA,OAPqD,CAStD;;;AACA,sBAAO,QAAP,CAAgB,IAAI,yCAAJ,CAAyB;AACxC,gBAAQ,EAAE,KAAK,SADyB;AAExC,cAAM,EAAE,KAAK,OAF2B;AAGxC,cAAM,EAAE,KAAK;AAH2B,OAAzB,CAAhB;AAKA;AAED,GAnBO;AAqBR;;;;;AAGQ,qDAAR;AAEC,QAAI,KAAK,QAAL,GAAgB,KAAK,YAArB,GAAqC,KAAK,gBAAL,GAAwB,KAAK,kBAAlE,IACH,KAAK,QAAL,GAAkB,KAAK,gBAAL,GAAwB,KAAK,aAA9B,GAA+C,KAAK,kBADtE,EAC4F;AAC1F,aAAO,IAAP;AACD,KALF,CAOC;AACA;AACA;AACA;;;AAEA,WAAO,KAAP;AAEA,GAdO;AAgBR;;;;;AAGQ,+CAAR;AAEC,QAAI,CAAC,KAAK,OAAV,EAAmB;AAClB,UAAI;AACH,cAAM,IAAI,KAAJ,CAAU,0CAAwC,IAAI,CAAC,SAAL,CAAe,KAAK,OAApB,CAAlD,CAAN;AACA,OAFD,CAEE,OAAO,CAAP,EAAU;AACX,eAAO,CAAC,GAAR,CAAY,CAAZ;AACA;;AACD,aAAO,KAAP;AACA;;AAED,WAAO,IAAP;AAEA,GAbO;;AAeT;AAAC,CA/GD;;AAAa,0C;;;;;;;;;;;;;;;;;;ACLb;;AACA;;AAEA,IAAY,aAAZ;;AAAA,WAAY,aAAZ,EAAyB;AACxB;AACA;AACA,CAHD,EAAY,aAAa,GAAb,kDAAa,EAAb,CAAZ;AAqBA;;;AACA;AAAA;AAAA;AAAA;AAES,uBAAoC,EAApC;AACA,mBAAkB,CAAlB;AAqIR;;AAjIO,6CAAP,UAAe,IAAf,EAAiC;AAChC,SAAK,aAAL,GAAqB,IAArB;AACA,GAFM;AAIP;;;;;;AAIO,kDAAP,UAAoB,MAApB,EAAkC;AACjC,SAAK,OAAL,GAAe,MAAf;;AACA,SAAK,iBAAL,CAAuB,KAAK,OAA5B;AACA,GAHM;AAKP;;;;;;AAIO,kDAAP,UAAoB,OAApB,EAAwC;AAEvC,SAAK,kBAAL;;AACA,SAAK,gBAAL;;AACA,SAAK,UAAL,GAAkB,OAAlB;;AAEA,QAAI,KAAK,UAAT,EAAqB;AACpB,WAAK,iBAAL;;AACA,WAAK,UAAL,CAAgB,gBAAhB,CAAiC,QAAjC,EAA2C,KAAK,MAAL,CAAY,IAAZ,CAAiB,IAAjB,CAA3C;AACA;AAED,GAXM;AAaP;;;AACO,4CAAP;AACC,SAAK,iBAAL;AACA,GAFM,CAtCR,CA0CC;AACA;;AAEA;;;AACQ,wDAAR;AACC,SAAK,WAAL,CAAiB,OAAjB,CAA0B,UAAC,SAAD,EAAU;AACnC,eAAS,CAAC,OAAV;AACA,KAFD;;AAGA,SAAK,WAAL,GAAmB,EAAnB;AACA,GALO;AAOR;;;AACQ,sDAAR;AACC,QAAI,KAAK,UAAT,EAAqB;AACpB,WAAK,UAAL,CAAgB,mBAAhB,CAAoC,QAApC,EAA8C,KAAK,MAAL,CAAY,IAAZ,CAAiB,IAAjB,CAA9C;AACA;AACD,GAJO;AAMR;;;AACQ,uDAAR;AAAA;;AACC,SAAK,UAAL,CAAgB,gBAAhB,CAAiC,YAAjC,EAA+C,OAA/C,CAAwD,UAAC,OAAD,EAAqB;AAC5E,UAAI,EAAE,GAAW,OAAO,CAAC,YAAR,CAAqB,IAArB,CAAjB;AACA,UAAI,UAAU,GAA2B,IAAI,CAAC,KAAL,CAAW,OAAO,CAAC,YAAR,CAAqB,gBAArB,CAAX,EAAmD,UAA5F;;AACA,UAAK,KAAI,CAAC,aAAL,CAAmB,EAAnB,EAAuB,UAAvB,CAAL,EAA0C;AACzC,aAAI,CAAC,wBAAL,CAA8B,UAA9B,EAA0C,EAA1C;AACA;AACD,KAND;AAOA,GARO;AAUR;;;;;AAGQ,8DAAR,UAAiC,UAAjC,EAAqE,EAArE,EAA+E;AAA/E;;AAEC,cAAU,CAAC,OAAX,CAAoB,UAAC,MAAD,EAAwB;AAE3C;AACA,YAAM,CAAC,EAAP,GAAY,EAAZ;AACA,YAAM,CAAC,mBAAP,GAA6B,IAA7B;AACA,YAAM,CAAC,YAAP,GAAsB,KAAI,CAAC,aAA3B;;AAEA,UAAI,MAAM,CAAC,IAAP,KAAgB,aAAa,CAAC,SAAlC,EAA6C;AAC5C,aAAI,CAAC,WAAL,CAAiB,IAAjB,CAAuB,IAAI,uCAAJ,CAAuB,MAAvB,EAA+B,KAAI,CAAC,UAApC,CAAvB;AACA,OAFD,MAEO,IAAI,MAAM,CAAC,IAAP,KAAgB,aAAa,CAAC,MAAlC,EAA0C;AAChD,aAAI,CAAC,WAAL,CAAiB,IAAjB,CAAuB,IAAI,iCAAJ,CAAoB,MAApB,EAA4B,KAAI,CAAC,UAAjC,CAAvB;AACA;AAED,KAbD;AAeA,GAjBO;AAmBR;;;AACQ,uDAAR;AAEC,SAAK,WAAL,CAAiB,OAAjB,CAA0B,UAAC,SAAD,EAAU;AACnC,eAAS,CAAC,MAAV;AACA,KAFD;;AAIA,WAAO,CAAC,GAAR,CAAY,qBAAZ;AACC,UAAc,CAAC,QAAf,CAAwB,OAAxB;AAED,GATO;AAWR;;;;;AAGQ,uDAAR,UAA0B,MAA1B,EAAwC;AACvC,SAAK,WAAL,CAAiB,OAAjB,CAA0B,UAAC,SAAD,EAAU;AACnC,eAAS,CAAC,MAAV,CAAiB,MAAjB;AACA,KAFD;AAGA,GAJO;AAMR;;;;;;;;AAMQ,mDAAR,UAAsB,EAAtB,EAAkC,MAAlC,EAAgE;AAE/D,QAAI,CAAC,EAAD,IAAO,EAAE,KAAK,EAAlB,EAAsB;AACrB,UAAI;AACH,cAAM,IAAI,KAAJ,CAAU,uDAAqD,IAAI,CAAC,SAAL,CAAe,MAAf,CAA/D,CAAN;AACA,OAFD,CAEE,OAAO,CAAP,EAAU;AACX,eAAO,CAAC,GAAR,CAAY,CAAZ;AACA;;AACD,aAAO,KAAP;AACA;;AAGD,WAAO,IAAP;AAEA,GAdO;;AAgBT;AAAC,CAxID;;AAAa,wD;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;IC1Bb;;AACA;;AACA;;AACA;;AACA;;AAEA;;AACA;;AACA;;AACA;;AACA;;AAEA,mF,CAwBA;;;AAEA;AAAA;AAAA;AAAmC;;AAAnC;;AAkaC;;AAvYO,iCAAP;AACC,SAAK,kBAAL;;AACA,SAAK,qBAAL;;AACA,SAAK,aAAL;;AACA,SAAK,iBAAL;AACA,GALM;;AAOA,qCAAP,aAEC,CAFM;;AAIA,2CAAP,aACC;AACA,GAFM;;AAIP,wBAAW,uBAAX,EAAW,MAAX,EAAe;SAAf;AACC,aAAQ,KAAK,KAAL,CAAW,OAAX,EAAR;AACA,KAFc;oBAAA;;AAAA,GAAf,EA1CD,CA8CC;AACA;AACA;AACA;AACA;;AAEA;;AACQ,+CAAR;AAEC,SAAK,KAAL,GAAa,KAAK,GAAL,CAAS,MAAT,CAAb;AACA,SAAK,QAAL,GAAgB,KAAK,GAAL,CAAS,SAAT,CAAhB;AACA,SAAK,MAAL,GAAc,KAAK,GAAL,CAAS,OAAT,CAAd;AACA,SAAK,QAAL,GAAgB,KAAK,GAAL,CAAS,SAAT,CAAhB;AACA,SAAK,UAAL,GAAkB,KAAK,GAAL,CAAS,WAAT,CAAlB;AACA,SAAK,WAAL,GAAmB,KAAK,GAAL,CAAS,YAAT,CAAnB;AACA,SAAK,GAAL,GAAW,KAAK,GAAL,CAAS,IAAT,CAAX;AACA,SAAK,QAAL,GAAgB,KAAK,GAAL,CAAS,SAAT,CAAhB;AACA,SAAK,KAAL,GAAa,KAAK,GAAL,CAAS,MAAT,CAAb;AACA,SAAK,OAAL,GAAe,KAAK,GAAL,CAAS,QAAT,CAAf;AACA,SAAK,QAAL,GAAgB,KAAK,GAAL,CAAS,SAAT,CAAhB;AACA,SAAK,QAAL,GAAgB,KAAK,GAAL,CAAS,SAAT,CAAhB;AACA,SAAK,KAAL,GAAa,KAAK,GAAL,CAAS,MAAT,CAAb;;AAEA,SAAK,OAAL,CAAa,aAAb,CAA2B,uBAAe,MAA1C;;AACA,SAAK,QAAL,CAAc,aAAd,CAA4B,uBAAe,OAA3C;AAEA,GAnBO;AAqBR;;;AACQ,kDAAR;AACC,SAAK,QAAL,CAAc,cAAd,CAA6B,KAAK,GAAlC;;AACA,SAAK,QAAL,CAAc,cAAd,CAA6B,KAAK,KAAlC;;AACA,SAAK,GAAL,CAAS,cAAT,CAAwB,KAAK,UAA7B;;AACA,SAAK,OAAL,CAAa,cAAb,CAA4B,KAAK,MAAjC,EAAyC,KAAK,WAA9C,EAA2D,KAAK,KAAhE;;AACA,SAAK,QAAL,CAAc,cAAd,CAA6B,KAAK,MAAlC,EAA0C,KAAK,WAA/C,EAA4D,KAAK,KAAjE;;AACA,SAAK,KAAL,CAAW,cAAX,CAA0B,KAAK,MAA/B,EAAuC,KAAK,WAA5C,EAAyD,KAAK,KAA9D;;AACA,SAAK,KAAL,CAAW,cAAX,CAA0B,KAAK,UAA/B;;AACA,SAAK,QAAL,CAAc,cAAd,CAA6B,KAAK,MAAlC,EAA0C,KAAK,UAA/C,EAA2D,KAAK,KAAhE,EAAuE,KAAK,QAA5E,EAAsF,KAAK,OAA3F;;AACA,SAAK,WAAL,CAAiB,cAAjB,CAAgC,KAAK,MAArC;AACA,GAVO;AAYR;;;AACQ,8CAAR;AACC,SAAK,QAAL,CAAc,OAAd,CAAsB,KAAK,KAAL,CAAW,OAAX,EAAtB,EAA4C,KAAK,KAAL,CAAW,aAAX,EAA5C,EAAwE,KAAK,KAAL,CAAW,OAAX,CAAmB,uBAAe,OAAlC,CAAxE;;AACA,SAAK,OAAL,CAAa,OAAb,CAAqB,KAAK,KAAL,CAAW,OAAX,EAArB,EAA2C,KAAK,KAAL,CAAW,aAAX,EAA3C,EAAuE,KAAK,KAAL,CAAW,OAAX,CAAmB,uBAAe,MAAlC,CAAvE;;AACA,SAAK,KAAL,CAAW,OAAX,CAAmB,KAAK,KAAL,CAAW,OAAX,EAAnB,EAAyC,KAAK,KAAL,CAAW,OAAX,EAAzC;;AACA,SAAK,WAAL,CAAiB,OAAjB,CAAyB,KAAK,KAAL,CAAW,OAAX,EAAzB,EAA+C,KAAK,KAAL,CAAW,aAAX,EAA/C;AACA,GALO;AAOR;;;AACQ,0CAAR;AAEC;AACA,oBAAO,EAAP,CAAU,6CAAV,EAAkC,KAAK,qBAAL,CAA2B,IAA3B,CAAgC,IAAhC,CAAlC;AACA,oBAAO,EAAP,CAAU,yCAAV,EAAgC,KAAK,iBAAL,CAAuB,IAAvB,CAA4B,IAA5B,CAAhC;AACA,oBAAO,EAAP,CAAU,6BAAV,EAA0B,KAAK,aAAL,CAAmB,IAAnB,CAAwB,IAAxB,CAA1B;AACA,oBAAO,EAAP,CAAU,+BAAV,EAA0B,KAAK,YAAL,CAAkB,IAAlB,CAAuB,IAAvB,CAA1B,EAND,CAQC;;AACA,oBAAO,EAAP,CAAU,sBAAU,gBAApB,EAAsC,KAAK,iBAAL,CAAuB,IAAvB,CAA4B,IAA5B,CAAtC;AACA,oBAAO,EAAP,CAAU,sBAAU,cAApB,EAAoC,KAAK,gBAAL,CAAsB,IAAtB,CAA2B,IAA3B,CAApC;AACA,oBAAO,EAAP,CAAU,sBAAU,iBAApB,EAAuC,KAAK,kBAAL,CAAwB,IAAxB,CAA6B,IAA7B,CAAvC;AACA,oBAAO,EAAP,CAAU,sBAAU,yBAApB,EAA+C,KAAK,yBAAL,CAA+B,IAA/B,CAAoC,IAApC,CAA/C;AACA,oBAAO,EAAP,CAAU,uDAAV,EAAsC,KAAK,wBAAL,CAA8B,IAA9B,CAAmC,IAAnC,CAAtC,EAbD,CAeC;;AACA,oBAAO,EAAP,CAAU,sBAAU,gBAApB,EAAuC,KAAK,iBAAL,CAAuB,IAAvB,CAA4B,IAA5B,CAAvC;AACA,oBAAO,EAAP,CAAU,sBAAU,gCAApB,EAAuD,KAAK,+BAAL,CAAqC,IAArC,CAA0C,IAA1C,CAAvD;AACA,oBAAO,EAAP,CAAU,sBAAU,iBAApB,EAAwC,KAAK,kBAAL,CAAwB,IAAxB,CAA6B,IAA7B,CAAxC;AACA,oBAAO,EAAP,CAAU,sBAAU,cAApB,EAAqC,KAAK,eAAL,CAAqB,IAArB,CAA0B,IAA1B,CAArC;AAEA,GArBO,CAhGT,CAuHC;;;AACQ,kDAAR,UAA8B,aAA9B,EAAkE;AAEjE,WAAO,CAAC,GAAR,CAAY,eAAZ,EAA6B,aAA7B,EAFiE,CAIjE;;AACA,QAAK,aAAa,CAAC,IAAd,KAAuB,yBAAiB,WAA7C,EAA0D;AACzD,WAAK,WAAL,CAAiB,qBAAjB,CAAuC,aAAa,CAAC,QAAd,CAAuB,WAA9D;AACA,KAFD,MAEO,IAAI,aAAa,CAAC,IAAd,KAAuB,yBAAiB,cAA5C,EAA6D;AACnE,WAAK,KAAL,CAAW,mBAAX,CAA+B,aAAa,CAAC,QAAd,CAAuB,WAAtD;AACA,KAFM,MAEA,IAAI,aAAa,CAAC,IAAd,KAAuB,yBAAiB,cAA5C,EAA4D;AAClE;AACA,WAAK,QAAL,CAAc,mBAAd,CAAkC,aAAa,CAAC,QAAd,CAAuB,WAAzD;;AACA,WAAK,OAAL,CAAa,mBAAb,CAAiC,aAAa,CAAC,QAAd,CAAuB,WAAxD;AACA,KAJM,MAIA,IAAI,aAAa,CAAC,IAAd,KAAuB,yBAAiB,uBAA5C,EAAsE;AAC5E,WAAK,QAAL,CAAc,qBAAd,CAAoC,aAAa,CAAC,QAAd,CAAuB,WAA3D,EAAwE,uBAAe,OAAvF;AACA,KAFM,MAEA,IAAI,aAAa,CAAC,IAAd,KAAuB,yBAAiB,uBAA5C,EAAsE;AAC5E,WAAK,OAAL,CAAa,qBAAb,CAAmC,aAAa,CAAC,QAAd,CAAuB,WAA1D,EAAuE,uBAAe,MAAtF;AACA,KAFM,MAEA,IAAI,aAAa,CAAC,IAAd,KAAuB,yBAAiB,IAA5C,EAAmD;AACzD,WAAK,KAAL,CAAW,cAAX,CAA0B,aAAa,CAAC,QAAd,CAAuB,WAAjD;AACA;AAED,GArBO;AAuBR;;;AACQ,8CAAR,UAA0B,KAA1B,EAAoD;AAEnD,QAAI,EAAE,GAAW,KAAK,CAAC,MAAN,CAAa,EAA9B;AACA,QAAI,IAAI,GAAW,KAAK,CAAC,MAAN,CAAa,IAAhC;;AAEA,QAAI,EAAE,KAAM,GAAZ,EAAiB;AAChB,WAAK,KAAL,CAAW,OAAX,CAAmB,IAAnB;AACA,KAFD,MAEO,IAAI,EAAE,KAAM,SAAR,IAAqB,EAAE,KAAM,UAA7B,IAA2C,EAAE,KAAM,QAAnD,IAA+D,EAAE,KAAM,WAA3E,EAAwF;AAC9F,UAAI,UAAU,GAAW,EAAE,CAAC,SAAH,CAAa,CAAb,EAAiB,EAAE,CAAC,MAAH,GAAY,CAA7B,CAAzB;;AACA,WAAK,KAAL,CAAW,OAAX,CAAmB,IAAnB,EAA0B,UAA1B;AACA,KAHM,MAGA,IAAI,EAAE,KAAM,WAAZ,EAAyB;AAC/B,WAAK,QAAL,CAAc,OAAd,CAAsB,IAAtB;AACA,KAFM,MAEA,IAAI,EAAE,KAAM,UAAZ,EAAwB;AAC9B,WAAK,OAAL,CAAa,OAAb,CAAqB,IAArB;AACA,KAFM,MAEA;AACN;AACA,WAAK,QAAL,CAAc,OAAd,CAAsB,EAAtB,EAA0B,IAA1B;AACA;AAED,GAnBO;AAqBR;;;AACQ,0CAAR,UAAsB,KAAtB,EAA0C;AACzC,QAAI,KAAK,CAAC,EAAN,KAAa,cAAjB,EAAiC;AAChC,WAAK,QAAL,CAAc,OAAd,CAAsB,KAAK,CAAC,IAA5B;AACA,KAFD,MAEO,IAAI,KAAK,CAAC,EAAN,KAAa,aAAjB,EAAgC;AACtC,WAAK,OAAL,CAAa,OAAb,CAAqB,KAAK,CAAC,IAA3B;AACA,KAFM,MAEC,IAAI,KAAK,CAAC,EAAN,KAAa,WAAjB,EAA8B;AACrC,WAAK,KAAL,CAAW,OAAX,CAAmB,KAAK,CAAC,IAAzB;AACA;AACD,GARO;AAUR;AACA;AACC;AACD;;AAEA;;;;;;AAIQ,yCAAR,UAAqB,KAArB,EAA0C;AAEzC;AACA;AACA,QAAI,qBAAqB,GAAY,KAAK,QAAL,CAAc,SAAd,CAAwB,KAAxB,CAArC,CAJyC,CAMzC;;;AACA,QAAI,qBAAJ,EAA2B;AAC1B,WAAK,QAAL,CAAc,IAAd;;AACA,WAAK,qBAAL,CAA2B,KAA3B,CAAiC,IAAjC,EAAuC,IAAvC;;AACA,WAAK,qBAAL,CAA2B,IAA3B,CAAgC,IAAhC,EAAsC,IAAtC;AACA;AAED,GAbO,CAzLT,CAwMC;;;AACQ,8CAAR,UAA0B,WAA1B,EAAwD;AAEvD;AACA,SAAK,QAAL,CAAc,cAAd,CAA6B,WAA7B;;AACA,SAAK,QAAL,CAAc,QAAd,CAAuB,WAAvB,EAAoC,KAApC;;AACA,SAAK,GAAL,CAAS,QAAT,CAAkB,WAAlB,EALuD,CAOvD;;;AACA,SAAK,yBAAL,CAA+B,WAA/B,EARuD,CAUvD;;;AACA,SAAK,QAAL,CAAc,cAAd,CAA6B,WAA7B;AAEA,GAbO;AAeR;;;AACQ,6CAAR,UAAyB,WAAzB,EAAyD,gBAAzD,EAAyF;AAAhC;AAAA;AAAgC,MAExF;;;AACA,QAAI,WAAW,GAAc,KAAK,uBAAL,CAA6B,WAA7B,EAAkD,aAAlD,CAAgE,WAAhE,CAA7B,CAHwF,CAKxF;;;AACA,QAAK,gBAAL,EAAuB;AACtB,WAAK,QAAL,CAAc,IAAd,CAAmB,WAAnB,EAAgC,WAAW,CAAC,KAA5C,EAAmD,WAAW,CAAC,IAA/D;AACA,KARuF,CAUxF;;;AACA,SAAK,GAAL,CAAS,QAAT,CAAkB,WAAlB;;AACA,SAAK,QAAL,CAAc,QAAd,CAAuB,WAAvB,EAZwF,CAcxF;;;AACA,QAAI,WAAW,CAAC,QAAZ,IAAwB,KAAK,QAAL,CAAc,SAAd,EAA5B,EAAuD;AACtD,WAAK,QAAL,CAAc,KAAd;;AACA,WAAK,kBAAL,CAAwB;AAAC,aAAK,EAAE,sBAAc;AAAtB,OAAxB;AACA,KAlBuF,CAoBxF;AACA;;;AACA,QAAI,WAAW,CAAC,iBAAhB,EAAmC;AAClC,WAAK,yBAAL,CAA+B,WAA/B;;AACA;AACA,KAzBuF,CA2BxF;AACA;;;AACA,QAAI,KAAK,YAAL,CAAkB,OAAlB,KAA8B,WAAW,CAAC,OAA1C,IAAqD,KAAK,YAAL,CAAkB,OAAlB,KAA8B,oBAAY,IAAnG,EAAyG;AACxG,WAAK,YAAL,GAAoB,WAApB;;AACC,WAAK,qBAAL,CAAmC,qBAAnC,CAAyD,WAAzD;;AACD,WAAK,QAAL,CAAc,KAAd;;AACA;AACA,KAlCuF,CAoCxF;AACA;;;AACA,QAAI,WAAW,CAAC,UAAZ,IAA0B,CAAC,WAA/B,EAA4C;AAC3C,WAAK,WAAL,CAAiB,WAAjB;;AACA;AACA,KAzCuF,CA2CxF;AACA;AAEA;;;AACA,SAAK,qBAAL,CAA2B,IAA3B,CAAgC,WAAhC,EA/CwF,CAiDxF;;;AACA,QAAI,QAAQ,GAAsB,KAAK,YAAvC;;AACA,SAAK,yBAAL,CAA+B,WAA/B;;AACA,SAAK,qBAAL,CAA2B,KAA3B,CAAiC,QAAjC;;AACA,SAAK,qBAAL,CAA2B,IAA3B,CAAgC,QAAhC;AAEA,GAvDO;AAyDR;;;AACQ,+CAAR,UAA2B,WAA3B,EAAyD;AAExD;AACA,QAAI,KAAK,YAAL,CAAkB,OAAlB,KAA8B,WAAW,CAAC,OAA9C,EAAuD;AACtD,WAAK,YAAL,GAAoB,WAApB;;AACC,WAAK,qBAAL,CAAmC,qBAAnC,CAAyD,WAAzD;;AACD;AACA,KAPuD,CASxD;;;AACA,eAAW,CAAC,UAAZ,GAAyB,IAAzB;AACA,eAAW,CAAC,QAAZ,GAAuB,KAAvB;AACA,eAAW,CAAC,iBAAZ,GAAgC,KAAhC,CAZwD,CAcxD;;AACA,SAAK,gBAAL,CAAsB,WAAtB,EAAmC,KAAnC;AAEA,GAjBO;AAmBR;;;AACQ,wCAAR,UAAoB,WAApB,EAAkD;AAEjD,WAAO,CAAC,GAAR,CAAY,6BAAZ,EAA2C,WAA3C,EAFiD,CAIjD;;AACC,SAAK,qBAAL,CAAmC,MAAnC,GALgD,CAOjD;;;AACA,SAAK,yBAAL,CAA+B,WAA/B,EARiD,CAUjD;;;AACA,SAAK,MAAL,CAAY,mBAAZ,CAAgC,KAAhC;;AACA,SAAK,QAAL,CAAc,kBAAd,CAAkC,KAAK,qBAAvC;;AACA,SAAK,GAAL,CAAS,IAAT;AAEA,GAfO;AAiBR;;;AACQ,sDAAR,UAAkC,WAAlC,EAAgE;AAE/D;AACA,SAAK,YAAL,GAAoB,WAApB;AACA,SAAK,qBAAL,GAA6B,KAAK,uBAAL,CAA6B,WAA7B,CAA7B;;AACC,SAAK,qBAAL,CAAmC,QAAnC,CAA4C,KAAK,YAAjD;AAED,GAPO;AASR;;;AACQ,oDAAR,UAAgC,KAAhC,EAAwD;AAEvD,QAAI,UAAJ;AACA,QAAI,iBAAiB,GAAW,KAAK,CAAC,OAAtC;;AACA,QAAI,KAAK,CAAC,OAAN,KAAkB,oBAAY,IAAlC,EAAwC;AACvC,uBAAiB,GAAG,KAAK,CAAC,UAA1B;AACA;;AACD,WAAO,KAAK,GAAL,CAAS,iBAAT,CAAP;AAEA,GATO,CAnUT,CA8UC;;;AACQ,sDAAR;AACC;AACA;AACA,SAAK,QAAL,CAAc,KAAd;;AACA,SAAK,qBAAL,CAA2B,KAA3B,CAAiC,IAAjC,EAAuC,IAAvC;;AACA,SAAK,qBAAL,CAA2B,IAA3B,CAAgC,IAAhC,EAAsC,IAAtC;AACA,GANO;AAQR;;;AACQ,qDAAR,UAAiC,KAAjC,EAAkE;AACjE,QAAI,IAAI,GAAgB,KAAK,CAAC,UAAN,KAAqB,uBAAe,OAArC,GAAgD,KAAK,QAArD,GAAgE,KAAK,OAA5F;AACC,QAAY,CAAC,GAAb;AAED,YAAG,KAAH,CAAS,UAAT,EAAqB,mBAArB,EAA0C,KAAK,CAAC,UAAhD;AAEA,GANO,CAxVT,CAgWC;;;AACQ,8CAAR;AAEC,YAAG,KAAH,CAAS,IAAT,EAAe,YAAf,EAFD,CAIC;;AACA,QAAK,KAAK,YAAL,CAAkB,OAAlB,KAA8B,oBAAY,IAA/C,EAAsD;AACrD,WAAK,KAAL,CAAW,OAAX;;AACA,WAAK,KAAL,CAAW,sBAAX,CAAkC,CAAlC;;AACA,WAAK,MAAL,CAAY,mBAAZ,CAAgC,IAAhC;;AACA,WAAK,QAAL,CAAc,KAAd;;AACA;AACA,KAXF,CAaC;;;AACA,QAAI,WAAW,GAAsB;AACpC,aAAO,EAAE,oBAAY,IADe;AAEpC,WAAK,EAAE,MAF6B;AAGpC,UAAI,EAAE,GAH8B;AAIpC,gBAAU,EAAE,IAJwB;AAKpC,cAAQ,EAAE;AAL0B,KAArC;;AAOA,SAAK,gBAAL,CAAsB,WAAtB;AAEA,GAvBO;AAyBR;;;AACQ,4DAAR,UAAwC,UAAxC,EAAkE;AAEjE,WAAO,CAAC,GAAR,CAAY,yBAAZ;;AACA,SAAK,QAAL,CAAc,KAAd;;AACA,QAAI,cAAc,GAAI,UAAU,KAAK,uBAAe,OAA/B,GAA0C,KAAK,QAA/C,GAA0D,KAAK,OAApF;AACA,kBAAc,CAAC,sBAAf,CAAsC,CAAtC;AAEA,GAPO;AASR;;;AACQ,+CAAR,UAA2B,CAA3B,EAAiC;AAAjC;;AAEC,QAAI,KAAK,GAAkB,CAAC,CAAC,KAA7B;;AACA,QAAI,KAAK,KAAK,sBAAc,IAA5B,EAAkC;AAEjC,WAAK,qBAAL,CAA2B,KAA3B;;AACA,WAAK,MAAL,CAAY,KAAZ,GAHiC,CAKjC;AACA;;;AACA,gBAAU,CAAC;AAAM,oBAAI,CAAC,KAAL;AAAgB,OAAvB,EAAyB,IAAzB,CAAV;AAEA,KATD,MASO,IAAI,KAAK,KAAK,sBAAc,MAA5B,EAAoC;AAC1C,WAAK,qBAAL,CAA2B,OAA3B;;AACA,WAAK,MAAL,CAAY,OAAZ;AACA;;AAED,SAAK,GAAL,CAAS,WAAT,CAAqB,KAArB,EAjBgC,CAmBhC;;;AACA,YAAG,KAAH,CAAS,IAAT,EAAc,UAAd,EAA0B,KAA1B;AAEA,GAtBO;AAwBR;;;AACQ,4CAAR;AACC,SAAK,QAAL,CAAc,KAAd;AACA,GAFO;;AAIT;AAAC,CAlaD,CAAmC,uBAAnC;;AAAa,sC;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACtCb;;AAIA;;AAGA,iG,CAGA;;;AAEA;AAAA;AAAA;AAA0C,0CAA1C,CAqCC;;;AACA,gCAAY,EAAZ,EAAsB;AAAtB,gBACC,kBAAM,EAAN,KAAS,IADV;;AA9BQ,0BAA8C,EAA9C,CA8Bc,CA9ByC;;AACvD,iCAA0C,0BAAkB,IAA5D,CA6Bc,CA7BqD;;AAYnE,eAAa,CAAb;AACA,sBAAqB,KAArB,CAgBc,CAdtB;;AACQ,0BAAqB;AAAC,OAAC,EAAE,CAAJ;AAAO,OAAC,EAAE;AAAV,KAArB;AACA,gCAA2B;AAAC,OAAC,EAAE,CAAJ;AAAO,OAAC,EAAE;AAAV,KAA3B;AACA,yBAAoB;AAAC,OAAC,EAAE,CAAJ;AAAO,OAAC,EAAE;AAAV,KAApB;AACA,gCAA8B,IAA9B;AAIA,+BAA6B,CAA7B;AACA,iCAA+B,CAA/B;AACA,gCAA8B,EAA9B;AACA,kCAAgC,CAAhC;;AAKP,SAAI,CAAC,MAAL;;;AACA;;AAEM,2CAAP,UAAe,KAAf,EAAwC,YAAxC,EAAoE;AACnE,SAAK,MAAL,GAAc,KAAd;AACA,SAAK,iBAAL,GAAyB,YAAzB;AACA,GAHM;AAKP;;;AACO,kDAAP,UAAsB,KAAtB,EAA4C;AAC3C,SAAK,gBAAL,GAAwB,KAAxB;AACA,GAFM,CAjDR,CAqDC;;;AACO,0CAAP;AAAA;;AAEC,SAAK,WAAL,GAAmB,MAAM,CAAC,UAA1B;AACA,SAAK,YAAL,GAAoB,MAAM,CAAC,WAA3B;;AAEA,QAAI,KAAK,aAAL,CAAmB,MAAnB,KAA8B,CAAlC,EAAqC;AACpC;AACA;;AAED,SAAK,aAAL,CAAmB,OAAnB,CAA2B,UAAC,gBAAD,EAAuC;AACjE,sBAAgB,CAAC,MAAjB,CAAwB,KAAI,CAAC,WAA7B,EAA2C,KAAI,CAAC,YAAhD;AACA,KAFD;;AAIA,SAAK,sBAAL,CAA4B,KAAK,WAAjC,EAA+C,KAAK,YAApD;;AAEA,QAAI,CAAC,KAAK,SAAV,EAAqB;AACpB,WAAK,EAAL,GAAW,KAAK,EAAL,KAAY,CAAb,GAAmB,CAAC,CAAD,GAAK,MAAM,CAAC,WAA/B,GAA6C,CAAvD;AACA,WAAK,iBAAL,CAAuB,CAAvB,GAA2B,KAAK,EAAhC;AACA;AAED,GApBM,CAtDR,CA4EC;AACA;;;AACO,yDAAP,UAA6B,WAA7B,EAA2D;AAC1D,SAAK,YAAL,GAAoB,WAApB;AACA,SAAK,mBAAL,CAAyB,0BAAkB,IAA3C;AACA,SAAK,mBAAL,CAAyB,0BAAkB,OAA3C;AACA,SAAK,mBAAL,CAAyB,0BAAkB,MAA3C;AACA,GALM,CA9ER,CAqFC;;;AACO,uDAAP,UAA2B,GAA3B,EAAiD;AAEhD,QAAI,GAAG,KAAK,0BAAkB,IAA9B,EAAoC;AACnC,WAAK,oBAAL;AACA,KAFD,MAEO,IAAI,GAAG,KAAK,0BAAkB,OAA9B,EAAuC;AAC7C,WAAK,oBAAL,CAA0B,uBAAe,OAAzC;AACA,KAFM,MAEC,IAAI,GAAG,KAAK,0BAAkB,MAA9B,EAAsC;AAC7C,WAAK,oBAAL,CAA0B,uBAAe,MAAzC;AACA;;AAED,SAAK,yBAAL,CAA+B,GAA/B,EAVgD,CAYhD;;;AACA,SAAK,MAAL,GAbgD,CAehD;;AACA,SAAK,oBAAL;;AACA,SAAK,YAAL,CAAkB,GAAlB;AAEA,GAnBM,CAtFR,CA2GC;;;AACO,gDAAP,UAAoB,KAApB,EAAiC;AAEhC,QAAI,CAAC,KAAK,SAAV,EAAqB;AACpB,WAAK,iBAAL,CAAuB,CAAvB,GAA6B,CAAC,CAAD,IAAM,KAAK,aAAL,GAAqB,KAA3B,CAAD,GAAsC,KAAK,aAAL,CAAmB,CAArF;AACA,WAAK,iBAAL,CAAuB,CAAvB,GAA4B,KAAK,EAAL,GAAU,KAAK,aAAL,CAAmB,CAAzD;AACA,WAAK,MAAL,GAAc,KAAd;AACA;;AAED,QAAK,KAAK,eAAV,EAA2B;AAC1B,WAAK,eAAL,CAAqB,QAArB,CAA8B,KAAK,IAAL,CAAU,SAAV,CAAoB,KAApB,EAA2B,CAA3B,EAA8B,CAA9B,CAA9B;AACA;AAED,GAZM;;AAcA,wCAAP;AACC;AACA,QAAI,CAAC,KAAK,SAAV,EAAqB;AACpB,WAAK,qBAAL,CAA2B,KAAK,gBAAL,CAAsB,aAAtB,EAA3B;AACA;AACD,GALM;AAOP;;;;;;AAIO,iDAAP,UAAqB,UAArB,EAA+C;AAA/C;;AAEC,QAAI,CAAC,GAAY,UAAU,KAAK,uBAAe,OAA/B,GAA0C,CAA1C,GAA+C,CAAC,CAAD,IAAM,KAAK,aAAL,GAAqB,KAAK,MAAhC,CAA/D;AACA,KAAC,GAAG,CAAJ;AACA,SAAK,SAAL,GAAiB,IAAjB;;AACA,SAAK,cAAL;;AACA,SAAK,EAAL,GAAU,CAAC,CAAD,GAAK,MAAM,CAAC,WAAtB;AACA,QAAI,CAAC,QAAL,CAAc,EAAd,CAAiB,KAAK,iBAAtB,EAAyC,CAAzC,EAA4C;AAC3C,OAAC,EAAE,KAAK,EADmC;AAE3C,OAAC,EAAE,CAFwC;AAG3C,UAAI,EAAE,IAAI,CAAC,MAAL,CAAY,SAHyB;AAI3C,gBAAU,EAAE;AAAM,oBAAI,CAAJ;AAAqB;AAJI,KAA5C;AAOA,SAAK,eAAL,GAAwB,UAAU,KAAK,uBAAe,OAA/B,GAA0C,KAAK,gBAA/C,GAAkE,KAAK,eAA9F;AACA,GAfM;AAiBP;;;;;;AAIO,iDAAP,UAAqB,UAArB,EAA+C;AAA/C;;AAEC,QAAI,CAAC,GAAY,UAAU,KAAK,uBAAe,OAA/B,GAA0C,CAA1C,GAA+C,CAAC,CAAD,IAAM,KAAK,aAAL,GAAqB,KAAK,MAAhC,CAA/D;AACA,SAAK,EAAL,GAAU,CAAV;AACA,SAAK,SAAL,GAAiB,IAAjB;;AACA,SAAK,cAAL;;AACA,QAAI,CAAC,QAAL,CAAc,EAAd,CAAiB,KAAK,iBAAtB,EAAyC,CAAzC,EAA4C;AAC3C,OAAC,EAAE,KAAK,EADmC;AAE3C,OAAC,EAAE,CAFwC;AAG3C,UAAI,EAAE,IAAI,CAAC,MAAL,CAAY,SAHyB;AAI3C,gBAAU,EAAE;AAAM,oBAAI,CAAJ;AAAqB;AAJI,KAA5C;AAOA,SAAK,eAAL,GAAuB,KAAK,aAA5B;AAEA,GAfM;AAiBP;;;AACO,+CAAP,UAAmB,QAAnB,EAAoC;AACnC,SAAK,SAAL,GAAiB,QAAjB;AACA,GAFM;AAIP;;;AACO,uDAAP;AACC,SAAK,cAAL;AACA,GAFM;AAIP;;;AACO,yCAAP,UAAa,KAAb,EAA4C;AAA/B;AAAA;AAA+B;;AAE3C,SAAK,SAAL,GAAiB,KAAjB;;AACA,SAAK,cAAL;;AAEA,QAAI,KAAK,CAAC,OAAN,KAAkB,oBAAY,IAAlC,EAAwC;AACvC,WAAK,MAAL,GAAc,GAAd;AACA,WAAK,EAAL,GAAU,CAAV;AACA,WAAK,eAAL,GAAuB,KAAK,aAA5B;AACA;;AAED,QAAI,KAAK,CAAC,OAAN,KAAkB,oBAAY,IAAlC,EAAwC;AACvC,WAAK,MAAL,GAAe,KAAK,CAAC,UAAN,KAAqB,uBAAe,OAArC,GAAgD,CAAhD,GAAoD,CAAlE;AACA,WAAK,EAAL,GAAU,CAAC,CAAD,GAAK,MAAM,CAAC,WAAtB;AACA,WAAK,eAAL,GAAwB,KAAK,CAAC,UAAN,KAAqB,uBAAe,OAArC,GAAgD,KAAK,gBAArD,GAAwE,KAAK,eAApG;AACA,KAf0C,CAiB3C;;;AACA,QAAI,CAAC,GAAW,CAAC,CAAD,IAAM,KAAK,aAAL,GAAqB,KAAK,MAAhC,CAAhB;AACA,QAAI,CAAC,QAAL,CAAc,GAAd,CAAkB,KAAK,iBAAvB,EAA0C;AAAC,OAAC,EAAE,KAAK,EAAT;AAAa,OAAC,EAAE;AAAhB,KAA1C,EAnB2C,CAqB3C;;AACA,QAAK,KAAK,eAAV,EAA6B;AAC5B,WAAK,eAAL,CAAqB,QAArB,CAA8B,KAAK,MAAnC;AACA;AAGD,GA3BM,CAtLR,CAmNC;AACA;AACA;AACA;AACA;AAEA;;;AACQ,wDAAR;AAEC;AACA,QAAI,OAAO,GAAG,IAAI,oBAAJ,CAAyB,KAAK,iBAA9B,EAAiD,KAAK,YAAL,CAAkB,QAAlB,CAA2B,gBAA3B,CAAjD,CAAd;AACA,WAAO,CAAC,OAAR,GAAkB,0BAAkB,IAApC;AACA,WAAO,CAAC,EAAR,GAAa,cAAb;;AACA,SAAK,aAAL,CAAmB,IAAnB,CAAwB,OAAxB,EAND,CAQC;;;AACA,QAAI,MAAM,GAAG,IAAI,oBAAJ,CAAyB,KAAK,iBAA9B,EAAiD,KAAK,YAAL,CAAkB,QAAlB,CAA2B,gBAA3B,CAAjD,EAA+F,IAA/F,CAAb;AACA,UAAM,CAAC,OAAP,GAAiB,0BAAkB,IAAnC;AACA,UAAM,CAAC,EAAP,GAAY,aAAZ,CAXD,CAYC;;AACA,SAAK,aAAL,CAAmB,IAAnB,CAAwB,MAAxB;AAEA,GAfO,CA1NT,CA2OC;;;AACQ,wDAAR,UAA6B,UAA7B,EAAuD;AAEtD,QAAI,UAAU,KAAM,uBAAe,OAAnC,EAA4C;AAE3C;AACA,UAAI,IAAI,GAAG,IAAI,oBAAJ,CAAyB,KAAK,iBAA9B,EAAiD,KAAK,YAAL,CAAkB,QAAlB,CAA2B,gBAA3B,CAAjD,EAA+F,KAA/F,EAAsG,IAAtG,CAAX;AACA,UAAI,CAAC,OAAL,GAAe,0BAAkB,OAAjC;AACA,UAAI,CAAC,EAAL,GAAU,cAAV,CAL2C,CAM3C;;AACA,WAAK,aAAL,CAAmB,IAAnB,CAAwB,IAAxB,EAP2C,CAS3C;;;AACA,UAAI,KAAK,GAAG,IAAI,oBAAJ,CAAyB,KAAK,iBAA9B,EAAkD,KAAK,YAAL,CAAkB,QAAlB,CAA2B,gBAA3B,CAAlD,EAAgG,IAAhG,EAAsG,IAAtG,CAAZ;AACA,WAAK,CAAC,OAAN,GAAgB,0BAAkB,OAAlC;AACA,WAAK,CAAC,EAAN,GAAW,eAAX,CAZ2C,CAa3C;;AACA,WAAK,aAAL,CAAmB,IAAnB,CAAwB,KAAxB;AAEA,KAhBD,MAgBO,IAAI,UAAU,KAAM,uBAAe,MAAnC,EAA2C,CAEjD;AAED,GAtBO,CA5OT,CAoQC;;;AACQ,0DAAR,UAA+B,UAA/B,EAAmD,WAAnD,EAAsE;AAErE;AACA,QAAI,aAAa,GAAyB,KAAK,kBAAL,CAAwB,cAAxB,CAA1C;;AAEA,QAAI,aAAJ,EAAmB;AAClB;AACA,mBAAa,CAAC,WAAd,CAA0B,UAAU,GAAG,CAAvC,EAA0C,WAAW,GAAG,CAAxD,EAFkB,CAIlB;;AACA,UAAI,YAAY,GAAyB,KAAK,kBAAL,CAAwB,aAAxB,CAAzC;;AACA,kBAAY,CAAC,WAAb,CAA0B,UAAU,GAAG,CAAd,GAAmB,aAAa,CAAC,OAAd,GAAwB,KAApE,EAA2E,WAAW,GAAG,CAAzF;AACA,KAZoE,CAcrE;;;AACA,QAAI,aAAa,GAAyB,KAAK,kBAAL,CAAwB,cAAxB,CAA1C;;AAEA,QAAI,aAAJ,EAAmB;AAElB;AACA;AACA,UAAI,SAAO,GAAW,UAAU,GAAG,CAAnC;AACA,UAAI,SAAO,GAAY,WAAW,GAAG,CAAf,GAAoB,aAAa,CAAC,OAAd,GAAwB,MAAlE;AACA,mBAAa,CAAC,WAAd,CAA0B,SAA1B,EAAoC,SAApC,EANkB,CAQlB;;AACA,UAAI,eAAe,GAAyB,KAAK,kBAAL,CAAwB,eAAxB,CAA5C;;AACA,qBAAe,CAAC,WAAhB,CAA4B,SAAO,GAAG,aAAa,CAAC,OAAd,GAAwB,KAA9D,EAAqE,SAArE,EAVkB,CAYlB;AAEA,KA/BoE,CAiCrE;;AAEA,GAnCO,CArQT,CA0SC;;;AACQ,wDAAR;AAEC,QAAI,KAAK,oBAAL,KAA8B,0BAAkB,IAApD,EAA0D;AAEzD;AACA,UAAI,YAAY,GAA0B,KAAK,kBAAL,CAAwB,aAAxB,CAA1C;;AACA,WAAK,aAAL,GAAqB,YAAY,CAAC,SAAb,GAAyB,CAAzB,GAA8B,YAAY,CAAC,OAAb,GAAuB,KAAvB,GAA+B,CAAlF;AAEA,KAND,MAMO,IAAI,KAAK,oBAAL,KAA8B,0BAAkB,OAApD,EAA6D;AAEnE;AACA,UAAI,OAAO,GAA0B,KAAK,kBAAL,CAAwB,eAAxB,CAArC;;AACA,WAAK,aAAL,GAAqB,OAAO,CAAC,SAAR,GAAoB,CAApB,GAAyB,OAAO,CAAC,OAAR,GAAkB,KAAlB,GAA0B,CAAxE;AAEA,KANM,MAMA,IAAI,KAAK,oBAAL,KAA8B,0BAAkB,MAApD,EAA4D,CAElE;AAED,GAlBO,CA3ST,CA+TC;AACA;;;AACQ,6DAAR,UAAkC,GAAlC,EAAwD;AAEvD,QAAI,GAAG,KAAM,0BAAkB,IAA/B,EAAqC;AAEpC,WAAK,aAAL,GAAqB,IAAI,IAAI,CAAC,WAAT,EAArB;;AACA,WAAK,aAAL,CAAmB,KAAnB,GAHoC,CAIpC;;;AACA,UAAI,WAAW,GAAG,KAAK,iBAAvB,CALoC,CAOpC;AACC;AACA;AACA;AACA;AACA;;AAED,WAAK,eAAL,GAAuB,KAAK,aAA5B;AAEA,KAhBD,MAgBQ,IAAI,GAAG,KAAM,0BAAkB,OAA/B,EAAwC;AAE/C,WAAK,gBAAL,GAAwB,IAAI,IAAI,CAAC,WAAT,EAAxB;;AACA,WAAK,gBAAL,CAAsB,KAAtB,GAH+C,CAK/C;;;AACA,UAAI,WAAW,GAAG,KAAK,iBAAvB;;AAEA,WAAK,gBAAL,CACE,IADF,CACO,WADP,EACoB,GADpB,EACyB;AAAC,YAAI,EAAE;AAAC,2BAAiB,EAAE;AAApB,SAAP;AAAkC,YAAI,EAAE,IAAI,CAAC,MAAL,CAAY;AAApD,OADzB,EACwF,CADxF,EAC+F;AAD/F,OAEE,EAFF,CAEK,WAFL,EAEkB,GAFlB,EAEuB;AAAC,YAAI,EAAE;AAAC,kBAAQ,EAAE,QAAX;AAAsB,wBAAc,EAAE,GAAtC;AAA2C,cAAI,EAAE,IAAI,CAAC,MAAL,CAAY;AAA7D;AAAP,OAFvB,EAEuG,GAFvG,EAE4G;AAF5G,OAGE,EAHF,CAGK,WAHL,EAGkB,GAHlB,EAGuB;AAAC,YAAI,EAAE;AAAC,kBAAQ,EAAE,QAAX;AAAsB,wBAAc,EAAE,GAAtC;AAA2C,cAAI,EAAE,IAAI,CAAC,MAAL,CAAY;AAA7D;AAAP,OAHvB,EAGuG,GAHvG,EAG4G;AAH5G,OAIE,EAJF,CAIK,WAJL,EAIkB,GAJlB,EAIuB;AAAC,YAAI,EAAE;AAAC,kBAAQ,EAAE,IAAX;AAAkB,wBAAc,EAAE,GAAlC;AAAuC,cAAI,EAAE,IAAI,CAAC,MAAL,CAAY;AAAzD;AAAP,OAJvB,EAImG,GAJnG,EAIyG;AAJzG,OAKE,GALF,CAKM,WALN,EAKmB;AAAC,YAAI,EAAE;AAAE,eAAK,EAAE;AAAT;AAAP,OALnB,EAKyC,CALzC;AAOA,KAfO,MAeD,IAAI,GAAG,KAAM,0BAAkB,MAA/B,EAAuC;AAE7C,WAAK,eAAL,GAAuB,IAAI,IAAI,CAAC,WAAT,EAAvB;;AACA,WAAK,eAAL,CAAqB,KAArB,GAH6C,CAI7C;;;AACA,UAAI,WAAW,GAAG,KAAK,iBAAvB;;AAEA,WAAK,eAAL,CACE,GADF,CACM,WADN,EACmB;AAAC,YAAI,EAAE;AAAC,kBAAQ,EAAE,QAAX;AAAqB,wBAAc,EAAE;AAArC;AAAP,OADnB,EACsE,CADtE,EAEE,EAFF,CAEK,WAFL,EAEkB,CAFlB,EAEqB;AAAC,YAAI,EAAE;AAAC,kBAAQ,EAAE,QAAX;AAAsB,wBAAc,EAAE;AAAtC,SAAP;AAAmD,YAAI,EAAE,IAAI,CAAC,MAAL,CAAY;AAArE,OAFrB,EAEqG,CAFrG,EAEyG;AAFzG,OAGE,GAHF,CAGM,WAHN,EAGmB;AAAC,YAAI,EAAE;AAAE,eAAK,EAAE;AAAT;AAAP,OAHnB,EAGyC,CAHzC;AAKA;AAED,GA/CO,CAjUT,CAkXC;;;AACQ,8DAAR,UAAmC,OAAnC,EAA6D;AAE5D,QAAI,WAAW,GAAwB,EAAvC;;AACA,SAAK,IAAI,CAAC,GAAG,CAAb,EAAgB,CAAC,GAAG,KAAK,aAAL,CAAmB,MAAvC,EAA+C,CAAC,EAAhD,EAAoD;AACnD,UAAI,KAAK,aAAL,CAAmB,CAAnB,EAAsB,OAAtB,KAAkC,OAAtC,EAA+C;AAC9C,mBAAW,CAAC,IAAZ,CAAiB,KAAK,aAAL,CAAmB,CAAnB,EAAsB,SAAtB,EAAjB;AACA;AACD;;AAED,WAAO,WAAP;AAEA,GAXO;;AAaA,sDAAR,UAA2B,EAA3B,EAAqC;AAEpC,SAAK,IAAI,CAAC,GAAG,CAAb,EAAgB,CAAC,GAAG,KAAK,aAAL,CAAmB,MAAvC,EAA+C,CAAC,EAAhD,EAAoD;AACnD,UAAI,KAAK,aAAL,CAAmB,CAAnB,EAAsB,EAAtB,KAA6B,EAAjC,EAAqC;AACpC,eAAO,KAAK,aAAL,CAAmB,CAAnB,CAAP;AACA;AACD;;AAED,WAAO,IAAP;AAEA,GAVO;AAYR;;;AACQ,yDAAR,UAA8B,UAA9B,EAA6C;AAE5C;AACA,SAAK,gBAAL,GAH4C,CAK5C;;;AACA,SAAK,YAAL,CAAkB,CAAlB,GAAuB,UAAU,CAAC,CAAX,GAAe,KAAK,YAArB,GAAqC,GAA3D;AACA,SAAK,mBAAL,CAAyB,CAAzB,GAA6B,CAAC,CAAD,IAAM,KAAK,YAAL,CAAkB,CAAlB,IAAuB,KAAK,YAAL,GAAoB,KAAK,mBAAhD,CAAN,CAA7B;AACA,SAAK,aAAL,CAAmB,CAAnB,GAAuB,KAAK,aAAL,CAAmB,CAAnB,GAAwB,CAAC,KAAK,mBAAL,CAAyB,CAAzB,GAA+B,KAAK,aAAL,CAAmB,CAAnD,IAAyD,KAAK,kBAA7G,CAR4C,CAU5C;;AACA,SAAK,YAAL,CAAkB,CAAlB,GAAuB,UAAU,CAAC,CAAX,GAAe,KAAK,WAArB,GAAoC,GAA1D;AACA,SAAK,mBAAL,CAAyB,CAAzB,GAA6B,CAAC,CAAD,IAAM,KAAK,YAAL,CAAkB,CAAlB,IAAuB,KAAK,YAAL,GAAoB,KAAK,mBAAhD,CAAN,CAA7B;AACA,SAAK,aAAL,CAAmB,CAAnB,GAAuB,KAAK,aAAL,CAAmB,CAAnB,GAAwB,CAAC,KAAK,mBAAL,CAAyB,CAAzB,GAA8B,KAAK,aAAL,CAAmB,CAAlD,IAAwD,KAAK,kBAA5G;AAEA,GAfO;AAiBR;;;AACQ,kDAAR;AACC,SAAK,SAAL,GAAiB,KAAjB;AACA,SAAK,kBAAL,GAA0B,KAAK,mBAA/B;AACA,GAHO;AAKR;;;AACQ,oDAAR;AACC,QAAI,KAAK,kBAAL,GAA0B,KAAM,oBAApC,EAA0D;AACzD,WAAK,kBAAL,IAA2B,KAAK,qBAAhC;AACA;AACD,GAJO;AAMR;;;AACQ,kDAAR;AACC,SAAK,YAAL,CAAkB,CAAlB,GAAsB,KAAK,YAAL,CAAkB,CAAlB,GAAsB,CAA5C;AACA,SAAK,mBAAL,CAAyB,CAAzB,GAA6B,KAAK,mBAAL,CAAyB,CAAzB,GAA6B,CAA1D;AACA,SAAK,aAAL,CAAmB,CAAnB,GAAuB,KAAK,aAAL,CAAmB,CAAnB,GAAuB,CAA9C;AACA,GAJO;;AAMT;AAAC,CAlbD,CAA0C,uBAA1C;;AAAa;;AAobb;AAAA;AAAA;AAWC,gCAAY,YAAZ,EAA0C,OAA1C,EAAiE,KAAjE,EAA0F,KAA1F,EAAgH;AAA/C;AAAA;AAAsB;;AAAG;AAAA;AAAsB;;AAHxG,kBAAiB,CAAjB;AACA,kBAAiB,CAAjB;AAGP,SAAK,iBAAL,GAAyB,YAAzB;AACA,SAAK,MAAL,GAAe,KAAD,GAAU,CAAC,CAAX,GAAe,CAA7B;AACA,SAAK,MAAL,GAAe,KAAD,GAAU,CAAC,CAAX,GAAe,CAA7B;;AACA,SAAK,aAAL,CAAmB,OAAnB;AACA;;AAEM,6CAAP;AACC,WAAO,KAAK,QAAZ;AACA,GAFM,CAlBR,CAsBC;;;AACO,+CAAP,UAAmB,CAAnB,EAA8B,CAA9B,EAAuC;AACtC,SAAK,QAAL,CAAc,QAAd,CAAuB,GAAvB,CAA2B,CAA3B,EAA8B,CAA9B;AACA,GAFM,CAvBR,CA2BC;;;AACO,2CAAP;AACC,WAAO;AACN,WAAK,EAAE,KAAK,QAAL,CAAc,OAAd,CAAsB,KAAtB,GAA8B,KAAK,MADpC;AAEN,YAAM,EAAE,KAAK,QAAL,CAAc,OAAd,CAAsB,MAAtB,GAA+B,KAAK;AAFtC,KAAP;AAIA,GALM,CA5BR,CAmCC;AACA;;;AACO,0CAAP,UAAc,UAAd,EAAkC,WAAlC,EAAqD;AAEpD;AACA,SAAK,MAAL,GAAc,sBAAU,IAAV,CAAe,eAAf,CACb;AAAC,WAAK,EAAE,KAAK,QAAL,CAAc,OAAd,CAAsB,KAA9B;AAAsC,YAAM,EAAE,KAAK,QAAL,CAAc,OAAd,CAAsB;AAApE,KADa,EAEb;AAAC,WAAK,EAAE,UAAR;AAAoB,YAAM,EAAE;AAA5B,KAFa,CAAd,CAHoD,CAQpD;;AACA,SAAK,QAAL,CAAc,KAAd,CAAoB,GAApB,CAAwB,KAAK,MAAL,GAAc,KAAK,MAA3C,EAAmD,KAAK,MAAL,GAAc,KAAK,MAAtE;AAEA,GAXM,CArCR,CAkDC;AACA;AACA;AACA;AACA;AAEA;;;AACQ,iDAAR,UAAsB,OAAtB,EAA2C;AAC1C,SAAK,QAAL,GAAgB,IAAI,IAAI,CAAC,MAAT,CAAgB,OAAhB,CAAhB;AACA,SAAK,QAAL,CAAc,WAAd,GAA4B,KAA5B;AACA,SAAK,QAAL,CAAc,MAAd,CAAqB,CAArB,GAA0B,GAA1B;AACA,SAAK,QAAL,CAAc,MAAd,CAAqB,CAArB,GAA0B,GAA1B;;AACA,SAAK,iBAAL,CAAuB,QAAvB,CAAgC,KAAK,QAArC;AACA,GANO;;AAQT;AAAC,CAjED;;AAAa,oD;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AChcb;;AACA;;AACA;AAGA;;;AACA;AAAA;AAAA;AAAuC;;AAAvC;;AAsDC;AAjDA;;;AACO,qCAAP;AACC;AACA,UAAM,CAAC,UAAP,GAAoB,KAAK,MAAL,CAAY,IAAZ,CAAiB,IAAjB,CAApB;AACA,GAHM;AAKP;;;;;;AAIQ,+CAAP,UAAsB,WAAtB,EAAoD;AACpD,SAAK,YAAL,GAAoB,WAApB;AACA,GAFO;AAIR;;;;;;;;AAMO,qCAAP,UAAY,WAAZ,EAA4C,KAA5C,EAA2D,GAA3D,EAAsE;AAErE,UAAM,CAAC,OAAP,CAAe,SAAf,CAAyB,WAAzB,EAAsC,KAAK,aAAL,CAAmB,KAAnB,CAAtC,EAAiE,GAAjE;AACA,YAAQ,CAAC,KAAT,GAAiB,KAAK,aAAL,CAAmB,KAAnB,CAAjB;;AAEA,QAAM,MAAc,CAAC,EAArB,EAA0B;AACxB,YAAc,CAAC,EAAf,CAAkB,KAAlB,EAAyB,MAAzB,EAAiC,GAAjC;AACA,YAAc,CAAC,EAAf,CAAkB,MAAlB,EAA0B,UAA1B;AACD;AAED,GAVM,CAzBR,CAqCC;AACA;AACA;AACA;AACA;;AAEA;;;AACQ,uCAAR;AACC,SAAK,aAAL,GAAsB,MAAM,CAAC,OAAP,CAAe,KAAf,KAAyB,IAA1B,GAAkC,MAAM,CAAC,OAAP,CAAe,KAAjD,GAAyD,KAAK,YAAnF;AACA,oBAAO,QAAP,CAAgB,sBAAU,iBAA1B,EAA6C,KAAK,aAAlD;AACA,GAHO;AAKR;;;AACQ,8CAAR,UAAsB,IAAtB,EAAkC;AACjC,WAAU,IAAI,qBAAd;AACA,GAFO;;AAIT;AAAC,CAtDD,CAAuC,uBAAvC;;AAAa,8C;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACNb;;AACA;;AACA;;AACA;;AACA;;AAGA;;AAEA;;AAOA;;AAKA;;AACA;;AAEA;;AAIA,wI,CACA;AAEA;;;AAEA;AAAA;AAAA;AAAoC;;AAApC;AAAA;;AAIS,oBAAmB,KAAnB,CAJT,CAIuC;;AAC9B,0BAAyB,KAAzB,CALT,CAK2C;;AAClC,qBAAoB,KAApB,CANT,CAMuC;;AAC9B,2BAA0B,KAA1B;AACA,8BAA6B,KAA7B;AAMA,6BAA2B,CAA3B;AACA,uBAAqB,GAArB;AAyBA,uBAAkB;AAAC,UAAI,EAAE,KAAP;AAAc,UAAI,EAAE,KAApB;AAA2B,SAAG,EAAE,KAAhC;AAAuC,UAAI,EAAE;AAA7C,KAAlB;AACA,sBAAiB;AAAC,aAAO,EAAE,KAAV;AAAiB,YAAM,EAAE;AAAzB,KAAjB;AACA,sBAAoB,CAApB;AACA,2BAAyB,CAAzB;AAKA,sBAAiB,EAAjB;AACA,oBAAe,EAAf;AACA,uBAAkB,EAAlB;AA4pBA,wBAAsB,CAAtB;;AAyFR,GAvyBD,CAoDC;;;AACO,kCAAP;AAAA;;AAEC,SAAK,OAAL,GAAe,IAAf,CAFD,CAIC;;AACA,QAAI,YAAY,GAAsB;AACrC,aAAO,EAAE,oBAAY,IADgB;AAErC,WAAK,EAAE,EAF8B;AAGrC,UAAI,EAAE;AAH+B,KAAtC;AAKA,oBAAO,QAAP,CAAgB,sBAAU,gBAA1B,EAA4C,YAA5C;AAEA,SAAK,YAAL,GAAoB,IAAI,2BAAJ,CAAiB,QAAQ,CAAC,aAAT,CAAuB,qBAAvB,CAAjB,EAAgE,EAAhE,CAApB;AACA,SAAK,GAAL,CAAS,SAAT,EAAoB,WAApB,GAAkC,KAAK,YAAvC;AAEA,QAAI,MAAM,GAAG,QAAQ,CAAC,aAAT,CAAuB,qDAAvB,CAAb;AACA,UAAM,CAAC,gBAAP,CAAwB,WAAxB,EAAqC,UAAC,CAAD,EAAE;AAEtC,UAAI,IAAI,GAAI,CAAC,CAAC,MAAF,CAAyB,aAAzB,CAAuC,aAAvC,CAAqD,qBAArD,EAAZ;AACA,UAAI,MAAM,GAAU;AAAC,SAAC,EAAE,IAAI,CAAC,IAAL,GAAY,EAAhB;AAAoB,SAAC,EAAE,IAAI,CAAC,GAAL,GAAW;AAAlC,OAApB;;AACA,WAAI,CAAC,aAAL,CAAmB,cAAnB,CAAkC,MAAlC;;AACA,WAAI,CAAC,gBAAL,CAAsB,cAAtB,CAAqC,IAArC;AACA,KAND;AAQA,UAAM,CAAC,gBAAP,CAAwB,UAAxB,EAAoC;AAEnC,WAAI,CAAC,aAAL,CAAmB,YAAnB,CAAgC,uBAAe,OAA/C;;AACA,WAAI,CAAC,gBAAL,CAAsB,cAAtB,CAAqC,KAArC;AACA,KAJD;AAMA,UAAM,GAAG,QAAQ,CAAC,aAAT,CAAuB,6DAAvB,CAAT;AACA,UAAM,CAAC,gBAAP,CAAwB,WAAxB,EAAqC,UAAC,CAAD,EAAE;AACtC,UAAI,IAAI,GAAI,CAAC,CAAC,MAAF,CAAyB,aAAzB,CAAuC,aAAvC,CAAqD,qBAArD,EAAZ;AACA,UAAI,MAAM,GAAU;AAAC,SAAC,EAAE,IAAI,CAAC,IAAL,GAAY,EAAhB;AAAoB,SAAC,EAAE,IAAI,CAAC,GAAL,GAAW;AAAlC,OAApB;;AACA,WAAI,CAAC,aAAL,CAAmB,cAAnB,CAAkC,MAAlC;;AACA,WAAI,CAAC,gBAAL,CAAsB,cAAtB,CAAqC,IAArC;AACA,KALD;AAOA,UAAM,CAAC,gBAAP,CAAwB,UAAxB,EAAoC;AACnC,WAAI,CAAC,aAAL,CAAmB,YAAnB,CAAgC,uBAAe,MAA/C;;AACA,WAAI,CAAC,gBAAL,CAAsB,cAAtB,CAAqC,KAArC;AACA,KAHD;AAOA,GA7CM,CArDR,CAoGC;;AAEA;;;AACO,sCAAP;AACC,WAAO,KAAK,OAAZ;AACA,GAFM;AAIP;;;AACO,4CAAP;AACC,WAAO,KAAK,aAAZ;AACA,GAFM;AAIP;;;AACO,2CAAP,UAAqB,WAArB,EAAmD;AAClD,WAAO,KAAK,cAAL,EAAP;AACA,GAFM;;AAIA,8CAAP;AACC;AACA;AACA,QAAI,KAAK,aAAL,IAAsB,CAAC,KAAK,QAAhC,EAA0C;AACzC,WAAK,MAAL;AACA;;AAED,WAAQ,KAAK,aAAL,IAAsB,KAAK,QAAnC;AACA,GARM,CArHR,CA+HC;AAEA;;;AACO,4CAAP,UAAsB,KAAtB,EAA8C,UAA9C,EAAgF,IAAhF,EAAoG;AACnG;AACA,SAAK,gBAAL,GAAwB,KAAxB;AACA,SAAK,qBAAL,GAA6B,UAA7B;AACA,SAAK,eAAL,GAAuB,IAAvB;AACA,GALM,CAlIR,CAyIC;;;AACO,qCAAP,UAAe,KAAf,EAAwC,cAAxC,EAAsE;AACrE,SAAK,MAAL,GAAc,KAAd;AACA,SAAK,eAAL,GAAuB,cAAvB;AACA,GAHM;AAKP;;;AACO,sCAAP,UAAgB,KAAhB,EAAwC;AACvC,SAAK,MAAL,GAAc,KAAd;AACA,GAFM;AAIP;;;;;;AAIO,qCAAP,UAAe,IAAf,EAA2B;AAC1B,SAAK,KAAL,GAAa,IAAb;AACA,SAAK,UAAL,CAAgB,GAAhB,GAAsB,IAAtB;;AACA,SAAK,iBAAL;AACA,GAJM;AAMP;;;;;;AAIO,qCAAP,UAAe,IAAf,EAAkC;AACjC,SAAK,KAAL,GAAa,IAAb;;AACA,SAAK,gBAAL;;AACA,SAAK,UAAL,CAAgB,IAAhB,GAAuB,IAAvB;;AACA,SAAK,iBAAL;AACA,GALM,CAlKR,CAyKC;;AAEA;;;AACO,mCAAP,UAAa,QAAb,EAAiD,UAAjD,EAA4E;AAA/D;AAAA;AAAkC;;AAAE;AAAA;AAA2B;;AAE3E,SAAK,SAAL,GAAiB,QAAjB,CAF2E,CAI3E;;AACA,QAAI,CAAC,KAAK,QAAV,EAAoB;AACnB,WAAK,MAAL;;AACA,WAAK,iBAAL,GAAyB,IAAzB;AACA;AACA,KAT0E,CAW3E;;;AACA,SAAK,4BAAL;;AAEA,SAAK,gBAAL,CAAsB,SAAtB,CAAgC,OAAhC;;AAEA,SAAK,eAAL,CAAqB,OAArB,GAA+B,IAA/B;;AAEA,QAAI,KAAK,SAAT,EAAoB;AACnB,WAAK,GAAL,CAAS,QAAT,CAAkB,KAAK,SAAvB,EAAkC,SAAlC;AACA,UAAI,CAAC,QAAL,CAAc,GAAd,CAAkB,CAAC,KAAK,SAAN,EAAiB,QAAQ,CAAC,aAAT,CAAuB,QAAvB,CAAjB,CAAlB,EAAsE;AAAC,iBAAS,EAAE,CAAZ;AAAe,aAAK,EAAE;AAAtB,OAAtE;AACA,KArB0E,CAuB3E;;;AACA,QAAI,UAAJ,EAAgB;AACf,WAAK,iBAAL;;AACA;AACA,KA3B0E,CA6B3E;;;AACA,QAAI,QAAQ,CAAC,OAAT,KAAqB,oBAAY,IAArC,EAA2C;AAC1C,WAAK,cAAL,CAAoB,QAAQ,CAAC,UAA7B;AACA;AAED,GAlCM;AAoCP;;;AACO,kCAAP,UAAY,QAAZ,EAAgD,UAAhD,EAA2E;AAA/D;AAAA;AAAkC;;AAAE;AAAA;AAA2B;;AAE1E,QAAI,CAAC,KAAK,SAAV,EAAqB;AACpB;AACA;;AAED,SAAK,eAAL,CAAqB,OAArB;;AAEA,QAAI,UAAJ,EAAgB;AACf,WAAK,gBAAL;;AACA;AACA;;AAED,QAAI,QAAQ,CAAC,OAAT,KAAqB,oBAAY,IAArC,EAA2C;AAC1C,WAAK,aAAL,CAAmB,QAAQ,CAAC,UAA5B;AACA;AAED,GAjBM;AAmBP;;;;;;AAIO,kCAAP,UAAY,QAAZ,EAA8C;AAAlC;AAAA;AAAkC;;AAC7C,QAAI,QAAQ,CAAC,OAAT,KAAqB,oBAAY,IAArC,EAA2C;AAC1C,WAAK,YAAL;AACA,KAFD,MAEO,IAAI,QAAQ,CAAC,OAAT,KAAqB,oBAAY,IAArC,EAA2C;AACjD,WAAK,YAAL,CAAkB,QAAQ,CAAC,UAA3B;AACA;;AACD,SAAK,OAAL,GAAgB,KAAhB;AACA,GAPM;AASP;;;AACO,oCAAP;AAAA;;AACC,SAAK,OAAL,GAAe,KAAf;;AACA,SAAK,sBAAL,CAA4B,KAA5B;;AACA,SAAK,4BAAL;;AACA,SAAK,SAAL,CAAe,MAAf,GAAwB,UAAU,CAAE;AAAM,kBAAI,CAAJ;AAA0B,KAAlC,EAAoC,GAApC,CAAlC;AACA,GALM;AAOP;;;AACO,mCAAP;AACC,SAAK,sBAAL,CAA4B,KAA5B;;AACA,QAAI,CAAC,QAAL,CAAc,EAAd,CAAiB,CAAC,KAAK,SAAN,EAAiB,QAAQ,CAAC,aAAT,CAAuB,QAAvB,CAAjB,CAAjB,EAAqE,IAArE,EAA2E;AAAC,WAAK,EAAE,GAAR;AAAa,UAAI,EAAE,IAAI,CAAC,MAAL,CAAY;AAA/B,KAA3E;AACA,GAHM;AAKP;;;AACO,qCAAP;AACC,SAAK,sBAAL,CAA4B,IAA5B;;AACA,QAAI,CAAC,QAAL,CAAc,EAAd,CAAiB,CAAC,KAAK,SAAN,EAAiB,QAAQ,CAAC,aAAT,CAAuB,QAAvB,CAAjB,CAAjB,EAAqE,IAArE,EAA2E;AAAC,WAAK,EAAE,CAAR;AAAW,UAAI,EAAE,IAAI,CAAC,MAAL,CAAY;AAA7B,KAA3E;AACA,GAHM;AAKP;;;AACO,4CAAP;AACC,QAAI,KAAK,OAAT,EAAkB;AACjB,WAAK,YAAL;AACA;AACD,GAJM;;AAMA,iDAAP,UAA2B,WAA3B,EAAwD;AAEvD,SAAK,gBAAL,GAAwB,WAAxB;AACA,SAAK,UAAL,CAAgB,IAAhB,GAAuB,IAAvB;;AACA,SAAK,iBAAL;;AAEA,QAAI,KAAK,aAAL,IAAsB,KAAK,OAA/B,EAAwC;AACvC,WAAK,MAAL;AACA;AAED,GAVM;AAYN;;;AACM,4CAAP,UAAsB,WAAtB,EAAmD;AAClD,SAAK,gBAAL,GAAwB,WAAxB;AACA,SAAK,UAAL,CAAgB,IAAhB,GAAuB,IAAvB;;AACA,SAAK,iBAAL;;AAEA,QAAI,KAAK,aAAL,IAAsB,KAAK,OAA/B,EAAwC;AACvC,WAAK,MAAL;AACA;AACD,GARM;AAUP;;;AACO,sCAAP;AACC;AACA;AACA,QAAI,KAAK,OAAT,EAAkB;AACjB,WAAK,UAAL,CAAgB,GAAhB,GAAsB,IAAtB;;AACA,WAAK,iBAAL;;AACA,WAAK,MAAL;AACA;AACD,GARM;;AAUA,oCAAP;AAEC,QAAI,KAAK,KAAT,EAAgB;AACf,WAAK,gBAAL;AACA;;AAED,QAAI,KAAK,QAAT,EAAmB;AAClB,WAAK,aAAL,CAAmB,eAAnB,CAAmC,KAAK,aAAxC;;AACA,WAAK,gBAAL,CAAsB,eAAtB,CAAsC,KAAK,aAA3C;;AACA,WAAK,eAAL,CAAqB,KAArB,CAA2B,CAA3B,GAA+B,KAAK,YAAL,GAAoB,CAAnD;AACA,WAAK,eAAL,CAAqB,CAArB,GAAyB,KAAK,YAAL,GAAoB,CAA7C,CAJkB,CAKlB;AACA;AAED,GAdM;;AAgBA,kCAAP;AAEC,QAAI,CAAC,KAAK,OAAN,IAAiB,CAAC,KAAK,QAA3B,EAAqC;AACpC;AACA;;AAED,SAAK,kBAAL;;AACA,SAAK,gBAAL;;AAEA,SAAK,eAAL,CAAqB,KAArB,CAA2B,GAA3B,CAA+B,MAAO,MAAM,IAAI,CAAC,GAAL,CAAS,KAAK,SAAd,CAA5C,EAAuE,MAAO,MAAM,IAAI,CAAC,GAAL,CAAS,KAAK,SAAd,CAApF;;AAEA,QAAI,KAAK,aAAT,EAAwB;AACvB;AACC,WAAK,aAAL,CAAmB,IAAnB,CAAwB,KAAK,gBAAL,CAAsB,aAAtB,EAAxB,EAA+D,KAAK,gBAAL,CAAsB,WAAtB,EAA/D,EAAoG,KAAK,SAAzG,EAAoH,KAApH,EAA2H,KAA3H;AACD,KAdF,CAgBC;AACC;AACD;;AAEA,GApBM,CA9TR,CAoVC;AACA;AACA;AACA;;AAEA;;;;;;AAIO,oDAAP,UAA8B,KAA9B,EAA2C;AAC1C,SAAK,gBAAL,GAAwB,KAAxB;;AACA,SAAK,gBAAL,CAAsB,QAAtB,CAA+B,KAA/B;AACA,GAHM,CA7VR,CAkWC;;;AACO,6CAAP;AACC,SAAK,OAAL,CAAa,iBAAb,CAA+B,CAA/B;AACA,GAFM;;AAIA,4CAAP,UAAsB,KAAtB,EAAmC;AAClC,SAAK,gBAAL,GAAwB,KAAxB;;AACA,SAAK,OAAL,CAAa,cAAb,CAA4B,KAA5B;AACA,GAHM,CAvWR,CA6WC;AACA;AACA;AACA;AACA;;AAEA;;;AACQ,8CAAR;AAEC,SAAK,WAAL,GAAmB,MAAM,CAAC,UAA1B;AACA,SAAK,YAAL,GAAoB,MAAM,CAAC,WAA3B;AAEA,SAAK,aAAL,GAAqB,KAAK,WAAL,GAAmB,KAAK,KAAL,CAAW,yBAAnD;;AAEA,QAAI,KAAK,WAAL,GAAmB,IAAvB,EAA6B;AAC5B,WAAK,aAAL,GAAqB,KAAK,WAAL,GAAmB,KAAK,KAAL,CAAW,wBAAnD;AACA;;AAED,QAAI,KAAK,WAAL,GAAmB,GAAvB,EAA4B;AAC3B,WAAK,aAAL,GAAqB,KAAK,WAAL,GAAmB,KAAK,KAAL,CAAW,wBAAnD;AACA;AAED,GAfO;AAiBR;;;AACQ,+CAAR;AAEC,QAAI,SAAS,GAAG,CAAC,KAAK,aAAtB;AACA,SAAK,aAAL,GAAuB,KAAK,UAAL,CAAgB,GAAhB,IAAuB,KAAK,UAAL,CAAgB,IAAvC,IAA+C,KAAK,UAAL,CAAgB,IAA/D,IAAuE,KAAK,UAAL,CAAgB,IAA9G,CAHD,CAKC;;AACA,QAAI,SAAS,IAAI,KAAK,aAAtB,EAAqC;AACpC;AACA,sBAAO,QAAP,CAAgB,IAAI,+BAAJ,CAAmB;AAClC,YAAI,EAAE,iBAAS;AADmB,OAAnB,CAAhB,EAEI;AAAC,aAAK,EAAE;AAAR,OAFJ;AAGA;AAED,GAbO;AAeR;;;AACQ,oCAAR;AAAA;;AAEC,QAAI,CAAC,KAAK,aAAN,IAAuB,KAAK,QAAhC,EAA0C;AACzC;AACA,KAJF,CAMC;;;AACA,QAAI,CAAC,KAAK,SAAV,EAAqB;AACpB,WAAK,GAAL,CAAS,MAAT,CAAgB,QAAQ,CAAC,aAAT,CAAuB,MAAvB,CAAhB,EAAgD,KAAK,KAArD,EAA4D;AAC3D,aAAI,CAAC,SAAL,GAAiB,QAAQ,CAAC,aAAT,CAAuB,OAAvB,CAAjB;;AACA,aAAI,CAAC,MAAL;AACA,OAHD;AAIA;AACA;;AAED,SAAK,gBAAL;;AACA,SAAK,YAAL;;AACA,SAAK,UAAL;;AACA,SAAK,gBAAL;;AACA,SAAK,WAAL;;AACA,SAAK,kBAAL;;AACA,SAAK,QAAL,GAAgB,IAAhB;AACA,SAAK,MAAL,GAtBD,CAwBC;;AACA,QAAI,KAAK,iBAAT,EAA4B;AAC3B,WAAK,KAAL,CAAW,KAAK,SAAhB,EAA2B,KAA3B;AACA,WAAK,IAAL,CAAU,KAAK,SAAf,EAA0B,KAA1B;AACA,WAAK,iBAAL,GAAyB,KAAzB;AACA;AAED,GA/BO;AAiCR;;;AACQ,0CAAR;AAEC;AACA,QAAI,KAAK,OAAT,EAAkB;AACjB,WAAK,OAAL,GAAe,KAAK,MAAL,CAAY,GAAZ,CAAgB,aAAhB,CAAf;;AACA,WAAK,OAAL,CAAa,YAAb,CAA0B,KAAK,YAAL,CAAkB,IAAlB,CAAuB,IAAvB,CAA1B;;AACA;AACA,KAPF,CASC;;;AACA,SAAK,OAAL,GAAe,IAAI,eAAJ,EAAf;;AACA,SAAK,OAAL,CAAa,YAAb,CAA2B,KAAK,SAAL,CAAe,aAAf,CAA6B,mBAA7B,CAA3B;;AACA,SAAK,OAAL,CAAa,EAAb,GAAmB,aAAnB;;AACA,SAAK,OAAL,CAAa,MAAb;;AACA,SAAK,OAAL,CAAa,MAAb,CAAoB,WAApB,GAAkC,CAAlC;;AACA,SAAK,OAAL,CAAa,YAAb,CAA0B,KAAK,YAAL,CAAkB,IAAlB,CAAuB,IAAvB,CAA1B;AAEA,GAjBO;AAmBR;;;AACQ,oDAAR,UAA+B,OAA/B,EAA+C;AAC9C,SAAK,OAAL,GAAe,OAAf;;AACA,SAAK,gBAAL,CAAsB,SAAtB,CAAgC,OAAhC;;AACA,SAAK,aAAL,CAAmB,SAAnB,CAA6B,OAA7B;AACA,GAJO;;AAMA,wCAAR;AACC;AACA,oBAAO,EAAP,CAAU,OAAV,EAAmB,oBAAnB,EAAyC,KAAK,qBAAL,CAA2B,IAA3B,CAAgC,IAAhC,CAAzC,EAFD,CAGC;;AACA,oBAAO,EAAP,CAAU,uCAAV,EAA+B,KAAK,WAAL,CAAiB,IAAjB,CAAsB,IAAtB,CAA/B;AACA,GALO;;AAOA,0CAAR,UAAqB,KAArB,EAAkC;AACjC,SAAK,gBAAL,GAAwB,KAAxB;;AACA,SAAK,gBAAL,CAAsB,QAAtB,CAA+B,KAA/B;;AACA,SAAK,OAAL,CAAa,cAAb,CAA4B,KAA5B;AACA,GAJO;;AAMA,gDAAR;AAAA,sBAEC;;;AACA,SAAK,gBAAL,GAAwB,IAAI,iCAAJ,CAAoB,CAApB,EAAuB,KAAvB,EAA8B,CAA9B,EAAiC,KAAjC,CAAxB;;AAEA,SAAK,gBAAL,CAAsB,eAAtB,CAAsC,KAAK,aAA3C;;AACA,SAAK,gBAAL,CAAsB,kBAAtB,CAAyC,KAAK,KAAL,CAAW,eAApD;;AACA,SAAK,gBAAL,CAAsB,SAAtB,GAAkC,KAAK,KAAL,CAAW,aAA7C;AACA,SAAK,gBAAL,CAAsB,gBAAtB,GAAyC,KAAK,KAAL,CAAW,gBAApD;AACA,SAAK,gBAAL,CAAsB,SAAtB,GAAkC,KAAlC;;AACA,SAAK,gBAAL,CAAsB,WAAtB,CAAkC,GAAlC;;AAEA,SAAK,gBAAL,CAAsB,MAAtB,GAA+B,UAAC,aAAD,EAAsB;AACpD,WAAI,CAAC,cAAL,GAAuB,aAAa,GAAG,KAAI,CAAC,UAA5C;AACA,WAAI,CAAC,UAAL,GAAkB,aAAlB;;AACA,WAAI,CAAC,qBAAL,CAA2B,YAA3B,CAAwC,aAAxC;;AACA,WAAI,CAAC,aAAL,CAAmB,WAAnB,CAA+B,aAA/B;;AACA,WAAI,CAAC,eAAL,CAAqB,KAAI,CAAC,cAA1B;AACA,KAND;;AAQA,SAAK,gBAAL,CAAsB,WAAtB,GAAoC;AACnC,WAAI,CAAC,gBAAL,CAAsB,WAAtB,CAAkC,IAAlC,EADmC,CAEnC;AACA;;AACA,KAJD;;AAMA,SAAK,gBAAL,CAAsB,UAAtB,GAAmC;AAClC,WAAI,CAAC,gBAAL,CAAsB,WAAtB,CAAkC,KAAlC,EADkC,CAElC;;AACA,KAHD;AAKA,GA/BO,CA/dT,CAggBC;;;AACQ,8CAAR;AAAA;;AAEC,SAAK,aAAL,GAAqB,IAAI,mCAAJ,CAAqB,KAAK,gBAA1B,EAA4C,KAAK,KAAjD,CAArB;;AACA,SAAK,aAAL,CAAmB,eAAnB,CAAmC,KAAK,aAAxC,EAHD,CAKC;;;AACA,SAAK,aAAL,CAAmB,SAAnB,CACC,KAAK,SAAL,CAAe,aAAf,CAA6B,cAA7B,CADD,EAEC,KAAK,SAAL,CAAe,aAAf,CAA6B,gBAA7B,CAFD,EAGC,KAAK,SAAL,CAAe,aAAf,CAA6B,eAA7B,CAHD,EAIC,KAAK,SAAL,CAAe,aAAf,CAA6B,mBAA7B,CAJD;;AAOA,SAAK,aAAL,CAAmB,MAAnB;;AAEA,SAAK,aAAL,CAAmB,WAAnB,CAA+B,GAA/B;;AACA,SAAK,aAAL,CAAmB,mBAAnB,CAAuC,KAAK,eAA5C,EAA6D,KAAK,gBAAlE;;AACA,SAAK,aAAL,CAAmB,eAAnB,CAAmC,KAAK,aAAxC;;AACA,SAAK,aAAL,CAAmB,cAAnB,GAAoC;AAAO,kBAAI,CAAC,GAAL,CAAS,WAAT,CAAqB,KAAI,CAAC,SAA1B;AAA+C,KAA1F;AAEA,GApBO;AAsBR;;;AACQ,yCAAR,aACC;AACA,GAFO,CAxhBT,CA4hBC;;;AACQ,gDAAR,UAA2B,UAA3B,EAAqD,CAEpD,CAFO;;AAIA,6CAAR,UAAwB,cAAxB,EAA8C;AAC7C,SAAK,SAAL,IAAmB,cAAc,GAAG,KAAK,KAAL,CAAW,cAA/C;AACA,GAFO;AAIR;;;AACQ,8CAAR;AACC,SAAK,SAAL,IAAkB,KAAK,KAAL,CAAW,gBAA7B;AACA,GAFO;AAIR;;;AACQ,gDAAR;AAEC,QAAI,CAAC,KAAK,SAAL,CAAe,OAAhB,IAA2B,KAAK,UAAL,GAAkB,IAAjD,EAAuD;AACtD,WAAK,SAAL,CAAe,OAAf,GAAyB,IAAzB;AACA,sBAAO,QAAP,CAAgB,IAAI,uDAAJ,CAAgC;AAAC,kBAAU,EAAE,uBAAe;AAA5B,OAAhC,CAAhB;AACA;;AAED,QAAI,CAAC,KAAK,SAAL,CAAe,MAAhB,IAA0B,KAAK,UAAL,GAAkB,IAAhD,EAAsD;AACrD,WAAK,SAAL,CAAe,MAAf,GAAwB,IAAxB;AACA,sBAAO,QAAP,CAAgB,IAAI,uDAAJ,CAAgC;AAAC,kBAAU,EAAE,uBAAe;AAA5B,OAAhC,CAAhB;AACA;AAED,GAZO;AAcR;;;AACQ,mDAAR,UAA8B,CAA9B,EAA2C;AAE1C,KAAC,CAAC,cAAF;;AACA,SAAK,sBAAL,CAA4B,KAA5B;;AACA,QAAI,KAAK,GAAa,CAAC,CAAC,MAAxB;AACA,QAAI,UAAU,GAAmB,KAAK,CAAC,YAAN,CAAmB,iBAAnB,CAAjC;;AAEA,QAAG,CAAC,UAAJ,EAAgB;AACf,gBAAU,GAAI,KAAK,aAAL,CAAmB,QAAnB,IAA+B,GAAhC,GAAuC,uBAAe,OAAtD,GAAgE,uBAAe,MAA5F;AACA;;AAED,SAAK,GAAL,CAAS,QAAT,CAAmB,KAAnB,EAA0B,cAA1B;AAEA,YAAG,KAAH,CAAS,IAAT,EAAe,uBAAf,EAAwC,UAAxC,EAb0C,CAe1C;;AACA,QAAI,QAAQ,GAAsB;AACjC,aAAO,EAAE,oBAAY,IADY;AAEjC,gBAAU,EAAE,UAFqB;AAGjC,WAAK,EAAG,UAAU,KAAK,uBAAe,OAA/B,GAA0C,SAA1C,GAAsD,QAH5B;AAIjC,UAAI,EAAE,MAAI,UAAJ,GAAc;AAJa,KAAlC;AAMA,oBAAO,QAAP,CAAgB,sBAAU,cAA1B,EAA0C,QAA1C;AAEA,WAAO,KAAP;AAEA,GA1BO,CA1jBT,CAslBC;AACA;;;AACQ,2CAAR,UAAsB,KAAtB,EAAiD;AAChD,QAAI,CAAC,KAAK,OAAV,EAAmB;AAClB;AACA;;AACD,SAAK,gBAAL,CAAsB,SAAtB,CAAiC,KAAK,IAAL,CAAU,SAAV,CAAoB,KAAK,UAAL,GAAmB,KAAK,CAAC,KAAN,GAAc,IAArD,EAA4D,CAA5D,EAA+D,CAA/D,CAAjC,EAJgD,CAKhD;AACA;;AACA,GAPO;;AASA,yCAAR,UAAoB,KAApB,EAA6C;AAC5C,QAAI,CAAC,KAAK,OAAV,EAAmB;AAClB;AACA;;AACD,QAAI,SAAS,GAAI,KAAK,CAAC,OAAN,KAAkB,2BAAmB,IAArC,IAA6C,KAAK,CAAC,OAAN,KAAkB,2BAAmB,OAAnF,GAA8F,CAAC,CAA/F,GAAmG,CAAnH;AACA,SAAK,gBAAL,IAAyB,SAAzB;AACA,SAAK,sBAAL,CAA6B,KAAK,IAAL,CAAU,SAAV,CAAoB,KAAK,gBAAzB,EAA2C,CAA3C,EAA8C,CAA9C,CAA7B,EAN4C,CAO5C;AACA;AACA,GATO;AAWR;;;AACQ,iDAAR;AACC,SAAK,eAAL,CAAqB,OAArB,GAA+B,KAA/B;AACA,SAAK,iBAAL,GAAyB,KAAzB;AACA,SAAK,GAAL,CAAS,WAAT,CAAqB,KAAK,SAA1B,EAAqC,SAArC;AACA,QAAI,CAAC,QAAL,CAAc,GAAd,CAAkB,CAAC,KAAK,SAAN,EAAiB,QAAQ,CAAC,aAAT,CAAuB,QAAvB,CAAjB,CAAlB,EAAsE;AAAC,eAAS,EAAE,CAAZ;AAAe,WAAK,EAAE;AAAtB,KAAtE;AACA,GALO,CA7mBT,CAonBC;AACA;;AAEA;;;AACQ,+CAAR;AAEC;AACA,SAAK,eAAL,CAAqB,GAArB,EAHD,CAKC;;;AACA,SAAK,aAAL,CAAmB,gBAAnB,GAND,CAQC;;;AACA,SAAK,qBAAL,CAA2B,KAA3B,CAAiC,KAAK,MAAtC;AAEA,GAXO;AAaR;;;AACQ,4CAAR,UAAuB,UAAvB,EAAiD;AAEhD;AACA,QAAI,QAAQ,GAAY,UAAU,KAAK,uBAAe,OAA/B,GAA0C,CAA1C,GAA8C,CAArE;;AACA,SAAK,eAAL,CAAqB,QAArB,EAJgD,CAMhD;;;AACA,SAAK,aAAL,CAAmB,aAAnB,CAAiC,UAAjC;AAEA,GATO;AAWR;;;AACQ,0DAAR;AAEC;AACA,gBAAY,CAAC,KAAK,SAAL,CAAe,MAAhB,CAAZ;;AACA,QAAK,KAAK,OAAL,CAAa,SAAlB,EAA8B;AAC7B,WAAK,OAAL,CAAa,SAAb,CAAuB,IAAvB;AACA,KANF,CAQC;;;AACA,QAAI,KAAK,aAAT,EAAwB;AACvB,WAAK,aAAL,CAAmB,2BAAnB;AACA;;AAED,SAAK,iBAAL,GAAyB,KAAzB;AAEA,GAfO;AAiBR;;;AACQ,6CAAR,UAAwB,QAAxB,EAAwC;AAEvC,SAAK,aAAL,CAAmB,WAAnB,CAA+B,QAA/B,EAAyC,IAAzC,EAFuC,CAGvC;;;AACA,SAAK,gBAAL,CAAsB,WAAtB,CAAkC,QAAlC;;AACA,SAAK,UAAL,GAAkB,QAAlB;AACA,SAAK,SAAL,GAAiB,CAAjB;AACA,SAAK,cAAL,GAAsB,CAAtB;;AAEA,QAAI,QAAQ,KAAK,CAAjB,EAAoB;AACnB,WAAK,gBAAL,GAAwB,CAAxB;AACA,KAFD,MAEO,IAAI,QAAQ,KAAK,CAAjB,EAAoB;AAC1B,WAAK,gBAAL,GAAwB,CAAxB;AACA,KAFM,MAEA;AACN,WAAK,gBAAL,GAAwB,CAAxB;AACA,KAfsC,CAiBvC;;;AACA,QAAI,iBAAiB,GAAQ;AAAC,OAAC,EAAG,MAAM,CAAC,UAAP,GAAoB,CAAzB;AAA6B,OAAC,EAAG,MAAM,CAAC,WAAP,GAAqB;AAAtD,KAA7B;;AACA,SAAK,aAAL,CAAmB,IAAnB,CAAwB,iBAAxB,EAA2C,KAA3C,EAAkD,CAAlD,EAAqD,IAArD,EAA2D,IAA3D;AAEA,GArBO,CApqBT,CA2rBC;AACA;;AAEA;;;AACQ,8CAAR;AAEC;AACA;AAEA,SAAK,mBAAL;;AACC,SAAK,gBAAL,CAAsB,cAAtB,GANF,CAQC;;;AACA,SAAK,aAAL,CAAmB,eAAnB;;AAEA,SAAK,MAAL;AAEA,GAbO;;AAgBA,iDAAR;AACC;AADD;;AAGC,SAAK,YAAL,CAAkB,OAAlB,CAA0B,UAA1B;;AAEA,QAAI,CAAC,QAAL,CAAc,MAAd,CAAqB,eAArB,EAAsC,IAAtC,EAA4C;AAAC,eAAS,EAAE,CAAZ;AAAe,WAAK,EAAE,CAAtB;AAAyB,OAAC,EAAE,CAAC,EAA7B;AAAiC,OAAC,EAAC,CAAC;AAApC,KAA5C,EAAwF;AAAC,eAAS,EAAE,CAAZ;AAAe,WAAK,EAAE,CAAtB;AAAyB,OAAC,EAAC,CAA3B;AAA8B,OAAC,EAAC,CAAhC;AAAmC,WAAK,EAAE;AAA1C,KAAxF;AACA,oBAAO,EAAP,CAAU,OAAV,EAAmB,+BAAnB,EAAoD;AAAM,kBAAI,CAAJ;AAA6B,KAAvF;AACA,oBAAO,EAAP,CAAU,WAAV,EAAuB,+BAAvB,EAAwD;AACvD,WAAI,CAAC,aAAL,CAAmB,cAAnB;;AACA,WAAI,CAAC,gBAAL,CAAsB,cAAtB;;AACA,kBAAY,CAAC,KAAI,CAAC,WAAN,CAAZ;AACA,WAAI,CAAC,WAAL,GAAmB,UAAU,CAAC;AAAM,oBAAI,CAAC,YAAL,CAAkB,OAAlB;AAAkC,OAAzC,EAA2C,EAA3C,CAA7B;AAEA,KAND;AAQA,oBAAO,EAAP,CAAU,UAAV,EAAsB,+BAAtB,EAAuD;AACtD,WAAI,CAAC,aAAL,CAAmB,iBAAnB;;AACA,WAAI,CAAC,gBAAL,CAAsB,iBAAtB;;AACA,kBAAY,CAAC,KAAI,CAAC,WAAN,CAAZ;AACA,WAAI,CAAC,WAAL,GAAmB,UAAU,CAAC;AAAM,oBAAI,CAAC,YAAL,CAAkB,OAAlB;AAAqC,OAA5C,EAA8C,EAA9C,CAA7B;AACA,KALD,EAfD,CAsBC;AACA;AAEA,GAzBO;;AA2BA,oDAAR;AACE,UAAc,CAAC,WAAf,GAA6B,KAA7B;;AACD,SAAK,aAAL,CAAmB,aAAnB;;AACA,SAAK,sBAAL,CAA4B,IAA5B;;AACA,SAAK,gBAAL,CAAsB,aAAtB;;AACC,UAAe,CAAC,WAAhB,GAA8B,KAA9B;AACA,UAAe,CAAC,aAAhB,GAAgC,IAAhC;;AAED,QAAI,KAAK,GAAU,KAAK,gBAAL,CAAsB,aAAtB,EAAnB;;AACA,QAAI,OAAO,GAAW,KAAK,CAAC,CAAN,GAAW,MAAM,CAAC,UAAP,GAAoB,CAArD;AACA,QAAI,OAAO,GAAW,KAAK,CAAC,CAAN,GAAW,MAAM,CAAC,WAAP,GAAqB,CAAtD;AAEA,QAAI,CAAC,QAAL,CAAc,EAAd,CAAiB,eAAjB,EAAkC,GAAlC,EAAuC;AAAC,eAAS,EAAE,CAAZ;AAAe,WAAK,EAAE,CAAtB;AAAyB,OAAC,EAAE,CAAC,EAAD,GAAM,OAAlC;AAA2C,OAAC,EAAE,CAAC,EAAD,GAAM;AAApD,KAAvC;AACA,QAAI,CAAC,QAAL,CAAc,EAAd,CAAiB,qBAAjB,EAAwC,GAAxC,EAA6C;AAAC,eAAS,EAAE,CAAZ;AAAe,UAAI,EAAE,IAAI,CAAC,MAAL,CAAY;AAAjC,KAA7C;AACA,QAAI,CAAC,QAAL,CAAc,EAAd,CAAiB,2BAAjB,EAA8C,GAA9C,EAAmD;AAAC,eAAS,EAAE,CAAZ;AAAe,UAAI,EAAE,IAAI,CAAC,MAAL,CAAY,QAAjC;AAA2C,WAAK,EAAE;AAAlD,KAAnD;AAEA,GAhBO;AAkBR;;;AACQ,2CAAR,UAAsB,UAAtB,EAAgD;AAAhD,qBAAgD,CAE/C;;;AACA,SAAK,aAAL,CAAmB,eAAnB,CAAmC,UAAnC,EAA+C,GAA/C,EAH+C,CAI/C;AAEA;;;AACA,SAAK,SAAL,CAAe,WAAf,GAA6B,UAAU,CAAE;AACxC,WAAI,CAAC,sBAAL,CAA4B,IAA5B;;AACA,WAAI,CAAC,aAAL,CAAmB,oBAAnB;;AACA,WAAI,CAAC,gBAAL,CAAsB,mBAAtB,CAA0C,IAA1C;AACA,KAJsC,EAIpC,IAJoC,CAAvC;AAMA,GAbO,CA7vBT,CA4wBC;AACA;AAEA;;;AACQ,0CAAR;AAAA;;AACC,SAAK,OAAL,CAAa,SAAb,GAAyB,IAAI,CAAC,QAAL,CAAc,EAAd,CACxB,CAAC,KAAK,SAAN,EAAiB,QAAQ,CAAC,aAAT,CAAuB,QAAvB,CAAjB,CADwB,EAExB,GAFwB,EAGxB;AAAC,eAAS,EAAE,CAAZ;AAAe,WAAK,EAAE,GAAtB;AAA2B,gBAAU,EAAE;AACtC,aAAI,CAAC,eAAL,CAAqB,OAArB,GAA+B,KAA/B;AACA;AAFD,KAHwB,CAAzB;AAOA,GARO,CAhxBT,CA0xBC;;;AACQ,0CAAR,UAAqB,UAArB,EAA+C;AAA/C,qBAA+C,CAC9C;;;AACA,SAAK,aAAL,CAAmB,aAAnB,CAAiC,UAAjC,EAF8C,CAG9C;;;AACA,SAAK,qBAAL,CAA2B,aAA3B,CAAyC,UAAzC;;AACA,SAAK,SAAL,CAAe,MAAf,GAAwB,UAAU,CAAE;AACnC,WAAI,CAAC,GAAL,CAAS,WAAT,CAAqB,KAAI,CAAC,SAA1B,EAAqC,SAArC;;AACA,WAAI,CAAC,eAAL,CAAqB,OAArB,GAA+B,KAA/B;AACA,KAHiC,EAG/B,IAH+B,CAAlC;AAKA,GAVO;;AAYT;AAAC,CAvyBD,CAAoC,uBAApC;;AAAa,wC;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACjCb;;AACA;;AACA;;AACA;;AAMA;;AACA;;AACA;AAEA;;;AACA;AAAA;AAAA;AAAoC;;AAApC;AAAA,0EAEC;;;AACQ,oBAAmB,KAAnB;AAEA,kBAAa,EAAb;AACA,8BAA8B,KAA9B;AACA,2BAA0B,KAA1B;AACA,iCAAgC,KAAhC;AACA,2BAA0B,KAA1B;AACA,yCAAwC,KAAxC;AACA,mCAAkC,KAAlC;AAEA,0BAAqB,EAArB;AAUA,sBAAiB,EAAjB;AACA,oBAAe,EAAf;AACA,uBAAkB,EAAlB;AAES,yBAAe,CAAC,OAAD,EAAU,QAAV,EAAoB,MAApB,EAA4B,SAA5B,CAAf;AACA,gCAAsB;AAAC,WAAK,EAAE,OAAR;AAAiB,YAAM,EAAE,QAAzB;AAAmC,UAAI,EAAE,MAAzC;AAAiD,aAAO,EAAE;AAA1D,KAAtB;;AAihBjB,GA7iBD,CA8BC;;;AACO,kCAAP;AAAA,sBAEC;;;AACA,SAAK,OAAL,GAAe,IAAf,CAHD,CAKC;;AACA,SAAK,KAAL,CAAW,KAAK,gBAAhB,IAAoC,EAApC;AACA,SAAK,iBAAL,GAAyB,IAAzB,CAPD,CASC;;AACA,QAAI,YAAY,GAAsB;AACrC,aAAO,EAAE,oBAAY,IADgB;AAErC,gBAAU,EAAE,KAAK,gBAFoB;AAGrC,WAAK,EAAE,KAAK,mBAAL,CAAyB,KAAK,gBAA9B,CAH8B;AAIrC,UAAI,EAAE,MAAI,KAAK,gBAAT,GAAyB;AAJM,KAAtC;AAMA,oBAAO,QAAP,CAAgB,sBAAU,gBAA1B,EAA4C,YAA5C,EAhBD,CAkBC;;AACA,SAAK,4BAAL,GAAoC,IAApC;AACA,cAAU,CAAE;AACX,WAAI,CAAC,4BAAL,GAAoC,KAApC;;AACA,UAAI,KAAI,CAAC,cAAL,IAAuB,CAAC,KAAI,CAAC,oBAAjC,EAAuD;AACtD,aAAI,CAAC,mBAAL;AACA;AACD,KALS,EAKP,IALO,CAAV;AAOA,GA3BM,CA/BR,CA4DC;AACA;AACA;AACA;AACA;;AAEA;;;AACO,mCAAP;AACC,SAAK,gBAAL,GAAwB,wBAAgB,KAAxC;AACA,SAAK,IAAL;AACA,GAHM;AAIP;;;AACO,oCAAP;AACC,SAAK,gBAAL,GAAwB,wBAAgB,MAAxC;AACA,SAAK,IAAL;AACA,GAHM;AAIP;;;AACO,kCAAP;AACC,SAAK,gBAAL,GAAwB,wBAAgB,IAAxC;AACA,SAAK,IAAL;AACA,GAHM;AAIP;;;AACO,qCAAP;AACC,SAAK,gBAAL,GAAwB,wBAAgB,OAAxC;AACA,SAAK,IAAL;AACA,GAHM,CAlFR,CAuFC;AACA;AACA;AACA;AACA;AAEA;AACA;;;AACO,2CAAP,UAAqB,KAArB,EAAoD;AAA/B;AAAA;AAA+B,MAEnD;;;AACA,QAAI,CAAC,KAAK,oBAAV,EAAgC;AAC/B,WAAK,mBAAL;;AACA,aAAO,KAAP;AACA;;AACD,WAAO,IAAP;AACA,GARM,CA/FR,CAyGC;;;AACO,8CAAP;AACC,WAAO,KAAK,aAAL,EAAP;AACA,GAFM,CA1GR,CA8GC;AACA;;AACA;;;AACO,4CAAP,UAAsB,SAAtB,EAAoD;AACnD,SAAK,UAAL,GAAkB,SAAlB;AACA,GAFM;AAIP;;;AACO,sCAAP;AACC;AACA,QAAI,KAAK,OAAT,EAAkB;AACjB,WAAK,aAAL,CAAmB,KAAK,gBAAxB,IAA4C,KAAK,SAAL,CAAe,aAAf,CAA6B,wBAAsB,KAAK,gBAAxD,CAA5C;AACA,WAAK,MAAL;AACA;AACD,GANM;AAQP;;;AACO,mCAAP;AACE,SAAK,SAAL,CAA+B,KAA/B,CAAqC,UAArC,GAAkD,SAAlD;AACA,SAAK,SAAL,CAA+B,KAA/B,CAAqC,OAArC,GAA+C,OAA/C;AACD,QAAI,CAAC,QAAL,CAAc,GAAd,CAAkB,CAAC,KAAK,SAAN,CAAlB,EAAoC;AAAC,WAAK,EAAE;AAAR,KAApC;;AACA,SAAK,4BAAL;AACA,GALM;AAOP;;;AACO,oCAAP;AAEC;;AACA,QAAI,CAAC,KAAK,gBAAN,IAA0B,CAAC,KAAK,aAAL,CAAmB,KAAK,gBAAxB,CAA/B,EAA0E;AACzE;AACA;;AAED,WAAO,CAAC,GAAR,CAAY,wDAAZ,EAAuE,KAAK,aAAL,CAAmB,KAAK,gBAAxB,EAA0C,YAAjH;AACC,SAAK,SAAL,CAA+B,KAA/B,CAAqC,MAArC,GAAiD,KAAK,aAAL,CAAmB,KAAK,gBAAxB,EAA0C,YAA1C,GAAsD,IAAvG;AACD,GATM;AAWP;;;AACO,kCAAP;AACC,SAAK,uBAAL;AACA,GAFM;AAIP;;;AACO,mCAAP;AACC,QAAI,CAAC,QAAL,CAAc,EAAd,CAAiB,CAAC,KAAK,SAAN,CAAjB,EAAmC,IAAnC,EAAyC;AAAC,WAAK,EAAE,GAAR;AAAa,UAAI,EAAE,IAAI,CAAC,MAAL,CAAY;AAA/B,KAAzC;AACA,GAFM;AAIP;;;AACO,qCAAP;AACC,QAAI,CAAC,QAAL,CAAc,EAAd,CAAiB,CAAC,KAAK,SAAN,CAAjB,EAAmC,IAAnC,EAAyC;AAAC,WAAK,EAAE,CAAR;AAAW,UAAI,EAAE,IAAI,CAAC,MAAL,CAAY;AAA7B,KAAzC;AACA,GAFM;AAIP;;;AACO,oCAAP;AAAA;;AACC,SAAK,OAAL,GAAe,KAAf;;AACA,SAAK,OAAL,CAAa,SAAb,CAAuB,KAAvB;;AACA,SAAK,4BAAL;;AACA,SAAK,SAAL,CAAe,MAAf,GAAwB,UAAU,CAAC;AAAM,kBAAI,CAAJ;AAA0B,KAAjC,EAAmC,GAAnC,CAAlC;AACA,GALM;AAOP;;;AACO,iCAAP;AACC,QAAI,CAAC,KAAK,iBAAV,EAA8B;AAC7B,WAAK,mBAAL;AACA,KAFD,MAEO,IAAI,CAAC,KAAK,iBAAN,IAA2B,KAAK,cAApC,EAAoD;AAC1D,WAAK,mBAAL;AACA,KAFM,MAEA,IAAI,CAAC,KAAK,iBAAV,EAA6B;AACnC,WAAK,cAAL,GAAsB,IAAtB;AACA;AACD,GARM;AAUP;;;AACO,kCAAP,UAAY,QAAZ,EAA8C;AAE7C;AACA;AACA;AAJD;;AAAY;AAAA;AAAkC;;AAM7C,SAAK,OAAL,GAAe,IAAf;;AAEA,QAAI,KAAK,OAAT,EAAmB;AAClB,WAAK,OAAL,CAAa,SAAb,CAAuB,IAAvB;AACA;;AAED,QAAI,KAAK,MAAL,CAAY,QAAhB,EAA0B;AAEzB,UAAI,YAAY,GAAW,KAAK,kBAAL,CAAwB,KAAK,gBAA7B,CAA3B;;AACA,WAAK,OAAL,CAAa,cAAb,CAA4B,YAA5B;;AAEA,UAAI,eAAa,GAAgB,KAAK,aAAL,CAAmB,KAAK,MAAL,CAAY,UAA/B,CAAjC;AACA,WAAK,MAAL;;AAEA,WAAK,qBAAL,CAA2B,eAA3B;;AACA,WAAK,GAAL,CAAS,QAAT,CAAkB,KAAK,SAAvB,EAAkC,YAAlC;AAEA,WAAK,OAAL,CAAa,SAAb,GAAyB,IAAI,CAAC,QAAL,CAAc,MAAd,CAAqB,KAAK,SAA1B,EAAqC,GAArC,EAA0C;AAAC,SAAC,EAAE,MAAJ;AAAY,iBAAS,EAAE,CAAvB;AAA0B,eAAO,EAAE;AAAnC,OAA1C,EAAuF;AAAC,SAAC,EAAE;AAAJ,OAAvF,CAAzB;AACA,WAAK,SAAL,CAAe,iBAAf,GAAmC,UAAU,CAAC;AAC7C,aAAI,CAAC,UAAL,CAAgB,QAAhB,CAAyB,eAAzB,EAAwC,CAAxC,EAA2C,eAAa,CAAC,aAAd,CAA4B,4BAA5B,CAA3C;;AACA,aAAI,CAAC,UAAL,CAAgB,SAAhB,CAA0B,IAA1B;AACA,OAH4C,EAG1C,GAH0C,CAA7C;AAIA,WAAK,SAAL,CAAe,QAAf,GAA0B,UAAU,CAAC;AAAM,+BAAO,QAAP,CAAgB,sBAAhB;AAAyC,OAAhD,EAAkD,IAAlD,CAApC;AACA,WAAK,SAAL,CAAe,WAAf,GAA6B,UAAU,CAAC;AAAM,oBAAI,CAAC,GAAL,CAAS,WAAT,CAAqB,KAAI,CAAC,SAA1B;AAAkD,OAAzD,EAA2D,IAA3D,CAAvC;AAEA;AACA,KAhC4C,CAkC7C;;;AACA,SAAK,kBAAL;;AACA,SAAK,UAAL,CAAgB,SAAhB,CAA0B,IAA1B;;AACA,SAAK,MAAL;AAEA,GAvCM;AAyCP;;;AACO,kCAAP,UAAY,QAAZ,EAA8C;AAAlC;AAAA;AAAkC;AAE7C,GAFM;AAIP;;;;;;AAIO,sCAAP,UAAgB,KAAhB,EAAwC;AACvC,SAAK,MAAL,GAAc,KAAd;AACA,SAAK,gBAAL,GAAyB,KAAK,MAAL,CAAY,UAArC;;AACA,QAAI,YAAY,GAAW,KAAK,kBAAL,CAAwB,KAAK,gBAA7B,CAA3B;AACA,GAJM;AAMP;;;;;;AAIO,mDAAP,UAA6B,KAA7B,EAAqD;AAArD;;AACC,SAAK,MAAL,GAAc,KAAd;;AACA,QAAI,YAAY,GAAW,KAAK,kBAAL,CAA0B,KAAK,CAAC,UAAhC,CAA3B,CAFoD,CAGpD;;;AACA,QAAI,KAAK,GAAY,KAAK,CAAC,QAAP,GAAmB,GAAnB,GAAyB,CAA7C;AACA,SAAK,SAAL,CAAe,gBAAf,GAAkC,UAAU,CAAC;AAAM,kBAAI,CAAC,cAAL,CAAoB,YAApB;AAAuC,KAA9C,EAAgD,KAAhD,CAA5C;AACA,QAAI,CAAC,QAAL,CAAc,EAAd,CAAiB,CAAC,KAAK,SAAN,CAAjB,EAAmC,GAAnC,EAAwC;AAAC,WAAK,EAAE,CAAR;AAAW,UAAI,EAAE,IAAI,CAAC,MAAL,CAAY;AAA7B,KAAxC;AACA,GAPM;AASP;;;;;;AAIO,qCAAP,UAAe,IAAf,EAA6B,OAA7B,EAAqD;AAEpD,SAAK,KAAL,CAAW,OAAX,IAAsB,IAAtB;AACA,SAAK,cAAL,GAAsB,KAAK,0BAAL,EAAtB,CAHoD,CAKpD;;AACA,QAAI,KAAK,cAAT,EAAyB;AACxB,sBAAO,QAAP,CAAgB,IAAI,+BAAJ,CAAmB;AAAC,YAAI,EAAE,iBAAS;AAAhB,OAAnB,CAAhB,EAA2D;AAAC,aAAK,EAAE;AAAR,OAA3D;AACA,KARmD,CAUpD;;;AACA,QAAI,KAAK,cAAL,KAA0B,KAAK,OAAL,IAAgB,KAAK,cAA/C,CAAJ,EAAoE;AAEnE,UAAI,CAAC,KAAK,4BAAV,EAAwC;AACvC,aAAK,mBAAL;AACA;AACD;AAED,GAlBM;AAoBP;;;;;;AAIO,gDAAP,UAA0B,OAA1B,EAAkD;AACjD,WAAO,KAAK,mBAAL,CAAyB,OAAzB,CAAP;AACA,GAFM,CAtRR,CA0RC;AACA;AACA;AACA;AACA;;AAEA;;;AACQ,wDAAR;AAAA;;AACC,QAAI,MAAM,GAAY,IAAtB;AACA,SAAK,YAAL,CAAkB,OAAlB,CAA2B,UAAC,OAAD,EAAgB;AAC1C,UAAI,KAAI,CAAC,KAAL,CAAW,OAAX,MAAwB,IAAxB,IAAgC,KAAI,CAAC,KAAL,CAAW,OAAX,MAAwB,SAA5D,EAAuE;AACtE,cAAM,GAAG,KAAT;AACA;AACD,KAJD;AAKA,WAAO,MAAP;AACA,GARO;AAUR;;;;;;AAIQ,iDAAR;AAAA;;AACC,QAAI,IAAI,GAAW,qFAEf,KAAK,sBAAL,EAFe,GAEc,oBAFjC;AAKA,SAAK,GAAL,CAAS,MAAT,CAAgB,QAAQ,CAAC,aAAT,CAAuB,MAAvB,CAAhB,EAAgD,IAAhD,EAAsD;AACrD,WAAI,CAAC,SAAL,GAAiB,QAAQ,CAAC,aAAT,CAAuB,OAAvB,CAAjB;;AACA,WAAI,CAAC,mBAAL;AACA,KAHD;AAIA,SAAK,iBAAL,GAAyB,IAAzB;AACA,GAXO;AAaR;;;AACQ,oDAAR;AAAA;;AAEC,QAAI,WAAW,GAAY,KAAK,OAAN,GAAiB,SAAjB,GAA6B,EAAvD;AACA,QAAI,IAAI,GAAW,uHAAkH,KAAK,YAAL,CAAkB,MAApI,GAA0I,GAA1I,GAA8I,WAA9I,GAAyJ,KAA5K;AACA,SAAK,YAAL,CAAkB,OAAlB,CAA2B,UAAC,OAAD,EAAkB,KAAlB,EAA+B;AACzD,UAAI,IAAI,KAAI,CAAC,qBAAL,CAA2B,OAA3B,EAAoC,KAApC,CAAR;AACA,KAFD;AAGA,QAAI,IAAI,OAAR;AACA,WAAO,IAAP;AACA,GATO;AAWR;;;AACQ,mDAAR,UAA8B,OAA9B,EAA+C,KAA/C,EAA4D;AAC3D,QAAI,KAAK,GAAW,KAAK,mBAAL,CAAyB,OAAzB,CAApB;AACA,WAAO,uCAAqC,KAArC,GAA0C,IAA1C,GAA+C,OAA/C,GAAsD,sBAAtD,GACM,OADN,GACa,wDADb,GACsE,KADtE,GAC2E,IAD3E,GACgF,KADhF,GACqF,kGAD5F;AAKA,GAPO;AASR;;;AACQ,iDAAR;AAAA,sBAEC;;;AACA,QAAI,KAAK,oBAAT,EAA+B;AAC9B;AACA,KALF,CAOC;;;AACA,QAAI,CAAC,KAAK,cAAV,EAA0B;AACzB,WAAK,cAAL,GAAsB,IAAtB;AACA;AACA;;AAED,SAAK,cAAL,GAAsB,KAAtB,CAbD,CAeC;;AACA,QAAI,UAAU,GAAW,EAAzB;AACA,UAAM,CAAC,IAAP,CAAY,KAAK,KAAjB,EAAwB,OAAxB,CAAiC,UAAC,GAAD,EAAY;AAC5C;AACA,UAAI,KAAI,CAAC,KAAL,CAAW,GAAX,MAAoB,EAAxB,EAA4B;AAC3B,kBAAU,IAAI,KAAI,CAAC,KAAL,CAAW,GAAX,CAAd;AACA;AACD,KALD;AAOA,SAAK,GAAL,CAAS,MAAT,CAAgB,KAAK,SAArB,EAAgC,UAAhC,EAA4C;AAC3C,WAAI,CAAC,oBAAL,GAA4B,IAA5B;;AACA,WAAI,CAAC,cAAL;;AACA,UAAI,KAAI,CAAC,OAAT,EAAkB;AACjB,aAAI,CAAC,OAAL,CAAa,QAAb,CAAsB,aAAtB;AACA;AACD,KAND;AAQA,GAhCO,CAnVT,CAqXC;;;AACQ,mDAAR,UAA8B,OAA9B,EAAkD;AAAlD;;AAEC,UAAM,CAAC,IAAP,CAAY,KAAK,aAAjB,EAAgC,OAAhC,CAAyC,UAAC,IAAD,EAAK;AAC7C,UAAI,KAAI,CAAC,aAAL,CAAmB,IAAnB,MAA6B,OAAjC,EAA0C;AACzC,aAAI,CAAC,aAAL,CAAmB,IAAnB,EAAyB,KAAzB,CAA+B,OAA/B,GAAyC,MAAzC;AACA;AACD,KAJD;AAMA,WAAO,CAAC,KAAR,CAAc,OAAd,GAAwB,OAAxB,CARiD,CASjD;;AACA,QAAI,CAAC,QAAL,CAAc,GAAd,CAAkB,OAAlB,EAA2B;AAAC,OAAC,EAAE;AAAJ,KAA3B;AAEA,GAZO;AAcR;;;AACQ,4CAAR;AAAA,sBACC;;;AACA,SAAK,SAAL,GAAiB,QAAQ,CAAC,aAAT,CAAuB,OAAvB,CAAjB;AACA,SAAK,YAAL,CAAkB,OAAlB,CAA2B,UAAC,OAAD,EAAQ;AAClC,UAAI,CAAC,KAAI,CAAC,aAAL,CAAmB,OAAnB,CAAL,EAAkC;AACjC,aAAI,CAAC,aAAL,CAAmB,OAAnB,IAA8B,KAAI,CAAC,SAAL,CAAe,aAAf,CAA6B,wBAAsB,OAAnD,CAA9B;AACA;AACD,KAJD;;AAMA,SAAK,mBAAL;AACA,GAVO;AAYR;;;AACQ,iDAAR;AAEC,SAAK,OAAL,GAAe,IAAI,eAAJ,EAAf;;AACA,SAAK,OAAL,CAAa,YAAb,CAA2B,KAAK,SAAL,CAAe,aAAf,CAA6B,mBAA7B,CAA3B;;AACA,SAAK,OAAL,CAAa,EAAb,GAAmB,aAAnB;;AACA,SAAK,OAAL,CAAa,MAAb;;AACA,SAAK,OAAL,CAAa,MAAb,CAAoB,wBAApB,GAA+C,GAA/C;AACA,SAAK,OAAL,CAAa,MAAb,CAAoB,KAApB,GAA4B,KAA5B;;AACA,SAAK,OAAL,CAAa,YAAb,CAA0B,KAAK,cAAL,CAAoB,IAApB,CAAyB,IAAzB,CAA1B;;AAEA,QAAI,KAAK,OAAT,EAAkB;AACjB,UAAI,YAAY,GAAW,KAAK,kBAAL,CAAwB,KAAK,gBAA7B,CAA3B;;AACA,WAAK,OAAL,CAAa,cAAb,CAA4B,YAA5B;;AACA,WAAK,OAAL,CAAa,SAAb,CAAuB,IAAvB;;AACA,UAAI,KAAK,oBAAT,EAA+B;AAC9B,aAAK,OAAL,CAAa,QAAb,CAAsB,aAAtB;AACA;AACD;AAED,GAnBO;AAqBR;;;AACQ,4CAAR,UAAuB,KAAvB,EAAsC,WAAtC,EAAkE;AAA5B;AAAA;AAA4B;;AAEjE,QAAI,OAAO,GAAG,KAAK,kBAAL,CAAwB,KAAxB,CAAd;;AAEA,YAAG,KAAH,CAAS,IAAT,EAAe,wBAAf,EAAyC,OAAzC,EAJiE,CAMjE;;AACA,QAAI,KAAK,gBAAL,KAA0B,OAA9B,EAAuC;AACtC;AACA,KATgE,CAWjE;;;AACA,QAAI,UAAU,GAAoB,KAAK,gBAAvC;;AACA,QAAI,eAAe,GAAW,KAAK,kBAAL,CAAwB,KAAK,gBAA7B,CAA9B;;AACA,SAAK,gBAAL,GAAwB,OAAxB;;AACA,SAAK,OAAL,CAAa,cAAb,CAA4B,KAA5B,EAfiE,CAiBjE;;;AACA,QAAI,SAAS,GAAI,eAAe,GAAG,KAAnB,GAA4B,CAA5B,GAAgC,CAAC,CAAjD;;AACA,SAAK,oBAAL,CAA0B,SAA1B,EAAqC,UAArC;;AACA,SAAK,kBAAL,GApBiE,CAsBjE;;;AACA,QAAI,CAAC,QAAL,CAAc,EAAd,CAAiB,mBAAjB,EAAsC,GAAtC,EAA2C;AAAC,OAAC,EAAK,CAAC,CAAD,IAAM,KAAK,GAAG,EAAd,IAAiB,GAAxB;AAA6B,UAAI,EAAE,IAAI,CAAC,MAAL,CAAY;AAA/C,KAA3C,EAvBiE,CAyBjE;;AACA,QAAI,WAAJ,EAAiB;AAChB;AACA,KA5BgE,CA8BjE;;;AACA,QAAI,QAAQ,GAAsB;AACjC,aAAO,EAAE,oBAAY,IADY;AAEjC,gBAAU,EAAE,KAAK,gBAFgB;AAGjC,WAAK,EAAE,KAAK,mBAAL,CAAyB,KAAK,gBAA9B,CAH0B;AAIjC,UAAI,EAAE,MAAI,KAAK,gBAAT,GAAyB,GAJE;AAKjC,uBAAiB,EAAE;AALc,KAAlC;AAOA,oBAAO,QAAP,CAAgB,sBAAU,cAA1B,EAA0C,QAA1C;AAEA,GAxCO;AA0CR;;;AACQ,gDAAR,UAA2B,KAA3B,EAAwC;AACvC,WAAQ,KAAK,YAAL,CAAkB,KAAlB,CAAR;AACA,GAFO,CAndT,CAudC;;;AACQ,gDAAR,UAA2B,OAA3B,EAAmD;AAClD,SAAK,IAAI,CAAC,GAAG,CAAb,EAAgB,CAAC,GAAG,KAAK,YAAL,CAAkB,MAAtC,EAA8C,CAAC,EAA/C,EAAmD;AAClD,UAAI,KAAK,YAAL,CAAkB,CAAlB,MAAyB,OAA7B,EAAsC;AACrC,eAAO,CAAP;AACA;AACD;;AACD,WAAO,CAAC,CAAR;AACA,GAPO,CAxdT,CAieC;;;AACQ,kDAAR,UAA6B,SAA7B,EAAgD,cAAhD,EAA+E;AAA/E;;AACC,QAAI,OAAO,GAAc,MAAM,SAAN,GAAe,GAAxC;AACA,QAAI,WAAW,GAAc,OAAO,CAAC,CAAD,GAAK,SAAZ,IAAsB,GAAnD;AAEA,SAAK,OAAL,CAAa,UAAb,GAA0B,IAAI,CAAC,QAAL,CAAc,EAAd,CAAiB,KAAK,aAAL,CAAmB,cAAnB,CAAjB,EAAqD,GAArD,EAA0D;AAAC,OAAC,EAAE,OAAJ;AAAa,UAAI,EAAE,IAAI,CAAC,MAAL,CAAY,OAA/B;AAAwC,gBAAU,EAAE;AACvI,aAAI,CAAC,GAAL,CAAS,WAAT,CAAqB,KAAI,CAAC,aAAL,CAAmB,cAAnB,CAArB,EAAyD,SAAzD;;AACA,aAAI,CAAC,aAAL,CAAmB,cAAnB,EAAmC,KAAnC,CAAyC,OAAzC,GAAmD,MAAnD;AACA;AAHmF,KAA1D,CAA1B;AAKA,SAAK,aAAL,CAAmB,KAAK,gBAAxB,EAA0C,KAA1C,CAAgD,OAAhD,GAA0D,OAA1D;AAEA,SAAK,GAAL,CAAS,QAAT,CAAkB,KAAK,aAAL,CAAmB,KAAK,gBAAxB,CAAlB,EAA6D,eAA7D;AACA,SAAK,OAAL,CAAa,UAAb,GAA0B,IAAI,CAAC,QAAL,CAAc,MAAd,CACzB,KAAK,aAAL,CAAmB,KAAK,gBAAxB,CADyB,EAEzB,GAFyB,EAGzB;AAAC,OAAC,EAAE,WAAJ;AAAiB,eAAS,EAAE;AAA5B,KAHyB,EAIzB;AAAC,OAAC,EAAE,IAAJ;AAAU,UAAI,EAAE,IAAI,CAAC,MAAL,CAAY,OAA5B;AAAqC,gBAAU,EAAE;AAChD,aAAI,CAAC,GAAL,CAAS,WAAT,CAAqB,KAAI,CAAC,aAAL,CAAmB,KAAI,CAAC,gBAAxB,CAArB,EAAgE,eAAhE;;AACA,aAAI,CAAC,GAAL,CAAS,QAAT,CAAkB,KAAI,CAAC,aAAL,CAAmB,KAAI,CAAC,gBAAxB,CAAlB,EAA6D,SAA7D;;AACA,aAAI,CAAC,MAAL;AACA;AAJD,KAJyB,CAA1B;AAWA,GAvBO;AAyBR;;;;;;AAIQ,gDAAR;AACC,QAAI,CAAC,QAAL,CAAc,GAAd,CAAkB,KAAK,aAAL,CAAmB,KAAK,gBAAxB,CAAlB,EAA6D;AAAC,OAAC,EAAE;AAAJ,KAA7D,EADD,CAEC;;AACA,QAAI,sBAAsB,GAAgB,KAAK,aAAL,CAAmB,KAAK,gBAAxB,EAA0C,aAA1C,CAAwD,4BAAxD,CAA1C;;AACA,SAAK,UAAL,CAAgB,QAAhB,CAAyB,KAAK,aAAL,CAAmB,KAAK,gBAAxB,CAAzB,EAAoE,GAApE,EAAyE,sBAAzE;AACA,GALO;AAOR;;;AACQ,iDAAR;AACC,SAAK,UAAL,CAAgB,SAAhB,CAA0B,KAA1B;;AACA,SAAK,UAAL,CAAgB,QAAhB,CAAyB,IAAzB;;AACA,QAAI,CAAC,QAAL,CAAc,GAAd,CAAkB,CAAC,KAAK,SAAN,CAAlB,EAAoC;AAAC,WAAK,EAAE;AAAR,KAApC;AACC,SAAK,SAAL,CAA+B,KAA/B,CAAqC,UAArC,GAAkD,QAAlD;AACA,SAAK,SAAL,CAA+B,KAA/B,CAAqC,OAArC,GAA+C,MAA/C;AACD,SAAK,GAAL,CAAS,WAAT,CAAqB,KAAK,SAA1B,EAAqC,SAArC;AACA,GAPO;AASR;;;AACQ,0DAAR;AAAA;;AACC,UAAM,CAAC,IAAP,CAAY,KAAK,OAAjB,EAA0B,OAA1B,CAAmC,UAAC,GAAD,EAAY;AAC9C,WAAI,CAAC,OAAL,CAAa,GAAb,EAAkB,IAAlB;AACA,KAFD;AAGA,UAAM,CAAC,IAAP,CAAY,KAAK,SAAjB,EAA4B,OAA5B,CAAqC,UAAC,GAAD,EAAY;AAChD,kBAAY,CAAC,KAAI,CAAC,SAAL,CAAe,GAAf,CAAD,CAAZ;AACA,KAFD;AAGA,UAAM,CAAC,IAAP,CAAY,KAAK,UAAjB,EAA6B,OAA7B,CAAsC,UAAC,GAAD,EAAY;AACjD,mBAAa,CAAC,KAAI,CAAC,UAAL,CAAgB,GAAhB,CAAD,CAAb;AACA,KAFD;AAGA,GAVO;AAYR;;;AACQ,qDAAR;AAEC,QAAI,CAAC,KAAK,OAAV,EAAmB;AAClB;AACA;;AAED,QAAI,KAAK,sBAAL,IAA+B,KAAK,UAAL,CAAgB,SAAhB,KAA8B,GAAjE,EAAsE;AACrE,WAAK,sBAAL,GAA8B,KAA9B;;AACA,WAAK,OAAL,CAAa,WAAb,CAAyB,WAAzB;AACA,KAHD,MAGQ,IAAI,CAAC,KAAK,sBAAN,IAAgC,KAAK,UAAL,CAAgB,SAAhB,MAA+B,GAAnE,EAAwE;AAC/E,WAAK,OAAL,CAAa,QAAb,CAAsB,WAAtB;;AACA,WAAK,sBAAL,GAA8B,IAA9B;AACA;AACD,GAbO;;AAeT;AAAC,CA7iBD,CAAoC,uBAApC;;AAAa,wC;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACdb,sH,CACA;;;AACA;;AACA;;AACA;;AAIA;AAAA;AAAA;AAAqC;;AAArC;AAAA;;AAES,4BAA2B,KAA3B;AAGA,wBAAmB;AAAC,OAAC,EAAE,CAAJ;AAAO,OAAC,EAAE;AAAV,KAAnB;AAEA,2BAAyB,CAAzB;AAGA,yBAAwB,KAAxB;AACA,oBAAmB,KAAnB;AACA,+BAA8B,KAA9B;AACA,4BAAyC,IAAI,6CAAJ,EAAzC;;AAyPR;;AAvPO,mCAAP,aAEC,CAFM;;AAIA,uCAAP;AACC,SAAK,YAAL,GAAoB,KAAK,SAAL,CAAe,aAAf,CAA6B,iBAA7B,CAApB;AACA,oBAAO,EAAP,CAAU,WAAV,EAAuB,gBAAvB,EAAyC,KAAK,UAAL,CAAgB,IAAhB,CAAqB,IAArB,CAAzC;AACA,oBAAO,EAAP,CAAU,UAAV,EAAsB,gBAAtB,EAAwC,KAAK,SAAL,CAAe,IAAf,CAAoB,IAApB,CAAxC;AACA,oBAAO,EAAP,CAAU,YAAV,EAAwB,KAAK,SAA7B,EAAwC,KAAK,aAAL,CAAmB,IAAnB,CAAwB,IAAxB,CAAxC;AACA,oBAAO,EAAP,CAAU,UAAV,EAAsB,KAAK,SAA3B,EAAsC,KAAK,WAAL,CAAiB,IAAjB,CAAsB,IAAtB,CAAtC;AACA,oBAAO,EAAP,CAAU,WAAV,EAAuB,KAAK,SAA5B,EAAuC,KAAK,YAAL,CAAkB,IAAlB,CAAuB,IAAvB,CAAvC;AACA,oBAAO,EAAP,CAAU,WAAV,EAAuB,KAAK,SAA5B,EAAuC,KAAK,YAAL,CAAkB,IAAlB,CAAuB,IAAvB,CAAvC;AACA,oBAAO,EAAP,CAAU,qCAAV,EAA6B,KAAK,cAAL,CAAoB,IAApB,CAAyB,IAAzB,CAA7B;AACA,GATM;;AAWA,mCAAP;AAEC,QAAI,KAAK,eAAL,IAAwB,KAAK,kBAAjC,EAAqD;AAEpD,UAAI,KAAK,kBAAT,EAA6B;AAC5B,YAAI,eAAe,GAAU,KAAK,eAAL,CAAqB,KAArB,CAA2B,KAAK,WAAhC,CAA7B;;AACA,aAAK,YAAL,CAAkB,KAAlB,CAAwB,SAAxB,GAAoC,iBAAe,eAAe,CAAC,CAA/B,GAAgC,MAAhC,GAAuC,eAAe,CAAC,CAAvD,GAAwD,QAA5F;AACA,OAHD,MAGO;AACN,aAAK,YAAL,CAAkB,KAAlB,CAAwB,SAAxB,GAAoC,iBAAe,KAAK,WAAL,CAAiB,CAAhC,GAAiC,MAAjC,GAAwC,KAAK,WAAL,CAAiB,CAAzD,GAA0D,QAA9F;AACA;AAED;AACD;;;;;;;;;AAQA,GApBM;AAsBP;;;AACO,oCAAP;AACC,SAAK,iBAAL,GAAyB,KAAK,eAA9B;AACA,SAAK,mBAAL,CAAyB,KAAzB,EAAgC,KAAhC;AACA,GAHM;AAKP;;;AACO,sCAAP;AACC,QAAI,KAAK,iBAAT,EAA4B;AAC3B,WAAK,mBAAL,CAAyB,IAAzB;AACA;AACD,GAJM;AAMP;;;AACO,6CAAP,UAAsB,MAAtB,EAAqC;AACpC,QAAI,KAAK,OAAL,KAAiB,MAArB,EAA6B;AAC5B,WAAK,GAAL,CAAS,WAAT,CAAqB,KAAK,YAA1B,EAAwC,SAAxC,EAAmD,MAAnD;AACA,WAAK,OAAL,GAAe,MAAf;AACA;AACD,GALM;AAOP;;;;;;;AAKO,kDAAP,UAA2B,MAA3B,EAA4C,qBAA5C,EAAiF;AAArC;AAAA;AAAqC;;AAEhF,QAAI,CAAC,KAAK,SAAV,EAAqB;AACpB;AACA;;AAED,QAAI,qBAAJ,EAA2B;AAC1B,WAAK,iBAAL,GAAyB,KAAzB;AACA;;AAED,SAAK,eAAL,GAAuB,MAAvB;AACA,SAAK,GAAL,CAAS,WAAT,CAAqB,KAAK,SAA1B,EAAqC,aAArC,EAAoD,KAAK,eAAzD;;AACA,SAAK,eAAL;AAEA,GAdM;AAgBP;;;;;;AAIO,wCAAP,UAAiB,MAAjB,EAA+B;AAE9B,QAAI,MAAM,KAAK,OAAf,EAAwB;AACvB,WAAK,GAAL,CAAS,WAAT,CAAqB,KAAK,SAA1B,EAAqC,aAArC;AACA;AACA;;AAED,SAAK,GAAL,CAAS,QAAT,CAAkB,KAAK,SAAvB,EAAkC,aAAlC;AAEA,GATM;;AAWA,0CAAP,UAAmB,MAAnB,EAAoC,IAApC,EAAyD,aAAzD,EAAoF;AAAhD;AAAA;AAAmB;;AAAE;AAAA;AAA2B;;AAEnF,QAAI,KAAK,GAAY,MAAD,GAAW,GAAX,GAAiB,GAArC;AAEA,SAAK,SAAL,GAAiB,MAAjB;AACC,UAAc,CAAC,WAAf,GAA8B,MAA9B,CALkF,CAOnF;;AACA,SAAK,GAAL,CAAS,WAAT,CAAqB,KAAK,YAA1B,EAAwC,UAAxC,EAAoD,MAApD;;AAEA,QAAI,MAAJ,EAAY;AACX,UAAI,SAAS,SAAb;AAAA,UAAe,QAAQ,GAAY,IAAnC;;AACA,UAAI,IAAI,KAAK,MAAb,EAAqB;AACpB,iBAAS,GAAG,KAAZ;AACA,OAFD,MAEO,IAAI,IAAI,KAAK,OAAb,EAAsB;AAC5B,gBAAQ,GAAG,KAAX;AACA;;AACD,WAAK,GAAL,CAAS,WAAT,CAAqB,KAAK,YAA1B,EAAwC,OAAxC,EAAiD,QAAjD;AACA,WAAK,GAAL,CAAS,WAAT,CAAqB,KAAK,YAA1B,EAAwC,QAAxC,EAAkD,SAAlD;AACA;AAED,GArBM;;AAuBA,4CAAP;AAEC,QAAI,CAAC,KAAK,WAAV,EAAuB;AACtB,aAAO;AAAC,SAAC,EAAE,MAAM,CAAC,UAAP,GAAoB,CAAxB;AAA2B,SAAC,EAAE,MAAM,CAAC,WAAP,GAAqB;AAAnD,OAAP;AACA;;AAED,WAAO,KAAK,WAAZ;AAEA,GARM;;AAUA,0CAAP;AACC,WAAO,KAAK,SAAZ;AACA,GAFM;;AAIA,6CAAP;AACC;AADD;;AAGC,SAAK,eAAL,CAAqB,cAArB,CACC;AAAC,OAAC,EAAG,MAAM,CAAC,UAAP,GAAkB,CAAvB;AAA2B,OAAC,EAAG,MAAM,CAAC,WAAP,GAAmB;AAAlD,KADD,EAEC,EAFD;;AAKA,SAAK,kBAAL,GAA2B,IAA3B,CARD,CASC;;AACA,cAAU,CAAC;AAAM,kBAAI,CAAC,GAAL,CAAS,QAAT,CAAkB,KAAI,CAAC,YAAvB;AAA8C,KAArD,EAAuD,GAAvD,CAAV;AACA,QAAI,CAAC,QAAL,CAAc,MAAd,CAAqB,KAAK,YAA1B,EAAwC,GAAxC,EAA6C;AAAC,eAAS,EAAE;AAAZ,KAA7C,EAA6D;AAAC,eAAS,EAAE,CAAZ;AAAe,WAAK,EAAE,GAAtB;AAA2B,UAAI,EAAE,IAAI,CAAC,MAAL,CAAY;AAA7C,KAA7D;AACA,GAZM;;AAcA,6CAAP;AAEC,QAAI,CAAC,KAAK,kBAAV,EAA8B;AAC7B;AACA;;AAED,SAAK,GAAL,CAAS,QAAT,CAAkB,KAAK,YAAvB,EAAqC,aAArC;AACA,SAAK,GAAL,CAAS,WAAT,CAAqB,KAAK,SAA1B,EAAqC,aAArC,EAAoD,IAApD;AACA,SAAK,GAAL,CAAS,QAAT,CAAkB,QAAQ,CAAC,aAAT,CAAuB,qBAAvB,CAAlB,EAAiE,QAAjE;AAEA;;;;;;;AAQA,GAlBM;;AAoBA,gDAAP;AAEC,QAAI,CAAC,KAAK,kBAAV,EAA8B;AAC7B;AACA;;AAED,SAAK,GAAL,CAAS,WAAT,CAAqB,KAAK,YAA1B,EAAwC,aAAxC;AACA,SAAK,GAAL,CAAS,WAAT,CAAqB,KAAK,SAA1B,EAAqC,aAArC,EAAoD,KAApD;AACA,SAAK,GAAL,CAAS,WAAT,CAAqB,QAAQ,CAAC,aAAT,CAAuB,qBAAvB,CAArB,EAAoE,QAApE;AACA,GATM;;AAWA,4CAAP;AACC,SAAK,cAAL,CAAoB,IAApB;AACA,SAAK,mBAAL,CAAyB,IAAzB;AACA,SAAK,GAAL,CAAS,WAAT,CAAqB,KAAK,YAA1B,EAAwC,aAAxC;AACA,SAAK,GAAL,CAAS,WAAT,CAAqB,KAAK,YAA1B,EAAwC,QAAxC;AACA,SAAK,kBAAL,GAA2B,KAA3B;AACA,GANM;;AAQC,8CAAR,aAEC;AACA;AACA;AACA;AAEA,GAPO;;AASA,4CAAR,UAAsB,CAAtB,EAAuB;AACtB,SAAK,MAAL,CAAY,cAAZ,GAA6B,IAA7B;AACA,SAAK,YAAL,GAAoB,IAApB;AACC,UAAc,CAAC,WAAf,GAA8B,IAA9B;AACD,GAJO;;AAMA,0CAAR,UAAoB,CAApB,EAAqB;AACnB,UAAc,CAAC,WAAf,GAA8B,KAA9B;AACD,SAAK,YAAL,GAAoB,KAApB;AACA,GAHO;;AAKA,2CAAR,UAAqB,CAArB,EAAsB;AAErB,QAAI,CAAC,KAAK,YAAV,EAA0B;AACzB,WAAK,MAAL,CAAY,cAAZ,GAA6B,KAA7B;AACA;;AAED,SAAK,WAAL,CAAiB,CAAjB,GAAqB,CAAC,CAAC,OAAvB;AACA,SAAK,WAAL,CAAiB,CAAjB,GAAqB,CAAC,CAAC,OAAvB;AAEA,GATO;;AAWA,2CAAR,UAAqB,CAArB,EAAsB;AACrB,SAAK,MAAL,CAAY,cAAZ,GAA6B,IAA7B;AACA,SAAK,WAAL,CAAiB,CAAjB,GAAqB,CAAC,CAAC,OAAF,CAAU,CAAV,EAAa,OAAlC;AACA,SAAK,WAAL,CAAiB,CAAjB,GAAqB,CAAC,CAAC,OAAF,CAAU,CAAV,EAAa,OAAlC;AACA,GAJO;;AAMA,yCAAR,UAAmB,CAAnB,EAAgC;AAC/B,QAAI,KAAK,eAAT,EAA0B;AACzB,WAAK,GAAL,CAAS,WAAT,CAAqB,KAAK,SAA1B,EAAqC,aAArC;AACA;AACD,GAJO;;AAMA,wCAAR,UAAkB,CAAlB,EAA+B;AAC9B,QAAI,KAAK,eAAT,EAA0B;AACzB,WAAK,GAAL,CAAS,QAAT,CAAkB,KAAK,SAAvB,EAAkC,aAAlC;AACA;AACD,GAJO;AAMR;;;AACQ,6CAAR,UAAuB,CAAvB,EAA2C;AAE1C,QAAK,CAAC,CAAC,IAAF,KAAW,SAAhB,EAA2B;AAC1B,WAAK,mBAAL,CAAyB,CAAC,CAAC,MAA3B,EAAmC,KAAnC;;AACA,UAAI,CAAC,CAAC,KAAN,EAAa;AACZ,aAAK,SAAL,CAAe,CAAC,CAAC,KAAjB;AACA;AACD,KALD,MAKO,IAAI,CAAC,CAAC,IAAF,KAAW,MAAf,EAAuB;AAC7B,WAAK,WAAL,CAAiB,CAAC,CAAC,MAAnB;AACA;AAED,GAXO;;AAaT;AAAC,CAtQD,CAAqC,uBAArC;;AAAa,0C;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACRb;;AACA;;AACA;;AACA;;AACA,mF,CAIA;;;AAEA;AAAA;AAAA;AAAuC;;AAAvC;;AA+KC;;AAzKO,qCAAP,aAAsB,CAAf,CANR,CAQC;;;AACO,+CAAP,UAAsB,IAAtB,EAA0C;AACzC,SAAK,eAAL,GAAuB,IAAvB;AACA,GAFM;;AAIA,yCAAP;AAAA;;AAEC,SAAK,YAAL,GAAoB,QAAQ,CAAC,aAAT,CAAuB,gBAAvB,CAApB;AAEA,oBAAO,EAAP,CAAU,OAAV,EAAmB,gBAAnB,EAAqC,UAAC,CAAD,EAAc;AAClD,OAAC,CAAC,cAAF;;AACA,WAAI,CAAC,kBAAL,CAAwB,CAAxB;;AACA,aAAO,KAAP;AACA,KAJD;AAMA,oBAAO,EAAP,CAAU,OAAV,EAAmB,gCAAnB,EAAqD,UAAC,CAAD,EAAc;AAClE,OAAC,CAAC,cAAF;;AACA,WAAI,CAAC,0BAAL,CAAgC,CAAhC;;AACA,aAAO,KAAP;AACA,KAJD;AAMA,oBAAO,EAAP,CAAU,OAAV,EAAmB,0BAAnB,EAA+C,UAAC,CAAD,EAAc;AAC5D,OAAC,CAAC,cAAF;;AACA,WAAI,CAAC,oBAAL,CAA0B,CAA1B;;AACA,aAAO,KAAP;AACA,KAJD;;AAMA,SAAK,qBAAL,CAA2B,KAAK,MAAhC;AAEA,GAxBM;AA0BP;;;AACO,0CAAP;AACC,WAAO,KAAK,GAAL,CAAS,QAAT,CAAkB,KAAK,SAAvB,EAAkC,OAAlC,CAAP;AACA,GAFM;AAIP;;;AACO,yCAAP,UAAgB,KAAhB,EAA0C,eAA1C,EAAyE;AAA/B;AAAA;AAA+B;;AACxE,SAAK,MAAL,GAAc,KAAd;;AACA,QAAI,eAAJ,EAAqB;AACpB,WAAK,qBAAL,CAA2B,KAA3B;AACA;AACD,GALM;AAOP;;;AACO,sCAAP;AACC,SAAK,aAAL,CAAmB,sBAAc,MAAjC;AACA,GAFM,CArDR,CAyDC;AACA;AACA;AACA;AACA;;AAEA;;;AACQ,mDAAR,UAA2B,CAA3B,EAAwC;AACvC,QAAI,UAAU,GAAa,CAAC,CAAC,MAA7B;AACA,QAAI,KAAK,GAAmB,KAAK,GAAL,CAAS,QAAT,CAAkB,UAAlB,EAA8B,OAA9B,CAAD,GAA2C,sBAAc,MAAzD,GAAkE,sBAAc,IAA3G;;AACA,SAAK,aAAL,CAAmB,KAAnB,EAHuC,CAKvC;;;AACA,oBAAO,QAAP,CAAgB,sBAAU,iBAA1B,EAA6C;AAAC,WAAK,EAAE;AAAR,KAA7C;AACA,GAPO,CAhET,CAyEC;;;AACQ,sDAAR,UAA8B,KAA9B,EAAsD;AACrD,SAAK,+BAAL;;AACA,QAAI,OAAJ;;AACA,QAAI,KAAK,CAAC,OAAN,KAAkB,oBAAY,IAA9B,IAAsC,KAAK,CAAC,OAAN,KAAkB,oBAAY,IAAxE,EAA8E;AAC7E,aAAO,GAAG,KAAK,SAAL,CAAe,aAAf,CAA6B,qBAAqB,KAAK,CAAC,UAAxD,CAAV;AACA,WAAK,GAAL,CAAS,QAAT,CAAkB,OAAlB,EAA2B,WAA3B;AACA;AACD,GAPO;AASR;;;AACQ,gEAAR;AAAA;;AACC,SAAK,SAAL,CAAe,gBAAf,CAAgC,gBAAhC,EAAkD,OAAlD,CAA2D,UAAC,IAAD,EAAc;AACxE,WAAI,CAAC,GAAL,CAAS,WAAT,CAAqB,IAArB,EAA2B,WAA3B;AACA,KAFD;AAGA,GAJO;AAMR;;;AACQ,8CAAR,UAAsB,KAAtB,EAA0C;AAA1C,qBAA0C,CACzC;;;AACA,QAAI,KAAK,KAAK,sBAAc,MAA5B,EAAoC;AACnC,WAAK,GAAL,CAAS,WAAT,CAAqB,KAAK,YAA1B,EAAwC,OAAxC;AACA,WAAK,GAAL,CAAS,WAAT,CAAqB,KAAK,SAA1B,EAAqC,OAArC;AACA,gBAAU,CAAC;AAAM,oBAAI,CAAC,GAAL,CAAS,WAAT,CAAqB,KAAI,CAAC,SAA1B;AAA+C,OAAtD,EAAwD,GAAxD,CAAV;;AACA,WAAK,gBAAL;AACA,KALD,MAKO;AACN,WAAK,GAAL,CAAS,QAAT,CAAkB,KAAK,YAAvB,EAAqC,OAArC;AACA,WAAK,GAAL,CAAS,QAAT,CAAkB,KAAK,SAAvB,EAAkC,OAAlC;AACA,WAAK,GAAL,CAAS,QAAT,CAAkB,KAAK,SAAvB,EAAkC,SAAlC,EAHM,CAIN;;AACA,UAAI,CAAC,QAAL,CAAc,GAAd,CAAkB,mBAAlB,EAAuC;AAAC,SAAC,EAAE;AAAJ,OAAvC,EALM,CAMN;;AACA,WAAK,gBAAL;AACA;AACD,GAhBO,CA3FT,CA6GC;;;AACQ,2DAAR,UAAmC,CAAnC,EAAgD;AAE/C;AACA,QAAI,KAAK,GAAa,CAAC,CAAC,MAAxB;AACA,QAAI,WAAW,GAAmB,KAAK,CAAC,YAAN,CAAmB,iBAAnB,CAAlC,CAJ+C,CAM/C;;AACA,QAAI,WAAW,KAAK,KAAK,MAAL,CAAY,UAA5B,IAA0C,KAAK,MAAL,CAAY,OAAZ,KAAwB,oBAAY,OAAlF,EAA2F;AAC1F,sBAAO,QAAP,CAAgB,sBAAU,gCAA1B,EAA4D,WAA5D;AACA;AACA;;AAED,YAAG,KAAH,CAAS,IAAT,EAAe,mBAAf,EAAoC,WAApC,EAZ+C,CAc/C;;AACA,QAAI,KAAK,GAAY,WAAW,KAAK,uBAAe,OAAhC,GAA2C,SAA3C,GAAuD,QAA3E;AACA,oBAAO,QAAP,CAAgB,sBAAU,cAA1B,EAA0C;AACzC,UAAI,EAAG,CAAC,CAAC,MAAF,CAAyB,YAAzB,CAAsC,MAAtC,CADkC;AAEzC,aAAO,EAAE,oBAAY,IAFoB;AAGzC,gBAAU,EAAE,WAH6B;AAIzC,cAAQ,EAAE,IAJ+B;AAKzC,WAAK,EAAE,KALkC;AAMzC,gBAAU,EAAE;AAN6B,KAA1C;AAWA,GA3BO,CA9GT,CA2IC;;;AACQ,qDAAR,UAA6B,CAA7B,EAA0C;AAEzC;AACA,QAAI,KAAK,MAAL,CAAY,OAAZ,KAAwB,oBAAY,IAAxC,EAA8C;AAC7C,UAAI,CAAC,QAAL,CAAc,EAAd,CAAiB,mBAAjB,EAAsC,GAAtC,EAA2C;AAAC,SAAC,EAAE;AAAJ,OAA3C;AACA;;AAED,QAAI,KAAK,GAAa,CAAC,CAAC,MAAxB;AACA,QAAI,WAAW,GAAoB,KAAK,CAAC,YAAN,CAAmB,kBAAnB,CAAnC;AAEA,YAAG,KAAH,CAAS,IAAT,EAAe,qBAAf,EAAsC,WAAtC,EAVyC,CAYzC;;AACA,oBAAO,QAAP,CAAgB,sBAAU,cAA1B,EAA0C;AACzC,UAAI,EAAE,KAAK,CAAC,YAAN,CAAmB,MAAnB,CADmC;AAEzC,aAAO,EAAE,oBAAY,IAFoB;AAGzC,gBAAU,EAAE,WAH6B;AAIzC,cAAQ,EAAE,IAJ+B;AAKzC,WAAK,EAAE,KAAK,eAAL,CAAqB,kBAArB,CAAwC,WAAxC;AALkC,KAA1C;AAQA,GArBO;AAuBR;;;AACQ,iDAAR;AACC,QAAI,CAAC,QAAL,CAAc,aAAd,CAA4B,gBAA5B,EAA8C,GAA9C,EAAmD;AAAC,OAAC,EAAE,CAAC,EAAL;AAAS,eAAS,EAAE;AAApB,KAAnD,EAA2E;AAAC,OAAC,EAAE,CAAJ;AAAO,eAAS,EAAE,CAAlB;AAAqB,WAAK,EAAE;AAA5B,KAA3E,EAA6G,IAA7G;AACA,QAAI,CAAC,QAAL,CAAc,MAAd,CAAqB,mBAArB,EAA0C,GAA1C,EAA+C;AAAC,OAAC,EAAE,CAAJ;AAAO,eAAS,EAAE;AAAlB,KAA/C,EAAqE;AAAC,OAAC,EAAE,CAAJ;AAAO,eAAS,EAAE,CAAlB;AAAqB,WAAK,EAAE;AAA5B,KAArE;AACA,GAHO;AAKR;;;AACQ,iDAAR;AACC,QAAI,CAAC,QAAL,CAAc,SAAd,CAAwB,gBAAxB,EAA0C,IAA1C,EAAgD;AAAC,OAAC,EAAE,CAAC,EAAL;AAAS,eAAS,EAAE;AAApB,KAAhD,EAAwE,IAAxE;AACA,QAAI,CAAC,QAAL,CAAc,EAAd,CAAiB,mBAAjB,EAAsC,IAAtC,EAA4C;AAAC,OAAC,EAAE,CAAJ;AAAO,eAAS,EAAE;AAAlB,KAA5C;AACA,GAHO;;AAKT;AAAC,CA/KD,CAAuC,uBAAvC;;AAAa,8C;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACVb;;AACA;;AAEA;AAAA;AAAA;AAAoC;;AAApC;AAAA;;AAIS,6BAAwB;AAAC,aAAO,EAAE,IAAV;AAAgB,YAAM,EAAE;AAAxB,KAAxB;AAEA,+BAA0B,IAA1B;;AAgGR;;AA9FO,kCAAP;AACC,SAAK,cAAL;AACA,GAFM;;AAIA,oCAAP;AACC;AACA,SAAK,MAAL,CAAY,QAAZ,CAAqB,MAArB,CAA4B,MAAM,CAAC,UAAnC,EAA+C,MAAM,CAAC,WAAtD;AACA,GAHM;;AAKA,mCAAP;AACC,SAAK,MAAL,CAAY,IAAZ;AACA,GAFM;;AAIA,qCAAP;AACC,SAAK,MAAL,CAAY,KAAZ;AACA,GAFM;;AAIA,qCAAP;AACC,WAAO,KAAK,MAAZ;AACA,GAFM;;AAIA,2CAAP;AACC,WAAO,KAAK,qBAAZ;AACA,GAFM;;AAIA,qCAAP,UAAe,UAAf,EAAyC;AACxC,WAAQ,UAAU,KAAK,uBAAe,OAA/B,GAA0C,KAAK,gBAAL,CAAsB,OAAhE,GAA0E,KAAK,gBAAL,CAAsB,MAAvG;AACA,GAFM;;AAIA,qCAAP;AACC,WAAO,KAAK,eAAZ;AACA,GAFM;;AAIA,kDAAP;AACC,WAAO,KAAK,kBAAZ;AACA,GAFM;;AAIA,kDAAP,UAA4B,IAA5B,EAAqC;AACpC,SAAK,kBAAL,GAA0B,IAA1B;AACA,GAFM,CA7CR,CAiDC;AACA;;;AACQ,4CAAR;AAEC;AACA,QAAI,UAAU,GAAG,KAAK,kBAAL,EAAjB;;AACA,SAAK,MAAL,GAAc,IAAI,IAAI,CAAC,WAAT,CAAqB;AAClC,WAAK,EAAE,MAAM,CAAC,UADoB;AAElC,YAAM,EAAE,MAAM,CAAC,WAFmB;AAGlC,gBAAU,EAAE,IAHsB;AAIlC,gBAAU,EAAG;AAJqB,KAArB,CAAd;AAOC,UAAc,CAAC,cAAf,GAAgC,UAAhC,CAXF,CAaC;;AACA,YAAQ,CAAC,IAAT,CAAc,WAAd,CAA0B,KAAK,MAAL,CAAY,IAAtC,EAdD,CAgBC;;AACA,SAAK,qBAAL,GAA6B,IAAI,IAAI,CAAC,SAAT,EAA7B;AACA,SAAK,qBAAL,CAA2B,WAA3B,GAAyC,KAAzC;AACA,SAAK,qBAAL,CAA2B,mBAA3B,GAAiD,KAAjD;AAEA,SAAK,eAAL,GAAuB,IAAI,IAAI,CAAC,SAAT,EAAvB;AACA,SAAK,eAAL,CAAqB,WAArB,GAAmC,KAAnC;AACA,SAAK,eAAL,CAAqB,mBAArB,GAA4C,KAA5C;AAEA,SAAK,gBAAL,CAAsB,OAAtB,GAAgC,IAAI,IAAI,CAAC,SAAT,EAAhC;AACA,SAAK,gBAAL,CAAsB,OAAtB,CAA8B,WAA9B,GAA4C,KAA5C;AACA,SAAK,gBAAL,CAAsB,OAAtB,CAA8B,mBAA9B,GAAoD,KAApD;AAEA,SAAK,gBAAL,CAAsB,MAAtB,GAA+B,IAAI,IAAI,CAAC,SAAT,EAA/B;AACA,SAAK,gBAAL,CAAsB,MAAtB,CAA6B,WAA7B,GAA2C,KAA3C;AACA,SAAK,gBAAL,CAAsB,MAAtB,CAA6B,mBAA7B,GAAmD,KAAnD;;AAEA,SAAK,MAAL,CAAY,KAAZ,CAAkB,QAAlB,CACC,KAAK,qBADN,EAEC,KAAK,eAFN,EAGC,KAAK,gBAAL,CAAsB,MAHvB,EAIC,KAAK,gBAAL,CAAsB,OAJvB;AAOA,GAxCO,CAnDT,CA6FC;AACA;;;AACQ,gDAAR;AACC,QAAI,UAAU,GAAG,MAAM,CAAC,gBAAP,IAA2B,CAA5C,CADD,CAEC;AACA;;AACA,WAAO,UAAP;AACA,GALO;;AAOT;AAAC,CAtGD,CAAoC,uBAApC;;AAAa,wC;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACHb;;AAEA;;AACA;;AACA;;AACA;;AAEA;;AACA;;AAEA;;AACA;;AAIA;;AAEA;;AACA;;AACA;;AACA;;AAQA;AAAA;AAAA;AAAuC;;AAAvC;AAAA;;AAEQ,2BAAyB,EAAzB,CAFR,CAEuC;;AAE9B,qCAAoC,KAApC;AACA,oCAAmC,KAAnC;AACA,kCAAiC,KAAjC;AACA,iCAAgC,KAAhC;AAEA,qBAAwB,oBAAY,IAApC;AAEA,wBAA8B,uBAAe,OAA7C,CAXT,CAWgE;;AAEvD,0BAAoC,EAApC;AACA,8BAA4B,CAA5B;AAMA,2BAAsB,EAAtB;AAKS,sBAAsC,CACtD;AAAC,aAAO,EAAE,MAAV;AAAkB,UAAI,EAAE,GAAxB;AAA6B,cAAQ,EAAE;AAAvC,KADsD,EAEtD;AACA;AAAC,aAAO,EAAE,SAAV;AAAqB,UAAI,EAAE,WAA3B;AAAwC,cAAQ,EAAE;AAAlD,KAHsD,EAItD;AAAC,aAAO,EAAE,QAAV;AAAoB,UAAI,EAAE,UAA1B;AAAsC,cAAQ,EAAE;AAAhD,KAJsD,EAKtD;AACA;AAAC,aAAO,EAAE,OAAV;AAAmB,UAAI,EAAE,SAAzB;AAAoC,cAAQ,EAAE;AAA9C,KANsD,EAOtD;AAAC,aAAO,EAAE,QAAV;AAAoB,UAAI,EAAE,UAA1B;AAAsC,cAAQ,EAAE;AAAhD,KAPsD,EAQtD;AAAC,aAAO,EAAE,MAAV;AAAkB,UAAI,EAAE,QAAxB;AAAkC,cAAQ,EAAE;AAA5C,KARsD,EAStD;AAAC,aAAO,EAAE,SAAV;AAAqB,UAAI,EAAE,WAA3B;AAAwC,cAAQ,EAAE;AAAlD,KATsD,CAAtC;;AA2hBjB;;AA/gBO,+CAAP,UAAsB,EAAtB,EAAsC;AACrC,SAAK,aAAL,GAAqB,EAArB;AACA,GAFM;AAIP;;;AACO,+CAAP,UAAsB,KAAtB,EAA8C;AAC7C,SAAK,QAAL,GAAgB,KAAK,CAAC,OAAtB;AACA,SAAK,WAAL,GAAmB,KAAK,CAAC,UAAzB;AACA,GAHM;AAKP;;;AACO,qCAAP;AACC,QAAI,CAAC,QAAL,CAAc,EAAd,CAAiB,KAAK,SAAtB,EAAiC,GAAjC,EAAsC;AAAC,eAAS,EAAE;AAAZ,KAAtC;;AACA,SAAK,cAAL,CAAoB,SAApB;AACA,GAHM;AAKP;;;AACO,qCAAP;AACC;AACA,QAAI,CAAC,QAAL,CAAc,EAAd,CAAiB,KAAK,SAAtB,EAAiC,GAAjC,EAAsC;AAAC,eAAS,EAAE,CAAZ;AAAe,WAAK,EAAE,GAAtB;AAA2B,UAAI,EAAE,IAAI,CAAC,MAAL,CAAY;AAA7C,KAAtC;;AACA,SAAK,aAAL,CAAmB,IAAnB;;AACA,QAAI,KAAK,cAAT,EAAyB;AACxB,WAAK,cAAL,CAAoB,UAApB;AACA;AACD,GAPM;;AASA,yCAAP;AAEC;AACA,QAAI,CAAC,KAAK,wBAAV,EAAoC;AACnC,WAAK,aAAL;;AACA,WAAK,mBAAL;;AACA,WAAK,wBAAL,GAAiC,IAAjC;AACA;AAED,GATM;;AAWA,+CAAP;AACC,QAAI,CAAC,KAAK,cAAV,EAA0B;AACzB,WAAK,cAAL,GAAuB,KAAK,MAAL,CAAY,GAAZ,CAAgB,iBAAhB,CAAvB;AACA;AACD,GAJM,CA1ER,CAgFC;;;AACO,wCAAP,UAAe,OAAf,EAAgC,OAAhC,EAAgD;AAC/C,WAAO,CAAC,SAAR,GAAoB,KAAK,cAAL,CAAoB,OAApB,CAApB;AACA,GAFM;AAIP;;;AACO,mDAAP,UAA0B,gBAA1B,EAAsD;AAAtD;;AAEC,SAAK,IAAL,GAFqD,CAIrD;;AACA,gBAAY,CAAC,KAAK,sBAAN,CAAZ;AACA,SAAK,sBAAL,GAA8B,WAAW,CAAC;AACzC,UAAM,gBAAwB,CAAC,gBAAzB,EAAN,EAAoD;AACnD,oBAAY,CAAC,KAAI,CAAC,sBAAN,CAAZ;AACA,wBAAO,QAAP,CAAgB,sBAAU,yBAA1B;;AACA,aAAI,CAAC,IAAL;AACA;AACD,KANwC,EAMtC,IANsC,CAAzC;AAQA,GAdM;AAgBP;;;AACO,0CAAP,UAAiB,KAAjB,EAAsC;AAErC,QAAI,KAAK,CAAC,IAAN,KAAe,KAAK,eAAxB,EAAyC;AACxC,aAAO,IAAP;AACA;;AAED,WAAO,KAAP;AAEA,GARM,CAvGR,CAiHC;AACA;AACA;;;AAEQ,8CAAR;AAEC;AACA,SAAK,eAAL,GAAuB,KAAK,QAAL,CAAc,QAAd,EAAvB;;AAEA,QAAI,KAAK,QAAL,KAAkB,oBAAY,IAAlC,EAAwC;AACvC,WAAK,eAAL,GAAuB,iBAAS,IAAhC;;AACA,WAAK,oBAAL;AACA,KAHD,MAGO,IAAI,KAAK,QAAL,KAAkB,oBAAY,IAAlC,EAAwC;AAC9C,WAAK,eAAL,GAAuB,iBAAS,IAAhC;;AACA,WAAK,oBAAL;AACA,KAHM,MAGA,IAAI,KAAK,QAAL,KAAkB,oBAAY,IAAlC,EAAwC;AAC9C,WAAK,eAAL,GAAwB,KAAK,WAAL,KAAqB,uBAAe,OAArC,GAAgD,iBAAS,OAAzD,GAAmE,iBAAS,MAAnG;;AACA,WAAK,oBAAL,CAA0B,KAAK,WAA/B;AACA,KAHM,MAGA,IAAI,KAAK,QAAL,KAAkB,oBAAY,OAAlC,EAA2C;AACjD,WAAK,eAAL,GAAuB,iBAAS,OAAhC;;AACA,WAAK,uBAAL,CAA6B,KAAK,WAAlC;AACA,KAjBF,CAmBC;;;AACA,SAAK,aAAL,CAAmB,CAAnB,EAAsB,EAAtB,GAA2B,KAAK,eAAhC,CApBD,CAsBC;;AACA,SAAK,aAAL,CAAmB,CAAnB,EAAsB,IAAtB;AAEA,GAzBO;AA2BR;;;AACQ,oDAAR;AAAA;;AACC,cAAU,CAAE;AACX,WAAI,CAAC,qBAAL,GAA6B,IAA7B;;AACA,WAAI,CAAC,oBAAL;AACA,KAHS,EAGP,IAHO,CAAV;AAIA,GALO;AAOR;;;AACQ,qDAAR;AAEC,QAAI,CAAC,KAAK,qBAAN,IAA+B,CAAC,KAAK,uBAAzC,EAAkE;AACjE;AACA,KAJF,CAMC;AACA;AACA;AACA;;;AACA,cAAU,CAAE;AAAM,6BAAO,QAAP,CAAgB,sBAAhB;AAAkD,KAA1D,EAA4D,GAA5D,CAAV;AAEA,GAZO;AAcR;;;AACQ,qDAAR;AAEC;AACA,SAAK,aAAL,CAAmB,IAAnB,CAAyB,KAAK,sBAAL,CAA4B,IAA5B,CAAzB,EAHD,CAKC;AACA;AACA;;;AACA,SAAK,aAAL,CAAmB,IAAnB,CAAyB,KAAK,sBAAL,CAA4B,CAAC,SAAD,EAAY,UAAZ,EAAwB,QAAxB,EAAkC,WAAlC,EAA+C,WAA/C,EAA4D,UAA5D,CAA5B,CAAzB,EARD,CAUC;AACA;;;AACA,SAAK,yBAAL;AAEA,GAdO;AAgBR;;;AACQ,uDAAR,UAA+B,mBAA/B,EAAmE;AAApC;AAAA;AAAoC;;AAElE,QAAI,WAAW,GAAY,MAAM,CAAC,UAAP,GAAoB,GAArB,GAA4B,MAA5B,GAAqC,MAA/D;AAEA,QAAI,UAAU,GAAG,IAAI,uBAAJ,EAAjB;AACA,cAAU,CAAC,SAAX,GAAuB,CACtB;AACA;AAAC,SAAG,EAAE,gBAAN;AAAwB,UAAI,EAAE,2CAA9B;AAA2E,mBAAa,EAAE;AAA1F,KAFsB,CAAvB,CALkE,CAUlE;;AACA,QAAI,mBAAJ,EAAyB;AACxB,gBAAU,CAAC,SAAX,CAAqB,IAArB,CAA0B;AACzB,WAAG,EAAE,kBADoB;AAEzB;AACA,YAAI,EAAE,6CAHmB;AAIzB,qBAAa,EAAE;AAJU,OAA1B;AAOA,gBAAU,CAAC,SAAX,CAAqB,IAArB,CAA0B;AAAC,WAAG,EAAE,MAAN;AAAc,YAAI,EAAE,iCAApB;AAAuD,qBAAa,EAAE;AAAtE,OAA1B;AAEA;;AAED,cAAU,CAAC,EAAX,GAAgB,WAAhB;AACA,cAAU,CAAC,gBAAX,GAA8B,KAAK,kBAAL,CAAwB,IAAxB,CAA6B,IAA7B,CAA9B,CAxBkE,CA0BlE;;AACA,QAAI,UAAU,GAAG,IAAI,uBAAJ,EAAjB;AACA,cAAU,CAAC,GAAX,GAAiB,iBAAjB;AACA,cAAU,CAAC,EAAX,GAAgB,WAAhB;AACA,cAAU,CAAC,UAAX,GAAwB,KAAK,kBAAL,CAAwB,IAAxB,CAA6B,IAA7B,CAAxB;AAEA,QAAI,WAAW,GAAG,IAAI,yBAAJ,EAAlB;AACA,eAAW,CAAC,GAAZ,CAAgB,UAAhB,EAA4B,UAA5B;AACA,eAAW,CAAC,UAAZ,GAAyB,KAAK,sBAAL,CAA4B,IAA5B,CAAiC,IAAjC,CAAzB;AACA,eAAW,CAAC,UAAZ,GAAyB,KAAK,sBAAL,CAA4B,IAA5B,CAAiC,IAAjC,CAAzB;AACA,eAAW,CAAC,IAAZ;AAEA,WAAO,WAAP;AAEA,GAxCO;AA0CR;;;;;;AAIQ,qDAAR,UAA6B,UAA7B,EAAuD;AAGtD;AACA,SAAK,yBAAL,CAA+B,UAA/B,EAA2C,IAA3C,EAJsD,CAMtD;;;AACA,QAAI,aAAa,GAAY,UAAU,KAAK,uBAAe,OAA/B,GAA0C,UAA1C,GAAwD,WAApF;;AACA,SAAK,aAAL,CAAmB,IAAnB,CAAyB,KAAK,sBAAL,CAA4B,CAAC,GAAD,EAAM,SAAN,EAAiB,UAAjB,EAA6B,QAA7B,EAAuC,WAAvC,EAAoD,aAApD,CAA5B,CAAzB,EARsD,CAUtD;;;AACA,SAAK,aAAL,CAAmB,IAAnB,CAAyB,KAAK,sBAAL,CAA4B,KAA5B,CAAzB,EAXsD,CAatD;;;AACA,QAAI,gBAAgB,GAAI,UAAU,KAAK,uBAAe,OAA/B,GAA0C,uBAAe,MAAzD,GAAkE,uBAAe,OAAxG;AACA,WAAO,CAAC,GAAR,CAAY,kBAAZ,EAAgC,gBAAhC;;AACA,SAAK,yBAAL,CAA+B,gBAA/B,EAAiD,KAAjD;AAEA,GAlBO;AAoBR;;;AACQ,0DAAR,UAAkC,UAAlC,EAAqE,mBAArE,EAAyG;AAAvE;AAAA;AAAiC;;AAAE;AAAA;AAAoC,MAExG;;;AACA,QAAI,CAAC,UAAD,IAAe,UAAU,KAAK,uBAAe,MAAjD,EAAyD;AACxD,WAAK,aAAL,CAAmB,IAAnB,CAAyB,KAAK,sBAAL,CAA4B,uBAAe,MAA3C,EAAmD,IAAnD,EAAyD,mBAAzD,CAAzB,EADwD,CAExD;;;AACA,yBAAmB,GAAG,KAAtB;AACA;;AACD,QAAI,CAAC,UAAD,IAAe,UAAU,KAAK,uBAAe,OAAjD,EAA0D;AACzD,WAAK,aAAL,CAAmB,IAAnB,CAAyB,KAAK,sBAAL,CAA4B,uBAAe,OAA3C,EAAoD,IAApD,EAA0D,mBAA1D,CAAzB;AACA,KAVuG,CAYxG;;;AACA,QAAI,CAAC,UAAD,IAAe,UAAU,KAAK,uBAAe,MAAjD,EAAyD;AACxD,WAAK,aAAL,CAAmB,IAAnB,CAAyB,KAAK,sBAAL,CAA6B,KAAK,kBAAL,CAAwB,uBAAe,MAAvC,CAA7B,CAAzB;AACA;;AACD,QAAI,CAAC,UAAD,IAAe,UAAU,KAAK,uBAAe,OAAjD,EAA0D;AACzD,WAAK,aAAL,CAAmB,IAAnB,CAAyB,KAAK,sBAAL,CAA6B,KAAK,kBAAL,CAAwB,uBAAe,OAAvC,CAA7B,CAAzB;AACA;AAED,GApBO;AAsBR;;;AACQ,qDAAR;AAAA,sBAEC;;;AACA,QAAI,UAAU,GAAkB,CAAC,GAAD,EAAM,WAAN,EAAmB,UAAnB,CAAhC;AACA,UAAM,CAAC,IAAP,CAAY,uBAAZ,EAA6B,OAA7B,CAAsC,UAAC,GAAD,EAAY;AACjD,UAAI,wBAAgB,GAAhB,EAAqB,QAArB,OAAoC,KAAI,CAAC,WAA7C,EAA0D;AACzD,kBAAU,CAAC,IAAX,CAAgB,MAAI,wBAAgB,GAAhB,EAAqB,QAArB,EAAJ,GAAmC,GAAnD;AACA;AACD,KAJD,EAJD,CAUC;AACA;;AACA,SAAK,aAAL,CAAmB,IAAnB,CAAyB,KAAK,sBAAL,CAA4B,UAA5B,EAAwC,KAAK,eAA7C,CAAzB,EAZD,CAcC;;;AACA,SAAK,aAAL,CAAmB,IAAnB,CAAyB,KAAK,sBAAL,CAA4B,IAA5B,CAAzB,EAfD,CAiBC;;;AACA,SAAK,yBAAL;AAEA,GApBO,CAnRT,CAySC;AACA;AAEA;;;AACQ,kDAAR,UAA0B,EAA1B,EAAsC,GAAtC,EAAmD,OAAnD,EAA0E;AAAvB;AAAA;AAAuB;;AACzE,QAAI,MAAM,GAAI,KAAK,MAAL,CAAY,gBAAb,GAAiC,QAAjC,GAA4C,SAAzD;AACA,QAAI,MAAM,GAAG,IAAI,uBAAJ,EAAb;AACA,UAAM,CAAC,EAAP,GAAY,EAAZ;AACA,UAAM,CAAC,GAAP,GAAa,GAAG,IAAG,wBAAsB,MAAzB,CAAhB;AACA,UAAM,CAAC,OAAP,GAAiB,OAAjB;AACA,UAAM,CAAC,UAAP,GAAqB,KAAK,qBAAL,CAA2B,IAA3B,CAAgC,IAAhC,CAArB;AACA,WAAO,MAAP;AACA,GARO;AAUR;;;AACQ,uDAAR,UAA+B,IAA/B,EAAqD,OAArD,EAA2E;AAA3E;;AAAqD;AAAA;AAAsB;;AAC1E,QAAI,eAAe,GAAgB,IAAI,yBAAJ,EAAnC;AACA,mBAAe,CAAC,EAAhB,GAAqB,OAArB;AACA,QAAI,CAAC,OAAL,CAAa,UAAC,OAAD,EAAQ;AACpB,UAAI,MAAM,GAAG,KAAI,CAAC,iBAAL,CAAuB,OAAvB,EAAgC,OAAhC,CAAb;;AACA,qBAAe,CAAC,GAAhB,CAAoB,MAApB;AACA,KAHD;AAIA,mBAAe,CAAC,UAAhB,GAA8B,KAAK,sBAAL,CAA4B,IAA5B,CAAiC,IAAjC,CAA9B;AACA,WAAO,eAAP;AAEA,GAVO;AAYR;;;AACQ,mDAAR,UAA2B,IAA3B,EAA+C;AAE9C,QAAI,IAAI,KAAK,uBAAe,OAA5B,EAAqC;AACpC,aAAO,CAAC,4BAAD,EAA+B,0BAA/B,EAA2D,oBAA3D,EAAiF,qBAAjF,EAAwG,0BAAxG,CAAP;AACA,KAFD,MAEO,IAAI,IAAI,KAAK,uBAAe,MAA5B,EAAoC;AAC1C,aAAO,CAAC,2BAAD,EAA8B,0CAA9B,CAAP;AACA;;AAED,WAAO,EAAP;AAEA,GAVO,CArUT,CAiVC;AACA;;;AACQ,uDAAR,UAA+B,IAA/B,EAAqD,OAArD,EAA6E,mBAA7E,EAAiH;AAA5D;AAAA;AAAsB;;AAAE;AAAA;AAAoC;;AAEhH,QAAI,SAAJ;AACA,QAAI,EAAJ;AACA,QAAI,QAAQ,GAAW,WAAS,IAAT,GAAa,OAApC;AACA,QAAI,MAAM,GAAW,UAAQ,IAA7B;AAEA,QAAI,WAAW,GAAY,MAAM,CAAC,UAAP,GAAoB,GAArB,GAA4B,MAA5B,GAAqC,MAA/D;;AAEA,QAAI,IAAI,KAAK,uBAAe,OAA5B,EAAqC;AACpC,eAAS,GAAG,CAAC;AACZ,WAAG,EAAE,yBADO;AAEZ,YAAI,EAAE,mDAAiD,WAAjD,GAA4D,OAFtD;AAGZ,qBAAa,EAAE;AAHH,OAAD,CAAZ;AAKA,QAAE,GAAG,cAAL;AAEA,KARD,MAQO;AACN,eAAS,GAAG,CAAC;AACZ,WAAG,EAAE,wBADO;AAEZ,YAAI,EAAE,kDAAgD,WAAhD,GAA2D,OAFrD;AAGZ,qBAAa,EAAE;AAHH,OAAD,CAAZ;AAKA,QAAE,GAAG,uBAAL;AACA,KAxB+G,CA0BhH;AACA;;;AACA,QAAI,mBAAJ,EAAyB;AACxB,eAAS,CAAC,IAAV,CAAe;AACd,WAAG,EAAE,kBADS;AAEd,YAAI,EAAE,2CAAyC,WAAzC,GAAoD,OAF5C;AAGd,qBAAa,EAAE;AAHD,OAAf;AAKA,KAlC+G,CAoChH;;;AACA,QAAI,CAAC,KAAK,oBAAV,EAAgC;AAC/B,eAAS,CAAC,IAAV,CAAe;AACd,WAAG,EAAE,gBADS;AAEd,YAAI,EAAE,yCAAuC,WAAvC,GAAkD,OAF1C;AAGd,qBAAa,EAAE;AAHD,OAAf;AAKA,WAAK,oBAAL,GAA4B,IAA5B;AACA;;AAED,QAAI,UAAU,GAAG,IAAI,uBAAJ,EAAjB;AACA,cAAU,CAAC,SAAX,GAAuB,SAAvB;AACA,cAAU,CAAC,EAAX,GAAgB,EAAhB;AACA,cAAU,CAAC,gBAAX,GAA8B,KAAK,kBAAL,CAAwB,IAAxB,CAA6B,IAA7B,CAA9B;AAEA,QAAI,UAAU,GAAG,IAAI,uBAAJ,EAAjB;AACA,cAAU,CAAC,GAAX,GAAiB,QAAjB;AACA,cAAU,CAAC,EAAX,GAAgB,MAAhB;AACA,cAAU,CAAC,UAAX,GAAwB,KAAK,kBAAL,CAAwB,IAAxB,CAA6B,IAA7B,CAAxB;AAEA,QAAI,WAAW,GAAG,IAAI,yBAAJ,EAAlB;AACA,eAAW,CAAC,EAAZ,GAAkB,OAAlB;AACA,eAAW,CAAC,GAAZ,CAAgB,UAAhB,EAA4B,UAA5B;AACA,eAAW,CAAC,UAAZ,GAAyB,KAAK,sBAAL,CAA4B,IAA5B,CAAiC,IAAjC,CAAzB;AACA,eAAW,CAAC,UAAZ,GAAyB,KAAK,sBAAL,CAA4B,IAA5B,CAAiC,IAAjC,CAAzB;AACA,WAAO,WAAP;AAEA,GA/DO;;AAiEA,wDAAR,UAAgC,UAAhC,EAA0D;AAEzD;AACA,QAAI,WAAW,GAAG,IAAI,yBAAJ,EAAlB;AACA,eAAW,CAAC,OAAZ,GAAsB,QAAQ,CAAC,gBAAT,CAA0B,cAA1B,CAAtB;AAEA,QAAI,WAAW,GAAG,IAAI,yBAAJ,EAAlB;AACA,eAAW,CAAC,EAAZ,GAAkB,SAAlB;AACA,eAAW,CAAC,GAAZ,CAAgB,WAAhB;AACA,eAAW,CAAC,UAAZ,GAAyB,KAAK,sBAAL,CAA4B,IAA5B,CAAiC,IAAjC,CAAzB;AACA,eAAW,CAAC,UAAZ,GAAyB,KAAK,sBAAL,CAA4B,IAA5B,CAAiC,IAAjC,CAAzB;;AACA,SAAK,aAAL,CAAmB,IAAnB,CAAyB,WAAzB;AAEA,GAbO,CApZT,CAmaC;;;AACQ,0DAAR;AACC,QAAI,WAAW,GAAgB,IAAI,yBAAJ,EAA/B;AACA,WAAO,WAAP;AACA,GAHO,CApaT,CAyaC;;;AACQ,uDAAR,UAA+B,IAA/B,EAAqC,MAArC,EAA2C;AAC1C,QAAI,KAAK,cAAT,EAAyB;AACxB,WAAK,cAAL,CAAoB,QAApB,CAA6B,IAAI,CAAC,KAAlC;AACA;AACD,GAJO,CA1aT,CAgbC;;;AACQ,uDAAR,UAA+B,EAA/B,EAAyC;AAExC,WAAO,CAAC,GAAR,CAAY,wBAAZ,EAAsC,KAAK,aAAL,CAAmB,KAAK,iBAAxB,CAAtC,EAFwC,CAIxC;;AACA,QAAI,KAAK,eAAL,IAAwB,KAAK,eAAL,KAAyB,EAArD,EAAyD;AACxD,WAAK,kBAAL;AACA,KAPuC,CASxC;;;AACA,SAAK,cAAL;AAEA,GAZO;AAcR;;;AACQ,mDAAR;AAEC;AACA,QAAK,KAAK,eAAL,KAAyB,oBAAY,OAA1C,EAAmD;AAClD,sBAAO,QAAP,CAAgB,IAAI,+BAAJ,CAAmB;AAAC,YAAI,EAAE,iBAAS;AAAhB,OAAnB,CAAhB,EAA8D;AAAC,aAAK,EAAE;AAAR,OAA9D;AACA;;AAED,SAAK,eAAL,GAAuB,IAAvB,CAPD,CAQC;;AACA,SAAK,uBAAL,GAA+B,IAA/B;;AACA,SAAK,oBAAL;AAEA,GAZO;AAcR;;;AACQ,+CAAR;AAAA;;AAEC,cAAU,CAAE;AACX,WAAI,CAAC,iBAAL,IAA0B,CAA1B;;AACA,UAAK,KAAI,CAAC,iBAAL,GAAyB,KAAI,CAAC,aAAL,CAAmB,MAAjD,EAA0D;AACzD,aAAI,CAAC,aAAL,CAAmB,KAAI,CAAC,iBAAxB,EAA2C,IAA3C;AACA;AACD,KALS,EAKN,KAAK,cALC,CAAV;AAOA,GATO,CA/cT,CA0dC;;;AACQ,mDAAR,UAA2B,QAA3B,EAA6C,SAA7C,EAA2D;AAE1D;AACA,QAAI,SAAS,CAAC,kBAAD,CAAb,EAAmC;AAClC,sBAAO,QAAP,CAAgB,IAAI,6CAAJ,CAA0B;AACzC,YAAI,EAAE,yBAAiB,WADkB;AAEzC,gBAAQ,EAAE,SAAS,CAAC,kBAAD;AAFsB,OAA1B,CAAhB;AAIA,KARyD,CAU1D;;;AACA,QAAI,SAAS,CAAC,gBAAD,CAAb,EAAiC;AAChC,sBAAO,QAAP,CAAiB,IAAI,6CAAJ,CAA0B;AAC1C,YAAI,EAAE,yBAAiB,cADmB;AAE1C,gBAAQ,EAAE,SAAS,CAAC,gBAAD;AAFuB,OAA1B,CAAjB;AAIA,KAhByD,CAkB1D;;AACA;;;;;;AAOA;;;AACA,QAAI,SAAS,CAAC,gBAAD,CAAb,EAAiC;AAChC,sBAAO,QAAP,CAAgB,IAAI,6CAAJ,CAA0B;AACzC,YAAI,EAAE,yBAAiB,cADkB;AAEzC,gBAAQ,EAAE,SAAS,CAAC,gBAAD;AAFsB,OAA1B,CAAhB;AAIA,KAhCyD,CAkC1D;;;AACA,QAAI,SAAS,CAAC,yBAAD,CAAb,EAA0C;AACzC,sBAAO,QAAP,CAAgB,IAAI,6CAAJ,CAA0B;AACzC,YAAI,EAAE,yBAAiB,uBADkB;AAEzC,gBAAQ,EAAE,SAAS,CAAC,yBAAD;AAFsB,OAA1B,CAAhB;AAIA,KAxCyD,CA0C1D;;;AACA,QAAI,SAAS,CAAC,wBAAD,CAAb,EAAyC;AACxC,sBAAO,QAAP,CAAgB,IAAI,6CAAJ,CAA0B;AACzC,YAAI,EAAE,yBAAiB,uBADkB;AAEzC,gBAAQ,EAAE,SAAS,CAAC,wBAAD;AAFsB,OAA1B,CAAhB;AAIA,KAhDyD,CAkD1D;;;AACA,QAAI,SAAS,CAAC,MAAD,CAAb,EAAuB;AACtB,sBAAO,QAAP,CAAiB,IAAI,6CAAJ,CAA0B;AAC1C,YAAI,EAAE,yBAAiB,IADmB;AAE1C,gBAAQ,EAAE,SAAS,CAAC,MAAD;AAFuB,OAA1B,CAAjB;AAIA;AAED,GA1DO,CA3dT,CAuhBC;;;AACQ,sDAAR,UAA8B,EAA9B,EAA0C,MAA1C,EAA4D;AAE3D;AACA,oBAAO,QAAP,CAAiB,IAAI,yCAAJ,CAAyB;AAAC,YAAM,EAAE;AAAT,KAAzB,CAAjB;;AAEA,QAAI,CAAC,MAAM,CAAC,OAAZ,EAAqB;AACpB,WAAK,cAAL,CAAoB,MAAM,CAAC,EAA3B,IAAiC,MAAM,CAAC,IAAxC;AACA,KAFD,MAEO;AACN,sBAAO,QAAP,CAAiB,wBAAW,WAA5B;AACA,KAT0D,CAW3D;;;AACA,UAAM,CAAC,OAAP;AAEA,GAdO;AAgBR;;;;;;;AAKQ,mDAAR,UAA2B,QAA3B,EAA6C,IAA7C,EAAwD,MAAxD,EAA0E;AACzE,oBAAO,QAAP,CAAgB,IAAI,6BAAJ,CAAkB;AACjC,QAAE,EAAE,QAD6B;AAEjC,UAAI,EAAE;AAF2B,KAAlB,CAAhB;AAIA,GALO;;AAOT;AAAC,CApjBD,CAAuC,uBAAvC;;AAAa,8C;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AC5Bb;;AACA;;AACA;;AACA;;AACA;;AASA;;AACA;;AACA;;AACA;;AAOA;AAAA;AAAA;AAAuC;;AAAvC;AAAA;;AAES,oBAAmB,KAAnB;AACA,qBAAoB,KAApB;AACA,6BAA4B,KAA5B;AACA,4BAA2B,KAA3B;AACA,gCAA+B,IAA/B;AACA,yBAAwB,KAAxB;AACA,+BAA+B,KAA/B;AA2BA,kBAA4B,EAA5B;AAEA,sBAAiB,EAAjB;AACA,oBAAe,EAAf;AACA,uBAAkB,EAAlB;;AA+oBR;;AAvoBO,qCAAP,UAAY,MAAZ,EAAuB;AAEtB,WAAO,CAAC,GAAR,CAAY,QAAZ,EAAsB,MAAtB,EAFsB,CAItB;;AACA,SAAK,OAAL,GAAe,IAAf;AACA,SAAK,WAAL,GAAmB,MAAM,CAAC,OAA1B;AACA,QAAI,WAAW,GAAW,sBAA1B;AAEA,QAAI,YAAY,GAAsB;AACrC,aAAO,EAAE,oBAAY,OADgB;AAErC,gBAAU,EAAE,KAAK,iBAFoB;AAGrC,iBAAW,EAAE,KAAK,WAHmB;AAIrC,WAAK,EAAG,KAAK,iBAAL,KAA2B,uBAAe,MAA3C,GAAwD,WAAW,cAAnE,GAAoF,WAAW,eAJjE;AAKrC,UAAI,EAAE,MAAI,KAAK,iBAAT,GAA0B,GAA1B,GAA8B,KAAK,WAAnC,GAA8C;AALf,KAAtC;AAOA,oBAAO,QAAP,CAAgB,sBAAU,gBAA1B,EAA4C,YAA5C,EAhBsB,CAkBtB;;AACA,SAAK,gBAAL,GAAwB,IAAxB;AAEA,GArBM;AAuBP;;;AACO,wCAAP,UAAe,MAAf,EAA0B;AACzB,SAAK,iBAAL,GAAyB,uBAAe,OAAxC;AACA,SAAK,IAAL,CAAU,MAAV;AACA,GAHM;AAKP;;;AACO,uCAAP,UAAc,MAAd,EAAyB;AACxB,SAAK,iBAAL,GAAyB,uBAAe,MAAxC;AACA,SAAK,IAAL,CAAU,MAAV;AACA,GAHM,CA7ER,CAkFC;AACA;;;AACO,8CAAP,UAAqB,KAArB,EAA6C;AAE5C;AAEA,WAAO,IAAP;AACA,GALM,CApFR,CA2FC;AACA;;;AACO,+CAAP,UAAsB,KAAtB,EAA8C,SAA9C,EAA8E,IAA9E,EAAoG,OAApG,EAA6H,MAA7H,EAAmJ;AAClJ,SAAK,gBAAL,GAAwB,KAAxB;AACA,SAAK,oBAAL,GAA4B,SAA5B;AACA,SAAK,eAAL,GAAuB,IAAvB;AACA,SAAK,kBAAL,GAA0B,OAA1B;AACA,SAAK,iBAAL,GAAyB,MAAzB;AACA,GANM,CA7FR,CAqGC;;;AACO,wCAAP,UAAe,GAAf,EAA4B,IAA5B,EAAwC;AAEvC,SAAK,KAAL,CAAW,IAAX,CAAgB;AAAC,SAAG,EAAE,GAAN;AAAW,UAAI,EAAE;AAAjB,KAAhB,EAFuC,CAIvC;;;AACA,QAAI,KAAK,kBAAL,IAA2B,KAAK,cAAL,KAAwB,GAAvD,EAA4D;AAC3D,WAAK,eAAL,CAAqB,GAArB;;AACA,WAAK,kBAAL,GAA0B,KAA1B,CAF2D,CAG3D;AACA;AAED,GAXM,CAtGR,CAmHC;AACC;;;AACM,yCAAP;AACC,SAAK,aAAL;;AACA,QAAI,KAAK,OAAT,EAAkB;AACjB,WAAK,QAAL;;AACA,WAAK,iBAAL;AACA;AACD,GANM;;AAQA,uCAAP;AACC,SAAK,YAAL,GAAoB,MAAM,CAAC,WAA3B;;AACA,SAAK,kBAAL;AACA,GAHM;;AAKA,uCAAP;AAAA;;AAEC,SAAK,kBAAL,GAA0B,KAA1B;AACA,SAAK,OAAL,GAAe,KAAf;;AACA,SAAK,oBAAL,CAA0B,KAA1B;;AACA,SAAK,oBAAL,CAA0B,SAA1B,CAAoC,KAApC;;AACA,SAAK,SAAL,CAAe,MAAf,GAAwB,UAAU,CAAE;AAAM,kBAAI,CAAJ;AAA0B,KAAlC,EAAoC,GAApC,CAAlC;;AACA,SAAK,qBAAL,CAA2B,qBAA3B;AAEA,GATM;;AAWA,uCAAP,UAAc,CAAd,EAAuB;AACtB,QAAI,KAAK,GAAG,CAAC,IAAI,MAAM,CAAC,WAAP,GAAqB,IAAzB,CAAb;AACA,GAFM;;AAIA,qCAAP;AACC,SAAK,sBAAL;AACA,GAFM;AAIP;;;AACO,sCAAP,UAAa,QAAb,EAAiD,UAAjD,EAA4E;AAA/D;AAAA;AAAkC;;AAAE;AAAA;AAA2B;;AAE3E,SAAK,kBAAL,GAA2B,KAA3B;AACA,SAAK,SAAL,GAAiB,QAAjB;AACA,SAAK,WAAL,GAAmB,UAAnB;;AAEA,QAAI,KAAK,qBAAL,EAAJ,EAAmC;AAClC,WAAK,MAAL;AACA;AAED,GAVM;AAYP;;;AACO,sCAAP;AACC,QAAI,CAAC,QAAL,CAAc,EAAd,CAAiB,CAAC,KAAK,SAAN,CAAjB,EAAmC,IAAnC,EAAyC;AAAC,WAAK,EAAE,GAAR;AAAa,UAAI,EAAE,IAAI,CAAC,MAAL,CAAY;AAA/B,KAAzC;AACA,GAFM;AAIP;;;AACO,wCAAP;AACC,QAAI,CAAC,QAAL,CAAc,EAAd,CAAiB,CAAC,KAAK,SAAN,CAAjB,EAAmC,IAAnC,EAAyC;AAAC,WAAK,EAAE,CAAR;AAAW,UAAI,EAAE,IAAI,CAAC,MAAL,CAAY;AAA7B,KAAzC;AACA,GAFM;AAIP;;;AACO,qCAAP,UAAY,QAAZ,EAAgD,UAAhD,EAA2E;AAA/D;AAAA;AAAkC;;AAAE;AAAA;AAA2B;;AAE1E,SAAK,YAAL,GAAoB,MAAM,CAAC,WAA3B;;AAEA,QAAI,KAAK,qBAAL,EAAJ,EAAmC;AAClC,WAAK,KAAL;;AACA;AACA,KAPyE,CAS1E;;;AACA,SAAK,QAAL,GAAgB,KAAhB,CAV0E,CAY1E;;AACA,QAAI,CAAC,KAAK,OAAV,EAAmB;AAClB,WAAK,eAAL,CAAqB,KAAK,MAAL,CAAY,IAAjC;AACA,KAFD,MAEO;AACN,WAAK,MAAL;;AACA,WAAK,MAAL;;AACA,WAAK,KAAL;AACA;;AAED,SAAK,OAAL,GAAe,IAAf;AAEA,GAvBM;AAyBP;;;AACO,qCAAP,UAAY,QAAZ,EAA8C;AAA9C;;AAAY;AAAA;AAAkC;;AAE7C,SAAK,SAAL,CAAe,aAAf,GAA+B,UAAU,CAAE;AAC1C,WAAI,CAAC,oBAAL,CAA0B,KAA1B;;AACA,WAAI,CAAC,oBAAL,CAA0B,SAA1B,CAAoC,KAApC;AACA,KAHwC,EAGtC,GAHsC,CAAzC;AAKA,SAAK,SAAL,CAAe,QAAf,GAA0B,UAAU,CAAE;AACrC,WAAI,CAAC,GAAL,CAAS,WAAT,CAAqB,KAAI,CAAC,SAA1B,EAAqC,SAArC;;AACA,WAAI,CAAC,eAAL,GAAuB,KAAvB;AACA,KAHmC,EAGjC,IAHiC,CAApC;;AAKA,SAAK,gBAAL;;AAEA,SAAK,OAAL,GAAe,KAAf;AAEA,GAhBM;AAkBP;;;AACO,yCAAP,UAAgB,KAAhB,EAAwC;AACvC,SAAK,MAAL,GAAc,KAAd;AACA,SAAK,iBAAL,GAAyB,KAAK,CAAC,UAA/B;AACA,SAAK,WAAL,GAAmB,KAAK,CAAC,WAAzB;AACA,SAAK,qBAAL,GAA8B,KAAK,iBAAL,KAA2B,uBAAe,OAA3C,GAAsD,KAAK,kBAA3D,GAAgF,KAAK,iBAAlH;AACA,GALM,CA1NR,CAiOC;AACA;AACA;AACA;AACA;;;AAEQ,sDAAR;AACC,WAAQ,KAAK,MAAL,CAAY,IAAZ,KAAqB,KAAK,cAA1B,IAA4C,KAAK,QAAzD;AACA,GAFO;AAIR;;;AACQ,uCAAR;AACC,SAAK,QAAL,GAAgB,IAAhB;AACA,GAFO;;AAIA,yCAAR;AACC;AACA,SAAK,OAAL,GAAe,KAAK,SAAL,CAAe,aAAf,CAA6B,iBAA7B,CAAf;AACA,SAAK,MAAL,GAAc,KAAK,SAAL,CAAe,aAAf,CAA6B,gBAA7B,CAAd,CAHD,CAIC;;AACA,SAAK,aAAL,GAAqB,KAAK,SAAL,CAAe,aAAf,CAA6B,iBAA7B,CAArB,CALD,CAMC;;AACA,SAAK,SAAL,GAAiB,KAAK,SAAL,CAAe,aAAf,CAA6B,mBAA7B,CAAjB;AACA,SAAK,cAAL,GAAsB,KAAK,SAAL,CAAe,aAAf,CAA6B,wBAA7B,CAAtB;AACA,SAAK,gBAAL,GAAwB,KAAK,SAAL,CAAe,aAAf,CAA6B,4BAA7B,CAAxB,CATD,CAUC;;AACA,SAAK,SAAL,GAAiB,KAAK,SAAL,CAAe,aAAf,CAA6B,mBAA7B,CAAjB;AAEA,SAAK,aAAL,GAAqB,KAAK,SAAL,CAAe,aAAf,CAA6B,wBAA7B,CAArB;AACA,SAAK,gBAAL,GAAwB,KAAK,SAAL,CAAe,aAAf,CAA6B,2BAA7B,CAAxB;AACA,SAAK,cAAL,GAAsB,KAAK,SAAL,CAAe,aAAf,CAA6B,yBAA7B,CAAtB;AACA,SAAK,cAAL,GAAsB,KAAK,SAAL,CAAe,aAAf,CAA6B,kBAA7B,CAAtB;AAGA,GAnBO;;AAqBA,kDAAR;AAAA;;AAEC,SAAK,WAAL,GAAmB,IAAI,uBAAJ,CAAe,KAAK,SAAL,CAAe,aAAf,CAA6B,sBAA7B,CAAf,EAAqE,KAAK,GAA1E,CAAnB;AAEA,oBAAO,EAAP,CAAU,2CAAV,EAAgC,UAAC,KAAD,EAA4B;AAC3D,WAAI,CAAC,oBAAL,CAA0B,gBAA1B,CAA2C,KAAK,CAAC,cAAjD;AACA,KAFD;AAIA,oBAAO,EAAP,CAAU,uCAAV,EAA8B,UAAC,KAAD,EAA0B;AACvD,WAAI,CAAC,WAAL,CAAiB,WAAjB,CAA6B,KAAK,CAAC,KAAnC,EAA0C,KAAK,CAAC,KAAhD;AACA,KAFD;AAIA,GAZO;;AAcA,oDAAR;AACC,QAAI,KAAK,GAAG,EAAZ;AACA,SAAK,SAAL,CAAe,gBAAf,CAAgC,gBAAhC,EAAkD,OAAlD,CAA0D,UAAC,OAAD,EAAqB;AAC9E,WAAK,CAAC,IAAN,CAAW;AACV,sBAAc,EAAE,MAAI,OAAO,CAAC,YAAR,CAAqB,IAArB,CADV;AAEV,aAAK,EAAE,OAAO,CAAC,YAAR,CAAqB,oBAArB;AAFG,OAAX;AAIA,KALD;;AAMA,SAAK,WAAL,CAAiB,MAAjB,CAAwB,KAAxB;AACA,GATO;;AAWA,8CAAR;AAAA;;AAGC,oBAAO,EAAP,CAAU,OAAV,EAAmB,yBAAnB,EAA8C,KAAK,aAAL,CAAmB,IAAnB,CAAwB,IAAxB,CAA9C;AACA,oBAAO,EAAP,CAAU,iCAAV,EAA2B,KAAK,aAAL,CAAmB,IAAnB,CAAwB,IAAxB,CAA3B,EAJD,CAMC;;AACA,UAAM,CAAC,gBAAP,CAAwB,mBAAxB,EAA6C;AAC1C,WAAI,CAAC,YAAL,GAAoB,KAApB;;AACA,WAAI,CAAC,MAAL;AACF,KAHD;AAKA,GAZO;;AAcA,mDAAR;AACC,SAAK,oBAAL,CAA0B,QAA1B,CAAmC,KAAK,SAAxC,EAAmD,GAAnD;;AACA,SAAK,oBAAL,CAA0B,SAA1B,CAAoC,IAApC;AACA,GAHO;AAKR;;;AACQ,gDAAR,UAAwB,GAAxB,EAAmC;AAAnC;;AAEC,SAAK,cAAL,GAAsB,GAAtB;;AACA,QAAI,IAAI,GAAG,KAAK,kBAAL,CAAwB,KAAK,cAA7B,CAAX,CAHkC,CAKlC;;;AACA,QAAI,CAAC,IAAL,EAAW;AACV,WAAK,kBAAL,GAA0B,IAA1B,CADU,CAEV;;AACA,WAAK,GAAL,CAAS,QAAT,CAAkB,KAAK,SAAvB,EAAkC,SAAlC;AACA;AACA;;AAED,SAAK,GAAL,CAAS,OAAT,CAAiB,KAAK,gBAAtB,EAAwC,IAAxC,EAA8C;AAE7C,WAAI,CAAC,MAAL,CAAY,YAAZ,CAAyB,SAAzB;;AACA,WAAI,CAAC,MAAL;;AACA,WAAI,CAAC,MAAL;;AACA,WAAI,CAAC,KAAL;;AAEA,aAAO,CAAC,GAAR,CAAY,qBAAZ;AACC,YAAc,CAAC,QAAf,CAAwB,OAAxB;AAED,KAVD;AAYA,GAzBO;AA2BR;;;AACQ,mDAAR,UAA2B,GAA3B,EAAsC;AAErC,QAAI,IAAI,GAAW,IAAnB;;AACA,SAAK,KAAL,CAAW,OAAX,CAAoB,UAAC,MAAD,EAAmB;AACtC,UAAI,MAAM,CAAC,GAAP,KAAe,GAAnB,EAAwB;AACvB,YAAI,GAAG,MAAM,CAAC,IAAd;AACA;AACD,KAJD;;AAMA,WAAO,IAAP;AAEA,GAXO;AAaR;;;AACQ,8CAAR,UAAsB,KAAtB,EAA4C;AAA5C,qBAA4C,CAE3C;;;AACA,QAAI,KAAK,CAAC,IAAN,KAAe,IAAnB,EAAyB;AACxB;AACA,KAL0C,CAO3C;;;AACA,QAAI,CAAC,KAAK,gBAAV,EAA4B;AAC3B,WAAK,GAAL,CAAS,MAAT,CAAgB,QAAQ,CAAC,aAAT,CAAuB,MAAvB,CAAhB,EAAgD,KAAK,mBAAL,EAAhD,EAA4E;AAC3E,aAAI,CAAC,SAAL,GAAiB,QAAQ,CAAC,aAAT,CAAuB,UAAvB,CAAjB;;AACA,aAAI,CAAC,QAAL;;AACA,aAAI,CAAC,iBAAL;;AACA,aAAI,CAAC,gBAAL,GAAwB,IAAxB;;AACA,aAAI,CAAC,aAAL,CAAmB,KAAnB;AACA,OAND;AAOA;AACA,KAjB0C,CAmB3C;AACA;;;AACA,QAAI,MAAM,GAAG,KAAK,aAAL,CAAmB,aAAnB,CAAiC,QAAjC,CAAb;;AACA,UAAM,CAAC,YAAP,CAAoB,KAApB,EAA2B,YAAU,KAAK,CAAC,IAAhB,GAAoB,MAA/C,EAtB2C,CAuB3C;AAEA;AAEA,GA3BO;AA6BR;;;AACQ,oDAAR;AAEC,WAAO,62FAAP;AAgDA,GAlDO,CA1XT,CA8aC;AACA;;;AAEQ,uCAAR;AAEC;AACA,SAAK,eAAL,GAAuB,KAAvB;;AACA,SAAK,gBAAL,CAAsB,mBAAtB,CAA0C,KAA1C,EAJD,CAMC;;;AACA,SAAK,mBAAL;;AACA,SAAK,cAAL,GAAsB,KAAK,SAAL,CAAe,aAAf,CAA6B,wBAA7B,CAAtB,CARD,CAUC;;AACA,QAAI,CAAC,QAAL,CAAc,GAAd,CAAkB,CAAC,KAAK,SAAN,CAAlB,EAAoC;AAAC,WAAK,EAAE;AAAR,KAApC;AACA,SAAK,SAAL,CAAe,KAAf,CAAqB,SAArB,GAAiC,oBAAjC,CAZD,CAcC;;AACA,SAAK,YAAL,GAAoB,KAApB;AACA,SAAK,MAAL,GAhBD,CAkBC;;AACA,QAAI,KAAK,WAAT,EAAsB;AACrB,WAAK,iBAAL;;AACA;AACA;;AAED,QAAI,KAAK,SAAL,CAAe,OAAf,KAA2B,oBAAY,IAA3C,EAAiD;AAChD,WAAK,cAAL,CAAoB,KAAK,SAAL,CAAe,UAAnC;AACA;AAED,GA5BO;AA8BR;;;AACQ,kDAAR,aAEC,CAFO;AAIR;;;AACQ,+CAAR,UAAuB,UAAvB,EAAiD;AAChD,SAAK,YAAL,GAAoB,KAApB;AACA,GAFO;AAIR;;;AACQ,oDAAR;AACC,SAAK,GAAL,CAAS,WAAT,CAAqB,KAAK,SAA1B,EAAqC,SAArC;AACA,SAAK,GAAL,CAAS,WAAT,CAAqB,KAAK,MAA1B,EAAkC,SAAlC;AACA,SAAK,GAAL,CAAS,WAAT,CAAqB,KAAK,MAA1B,EAAkC,OAAlC,EAHD,CAIC;;AACA,QAAI,CAAC,QAAL,CAAc,GAAd,CAAkB,CAAC,KAAK,SAAN,CAAlB,EAAoC;AAAC,WAAK,EAAE;AAAR,KAApC;AACA,SAAK,eAAL,GAAuB,KAAvB;;AACA,QAAI,KAAK,aAAT,EAAwB;AACvB,WAAK,aAAL,CAAmB,KAAnB;AACA;AACD,GAVO,CA1dT,CAseC;AACA;;;AAEQ,sCAAR;AAAA,sBAEC;;;AACA,SAAK,GAAL,CAAS,QAAT,CAAkB,KAAK,SAAvB,EAAkC,SAAlC;AACA,SAAK,SAAL,CAAe,aAAf,GAA+B,UAAU,CAAE;AAAM,kBAAI,CAAJ;AAAyB,KAAjC,EAAmC,IAAnC,CAAzC;;AAEA,QAAI,KAAK,WAAT,EAAsB;AACrB,WAAK,gBAAL;;AACA;AACA;;AAED,QAAI,KAAK,SAAL,CAAe,OAAf,KAA2B,oBAAY,IAA3C,EAAiD;AAChD,WAAK,aAAL,CAAmB,KAAK,SAAL,CAAe,UAAlC;AACA;AAED,GAfO;AAiBR;;;AACQ,iDAAR;AAEC;AACA,SAAK,GAAL,CAAS,QAAT,CAAkB,KAAK,MAAvB,EAA+B,SAA/B;AACA,SAAK,GAAL,CAAS,QAAT,CAAkB,KAAK,MAAvB,EAA+B,OAA/B;AAEA,QAAI,CAAC,QAAL,CAAc,GAAd,CAAkB,KAAK,OAAvB,EAAgC;AAAC,eAAS,EAAE;AAAZ,KAAhC,EAND,CAOC;;AACA,SAAK,WAAL,CAAiB,IAAjB;;AAEA,SAAK,gBAAL,CAAsB,GAAtB;;AACA,SAAK,uBAAL;AAEA,GAbO;AAeR;;;AACQ,8CAAR,UAAsB,UAAtB,EAAgD;AAE/C;AAFD,qBAAgD,CAI/C;AACA;;;AACA,SAAK,SAAL,CAAe,WAAf,GAA6B,UAAU,CAAE;AACxC,WAAI,CAAC,GAAL,CAAS,QAAT,CAAkB,KAAI,CAAC,OAAvB,EAAgC,SAAhC;;AACA,UAAK,KAAI,CAAC,oBAAL,CAA0B,SAA1B,OAA0C,CAA/C,EAAkD;AACjD,aAAI,CAAC,GAAL,CAAS,QAAT,CAAkB,KAAI,CAAC,OAAvB,EAAgC,OAAhC;AACA;AACD,KALsC,EAKpC,IALoC,CAAvC;AAOA,QAAI,CAAC,QAAL,CAAc,GAAd,CAAkB,KAAK,MAAvB,EAA+B;AAAC,eAAS,EAAE;AAAZ,KAA/B;;AACA,SAAK,gBAAL,CAAsB,GAAtB;;AACA,SAAK,uBAAL,GAf+C,CAiB/C;;;AACA,QAAI,MAAM,CAAC,UAAP,GAAoB,GAAxB,EAA6B;AAC5B,UAAI,CAAC,QAAL,CAAc,MAAd,CAAqB,KAAK,gBAA1B,EAA4C,GAA5C,EAAiD;AAAC,SAAC,EAAE,GAAJ;AAAS,iBAAS,EAAC;AAAnB,OAAjD,EAAwE;AAAC,SAAC,EAAE,CAAJ;AAAO,iBAAS,EAAE,CAAlB;AAAqB,aAAK,EAAE,GAA5B;AAAiC,YAAI,EAAE,IAAI,CAAC,MAAL,CAAY;AAAnD,OAAxE;AACA,KApB8C,CAsB/C;;;AACA,SAAK,WAAL,CAAiB,IAAjB;AAEA,GAzBO;;AA2BA,wDAAR;AAEC,QAAI,CAAC,QAAL,CAAc,MAAd,CAAqB,KAAK,SAA1B,EAAqC,GAArC,EAA0C;AAAC,eAAS,EAAE;AAAZ,KAA1C,EAA0D;AAAC,eAAS,EAAE,CAAZ;AAAe,WAAK,EAAE,CAAtB;AAAyB,UAAI,EAAE,IAAI,CAAC,MAAL,CAAY;AAA3C,KAA1D;AACA,QAAI,CAAC,QAAL,CAAc,MAAd,CAAqB,KAAK,aAA1B,EAAyC,GAAzC,EAA8C;AAAC,OAAC,EAAE,EAAJ;AAAQ,eAAS,EAAE;AAAnB,KAA9C,EAAqE;AAAC,OAAC,EAAE,CAAJ;AAAO,eAAS,EAAE,CAAlB;AAAqB,WAAK,EAAE,GAA5B;AAAiC,UAAI,EAAE,IAAI,CAAC,MAAL,CAAY;AAAnD,KAArE;AACA,QAAI,CAAC,QAAL,CAAc,MAAd,CAAqB,KAAK,gBAA1B,EAA4C,GAA5C,EAAiD;AAAC,OAAC,EAAE,EAAJ;AAAQ,eAAS,EAAE;AAAnB,KAAjD,EAAwE;AAAC,OAAC,EAAE,CAAJ;AAAO,eAAS,EAAE,CAAlB;AAAqB,WAAK,EAAE,GAA5B;AAAiC,UAAI,EAAE,IAAI,CAAC,MAAL,CAAY;AAAnD,KAAxE;AACA,QAAI,CAAC,QAAL,CAAc,MAAd,CAAqB,KAAK,cAA1B,EAA0C,GAA1C,EAA+C;AAAC,OAAC,EAAE,EAAJ;AAAQ,eAAS,EAAE;AAAnB,KAA/C,EAAsE;AAAC,OAAC,EAAE,CAAJ;AAAO,eAAS,EAAE,CAAlB;AAAqB,WAAK,EAAE,GAA5B;AAAiC,UAAI,EAAE,IAAI,CAAC,MAAL,CAAY;AAAnD,KAAtE;AACA,QAAI,CAAC,QAAL,CAAc,MAAd,CAAqB,KAAK,cAA1B,EAA0C,GAA1C,EAA+C;AAAC,OAAC,EAAE,EAAJ;AAAQ,eAAS,EAAE;AAAnB,KAA/C,EAAsE;AAAC,OAAC,EAAE,CAAJ;AAAO,eAAS,EAAE,CAAlB;AAAqB,WAAK,EAAE,GAA5B;AAAiC,UAAI,EAAE,IAAI,CAAC,MAAL,CAAY;AAAnD,KAAtE,EAND,CAQC;AACA;AACA;AACA,GAXO;AAaR;;;AACQ,iDAAR,UAAyB,KAAzB,EAA0C;AAA1C;;AAAyB;AAAA;AAAiB;;AAEzC,SAAK,YAAL,GAAoB,KAApB;;AACA,SAAK,aAAL,CAAmB,IAAnB;;AACA,QAAI,CAAC,QAAL,CAAc,MAAd,CAAqB,KAAK,aAA1B,EAAyC,GAAzC,EAA8C;AAAC,eAAS,EAAE;AAAZ,KAA9C,EAA8D;AAC7D,eAAS,EAAE,CADkD;AAE7D,UAAI,EAAE,IAAI,CAAC,MAAL,CAAY,QAF2C;AAG7D,WAAK,EAAE,KAHsD;AAI7D,gBAAU,EAAE;AACX,aAAI,CAAC,aAAL,CAAmB,IAAnB;;AACA,aAAI,CAAC,mBAAL,GAA2B,IAA3B;AACA;AAP4D,KAA9D;AASA,GAbO;AAeR;;;AACQ,iDAAR,UAAyB,KAAzB,EAA0C;AAAjB;AAAA;AAAiB;;AACzC,SAAK,aAAL,CAAmB,KAAnB;;AACA,QAAI,CAAC,QAAL,CAAc,EAAd,CAAiB,KAAK,aAAtB,EAAqC,GAArC,EAA0C;AAAC,eAAS,EAAE,CAAZ;AAAe,UAAI,EAAE,IAAI,CAAC,MAAL,CAAY,QAAjC;AAA2C,WAAK,EAAE;AAAlD,KAA1C,EAFyC,CAGzC;;AACA,SAAK,cAAL,GAAsB,IAAtB;AACA,GALO,CApkBT,CA2kBC;;AAEA;;;;;;AAIQ,8CAAR,UAAsB,KAAtB,EAAuC;AAAvC;;AAEC,SAAK,CAAC,cAAN;;AACA,QAAI,KAAK,eAAT,EAA0B;AACzB;AACA;;AAED,YAAG,KAAH,CAAS,IAAT,EAAe,sBAAf,EAAuC,MAAM,CAAC,QAAP,CAAgB,QAAvD,EAPsC,CAStC;;AACA,SAAK,eAAL,GAAuB,IAAvB;AACA,QAAI,UAAU,GAAW,GAAzB,CAXsC,CAatC;;AACA,QAAK,KAAK,oBAAL,CAA0B,SAA1B,KAAwC,CAA7C,EAAiD;AAEhD,gBAAU,CAAE;AACX,aAAI,CAAC,oBAAL,CAA0B,QAA1B,CAAmC,CAAnC;;AACA,aAAI,CAAC,oBAAL,CAA0B,QAA1B,CAAmC,IAAnC;AACA,OAHS,EAGP,GAHO,CAAV;AAKA,gBAAU,GAAG,GAAb;AACA;;AAED,QAAI,CAAC,QAAL,CAAc,EAAd,CAAiB,KAAK,SAAtB,EAAiC,GAAjC,EAAsC;AAAC,eAAS,EAAE,CAAZ;AAAe,WAAK,EAAE,GAAtB;AAA2B,UAAI,EAAE,IAAI,CAAC,MAAL,CAAY;AAA7C,KAAtC,EAxBsC,CA0BtC;;AACA,QAAI,MAAM,CAAC,UAAP,GAAoB,GAAxB,EAA6B;AAC5B,UAAI,CAAC,QAAL,CAAc,EAAd,CAAiB,KAAK,gBAAtB,EAAwC,GAAxC,EAA6C;AAAC,SAAC,EAAE,GAAJ;AAAS,aAAK,EAAE,UAAhB;AAA4B,YAAI,EAAE,IAAI,CAAC,MAAL,CAAY;AAA9C,OAA7C;AACA,KA7BqC,CA+BtC;AACA;;;AACA,SAAK,GAAL,CAAS,WAAT,CAAqB,KAAK,OAA1B,EAAmC,SAAnC;AACA,SAAK,GAAL,CAAS,WAAT,CAAqB,KAAK,OAA1B,EAAmC,OAAnC;;AACA,SAAK,WAAL,CAAiB,IAAjB,GAnCsC,CAqCtC;;;AACA,QAAI,QAAQ,GAAsB;AACjC,aAAO,EAAE,oBAAY,IADY;AAEjC,gBAAU,EAAE,KAAK,iBAFgB;AAGjC,WAAK,EAAG,KAAK,iBAAL,KAA2B,uBAAe,OAA3C,GAAsD,SAAtD,GAAkE,QAHxC;AAIjC,UAAI,EAAE,MAAI,KAAK,iBAAT,GAA0B;AAJC,KAAlC;AAMA,oBAAO,QAAP,CAAgB,sBAAU,cAA1B,EAA0C,QAA1C,EAAoD;AAAC,WAAK,EAAE;AAAR,KAApD;AAEA,WAAO,KAAP;AAEA,GAhDO;AAkDR;;;AACQ,mDAAR;AAEC,QAAI,CAAC,KAAK,aAAN,IAAuB,CAAC,KAAK,cAA7B,IAA+C,KAAK,YAAxD,EAAsE;AACrE;AACA,KAJF,CAMC;AACA;AACA;AACA;AAEA;AACA;;;AAEA,QAAI,SAAS,GAAG;AAAC,WAAK,EAAE,IAAR;AAAc,YAAM,EAAE;AAAtB,KAAhB;AACA,QAAI,aAAa,GAAG;AAAC,WAAK,EAAE,MAAM,CAAC,UAAf;AAA2B,YAAM,EAAE,MAAM,CAAC;AAA1C,KAApB;;AAEA,QAAI,CAAC,KAAK,YAAN,IAAuB,MAAM,CAAC,UAAP,IAAqB,GAAhD,EAAqD;AAEnD,cAAQ,CAAC,aAAT,CAAuB,4BAAvB,EAAqE,KAArE,CAA2E,MAA3E,GAAuF,MAAM,CAAC,WAAP,GAAqB,GAArB,GAAwB,IAA/G,CAFmD,CAIpD;AACA;;AACA,UAAI,MAAM,CAAC,UAAP,IAAqB,GAAzB,EAA8B;AAC7B;AACA,aAAK,cAAL,CAAoB,KAApB,CAA0B,MAA1B,GAAsC,MAAM,CAAC,WAAP,GAAqB,GAArB,GAAwB,IAA9D;AACA;;AAED,UAAI,IAAI,GAAG,KAAK,IAAL,CAAU,YAAV,CAAuB,SAAvB,EAAkC,aAAlC,CAAX;AACA,WAAK,aAAL,CAAmB,KAAnB,CAAyB,KAAzB,GAAoC,IAAI,CAAC,KAAL,GAAU,IAA9C;AACA,WAAK,aAAL,CAAmB,KAAnB,CAAyB,MAAzB,GAAqC,IAAI,CAAC,MAAL,GAAW,IAAhD;AAEA,WAAK,YAAL,GAAoB,IAApB;AAEA;AAED,GApCO;;AAsCA,uDAAR;AACC,QAAI,KAAK,mBAAL,IAA4B,KAAK,oBAAL,CAA0B,SAA1B,KAAwC,KAAK,YAA7E,EAA2F;AAC1F,WAAK,mBAAL,GAA2B,KAA3B;;AACA,WAAK,aAAL,CAAmB,KAAnB;;AACA,WAAK,aAAL,CAAmB,KAAnB,CAAyB,UAAzB,GAAsC,QAAtC;AACA,KAJD,MAIO,IAAI,CAAC,KAAK,mBAAN,IAA6B,KAAK,oBAAL,CAA0B,SAA1B,MAAyC,KAAK,YAA/E,EAA6F;AACnG,WAAK,aAAL,CAAmB,IAAnB;;AACA,WAAK,aAAL,CAAmB,KAAnB,CAAyB,UAAzB,GAAsC,SAAtC;AACA,WAAK,mBAAL,GAA2B,IAA3B;AACA;AACD,GAVO;;AAYT;AAAC,CAtrBD,CAAuC,uBAAvC;;AAAa,8C;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACvBb;;AACA;;AAEA;;AACA;;AACA;;AACA,4H,CAGA;;AAEA;;;AACA;AAAA;AAAA;AAAyC;;AAAzC;AAAA;;AAEQ,uBAAsB,KAAtB;AAGC,oBAAmB,KAAnB;AACA,oBAAmB,KAAnB;AACA,sBAAqB,KAArB;AACA,0BAAyB,IAAzB;AASA,oBAAkB,CAAlB;AACA,0BAAwB,CAAxB;AACA,uBAAqB,CAArB;AACA,0BAAwB,CAAxB;AACA,6BAA2B,CAA3B;AACA,uBAAqB,CAArB,CAtBT,CAwBC;;AACQ,8BAA4B,CAA5B;AACA,2BAAyB,CAAzB;AACA,kBAAgB,CAAhB;AACA,sBAAiB;AAAC,UAAI,EAAE,IAAP;AAAa,QAAE,EAAE;AAAjB,KAAjB,CA5BT,CA8BC;;AACQ,yBAAuB,CAAvB;AAEA,uBAAqB,CAArB;;AAubR;;AAlbO,uCAAP;AACC,SAAK,uBAAL,GAA+B,IAAI,+CAAJ,EAA/B;AACA,GAFM;;AAIA,yCAAP;AAEC,QAAI,CAAC,KAAK,OAAV,EAAmB;AAClB;AACA;;AAED,SAAK,uBAAL,CAA6B,MAA7B;;AACA,SAAK,UAAL;;AACA,SAAK,UAAL,CAAgB,GAAhB,EAAqB,KAArB;AAEA,GAVM;AAYP;;;AACO,8CAAP;AACC,WAAO,KAAK,OAAL,GAAe,KAAK,gBAA3B;AACA,GAFM;AAIP;;;AACO,4CAAP;AACC,WAAO,IAAI,CAAC,GAAL,CAAS,KAAK,OAAd,CAAP;AACA,GAFM;AAIP;;;AACO,2CAAP,UAAgB,CAAhB,EAAyB;AAAzB;;AAEC,QAAI,KAAK,aAAL,KAAuB,qBAAa,MAAxC,EAAgD;AAC/C,WAAK,aAAL,GAAqB,KAAK,IAAL,CAAU,SAAV,CAAoB,CAApB,EAAwB,KAAK,gBAA7B,EAA+C,CAA/C,CAArB;;AACA,WAAK,iBAAL;AACA,KAHD,MAGO;AACN,UAAI,SAAO,GAAG;AAAC,cAAM,EAAE,IAAI,CAAC,KAAL,CAAW,IAAI,CAAC,GAAL,CAAS,KAAK,OAAd,CAAX;AAAT,OAAd;AACA,UAAI,CAAC,QAAL,CAAc,EAAd,CAAiB,SAAjB,EAA0B,GAA1B,EAA+B;AAC9B,cAAM,EAAE,CADsB;AAE9B,YAAI,EAAE,IAAI,CAAC,MAAL,CAAY,SAFY;AAG9B,gBAAQ,EAAE;AACT,eAAI,CAAC,OAAL,GAAe,KAAI,CAAC,aAAL,GAAqB,CAAC,CAAD,GAAK,SAAO,CAAC,MAAjD;AACA,gBAAM,CAAC,QAAP,CAAgB,CAAhB,EAAmB,SAAO,CAAC,MAA3B;AACA;AAN6B,OAA/B;AASA;;;;;AAMA;AAED,GAxBM;AA0BP;;;AACO,mDAAP,UAAwB,QAAxB,EAAwC;AACvC,QAAI,OAAO,GAAgB,KAAK,QAAL,CAAc,aAAd,CAA4B,QAA5B,CAA3B;;AACA,QAAI,CAAC,GAAW,KAAK,YAAL,CAAkB,OAAlB,CAAhB;;AACA,SAAK,QAAL,CAAc,CAAd;AACA,GAJM;AAMP;;;AACO,wCAAP;AACC,SAAK,QAAL,CAAc,KAAd;AACA,SAAK,KAAL,GAAa,KAAK,aAAL,GAAqB,KAAK,OAAL,GAAe,KAAK,UAAL,GAAkB,CAAnE;AACA,GAHM;AAKP;;;AACO,2CAAP,UAAgB,KAAhB,EAA8B;AAC7B,SAAK,OAAL,GAAe,KAAf;AACA,GAFM;AAIP;;;AACO,4CAAP,UAAiB,MAAjB,EAAgC;AAC/B,SAAK,OAAL,GAAe,MAAf;;AACA,QAAI,MAAJ,EAAY;AACX,WAAK,GAAL,CAAS,QAAT,CAAkB,KAAK,SAAvB,EAAkC,SAAlC;AACA,KAFD,MAEO;AACN,WAAK,GAAL,CAAS,WAAT,CAAqB,KAAK,SAA1B,EAAqC,SAArC;AACA;AACD,GAPM;;AASA,4CAAP;AACC,WAAO,KAAK,OAAZ;AACA,GAFM;;AAIA,+CAAP;AACC,WAAO,KAAK,UAAZ;AACA,GAFM;AAIP;;;AACO,2CAAP,UAAgB,QAAhB,EAAuC,WAAvC,EAAgE,aAAhE,EAAiG;AAAjG;;AAAuC;AAAA;AAAuB;;AAAE;AAAA;AAAiC;;AAEhG,QAAI,qBAAqB,GAAY,KAArC;AACA,SAAK,UAAL,GAAkB,KAAlB;AACA,SAAK,QAAL,GAAgB,QAAhB;AACA,SAAK,cAAL,GAAuB,aAAD,GAAkB,aAAlB,GAAmC,QAAzD;;AAEA,QAAI,KAAK,QAAT,EAAmB;AAElB;AACA,UAAI,KAAK,OAAL,IAAgB,WAAW,KAAK,CAApC,EAAwC;AACvC,aAAK,OAAL,GAAe,KAAf;AACA,6BAAqB,GAAG,IAAxB;AACA;;AAED,WAAK,KAAL,GAAa,KAAK,aAAL,GAAqB,KAAK,OAAL,GAAgB,CAAlD;;AACA,WAAK,UAAL;;AACA,WAAK,UAAL,CAAgB,WAAhB,EAA6B,qBAA7B,EAVkB,CAYlB;;;AACA,WAAK,uBAAL,CAA6B,YAA7B,CAA0C,KAAK,QAA/C,EAbkB,CAelB;;;AACA,WAAK,MAAL,CAAY,qBAAZ,CAAkC,KAAK,QAAvC,EAhBkB,CAkBlB;AAEA;;AACA,UAAI,KAAK,aAAL,KAAuB,qBAAa,MAAxC,EAAgD;AAC/C,YAAI,KAAK,GAAS,MAAc,CAAC,YAAjC;AACA,YAAI,KAAK,GAAG,IAAI,KAAJ,CAAW,KAAK,cAAhB,EAAgC;AAAM,sBAAI,CAAJ;AAAa,SAAnD,CAAZ;AACA;AAED,KA1BD,MA0BO;AACN,WAAK,OAAL,GAAe,KAAf;AACA,WAAK,OAAL,GAAe,KAAK,KAAL,GAAc,KAAK,aAAL,GAAqB,CAAlD;;AACA,WAAK,uBAAL,CAA6B,YAA7B,CAA0C,IAA1C;AACA;AAED,GAvCM,CAhIR,CAyKC;;;AACO,uCAAP;AAEC,QAAI,CAAC,KAAK,OAAV,EAAmB;AAClB;AACA,KAJF,CAMC;;;AAEA,QAAI,KAAK,aAAL,KAAuB,qBAAa,MAApC,IAA8C,CAAC,KAAK,aAAxD,EAAuE;AACtE,WAAK,mBAAL;AACA;;AAED,SAAK,uBAAL,CAA6B,YAA7B,CAA2C,IAAI,CAAC,GAAL,CAAS,KAAK,OAAd,CAA3C;AAEA,GAdM;AAgBP;;;AACO,2CAAP;AAAA;;AAEC,SAAK,iBAAL;;AACA,SAAK,uBAAL,CAA6B,OAA7B,CAAqC,KAAK,aAA1C;;AAEA,SAAK,KAAL,GAAa,KAAK,SAAL,CAAe,aAAf,CAA6B,iBAA7B,CAAb;;AAGA,QAAI,KAAK,aAAL,KAAuB,qBAAa,MAAxC,EAAgD;AAE/C,sBAAO,EAAP,CAAU,WAAV,EAAuB,iBAAvB,EAA0C,KAAK,WAAL,CAAiB,IAAjB,CAAsB,IAAtB,CAA1C;AACA,sBAAO,EAAP,CAAU,YAAV,EAAyB,MAAzB,EAAiC,KAAK,aAAL,CAAmB,IAAnB,CAAwB,IAAxB,CAAjC,EAH+C,CAK/C;;AACA,YAAM,CAAC,gBAAP,CAAwB,YAAxB,EAAsC,UAAC,CAAD,EAAmB;AAAM,aAAI,CAAC,aAAL,CAAmB,CAAnB;AAAwB,OAAvF,EAAyF,KAAzF;AACA,YAAM,CAAC,gBAAP,CAAwB,gBAAxB,EAA0C,UAAC,CAAD,EAAmB;AAAM,aAAI,CAAC,aAAL,CAAmB,CAAnB;AAAwB,OAA3F,EAA6F,KAA7F,EAP+C,CAQ/C;;AACA,YAAM,CAAC,gBAAP,CAAwB,OAAxB,EAAiC,UAAC,CAAD,EAAiB;AAAO,aAAI,CAAC,WAAL,CAAiB,CAAjB;AAAsB,OAA/E,EAAiF,KAAjF;AACA,KAlBF,CAoBC;AACA;AACA;;AAEA,GAxBM;;AA0BA,yCAAP,UAAc,CAAd,EAAuB;AACtB,QAAI,KAAK,aAAL,KAAuB,qBAAa,QAAxC,EAAkD;AACjD,WAAK,OAAL,GAAe,KAAK,aAAL,GAAqB,CAAC,CAAD,GAAK,CAAzC;;AACA,WAAK,aAAL;AACA;AACD,GALM,CArNR,CA4NC;AACA;AACA;AACA;AACA;;AAEA;;;AACQ,6CAAR;AAEC,SAAK,aAAL,GAAsB,KAAK,cAAL,CAAoB,YAApB,GAAmC,KAAK,YAA9D;;AAEA,QAAI,KAAK,aAAT,EAAwB;AACvB,WAAK,GAAL,CAAS,WAAT,CAAqB,KAAK,SAA1B,EAAqC,SAArC;AACA;AACA;;AAED,SAAK,YAAL,GAAoB,MAAM,CAAC,WAA3B;AACA,QAAI,KAAK,GAAW,KAAK,YAAL,GAAoB,KAAK,cAAL,CAAoB,YAA5D;AACA,SAAK,gBAAL,GAAwB,CAAC,CAAD,IAAO,KAAK,cAAL,CAAoB,YAApB,GAAmC,KAAK,YAA/C,CAAxB;AACA,SAAK,UAAL,GAAkB,KAAK,YAAL,GAAoB,KAAtC;AACA,SAAK,aAAL,GAAsB,KAAK,YAAL,GAAoB,KAAK,UAA1B,GAAwC,EAA7D;AAEA,SAAK,GAAL,CAAS,QAAT,CAAkB,KAAK,SAAvB,EAAkC,SAAlC;AAEA,GAjBO;AAmBR;;;AACQ,6CAAR,UAAmB,WAAnB,EAA4C,qBAA5C,EAAkF;AAAlF;;AAAmB;AAAA;AAAuB;;AAAE;AAAA;AAAsC;;AACjF,QAAI,gBAAgB,GAAS,qBAAD,GAA0B;AAAQ,WAAI,CAAC,OAAL,GAAe,IAAf;AAAsB,KAAxD,GAA2D,IAAvF;AACA,QAAI,CAAC,QAAL,CAAc,EAAd,CAAiB,KAAK,KAAtB,EAA6B,WAA7B,EAA0C;AAAC,OAAC,EAAE,KAAK,KAAT;AAAgB,YAAM,EAAE,KAAK,UAA7B;AAAyC,gBAAU,EAAE;AAArD,KAA1C;AACA,GAHO;AAKR;;;AACQ,8CAAR,UAAoB,CAApB,EAAiC;AAEhC,QAAI,CAAC,KAAK,OAAN,IAAiB,KAAK,OAAtB,IAAiC,KAAK,aAA1C,EAAyD;AACxD;AACA;;AAGD,SAAK,cAAL,GAAsB,KAAK,KAA3B;AACA,SAAK,iBAAL,GAAyB,CAAC,CAAC,OAA3B;AAEA,SAAK,GAAL,CAAS,QAAT,CAAkB,KAAK,SAAvB,EAAkC,WAAlC;AACA,SAAK,SAAL,GAAiB,IAAjB;AAEA,SAAK,SAAL,CAAe,IAAf,GAAuB,gBAAO,EAAP,CAAU,WAAV,EAAuB,MAAvB,EAA+B,KAAK,UAAL,CAAgB,IAAhB,CAAqB,IAArB,CAA/B,CAAvB;AACA,SAAK,SAAL,CAAe,EAAf,GAAqB,gBAAO,EAAP,CAAU,SAAV,EAAqB,MAArB,EAA6B,KAAK,aAAL,CAAmB,IAAnB,CAAwB,IAAxB,CAA7B,CAArB;AAEA,GAhBO;AAkBR;;;AACQ,6CAAR,UAAmB,CAAnB,EAAgC;AAE5B,SAAK,KAAL,GAAc,KAAK,IAAL,CAAU,SAAV,CAAoB,KAAK,cAAL,IAAuB,CAAC,CAAC,OAAF,GAAY,KAAK,iBAAxC,CAApB,EAAgF,KAAK,aAArF,EAAoG,KAAK,aAAzG,CAAd;AACA,QAAI,CAAC,QAAL,CAAc,GAAd,CAAkB,KAAK,KAAvB,EAA8B;AAAC,OAAC,EAAE,KAAK;AAAT,KAA9B,EAH4B,CAK5B;;AACA,SAAK,aAAL,GAAuB,KAAK,gBAAL,IAAyB,KAAK,KAAL,GAAc,KAAK,aAA5C,CAAvB;AAEH,GARO,CAhRT,CA0RC;;;AACQ,gDAAR;AACC,oBAAO,OAAP,CAAe,KAAK,SAAL,CAAe,IAA9B,EAAoC,KAAK,SAAL,CAAe,EAAnD;AACA,SAAK,GAAL,CAAS,WAAT,CAAqB,KAAK,SAA1B,EAAqC,WAArC;AACA,SAAK,SAAL,GAAiB,KAAjB;AACA,GAJO;;AAMA,gDAAR,UAAsB,CAAtB,EAAmC;AAElC,WAAO,CAAC,GAAR,CAAY,aAAZ;;AAEA,QAAI,CAAC,KAAK,OAAN,IAAiB,KAAK,OAAtB,IAAiC,KAAK,aAA1C,EAAyD;AACxD;AACA;;AAED,SAAK,SAAL,GAAiB,IAAjB;AACA,SAAK,YAAL,GAAoB,CAAC,CAAC,OAAF,CAAU,CAAV,EAAa,OAAjC;AACA,SAAK,UAAL,GAAkB,CAAlB;AACA,SAAK,SAAL,CAAe,SAAf,GAA4B,gBAAO,EAAP,CAAU,WAAV,EAAuB,MAAvB,EAA+B,KAAK,YAAL,CAAkB,IAAlB,CAAuB,IAAvB,CAA/B,CAA5B;AACA,SAAK,SAAL,CAAe,WAAf,GAA8B,gBAAO,EAAP,CAAU,UAAV,EAAsB,MAAtB,EAA8B,KAAK,WAAL,CAAiB,IAAjB,CAAsB,IAAtB,CAA9B,CAA9B;AAEA,GAdO;;AAgBA,+CAAR,UAAqB,CAArB,EAAkC;AACjC;AACC,SAAK,aAAL,GAAsB,KAAK,IAAL,CAAU,SAAV,CAAoB,KAAK,aAAL,GAAsB,CAAC,CAAC,CAAC,OAAF,CAAU,CAAV,EAAa,OAAb,GAAuB,KAAK,YAA7B,IAA6C,CAAvF,EAA0F,KAAK,gBAA/F,EAAiH,CAAjH,CAAtB;AACA,SAAK,YAAL,GAAoB,CAAC,CAAC,OAAF,CAAU,CAAV,EAAa,OAAjC;AAED,GALO;;AAOA,8CAAR,UAAoB,CAApB,EAAiC;AAChC,WAAO,CAAC,GAAR,CAAY,WAAZ;AACA,oBAAO,OAAP,CAAe,KAAK,SAAL,CAAe,SAA9B,EAAyC,KAAK,SAAL,CAAe,WAAxD;AACA,SAAK,SAAL,GAAiB,KAAjB;AACA,SAAK,UAAL,GAAkB,CAAlB;AACA,GALO;AAOR;;;;AAGQ,gDAAR,UAAsB,CAAtB,EAAuB;AAEtB,QAAI,KAAK,OAAT,EAAkB;AACjB;AACA,KAJqB,CAMtB;;;AACA,QAAI,KAAK,GAAW,IAAI,CAAC,GAAL,CAAS,CAAC,CAAV,EAAa,IAAI,CAAC,GAAL,CAAS,CAAT,EAAa,CAAC,CAAC,UAAF,IAAgB,CAAC,CAAC,CAAC,MAAhC,CAAb,CAApB,CAPsB,CAStB;;AACA,QAAI,CAAC,KAAK,OAAN,IAAiB,KAAK,SAAtB,IAAmC,KAAK,aAA5C,EAA2D;AAC1D;AACA,UAAI,CAAC,KAAK,OAAV,EAAmB;AACf,wBAAO,QAAP,CAAgB,IAAI,2CAAJ,CAAyB;AAAC,eAAK,EAAE;AAAR,SAAzB,CAAhB;AACH;;AACD;AACA;;AAED,SAAK,aAAL,GAAqB,KAAK,IAAL,CAAU,SAAV,CAAqB,KAAK,aAAL,GAAsB,KAAK,GAAG,KAAK,oBAAL,EAAnD,EAAmF,KAAK,gBAAxF,EAA0G,CAA1G,CAArB,CAlBsB,CAmBtB;;AACA,SAAK,iBAAL;AAEA,GAtBO;;AAwBA,+CAAR,UAAqB,OAArB,EAAyC;AAExC,QAAI,CAAC,OAAL,EAAc;AACb,UAAI;AACH,cAAM,IAAI,KAAJ,CAAU,oDAAV,CAAN;AACA,OAFD,CAEE,OAAO,CAAP,EAAU;AACX,eAAO,CAAC,GAAR,CAAY,CAAZ;AACA;;AACD,aAAO,CAAP;AACA;;AAED,WAAO,OAAO,CAAC,SAAf;AACA,GAZO;AAcR;;;AACQ,8CAAR,UAAoB,CAApB,EAAoC;AAEnC,QAAI,GAAG,GAAY,CAAC,CAAC,OAAF,GAAY,CAAC,CAAC,OAAd,GAAwB,CAAC,CAAC,KAA7C;AACA,QAAI,OAAJ;AACA,QAAI,IAAJ;;AAEA,QAAK,GAAG,KAAK,EAAb,EAAkB;AACjB,aAAO,GAAG,2BAAmB,IAA7B;AACA,KAFD,MAEO,IAAK,GAAG,KAAK,EAAb,EAAkB;AACxB,aAAO,GAAG,2BAAmB,EAA7B;AACA,KAFM,MAEA,IAAK,GAAG,KAAK,EAAb,EAAkB;AACxB,aAAO,GAAG,2BAAmB,SAA7B;AACA,KAFM,MAEC,IAAK,GAAG,KAAK,EAAb,EAAkB;AACzB,aAAO,GAAG,2BAAmB,OAA7B;AACA,KAFO,MAED,IAAK,GAAG,KAAK,EAAb,EAAkB;AACxB,aAAO,GAAG,2BAAmB,KAA7B;AACA,KAFM,MAEC,IAAK,GAAG,KAAK,EAAb,EAAkB;AACzB,aAAO,GAAG,2BAAmB,IAA7B;AACA,KAlBkC,CAoBnC;;;AACA,QAAK,CAAC,CAAC,KAAK,OAAN,IAAiB,KAAK,OAAtB,IAAiC,KAAK,aAAvC,KAAyD,OAA9D,EAAuE;AACtE,sBAAO,QAAP,CAAgB,IAAI,uCAAJ,CAAuB;AAAC,eAAO,EAAE;AAAV,OAAvB,CAAhB;AACA;AACA;;AAED,QAAI,GAAG,KAAK,iBAAL,CAAuB,OAAvB,CAAP;;AACA,QAAI,CAAC,IAAL,EAAW;AACV;AACA;;AAED,SAAK,aAAL,GAAqB,KAAK,IAAL,CAAU,SAAV,CAAqB,KAAK,aAAL,GAAqB,IAA1C,EAAiD,KAAK,gBAAtD,EAAwE,CAAxE,CAArB,CA/BmC,CAgCnC;;AACA,SAAK,iBAAL;AAEA,GAnCO;AAqCR;;;AACQ,8CAAR;AACC,QAAI,CAAC,KAAK,OAAV,EAAmB;AAClB;AACA;AACD,GAJO;AAMR;;;AACQ,sDAAR;AAEC,SAAK,OAAL,GAAe,KAAK,IAAL,CAAU,SAAV,CAAoB,KAAK,OAAL,GAAgB,CAAC,KAAK,aAAL,GAAqB,KAAK,OAA3B,IAAuC,KAAK,UAAhF,EAA8F,KAAK,gBAAnG,EAAqH,CAArH,CAAf;;AACA,SAAK,aAAL;;AAEA,UAAM,CAAC,QAAP,CAAgB,CAAhB,EAAmB,IAAI,CAAC,KAAL,CAAY,CAAC,CAAD,GAAM,KAAK,OAAvB,CAAnB;AACA,WAAO,CAAC,GAAR,CAAY,MAAM,CAAC,OAAnB,EAA4B,KAAK,OAAjC,EAND,CAQC;AACA,GATO;AAWR;;;AACQ,uDAAR;AACC,WAAO,GAAP;AACA,GAFO;AAIR;;;AACQ,oDAAR,UAA0B,OAA1B,EAAqD;AAEpD;AACA,QAAI,OAAO,KAAK,2BAAmB,OAA/B,IAA0C,OAAO,KAAK,2BAAmB,SAA7E,EAAwF;AACvF,aAAQ,OAAO,KAAK,2BAAmB,OAAhC,GAA2C,KAAK,YAAhD,GAA+D,CAAC,CAAD,GAAM,KAAK,YAAjF;AACA,KALmD,CAMpD;;;AACA,QAAI,OAAO,KAAK,2BAAmB,EAA/B,IAAqC,OAAO,KAAK,2BAAmB,IAAxE,EAA8E;AAC7E,aAAS,OAAO,KAAK,2BAAmB,EAAhC,GAAsC,GAAtC,GAA4C,CAAC,GAArD;AACA;;AAED,WAAO,CAAP;AAEA,GAbO;AAeR;;;AACQ,oDAAR;AAIC,QAAI,KAAK,GAAW,KAAK,aAAL,GAAqB,KAAK,gBAA9C;AACA,SAAK,KAAL,GAAa,KAAK,GAAG,KAAK,aAA1B;AACA,QAAI,CAAC,QAAL,CAAc,EAAd,CAAiB,KAAK,KAAtB,EAA6B,GAA7B,EAAkC;AAAC,OAAC,EAAE,KAAK;AAAT,KAAlC;AACA,GAPO;AASR;;;AACQ,gDAAR;AACC,QAAK,KAAK,UAAL,GAAkB,KAAK,OAA5B,EAAqC;AACpC,WAAK,UAAL,GAAkB,CAAC,CAAnB;AACA,KAFD,MAEO,IAAI,KAAK,UAAL,GAAkB,KAAK,OAA3B,EAAoC;AAC1C,WAAK,UAAL,GAAkB,CAAlB;AACA;;AACD,SAAK,UAAL,GAAkB,KAAK,OAAvB;AACA,GAPO;AASR;;;AACQ,oDAAR;AAEC,SAAK,aAAL,GAAsB,MAAM,CAAC,UAAP,GAAoB,IAArB,GAA8B,qBAAa,QAA3C,GAAsD,qBAAa,MAAxF,CAFD,CAIC;AACA;;AAEA,QAAK,KAAK,aAAL,KAAuB,qBAAa,QAAzC,EAAmD;AAClD,WAAK,GAAL,CAAS,QAAT,CAAkB,QAAQ,CAAC,aAAT,CAAuB,MAAvB,CAAlB,EAAkD,mBAAlD;AACA;AAED,GAXO;;AAaT;AAAC,CAxdD,CAAyC,uBAAzC;;AAAa,kD;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACZb;;AACA;;AAEA;;AACA;;AACA;;AAGA;;AACA,mF,CAEA;;;AAEA;AAAA;AAAA;AAAkC;;AAAlC;AAAA;;AAIS,iCAAgC,KAAhC;AAGA,qCAAmC,CAAnC;AACA,uBAAsB,IAAtB;;AAsQR;;AAjQO,gCAAP;AACC,oBAAO,EAAP,CAAU,uCAAV,EAA8B,KAAK,cAAL,CAAoB,IAApB,CAAyB,IAAzB,CAA9B;AACA,GAFM;;AAIA,0CAAP,UAAsB,SAAtB,EAAoD;AACnD,SAAK,oBAAL,GAA4B,SAA5B;AACA,GAFM;;AAIA,oCAAP;AAAA;;AAEC,SAAK,SAAL,GAAiB,KAAK,SAAL,CAAe,aAAf,CAA6B,WAA7B,CAAjB;AACA,SAAK,YAAL,GAAoB,KAAK,SAAL,CAAe,aAAf,CAA6B,cAA7B,CAApB;AAEA,oBAAO,EAAP,CAAU,OAAV,EAAmB,iBAAnB,EAAsC,UAAC,CAAD,EAAc;AACnD,OAAC,CAAC,cAAF;;AACA,WAAI,CAAC,kBAAL,CAAwB,CAAxB;;AACA,aAAO,KAAP;AACA,KAJD;AAMA,oBAAO,EAAP,CAAU,OAAV,EAAmB,iBAAnB,EAAsC,UAAC,CAAD,EAAc;AACnD,OAAC,CAAC,cAAF;AACA,sBAAO,QAAP,CAAgB,sBAAU,gBAA1B;AACA,aAAO,KAAP;AACA,KAJD;AAMA,SAAK,QAAL,CAAc,KAAK,MAAnB;AAEA,GAnBM;;AAqBA,uCAAP,UAAmB,KAAnB,EAAuC;AAEtC,QAAI,KAAK,KAAM,sBAAc,IAA7B,EAAoC;AACnC,WAAK,GAAL,CAAS,QAAT,CAAkB,KAAK,SAAvB,EAAkC,UAAlC;AACA;AACA;;AAED,SAAK,GAAL,CAAS,WAAT,CAAqB,KAAK,SAA1B,EAAqC,UAArC;AACA,GARM;AAUP;;;AACO,oCAAP,UAAgB,KAAhB,EAAwC;AAEvC,SAAK,MAAL,GAAc,KAAd;;AACA,QAAI,CAAC,KAAK,SAAV,EAAqB;AACpB;AACA;;AAED,WAAO,CAAC,GAAR,CAAY,OAAZ,EAAqB,KAArB;AAEA,QAAI,WAAW,GAAW,IAA1B;AACA,QAAI,UAAJ;AACA,QAAI,cAAc,GAAW,IAA7B;AACA,QAAI,aAAJ,CAZuC,CAcvC;;AACA,QAAI,KAAK,CAAC,OAAN,KAAkB,oBAAY,OAAlC,EAA2C;AAE1C,iBAAW,GAAG,KAAK,CAAC,UAAN,CAAiB,MAAjB,CAAwB,CAAxB,EAA2B,WAA3B,KAA2C,KAAK,CAAC,UAAN,CAAiB,MAAjB,CAAwB,CAAxB,CAAzD;AACA,oBAAc,GAAG,CAAC,KAAK,CAAC,WAAN,CAAkB,MAAlB,CAAyB,CAAzB,EAA4B,WAA5B,KAA4C,KAAK,CAAC,WAAN,CAAkB,MAAlB,CAAyB,CAAzB,CAA7C,EAA0E,OAA1E,CAAkF,IAAI,MAAJ,CAAW,GAAX,EAAgB,GAAhB,CAAlF,EAAwG,GAAxG,CAAjB;AAEA,gBAAU,GAAG,MAAI,WAAW,CAAC,WAAZ,EAAJ,GAA6B,GAA1C;AACA,mBAAa,GAAG,KAAK,CAAC,IAAtB;AAEA,KARD,MAQO,IAAI,KAAK,CAAC,OAAN,KAAkB,oBAAY,IAAlC,EAA0C;AAChD,UAAI,KAAK,CAAC,OAAN,KAAkB,oBAAY,IAA9B,IAAsC,KAAK,CAAC,OAAN,KAAkB,oBAAY,IAAxE,EAA8E;AAC7E,mBAAW,GAAG,KAAK,CAAC,UAAN,CAAiB,MAAjB,CAAwB,CAAxB,EAA2B,WAA3B,KAA2C,KAAK,CAAC,UAAN,CAAiB,MAAjB,CAAwB,CAAxB,CAAzD;AACA,OAFD,MAEO;AACN,mBAAW,GAAI,KAAK,CAAC,OAAN,CAAyB,MAAzB,CAAgC,CAAhC,EAAmC,WAAnC,KAAoD,KAAK,CAAC,OAAN,CAAyB,MAAzB,CAAgC,CAAhC,CAAnE;AACA;;AAED,UAAK,KAAK,CAAC,OAAN,KAAkB,oBAAY,IAAnC,EAA0C;AACzC,kBAAU,GAAG,MAAI,KAAK,CAAC,OAAV,GAAiB,GAA9B;AACA,OAFD,MAEO;AACN,kBAAU,GAAG,MAAI,KAAK,CAAC,UAAV,GAAoB,GAAjC;AACA;AAED;;AACD,SAAK,cAAL,CAAoB,KAAK,SAAzB,EAAoC,WAApC,EAAiD,UAAjD,EArCuC,CAuCvC;;;AACA,QAAI,CAAC,cAAD,IAAmB,KAAK,CAAC,UAAzB,IAAuC,KAAK,CAAC,OAAN,KAAkB,oBAAY,IAArE,IAA6E,KAAK,CAAC,OAAN,KAAkB,oBAAY,IAA/G,EAAsH;AACrH,oBAAc,GAAG,KAAK,CAAC,UAAN,CAAiB,MAAjB,CAAwB,CAAxB,EAA2B,WAA3B,KAA2C,KAAK,CAAC,UAAN,CAAiB,MAAjB,CAAwB,CAAxB,CAA5D;AACA;;AACD,SAAK,cAAL,CAAoB,KAAK,YAAzB,EAAuC,cAAvC,EAAuD,aAAvD;;AAGA,SAAK,kBAAL;AAEA,GAhDM;AAkDP;;;AACQ,0CAAR,UAAuB,OAAvB,EAA6C,IAA7C,EAAmE,IAAnE,EAAsF;AAAzC;AAAA;AAAoB;;AAAE;AAAA;AAAmB;;AACrF,QAAI,IAAJ,EAAU;AACT,WAAK,GAAL,CAAS,QAAT,CAAkB,OAAlB,EAA2B,OAA3B;AACA,WAAK,GAAL,CAAS,OAAT,CAAiB,OAAjB,EAA0B,IAA1B;;AACA,UAAI,IAAJ,EAAU;AACT,aAAK,GAAL,CAAS,YAAT,CAAsB,OAAtB,EAA+B,MAA/B,EAAuC,IAAvC;AACA;AACD,KAND,MAMO;AACN,WAAK,GAAL,CAAS,WAAT,CAAqB,OAArB,EAA8B,OAA9B;AACA;AACD,GAVO;AAYR;;;AACQ,8CAAR;AAEC,QAAI,KAAK,MAAL,CAAY,OAAZ,KAAwB,oBAAY,IAAxC,EAA+C;AAC9C,WAAK,GAAL,CAAS,QAAT,CAAkB,KAAK,SAAvB,EAAkC,OAAlC;AACA;AACA;;AAED,SAAK,GAAL,CAAS,WAAT,CAAqB,KAAK,SAA1B,EAAqC,OAArC;AAEA,GATO;;AAWD,gCAAP;AAEC,QAAI,KAAK,oBAAT,EAA+B;AAE9B,WAAK,GAAL,CAAS,OAAT,CAAiB,KAAK,YAAtB,EAAoC,KAAK,WAAL,CAAiB,MAAjB,CAAwB,CAAxB,EAA2B,KAAK,oBAAhC,CAApC;;AAEA,UAAI,KAAK,wBAAL,KAAkC,CAAtC,EAAyC;AACxC,aAAK,oBAAL;;AACA,YAAI,KAAK,oBAAL,KAA8B,KAAK,WAAL,CAAiB,MAAjB,GAA0B,CAA5D,EAA+D;AAC9D,eAAK,oBAAL,GAA4B,KAA5B;AACA;AACD,OALD,MAKO,IAAI,KAAK,wBAAL,KAAkC,CAAC,CAAvC,EAA0C;AAChD,aAAK,oBAAL;;AACA,YAAI,KAAK,oBAAL,KAA8B,CAAC,CAAnC,EAAsC;AACrC,eAAK,oBAAL,GAA4B,KAA5B;AACA;AACD;AAED;;AAED,SAAK,gBAAL;;AAEA,QAAI,CAAC,KAAK,oBAAL,CAA0B,UAA3B,IAAyC,KAAK,oBAAL,CAA0B,WAA1B,KAA0C,IAAvF,EAA6F;AAC5F,cAAG,KAAH,CAAS,UAAT,EAAqB,qBAArB,EAA4C,MAAM,CAAC,QAAP,CAAgB,QAA5D;AACA,WAAK,oBAAL,CAA0B,UAA1B,GAAuC,IAAvC;AACA;AAED,GA3BM;;AA6BA,gCAAP;AACC,QAAI,CAAC,QAAL,CAAc,MAAd,CAAqB,iBAArB,EAAwC,GAAxC,EAA6C;AAAC,eAAS,EAAE,CAAZ;AAAe,WAAK,EAAE;AAAtB,KAA7C,EAAuE;AAAC,WAAK,EAAE,CAAR;AAAW,eAAS,EAAE,CAAtB;AAAyB,WAAK,EAAE,GAAhC;AAAqC,UAAI,EAAE,IAAI,CAAC,MAAL,CAAY;AAAvD,KAAvE;AACA,QAAI,CAAC,QAAL,CAAc,EAAd,CAAiB,gBAAjB,EAAmC,GAAnC,EAAwC;AAAC,OAAC,EAAE,CAAJ;AAAO,UAAI,EAAE,IAAI,CAAC,MAAL,CAAY,OAAzB;AAAkC,WAAK,EAAE;AAAzC,KAAxC;AACA,QAAI,CAAC,QAAL,CAAc,EAAd,CAAiB,iBAAjB,EAAoC,GAApC,EAAyC;AAAC,eAAS,EAAE,CAAZ;AAAe,UAAI,EAAE,IAAI,CAAC,MAAL,CAAY,OAAjC;AAA0C,WAAK,EAAE;AAAjD,KAAzC;AAEA,SAAK,QAAL,CAAc,KAAK,MAAnB;AAEA,GAPM;;AASA,gCAAP;AACC,QAAI,CAAC,QAAL,CAAc,EAAd,CAAiB,iBAAjB,EAAoC,GAApC,EAAyC;AAAC,WAAK,EAAE,CAAR;AAAW,eAAS,EAAE,CAAtB;AAAyB,UAAI,EAAE,IAAI,CAAC,MAAL,CAAY;AAA3C,KAAzC;AACA,QAAI,CAAC,QAAL,CAAc,EAAd,CAAiB,gBAAjB,EAAmC,GAAnC,EAAwC;AAAC,OAAC,EAAE,GAAJ;AAAS,UAAI,EAAE,IAAI,CAAC,MAAL,CAAY;AAA3B,KAAxC;AACA,QAAI,CAAC,QAAL,CAAc,EAAd,CAAiB,iBAAjB,EAAoC,GAApC,EAAyC;AAAC,eAAS,EAAE,CAAZ;AAAe,UAAI,EAAE,IAAI,CAAC,MAAL,CAAY;AAAjC,KAAzC;AACA,GAJM;AAMP;;;AACO,kCAAP,UAAc,OAAd,EAA6B;AAC5B;AACA,SAAK,gBAAL;AACA,GAHM,CA7KR,CAkLC;AACA;AACA;AACA;AACA;;AAEA;;;AACQ,8CAAR,UAA2B,CAA3B,EAAwC;AACvC,QAAI,CAAC,KAAK,GAAL,CAAS,QAAT,CAAmB,CAAC,CAAC,MAArB,EAAyC,SAAzC,CAAL,EAA2D;AAC1D;AACA;;AACD,YAAG,KAAH,CAAS,IAAT,EAAe,kBAAf;AACA,oBAAO,QAAP,CAAgB,sBAAU,aAA1B;AACA,GANO;AAQR;;;AACQ,0CAAR,UAAuB,KAAvB,EAAgD;AAE/C;AACA,QAAI,KAAK,CAAC,KAAN,KAAgB,0BAAkB,IAAtC,EAA4C;AAC3C,WAAK,GAAL,CAAS,QAAT,CAAkB,KAAK,SAAvB,EAAkC,OAAlC;AACA,WAAK,GAAL,CAAS,QAAT,CAAkB,QAAQ,CAAC,aAAT,CAAuB,iBAAvB,CAAlB,EAA6D,OAA7D;AACA,WAAK,GAAL,CAAS,QAAT,CAAkB,QAAQ,CAAC,aAAT,CAAuB,gBAAvB,CAAlB,EAA4D,OAA5D;AACA;AACA;;AAED,SAAK,GAAL,CAAS,WAAT,CAAqB,KAAK,SAA1B,EAAqC,OAArC;AACA,SAAK,GAAL,CAAS,WAAT,CAAqB,QAAQ,CAAC,aAAT,CAAuB,iBAAvB,CAArB,EAAgE,OAAhE;AACA,SAAK,GAAL,CAAS,WAAT,CAAqB,QAAQ,CAAC,aAAT,CAAuB,gBAAvB,CAArB,EAA+D,OAA/D;AAEA,GAdO;AAgBR;;;AACQ,4CAAR;AAEC,QAAI,OAAO,GAAW,KAAK,oBAAL,CAA0B,SAA1B,EAAtB;;AACA,QAAI,eAAe,GAAW,KAAK,oBAAL,CAA0B,YAA1B,EAA9B,CAHD,CAKC;AACA;AACA;;;AACA,QAAK,KAAK,UAAL,IAAmB,eAAe,KAAK,CAA5C,EAA+C;AAC9C,UAAK,KAAK,wBAAL,CAA8B,OAA9B,CAAL,EAA8C;AAC7C,aAAK,eAAL,CAAqB,KAArB;AACA;;AACD;AACA,KAbF,CAeC;AACA;AACA;AACA;AACA;;;AACA,QAAI,CAAC,KAAK,UAAV,EAAsB;AACrB,UAAI,cAAc,GAAY,KAAK,oBAAL,CAA0B,SAA1B,EAA9B;;AACA,UAAI,eAAe,KAAK,CAAC,CAArB,IAA0B,CAAC,KAAK,wBAAL,CAA8B,OAA9B,CAA3B,IAAsE,CAAC,cAA3E,EAA2F;AAC1F,aAAK,eAAL,CAAqB,IAArB;AACA;;AACD;AACA;AAED,GA5BO;AA8BR;AACA;;;AACQ,2CAAR,UAAwB,IAAxB,EAAqC;AAEpC,SAAK,UAAL,GAAkB,IAAlB;;AAEA,QAAI,KAAK,UAAT,EAAqB;AACpB,WAAK,GAAL,CAAS,WAAT,CAAqB,KAAK,SAA1B,EAAqC,OAArC;AACA,WAAK,GAAL,CAAS,QAAT,CAAkB,QAAQ,CAAC,aAAT,CAAuB,iBAAvB,CAAlB,EAA6D,OAA7D;AACA,WAAK,GAAL,CAAS,QAAT,CAAkB,QAAQ,CAAC,aAAT,CAAuB,sBAAvB,CAAlB,EAAkE,OAAlE;AACA,WAAK,GAAL,CAAS,QAAT,CAAkB,QAAQ,CAAC,aAAT,CAAuB,cAAvB,CAAlB,EAA0D,aAA1D;AACA;AACA,KAVmC,CAYpC;;;AACA,SAAK,GAAL,CAAS,WAAT,CAAqB,QAAQ,CAAC,aAAT,CAAuB,iBAAvB,CAArB,EAAgE,OAAhE;AACA,SAAK,GAAL,CAAS,WAAT,CAAqB,QAAQ,CAAC,aAAT,CAAuB,sBAAvB,CAArB,EAAqE,OAArE;AACA,SAAK,GAAL,CAAS,WAAT,CAAqB,QAAQ,CAAC,aAAT,CAAuB,cAAvB,CAArB,EAA6D,aAA7D;AAEA,SAAK,GAAL,CAAS,QAAT,CAAkB,KAAK,SAAvB,EAAkC,OAAlC;AAEA,GAnBO;AAqBR;;;AACQ,oDAAR,UAAiC,OAAjC,EAAgD;AAC/C,QAAI,WAAW,GAAW,KAAK,oBAAL,CAA0B,WAA1B,EAA1B;;AACA,WAAQ,OAAO,GAAG,GAAV,IAAiB,WAAW,GAAG,IAAvC;AACA,GAHO;;AAKT;AAAC,CA9QD,CAAkC,uBAAlC;;AAAa,oC;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACbb;;AACA;;AAIA;;AACA;;AACA;;AACA;;AACA;;AAKA;;AAEA;;AACA;;AACA;;AACA;;AAMA;AAAA;AAAA;AAAoC,oCAApC,CAwEC;AACA;AACA;AACA;AAEA;AACA;;;AACA,0BAAY,EAAZ,EAAsB;AAAtB,gBACC;AACA,sBAAM,EAAN,KAAS,IAFV;;AA3EQ,oBAAoB,KAApB;AACA,0BAAyB,KAAzB,CA0Ec,CA1EoB;;AAClC,qBAAoB,KAApB,CAyEc,CAzEgB;;AAC9B,4BAA2B,KAA3B,CAwEc,CAxEqB;;AACnC,gCAA+B,KAA/B,CAuEc,CAvEwB;;AACtC,2BAA0B,KAA1B,CAsEc,CAtEoB;;AAClC,yBAAwB,KAAxB;AACA,iCAAgC,KAAhC;AAgBA,uBAAkB;AAAC,UAAI,EAAE,KAAP;AAAc,SAAG,EAAE,KAAnB;AAA0B,UAAI,EAAE;AAAhC,KAAlB;AAMA,+BAA8B,KAA9B;AACA,0BAAwB,CAAxB;AAIA,gCAA8B,CAA9B;AAEA,sBAAqB,KAArB;AAGA,0BAAyB,IAAzB;AACA,oBAAkB,CAAlB;AAMA,qCAAoC,KAApC;AACA,+BAA6B,CAA7B,CA4Bc,CA1BtB;;AACQ,2BAAyB,CAAzB;AACA,sBAAoB,CAApB;AACA,8BAA4B,CAA5B;AACA,6BAA2B,CAA3B;AACA,2BAAyB,GAAzB;AASA,sBAAiB,EAAjB;AACA,oBAAe,EAAf;AACA,uBAAkB,EAAlB;AAES,4BAA0B,GAA1B;AAWhB,oBAAO,EAAP,CAAU,+BAAV,EAA2B,KAAI,CAAC,YAAL,CAAkB,IAAlB,CAAuB,KAAvB,CAA3B;;AACA;;AAEM,kCAAP;AAEC;AACA,SAAK,OAAL,GAAe,IAAf,CAHD,CAKC;;AACA,QAAI,YAAY,GAAsB;AACrC,aAAO,EAAE,oBAAY,IADgB;AAErC,gBAAU,EAAE,KAAK,WAFoB;AAGrC,WAAK,EAAG,KAAK,WAAL,KAAqB,uBAAe,MAArC,GAA+C,QAA/C,GAA0D,SAH5B;AAIrC,UAAI,EAAE,MAAI,KAAK,WAAT,GAAoB;AAJW,KAAtC;AAMA,oBAAO,QAAP,CAAgB,sBAAU,gBAA1B,EAA4C,YAA5C;AAEA,GAdM,CArFR,CAqGC;;;AACO,oCAAP;AACC,SAAK,WAAL,GAAmB,uBAAe,MAAlC;AACA,SAAK,IAAL;AACA,GAHM,CAtGR,CA2GC;;;AACO,qCAAP;AACC,SAAK,WAAL,GAAmB,uBAAe,OAAlC;AACA,SAAK,IAAL;AACA,GAHM;AAKP;;;AACO,2CAAP,UAAqB,UAArB,EAA+C;AAC9C,SAAK,WAAL,GAAmB,UAAnB;AACA,GAFM,CAlHR,CAsHC;AACA;;AAEA;;;AACO,2CAAP,UAAqB,KAArB,EAA6C;AAC5C;AACA,WAAO,KAAK,aAAZ;AACA,GAHM;AAKP;;;AACO,8CAAP,UAAwB,KAAxB,EAAgD;AAE/C;AACA;AACA,QAAI,KAAK,aAAL,IAAsB,CAAC,KAAK,QAAhC,EAA0C;AACzC,WAAK,MAAL;AACA;;AAED,WAAQ,KAAK,aAAL,IAAsB,KAAK,QAAnC;AAEA,GAVM,CAhIR,CA4IC;;AACA;;;AACO,qCAAP,UAAe,IAAf,EAA2B;AAC1B,SAAK,KAAL,GAAa,IAAb;AACA,SAAK,UAAL,CAAgB,GAAhB,GAAsB,IAAtB;;AACA,SAAK,iBAAL;;AACA,QAAI,KAAK,mBAAT,EAA8B;AAC7B,WAAK,WAAL;AACA;AACD,GAPM;AASP;;;AACO,qCAAP,UAAe,IAAf,EAAkC;AACjC,SAAK,KAAL,GAAa,IAAb;AACA,SAAK,UAAL,CAAgB,IAAhB,GAAuB,IAAvB;;AACA,SAAK,iBAAL;AAEA,GALM;AAOP;;;AACO,sCAAP,UAAgB,KAAhB,EAAwC;AACvC,SAAK,MAAL,GAAc,KAAd;AACA,GAFM,CAhKR,CAoKC;;;AACO,4CAAP,UAAsB,KAAtB,EAA8C,UAA9C,EAAgF,IAAhF,EAAoG;AACnG,SAAK,gBAAL,GAAwB,KAAxB;AACA,SAAK,qBAAL,GAA6B,UAA7B;AACA,SAAK,eAAL,GAAuB,IAAvB;AACA,GAJM,CArKR,CA2KC;;;AACO,qCAAP,UAAe,KAAf,EAAwC,oBAAxC,EAA8E,cAA9E,EAA4G;AAC3G,SAAK,MAAL,GAAc,KAAd;AACA,SAAK,qBAAL,GAA6B,oBAA7B;AACA,SAAK,eAAL,GAAuB,cAAvB;AACA,GAJM,CA5KR,CAkLC;AACA;;;AACO,sCAAP;AAEC,SAAK,WAAL,GAAmB,MAAM,CAAC,UAA1B;;AAEA,QAAI,KAAK,OAAT,EAAkB;AACjB;AACA,WAAK,UAAL,CAAgB,GAAhB,GAAsB,IAAtB;;AACA,WAAK,iBAAL;AACA,KARF,CAUC;;;AACA,QAAI,KAAK,aAAT,EAAwB;AACvB,WAAK,MAAL;;AACA;AACA,KAdF,CAgBC;;;AACA,SAAK,kBAAL;AAEA,GAnBM;AAqBP;;;AACO,iCAAP;AACC,QAAI,KAAK,KAAT,EAAgB;AACf,WAAK,WAAL;AACA,KAFD,MAEO;AACN,WAAK,mBAAL,GAA4B,IAA5B;AACA;AACD,GANM;AAQP;;;AACO,oCAAP;AAAA;;AACC,SAAK,OAAL,GAAe,KAAf;;AACA,SAAK,gBAAL,CAAsB,SAAtB,CAAgC,KAAhC;;AACA,SAAK,gBAAL,CAAsB,mBAAtB,CAA0C,KAA1C;;AACA,SAAK,SAAL,CAAe,MAAf,GAAwB,UAAU,CAAE;AAAM,kBAAI,CAAJ;AAA0B,KAAlC,EAAoC,GAApC,CAAlC;AACA,GALM;AAOP;;;AACO,mDAAP;AAEC,QAAI,KAAK,eAAT,EAA0B;AACzB,WAAK,iBAAL;;AACA,WAAK,eAAL,CAAqB,OAArB,GAA+B,KAA/B;AACA,WAAK,GAAL,CAAS,WAAT,CAAqB,KAAK,SAA1B,EAAqC,SAArC;AACA;AACD,GAPM;AASP;;;AACO,mCAAP,UAAa,QAAb,EAAiD,UAAjD,EAA4E;AAA/D;AAAA;AAAkC;;AAAE;AAAA;AAA2B,MAE3E;;;AACA,SAAK,4BAAL;;AAEA,SAAK,eAAL,CAAqB,OAArB,GAA+B,IAA/B;AACA,QAAI,CAAC,QAAL,CAAc,GAAd,CAAkB,CAAC,KAAK,SAAN,EAAiB,QAAQ,CAAC,aAAT,CAAuB,QAAvB,CAAjB,CAAlB,EAAsE;AAAC,eAAS,EAAE,CAAZ;AAAe,WAAK,EAAE;AAAtB,KAAtE;AACA,SAAK,OAAL,GAAe,CAAf;;AACA,SAAK,gBAAL,CAAsB,SAAtB,CAAgC,OAAhC;;AAEA,QAAK,KAAK,QAAL,KAAkB,QAAQ,KAAK,IAAb,IAAqB,QAAQ,CAAC,OAAT,KAAqB,oBAAY,OAAxE,CAAL,EAAuF;AACtF,WAAK,cAAL;;AACA,WAAK,WAAL;;AACA,WAAK,OAAL,CAAa,KAAb;;AACA,WAAK,OAAL,CAAa,cAAb,CAA4B,CAA5B;;AACA,UAAI,CAAC,QAAL,CAAc,GAAd,CAAkB,KAAK,OAAL,CAAa,UAA/B,EAA2C;AAAC,SAAC,EAAE,GAAJ;AAAS,SAAC,EAAE;AAAZ,OAA3C;AACA,KAhB0E,CAkB3E;;;AACA,SAAK,GAAL,CAAS,QAAT,CAAkB,KAAK,SAAvB,EAAkC,SAAlC,EAnB2E,CAqB3E;;AACA,QAAI,UAAJ,EAAgB;AACf,WAAK,iBAAL;;AACA;AACA,KAzB0E,CA2B3E;;;AACA,QAAI,QAAQ,CAAC,OAAT,KAAqB,oBAAY,IAArC,EAA2C;AAC1C,WAAK,aAAL;AACA,KA9B0E,CAgC3E;;;AACA,QAAI,QAAQ,CAAC,OAAT,KAAqB,oBAAY,OAArC,EAA8C;AAC7C,WAAK,gBAAL;AACA;AAED,GArCM;AAuCP;;;;;;;AAKO,kCAAP,UAAY,QAAZ,EAAyC,UAAzC,EAAoE;AAA3B;AAAA;AAA2B;;AAEnE,SAAK,eAAL,CAAqB,OAArB,GAFmE,CAInE;;;AACA,QAAI,CAAC,QAAD,IAAa,UAAjB,EAA6B;AAC5B;AACA,WAAK,iBAAL;;AACA;AACA,KATkE,CAWnE;;;AACA,QAAI,QAAQ,CAAC,OAAT,KAAsB,oBAAY,IAAtC,EAA4C;AAC3C,WAAK,aAAL;AACA,KAdkE,CAgBnE;;;AACA,QAAI,QAAQ,CAAC,OAAT,KAAsB,oBAAY,OAAtC,EAA+C;AAC9C,WAAK,gBAAL;AACA;AAED,GArBM;AAuBP;;;;;;AAIO,kCAAP,UAAY,QAAZ,EAA8C;AAAlC;AAAA;AAAkC;;AAC7C,QAAI,QAAQ,CAAC,OAAT,KAAqB,oBAAY,IAArC,EAA2C;AAC1C,WAAK,YAAL;AACA,KAFD,MAEO,IAAI,QAAQ,CAAC,OAAT,KAAqB,oBAAY,IAArC,EAA2C;AACjD,WAAK,YAAL;AACA;;AACD,SAAK,OAAL,GAAgB,KAAhB;AACA,GAPM;AASP;;;AACO,mCAAP;AACC,SAAK,sBAAL,CAA4B,KAA5B;;AACA,QAAI,CAAC,QAAL,CAAc,EAAd,CAAiB,CAAC,KAAK,SAAN,EAAiB,QAAQ,CAAC,aAAT,CAAuB,QAAvB,CAAjB,CAAjB,EAAqE,IAArE,EAA2E;AAAC,WAAK,EAAE,GAAR;AAAa,UAAI,EAAE,IAAI,CAAC,MAAL,CAAY;AAA/B,KAA3E;AACA,GAHM;AAKP;;;AACO,qCAAP;AACC,SAAK,sBAAL,CAA4B,IAA5B;;AACA,QAAI,CAAC,QAAL,CAAc,EAAd,CAAiB,CAAC,KAAK,SAAN,EAAiB,QAAQ,CAAC,aAAT,CAAuB,QAAvB,CAAjB,CAAjB,EAAqE,IAArE,EAA2E;AAAC,WAAK,EAAE,CAAR;AAAW,UAAI,EAAE,IAAI,CAAC,MAAL,CAAY;AAA7B,KAA3E;AACA,GAHM;AAKP;;;;;;AAIO,oDAAP,UAA8B,KAA9B,EAA2C;AAC1C,SAAK,OAAL;AACA,SAAK,mBAAL,GAA2B,KAA3B;;AACA,SAAK,gBAAL,CAAsB,QAAtB,CAA+B,KAA/B;AACA,GAJM;AAMP;;;AACO,oCAAP;AAAA;;AAEC,QAAI,CAAC,KAAK,OAAV,EAAmB;AAClB;AACA;;AAED,SAAK,gBAAL;;AACA,SAAK,WAAL,GAAmB,MAAM,CAAC,UAA1B;AACA,QAAI,WAAJ;;AACA,SAAK,MAAL,CAAY,OAAZ,CAAoB,UAAC,IAAD,EAAK;AACxB;AACA,UAAI,IAAI,KAAK,KAAI,CAAC,kBAAlB,EAAsC;AACrC,YAAI,CAAC,MAAL;AACA;AACD,KALD;AAOA,GAhBM;AAkBP;;;AACO,kCAAP;AACC,QAAI,KAAK,QAAL,IAAiB,KAAK,OAA1B,EAAmC;AAClC,WAAK,qBAAL;;AACA,WAAK,gBAAL;;AACA,WAAK,uBAAL;;AACA,WAAK,uBAAL;AACA;AACD,GAPM;AASP;;;;;;AAIO,iDAAP,UAA2B,WAA3B,EAAwD;AACvD,SAAK,qBAAL,GAA6B,WAA7B;;AACA,SAAK,2BAAL;;AACA,WAAO,CAAC,GAAR,CAAY,OAAZ,EAAqB,KAAK,WAA1B,EAAuC,QAAvC,EAAiD,KAAK,UAAtD;AACA,GAJM,CA5WR,CAkXC;;;AACO,mDAAP,UAA6B,WAA7B,EAA4D,UAA5D,EAAsF;AACrF,SAAK,sBAAL,GAA8B,WAA9B;;AACA,SAAK,2BAAL;AACA,GAHM,CAnXR,CAwXC;AACA;AACA;AAEA;AACA;;AAEA;;;AACQ,+CAAR;AACC,SAAK,aAAL,GAAuB,KAAK,UAAL,CAAgB,GAAhB,IAAuB,KAAK,UAAL,CAAgB,IAAvC,IAA+C,KAAK,UAAL,CAAgB,IAAtF;AACA,GAFO;AAIR;;;AACQ,yCAAR,UAAoB,UAApB,EAA+C;AAA/C;;AAAoB;AAAA;AAA2B,MAE9C;;;AACA,QAAI,KAAK,eAAT,EAA0B;AACzB;AACA;;AAED,SAAK,GAAL,CAAS,MAAT,CAAgB,QAAQ,CAAC,aAAT,CAAuB,MAAvB,CAAhB,EAAgD,KAAK,KAArD,EAA4D;AAC3D,WAAI,CAAC,SAAL,GAAiB,QAAQ,CAAC,aAAT,CAAuB,YAAU,KAAI,CAAC,WAAtC,CAAjB;AACA,WAAI,CAAC,OAAL,GAAgB,KAAI,CAAC,SAAL,CAAe,aAAf,CAA6B,sBAA7B,CAAhB;AACA,WAAI,CAAC,YAAL,GAAoB,KAAI,CAAC,SAAL,CAAe,aAAf,CAA6B,mBAA7B,CAApB;;AACA,WAAI,CAAC,MAAL,CAAY,qBAAZ,CAAkC,KAAI,CAAC,SAAvC;;AACA,UAAK,UAAL,EAAkB;AACjB,kBAAU;AACV;AACD,KARD;AAUA,SAAK,eAAL,GAAuB,IAAvB;AACA,SAAK,mBAAL,GAA2B,KAA3B;AACA,GAnBO;AAqBR;;;AACQ,gDAAR;AACC,QAAI,KAAK,mBAAL,IAA4B,KAAK,aAArC,EAAqD;AACpD,WAAK,WAAL;AACA;AACD,GAJO;AAMR;;;AACQ,oCAAR;AAAA;;AAEC,QAAI,KAAK,QAAT,EAAmB;AAClB;AACA,KAJF,CAMC;;;AACA,QAAI,CAAC,KAAK,SAAV,EAAqB;AACpB,WAAK,WAAL,CAAiB;AAAM,oBAAI,CAAJ;AAAa,OAApC;;AACA;AACA;;AAED,SAAK,OAAL,GAAgB,KAAK,SAAL,CAAe,aAAf,CAA6B,sBAA7B,CAAhB;AACA,SAAK,YAAL,GAAoB,KAAK,SAAL,CAAe,aAAf,CAA6B,mBAA7B,CAApB;;AAEA,SAAK,UAAL;;AACA,SAAK,YAAL;;AACA,SAAK,aAAL;;AACA,SAAK,QAAL,GAAgB,IAAhB,CAlBD,CAoBC;;AACA,QAAI,IAAI,GAAc,KAAK,WAAL,KAAqB,uBAAe,OAArC,GAAgD,iBAAS,OAAzD,GAAmE,iBAAS,MAAjG;AACA,oBAAO,QAAP,CAAgB,IAAI,+BAAJ,CAAmB;AAClC,UAAI,EAAE;AAD4B,KAAnB,CAAhB,EAEI;AAAC,WAAK,EAAE;AAAR,KAFJ;AAIA,GA1BO;AA4BR;;;AACQ,8CAAR;AAEC,QAAK,MAAM,CAAC,UAAP,IAAqB,GAA1B,EAA+B;AAC9B,WAAK,gBAAL,CAAsB,eAAtB,CAAsC,KAAK,MAAL,CAAY,MAAZ,GAAqB,MAAM,CAAC,UAAlE;;AACA;AACA;;AAED,SAAK,gBAAL,CAAsB,eAAtB,CAAuC,KAAK,MAAL,CAAY,MAAZ,GAAqB,MAAM,CAAC,UAA7B,GAA2C,GAAjF;AAEA,GATO;AAWR;;;AACQ,0CAAR;AACC,SAAK,OAAL,GAAe,IAAI,eAAJ,EAAf;;AACA,SAAK,OAAL,CAAa,YAAb,CAA2B,KAAK,SAAL,CAAe,aAAf,CAA6B,MAAI,KAAK,WAAT,GAAoB,SAAjD,CAA3B;;AACA,SAAK,OAAL,CAAa,EAAb,GAAsB,KAAK,WAAL,GAAgB,SAAtC;;AACA,SAAK,OAAL,CAAa,MAAb;;AACA,SAAK,OAAL,CAAa,YAAb,CAA0B,KAAK,YAAL,CAAkB,IAAlB,CAAuB,IAAvB,CAA1B;AACA,GANO;AAQR;;;AACQ,2CAAR;AACC;AACA,oBAAO,EAAP,CAAU,OAAV,EAAoB,YAAU,KAAK,WAAf,GAA0B,mBAA9C,EAAmE,KAAK,sBAAL,CAA4B,IAA5B,CAAiC,IAAjC,CAAnE;AACA,oBAAO,EAAP,CAAU,OAAV,EAAoB,mBAApB,EAAyC,KAAK,kBAAL,CAAwB,IAAxB,CAA6B,IAA7B,CAAzC;AACA,oBAAO,EAAP,CAAU,2CAAV,EAAiC,KAAK,aAAL,CAAmB,IAAnB,CAAwB,IAAxB,CAAjC;AACA,oBAAO,EAAP,CAAU,uCAAV,EAA+B,KAAK,WAAL,CAAiB,IAAjB,CAAsB,IAAtB,CAA/B;AACA,GANO;AAQR;;;AACQ,yDAAR;AAEC,QAAI,KAAK,qBAAL,IAA8B,KAAK,sBAAnC,IAA6D,CAAC,KAAK,MAAvE,EAA+E;AAC9E,WAAK,UAAL,CAAgB,IAAhB,GAAuB,IAAvB;;AACA,WAAK,iBAAL;AACA,KALF,CAOC;;;AACA,QAAI,KAAK,OAAL,IAAgB,KAAK,aAAzB,EAAwC;AACvC,WAAK,MAAL;;AACA;AACA,KAXF,CAaC;;;AACA,SAAK,kBAAL;AAEA,GAhBO;AAkBR;;;AACQ,wCAAR;AACC,SAAK,gBAAL;;AACA,SAAK,kBAAL;AACA,GAHO;AAKR;;;AACQ,8CAAR;AAAA;;AAEC,QAAI,QAAQ,GAA4B,KAAK,KAAL,CAAW,QAAnD;AACA,QAAI,SAAJ;AACA,SAAK,MAAL,GAAc,EAAd,CAJD,CAMC;;AACA,QAAI,IAAI,GAAiB,IAAI,2BAAJ,CAAiB,IAAjB,EAAuB,IAAvB,EAA6B,IAA7B,EAAmC,IAAnC,EAAyC,IAAzC,CAAzB;;AACA,SAAK,MAAL,CAAY,IAAZ,CAAiB,IAAjB,EARD,CAUC;;;AACA,YAAQ,CAAC,OAAT,CAAkB,UAAC,OAAD,EAA4B,KAA5B,EAAyC;AAE1D;AACA,eAAS,GAAG,KAAZ,CAH0D,CAI1D;;AACA,UAAI,IAAI,GAAiB,IAAI,2BAAJ,CAAiB,KAAI,CAAC,eAAtB,EAAuC,SAAvC,EAAkD,OAAlD,EAA2D,KAAI,CAAC,eAAhE,EAAiF,KAAI,CAAC,SAAtF,CAAzB;AACA,UAAI,CAAC,eAAL,CAAqB,KAAI,CAAC,qBAA1B,EAAiD,KAAI,CAAC,sBAAtD;AACA,UAAI,CAAC,UAAL,CAAiB,KAAI,CAAC,MAAL,CAAY,GAAZ,CAAmB,KAAI,CAAC,WAAL,GAAgB,WAAhB,GAA4B,KAA/C,CAAjB,EAP0D,CAS1D;;AACA,UAAI,CAAC,gBAAL,GAAwB,UAAC,IAAD,EAAK;AAC5B,gBAAG,KAAH,CAAS,IAAT,EAAe,kCAAf,EAAmD,IAAI,CAAC,IAAxD;;AACA,aAAI,CAAC,gBAAL,CAAsB,IAAI,CAAC,IAA3B,EAAiC,IAAI,CAAC,KAAL,GAAa,CAA9C,EAAiD,IAAI,CAAC,IAAtD,EAA4D,IAAI,CAAC,KAAjE;AACA,OAHD;;AAKA,UAAI,CAAC,MAAL;;AACA,WAAI,CAAC,MAAL,CAAY,IAAZ,CAAiB,IAAjB;AAEA,KAlBD;AAoBA,SAAK,eAAL,GAAuB,MAAM,KAAK,MAAL,CAAY,MAAzC,CA/BD,CAiCC;AACA;AACA;;AACA,SAAK,aAAL,GAAsB,KAAK,mBAAL,GAA4B,KAAK,eAAvD,CApCD,CAsCC;;AACA,SAAK,mBAAL,GAvCD,CAyCC;;;AACA,SAAK,iBAAL,GAAyB,IAAI,KAAK,MAAL,CAAY,MAAzC;AAEA,GA5CO;;AA8CA,gDAAR;AAAA;;AAEC,QAAI,KAAK,gBAAT,EAA2B;AAC1B;AACA,KAJF,CAMC;;;AACA,SAAK,gBAAL,GAAwB,IAAI,iCAAJ,CAAoB,KAAK,MAAL,CAAY,MAAhC,EAAwC,IAAxC,EAA8C,CAA9C,EAAiD,KAAjD,CAAxB;AAEA,QAAK,eAAe,GAAY,MAAO,MAAM,KAAK,MAAL,CAAY,MAAzD;;AACA,SAAK,gBAAL,CAAsB,cAAtB,CAAqC,CAArC,EAAwC,eAAxC;;AACA,SAAK,gBAAL,CAAsB,kBAAtB,CAAyC,KAAK,KAAL,CAAW,eAApD;;AACA,SAAK,gBAAL,CAAsB,SAAtB,GAAkC,KAAK,KAAL,CAAW,SAA7C;AACA,SAAK,gBAAL,CAAsB,gBAAtB,GAAyC,KAAK,KAAL,CAAW,SAApD;AACA,SAAK,gBAAL,CAAsB,SAAtB,GAAkC,KAAlC;;AACA,SAAK,gBAAL,CAAsB,WAAtB,CAAkC,CAAlC;;AAEA,SAAK,gBAAL,CAAsB,MAAtB,GAA+B,UAAC,aAAD,EAAsB;AAEpD,UAAI,CAAE,KAAI,CAAC,OAAX,EAAqB;AACpB;AACA;;AAED,WAAI,CAAC,cAAL,GAAuB,aAAa,GAAG,KAAI,CAAC,aAA5C;AACA,WAAI,CAAC,aAAL,GAAqB,aAArB;;AACA,WAAI,CAAC,mBAAL;;AACA,WAAI,CAAC,qBAAL;;AACA,WAAI,CAAC,oBAAL;;AACA,WAAI,CAAC,cAAL;;AACA,WAAI,CAAC,kBAAL;;AACA,WAAI,CAAC,eAAL,CAAqB,KAAI,CAAC,cAA1B;AACA,KAdD;;AAgBA,SAAK,gBAAL,CAAsB,WAAtB,GAAoC;AAEnC,UAAI,CAAC,KAAI,CAAC,OAAV,EAAmB;AAClB;AACA,OAJkC,CAMnC;;;AACA,WAAI,CAAC,gBAAL,CAAsB,WAAtB,CAAkC,IAAlC,EAAwC,IAAxC,EAA8C,GAA9C,EAPmC,CASnC;;;AACA,WAAI,CAAC,wBAAL,GAVmC,CAYnC;;;AACA,WAAI,CAAC,wBAAL,GAAgC,KAAhC;AAEA,KAfD;;AAiBA,SAAK,gBAAL,CAAsB,UAAtB,GAAmC;AAClC,WAAI,CAAC,gBAAL,CAAsB,WAAtB,CAAkC,KAAlC,EADkC,CAElC;;;AACA,WAAI,CAAC,sBAAL;AACA,KAJD;;AAMA,SAAK,gBAAL,CAAsB,MAAtB,GAA+B,UAAC,SAAD,EAAkB;AAChD,WAAI,CAAC,gBAAL,CAAsB,SAAtB;;AACA,WAAI,CAAC,gBAAL,CAAsB,WAAtB,CAAkC,KAAlC;AACA,KAHD;;AAKA,SAAK,gBAAL,CAAsB,SAAtB,CAAgC,KAAhC;AAEA,GA/DO;AAiER;;;AACQ,sDAAR;AAAA;;AACC,SAAK,MAAL,CAAY,OAAZ,CAAoB,UAAC,IAAD,EAAmB;AACtC,UAAI,IAAI,CAAC,SAAT,EAAoB;AACnB,YAAI,CAAC,SAAL,CAAe,KAAI,CAAC,gBAAL,CAAsB,aAAtB,EAAf;AACA;AACD,KAJD;AAKA,GANO;AAQR;;;AACQ,oDAAR;AACC,SAAK,MAAL,CAAY,OAAZ,CAAoB,UAAC,IAAD,EAAmB;AACtC,UAAI,IAAI,CAAC,SAAL,IAAkB,IAAI,CAAC,gBAA3B,EAA6C;AAC5C,YAAI,CAAC,OAAL;AACA;AACD,KAJD;AAKA,GANO;AAQR;;;AACQ,mDAAR;AAAA;;AACC,SAAK,MAAL,CAAY,OAAZ,CAAoB,UAAC,IAAD,EAAmB;AACtC,UAAI,IAAI,CAAC,SAAL,IAAkB,IAAI,CAAC,gBAA3B,EAA6C;AAC5C,YAAI,CAAC,gBAAL,CAAsB,KAAI,CAAC,gBAAL,CAAsB,aAAtB,EAAtB;AACA;AACD,KAJD;AAKA,GANO,CAxnBT,CAgoBC;AACA;;AAEA;;;AACQ,0DAAR;AAAA;;AACC,UAAM,CAAC,IAAP,CAAY,KAAK,OAAjB,EAA0B,OAA1B,CAAmC,UAAC,GAAD,EAAY;AAC9C,WAAI,CAAC,OAAL,CAAa,GAAb,EAAkB,IAAlB;AACA,KAFD;AAGA,UAAM,CAAC,IAAP,CAAY,KAAK,SAAjB,EAA4B,OAA5B,CAAqC,UAAC,GAAD,EAAY;AAChD,kBAAY,CAAC,KAAI,CAAC,SAAL,CAAe,GAAf,CAAD,CAAZ;AACA,KAFD;AAGA,UAAM,CAAC,IAAP,CAAY,KAAK,UAAjB,EAA6B,OAA7B,CAAsC,UAAC,GAAD,EAAY;AACjD,mBAAa,CAAC,KAAI,CAAC,UAAL,CAAgB,GAAhB,CAAD,CAAb;AACA,KAFD;AAGA,GAVO;AAYR;;;AACQ,+CAAR;AAEC;AACA,SAAK,qBAAL,CAA2B,KAA3B,CAAiC,KAAK,MAAtC,EAHD,CAKC;;;AACA,QAAI,CAAC,QAAL,CAAc,GAAd,CAAkB,KAAK,OAAvB,EAAgC;AAAC,OAAC,EAAE;AAAJ,KAAhC;AAEA,GARO;AAUR;;;AACQ,2CAAR;AACC,SAAK,eAAL,CAAqB,OAArB,GAA+B,KAA/B;AACA,QAAI,CAAC,QAAL,CAAc,GAAd,CAAkB,KAAK,OAAvB,EAAgC;AAAC,OAAC,EAAE,MAAM,CAAC,WAAP,GAAqB;AAAzB,KAAhC;AACA,GAHO;AAKR;;;AACQ,8CAAR,aACC;AACA,GAFO;AAIR;;;AACQ,4CAAR;AACC,SAAK,aAAL,GAAqB,CAArB;AACA,SAAK,aAAL,GAAqB,CAArB;AACA,SAAK,cAAL,GAAsB,CAAtB;;AACA,SAAK,gBAAL,CAAsB,WAAtB,CAAkC,CAAlC;AACA,GALO;AAOR;;;AACQ,yCAAR;AACC,SAAK,MAAL,CAAY,OAAZ,CAAqB,UAAC,IAAD,EAAmB;AAAK,iBAAI,CAAJ;AAAY,KAAzD;AACA,GAFO;AAIR;;;AACQ,iDAAR;AACC,SAAK,eAAL,CAAqB,OAArB,GAA+B,KAA/B;AACA,SAAK,GAAL,CAAS,WAAT,CAAqB,KAAK,SAA1B,EAAqC,SAArC;;AACA,SAAK,cAAL;;AACA,SAAK,WAAL;AACA,GALO,CAprBT,CA2rBC;AACA;;AAEA;;;AACQ,+CAAR;AAAA;;AAEI,SAAK,OAAL,GAAe,IAAf,CAFJ,CAIC;;AACC,SAAK,gBAAL,CAAsB,SAAtB,CAAgC,IAAhC;;AACD,SAAK,gBAAL,CAAsB,mBAAtB,CAA0C,IAA1C,EAND,CAQC;;;AACA,SAAK,MAAL;;AACA,SAAK,mBAAL;;AAEA,SAAK,OAAL,CAAa,IAAb;;AACA,SAAK,OAAL,CAAa,MAAb,GAAsB,IAAI,CAAC,QAAL,CAAc,EAAd,CACpB,KAAK,OAAL,CAAa,UADO,EAEpB,GAFoB,EAGpB;AAAC,OAAC,EAAE,CAAJ;AAAO,OAAC,EAAE,MAAV;AAAkB,UAAI,EAAE,IAAI,CAAC,MAAL,CAAY,OAApC;AAA6C,WAAK,EAAE;AAApD,KAHoB,CAAtB;AAMA,SAAK,SAAL,CAAe,MAAf,GAAwB,UAAU,CAAE;AACnC,WAAI,CAAC,gBAAL;AACA,KAFiC,EAE/B,IAF+B,CAAlC;AAMA,SAAK,SAAL,CAAe,UAAf,GAA4B,UAAU,CAAE;AAAM,kBAAI,CAAC,YAAL;AAAwB,KAAhC,EAAkC,IAAlC,CAAtC;AAEA,GA3BO;AA6BR;;;AACQ,2CAAR;AAAA;;AAEC,SAAK,gBAAL,CAAsB,mBAAtB,CAA0C,KAA1C,EAFD,CAGC;;;AAEA,QAAI,CAAC,QAAL,CAAc,GAAd,CAAkB,KAAK,OAAvB,EAAgC;AAAC,OAAC,EAAE,KAAK,OAAT;AAAkB,eAAS,EAAE;AAA7B,KAAhC;AACA,SAAK,OAAL,CAAa,IAAb,GAAoB,IAAI,CAAC,QAAL,CAAc,EAAd,CAAiB,KAAK,OAAtB,EAA+B,GAA/B,EAAoC;AAAC,OAAC,EAAE,CAAJ;AAAO,UAAI,EAAE,IAAI,CAAC,MAAL,CAAY,OAAzB;AAAkC,WAAK,EAAE,GAAzC;AAA8C,gBAAU,EAAE;AAEjH,YAAI,CAAC,KAAI,CAAC,QAAV,EAAoB;AACnB,eAAI,CAAC,MAAL;AACA;;AAED,aAAI,CAAC,gBAAL,CAAsB,SAAtB,CAAgC,IAAhC;;AACA,aAAI,CAAC,gBAAL,CAAsB,mBAAtB,CAA0C,IAA1C;;AACA,aAAI,CAAC,eAAL,CAAqB,OAArB,GAA+B,IAA/B;AACA,aAAI,CAAC,OAAL,GAAe,IAAf;;AACA,aAAI,CAAC,MAAL;;AACA,aAAI,CAAC,mBAAL;;AACA,aAAI,CAAC,gBAAL;;AACA,aAAI,CAAC,SAAL,CAAe,UAAf,GAA4B,UAAU,CAAE;AAAM,sBAAI,CAAC,YAAL;AAAwB,SAAhC,EAAkC,IAAlC,CAAtC;AAEA;AAfuD,KAApC,CAApB;;AAiBA,QAAI,KAAK,OAAT,EAAkB;AACjB,WAAK,OAAL,CAAa,IAAb;;AACA,WAAK,OAAL,CAAa,MAAb,GAAsB,IAAI,CAAC,QAAL,CAAc,EAAd,CACrB,KAAK,OAAL,CAAa,UADQ,EAErB,GAFqB,EAGrB;AAAC,SAAC,EAAE,CAAJ;AAAO,SAAC,EAAE,MAAV;AAAkB,YAAI,EAAE,IAAI,CAAC,MAAL,CAAY,OAApC;AAA6C,aAAK,EAAE;AAApD,OAHqB,CAAtB;AAKA;AAED,GAhCO;AAkCR;;;AACQ,8CAAR;AAAA,sBAEC;;;AACA,QAAI,KAAK,kBAAT,EAA6B;AAC5B,WAAK,kBAAL,CAAwB,eAAxB;AACA,KALF,CAOC;;;AACA,SAAK,OAAL,GAAe,IAAf;AACA,SAAK,MAAL;AACA,SAAK,OAAL,GAAe,KAAf,CAVD,CAYC;;AACA,SAAK,MAAL,CAAY,OAAZ,CAAqB,UAAC,IAAD,EAAqB,KAArB,EAAkC;AACtD,UAAI,KAAK,KAAK,CAAV,IAAe,IAAI,KAAK,KAAI,CAAC,kBAAjC,EAAqD;AACpD,YAAI,CAAC,eAAL;AACA;AACD,KAJD,EAbD,CAmBC;;;AACA,SAAK,kBAAL,GAA0B,IAA1B;;AACA,SAAK,qBAAL,CAA2B,WAA3B,CAAuC,IAAvC;;AACA,SAAK,SAAL,CAAe,WAAf,GAA6B,UAAU,CAAC;AACvC,WAAI,CAAC,qBAAL,CAA2B,mBAA3B;;AACA,WAAI,CAAC,sBAAL,CAA4B,IAA5B;;AACA,WAAI,CAAC,qBAAL,CAA2B,MAA3B;;AACA,WAAI,CAAC,OAAL,CAAa,IAAb;AACA,KALsC,EAKpC,IALoC,CAAvC;AAOA,SAAK,SAAL,CAAe,OAAf,GAAyB,UAAU,CAAC;AACnC,WAAI,CAAC,MAAL;AACA,KAFkC,EAEhC,IAFgC,CAAnC,CA7BD,CAiCC;;AACA,SAAK,eAAL,CAAqB,OAArB;AAEA,GApCO;AAsCR;;;AACQ,8CAAR;AACC,SAAK,kBAAL,GAA0B,IAA1B;;AACA,SAAK,OAAL,CAAa,gBAAb;AACA,GAHO,CAvyBT,CA4yBC;AACA;AAEA;;;AACQ,0CAAR;AAAA;;AACC,SAAK,OAAL,CAAa,SAAb,GAAyB,IAAI,CAAC,QAAL,CAAc,EAAd,CAAiB,CAAC,KAAK,SAAN,EAAiB,QAAQ,CAAC,aAAT,CAAuB,QAAvB,CAAjB,CAAjB,EAAqE,GAArE,EAA0E;AAClG,eAAS,EAAE,CADuF;AAElG,WAAK,EAAE,GAF2F;AAGjG,gBAAU,EAAE;AACZ,aAAI,CAAC,eAAL,CAAqB,OAArB,GAA+B,KAA/B;AACA;AALiG,KAA1E,CAAzB;AAOA,GARO,CAhzBT,CA0zBC;;;AACQ,0CAAR;AAAA;;AAEC,SAAK,OAAL,GAAe,KAAf;;AACA,SAAK,gBAAL,CAAsB,SAAtB,CAAgC,KAAhC;;AACA,SAAK,YAAL,GAAoB,KAApB;;AACA,SAAK,uBAAL;;AACA,SAAK,qBAAL,CAA2B,aAA3B,CAAyC,KAAK,WAA9C,EAND,CAQC;;;AACA,QAAI,CAAC,QAAL,CAAc,GAAd,CAAkB,KAAK,OAAvB,EAAgC;AAAC,OAAC,EAAE,KAAK;AAAT,KAAhC;AACA,SAAK,OAAL,CAAa,IAAb,GAAoB,IAAI,CAAC,QAAL,CAAc,EAAd,CAAiB,KAAK,OAAtB,EAA+B,GAA/B,EAAoC;AACvD,OAAC,EAAE,MAAM,CAAC,WAD6C;AAEvD,UAAI,EAAE,IAAI,CAAC,MAAL,CAAY,MAFqC;AAGvD,gBAAU,EAAE;AACX,aAAI,CAAC,GAAL,CAAS,WAAT,CAAqB,KAAI,CAAC,SAA1B,EAAqC,SAArC;;AACA,aAAI,CAAC,eAAL,CAAqB,OAArB,GAA+B,KAA/B;AACA;AANsD,KAApC,CAApB,CAVD,CAmBC;;AACA,SAAK,OAAL,CAAa,MAAb,GAAsB,IAAI,CAAC,QAAL,CAAc,EAAd,CAAiB,KAAK,OAAL,CAAa,UAA9B,EAA0C,GAA1C,EAA+C;AAAC,OAAC,EAAE,GAAJ;AAAS,UAAI,EAAE,IAAI,CAAC,MAAL,CAAY;AAA3B,KAA/C,CAAtB;AAEA,GAtBO,CA3zBT,CAm1BC;;AAEA;;;AACQ,oDAAR,UAA+B,OAA/B,EAA+C;AAC9C,SAAK,OAAL,GAAe,OAAf;;AACA,SAAK,gBAAL,CAAsB,SAAtB,CAAgC,OAAhC;;AACA,SAAK,gBAAL,CAAsB,mBAAtB,CAA0C,OAA1C;AACA,GAJO;;AAMA,0CAAR,UAAqB,KAArB,EAAkC;AAAlC;;AACC,SAAK,gBAAL,CAAsB,QAAtB,CAA+B,KAA/B;;AACA,SAAK,gBAAL,CAAsB,KAAtB;;AACA,SAAK,kBAAL,CAAwB,KAAxB;;AACA,SAAK,wBAAL,GAAiC,IAAjC;AACA,iBAAa,CAAC,KAAK,SAAL,CAAe,aAAhB,CAAb;AACA,SAAK,SAAL,CAAe,aAAf,GAA+B,UAAU,CAAC;AACzC,WAAI,CAAC,wBAAL,GAAgC,KAAhC;AACA,KAFwC,EAEtC,IAFsC,CAAzC;AAGA,GATO;;AAWA,8CAAR,UAAyB,KAAzB,EAAsC;AACrC,SAAK,kBAAL,GAA0B,KAAK,MAAL,CAAY,KAAZ,CAA1B;;AACA,SAAK,OAAL,CAAa,cAAb,CAA4B,KAA5B;AACA,GAHO,CAv2BT,CA42BC;AACA;;;AACQ,oDAAR,UAA+B,CAA/B,EAA4C;AAC3C,KAAC,CAAC,cAAF;AACA,KAAC,CAAC,eAAF;AACA,SAAK,GAAL,CAAS,QAAT,CAAkB,CAAC,CAAC,MAApB,EAA2C,UAA3C;AACA,QAAI,IAAI,GAAG,KAAK,GAAL,CAAS,YAAT,CAAsB,CAAC,CAAC,MAAxB,EAAgC,WAAhC,CAAX;AACA,QAAI,KAAK,GAAG,KAAK,GAAL,CAAS,YAAT,CAAsB,CAAC,CAAC,MAAxB,EAAgC,YAAhC,CAAZ;AACA,QAAI,IAAI,GAAG,KAAK,GAAL,CAAS,YAAT,CAAsB,CAAC,CAAC,MAAxB,EAAgC,MAAhC,CAAX;AACA,QAAI,KAAK,GAAG,QAAQ,CAAC,KAAK,GAAL,CAAS,YAAT,CAAsB,CAAC,CAAC,MAAxB,EAAgC,YAAhC,CAAD,EAAgD,EAAhD,CAAR,GAA8D,CAA1E;AAEA,YAAG,KAAH,CAAS,IAAT,EAAe,+BAAf,EAAgD,IAAhD;;AAEA,SAAK,gBAAL,CAAsB,IAAtB,EAA4B,KAA5B,EAAmC,IAAnC,EAAyC,KAAzC;;AACA,WAAO,KAAP;AACA,GAbO;AAeR;;;AACQ,gDAAR,UAA2B,CAA3B,EAAwC;AAEvC,KAAC,CAAC,cAAF,GAFuC,CAIvC;;AACA,QAAI,QAAQ,GAAsB;AACjC,aAAO,EAAE,oBAAY,IADY;AAEjC,WAAK,EAAE,MAF0B;AAGjC,UAAI,EAAE;AAH2B,KAAlC;AAKA,oBAAO,QAAP,CAAgB,sBAAU,cAA1B,EAA0C,QAA1C;AAEA,YAAG,KAAH,CAAS,IAAT,EAAe,4BAAf,EAA6C,KAAK,MAAL,CAAY,UAAzD;AAEA,WAAO,KAAP;AAEA,GAhBO,CA93BT,CAg5BC;;;AACQ,8CAAR,UAAyB,IAAzB,EAAuC,KAAvC,EAAsD,IAAtD,EAAoE,KAApE,EAAiF;AAAjF,qBAAiF,CAEhF;;;AACA,SAAK,OAAL,CAAa,IAAb;;AACA,SAAK,kBAAL,GAA0B,KAAK,MAAL,CAAY,KAAZ,CAA1B;;AACA,SAAK,kBAAL,CAAwB,gBAAxB;;AACA,SAAK,gBAAL,CAAsB,SAAtB,CAAgC,KAAhC;;AACA,SAAK,gBAAL,CAAsB,KAAtB,EAPgF,CAShF;;;AACA,SAAK,SAAL,CAAe,UAAf,GAA4B,UAAU,CAAE;AAAM,kBAAI,CAAC,eAAL;AAA4B,KAApC,EAAsC,IAAtC,CAAtC;;AAEA,SAAK,qBAAL,CAA2B,WAA3B,CAAuC,IAAvC,EAZgF,CAchF;;;AACA,QAAI,QAAQ,GAAsB;AACjC,aAAO,EAAE,oBAAY,OADY;AAEjC,gBAAU,EAAE,KAAK,WAFgB;AAGjC,iBAAW,EAAE,IAHoB;AAIjC,WAAK,EAAE,KAJ0B;AAKjC,UAAI,EAAE,KAAG;AALwB,KAAlC;AAOA,oBAAO,QAAP,CAAgB,sBAAU,cAA1B,EAA0C,QAA1C,EAAoD;AAAC,WAAK,EAAE;AAAR,KAApD;AAEA,GAxBO;AA0BR;;;AACS,8CAAR,UAAyB,SAAzB,EAA+C;AAAtB;AAAA,mBAAqB,CAArB;AAAsB;;AAC9C,SAAK,MAAL,CAAY,OAAZ,CAAoB,UAAC,IAAD,EAAO,KAAP,EAAY;AAC/B,UAAI,KAAK,KAAK,CAAV,IAAe,KAAK,KAAK,SAA7B,EAAwC;AACvC,YAAI,CAAC,cAAL;AACA;AACD,KAJD;AAKA,GANO;;AAQC,+CAAR,UAA0B,SAA1B,EAAgD;AAAtB;AAAA,mBAAqB,CAArB;AAAsB;;AAChD,SAAK,MAAL,CAAY,OAAZ,CAAoB,UAAC,IAAD,EAAO,KAAP,EAAY;AAC/B,UAAI,KAAK,KAAK,CAAV,IAAe,KAAK,KAAK,SAA7B,EAAwC;AACvC,YAAI,CAAC,eAAL;AACA;AACD,KAJD;AAKA,GANQ;AAQT;;;AACQ,qDAAR;AAEC,QAAI,CAAC,KAAK,kBAAV,EAA8B;AAC7B;AACA;;AAED,QAAI,KAAK,aAAL,GAAqB,CAAzB,EAA4B;AAC3B,WAAK,kBAAL,GAA0B,KAA1B;;AACA,WAAK,OAAL,CAAa,iBAAb;AACA;AAED,GAXO;AAaT;;;AACQ,4CAAR;AAEC,QAAI,KAAK,kBAAT,EAA6B;AAC5B;AACA;;AAED,SAAK,kBAAL;;AACA,QAAI,CAAC,KAAK,wBAAN,IAAkC,KAAK,kBAAL,IAA2B,CAAjE,EAAoE;AAEnE,UAAI,QAAQ,GAAW,KAAK,OAAL,CAAa,cAAb,EAAvB;;AACA,UAAI,QAAQ,GAAW,KAAK,OAAL,CAAa,mBAAb,CAAkC,KAAK,aAAL,GAAqB,CAAvD,CAAvB;;AACA,WAAK,kBAAL,GAA0B,EAA1B;;AAEA,UAAI,QAAQ,KAAK,QAAjB,EAA2B;AAC1B,aAAK,kBAAL,CAAwB,QAAxB;;AACA,gBAAG,KAAH,CAAS,UAAT,EAAqB,YAAU,KAAK,MAAL,CAAY,UAAtB,GAAgC,sBAArD,EAA6E,WAAS,QAAtF;AACA;AAED;AACD,GAnBO;AAqBR;;;AACQ,gDAAR,UAA2B,KAA3B,EAAwC;AACvC;AACA;AACA,SAAK,aAAL,GAAqB,KAArB;AACA,oBAAO,QAAP,CAAgB,IAAI,iCAAJ,CAAoB;AACnC,UAAI,EAAE,KAAK,OAAL,CAAa,aAAb,CAA2B,KAAK,aAAhC,CAD6B;AAEnC,WAAK,EAAE;AAF4B,KAApB,CAAhB;AAIA,GARO;AAUR;;;AACQ,qDAAR;AAEC,QAAI,CAAC,KAAK,YAAV,EAAwB;AACvB;AACA;;AAGD,QAAI,CAAC,KAAK,oBAAN,IAA+B,KAAK,eAAL,EAAnC,EAA4D;AAC3D,WAAK,oBAAL,GAA4B,IAA5B;AACA,WAAK,GAAL,CAAS,QAAT,CAAkB,KAAK,YAAvB,EAAqC,OAArC;AACA,KAHD,MAGO,IAAI,KAAK,oBAAL,IAA6B,CAAC,KAAK,eAAL,EAAlC,EAA2D;AACjE,WAAK,oBAAL,GAA4B,KAA5B;AACA,WAAK,GAAL,CAAS,WAAT,CAAqB,KAAK,YAA1B,EAAwC,OAAxC;AACA;AAED,GAfO;AAiBR;;;AACQ,6CAAR;AAEC,QAAI,KAAK,YAAL,IAAqB,KAAK,cAA1B,IAA4C,KAAK,aAAL,IAAuB,KAAK,eAAL,GAAuB,IAA1F,KAAoG,KAAK,aAAL,GAAqB,MAArB,IAA+B,KAAK,SAAL,IAAkB,CAArJ,CAAJ,EAA6J;AAC5J,aAAO,IAAP;AACA;;AAED,WAAO,KAAP;AAEA,GARO;AAUR;;;AACQ,iDAAR;AAEC;AACA,SAAK,eAAL,GAAuB,KAAK,aAAL,GAAqB,CAA5C;AACA,SAAK,OAAL,GAAgB,KAAK,eAAL,GAAwB,KAAK,eAA9B,GAAiD,KAAK,eAArE,CAJD,CAMC;;AACA,SAAK,IAAI,CAAC,GAAG,CAAb,EAAgB,CAAC,GAAG,KAAK,MAAL,CAAY,MAAhC,EAAwC,CAAC,EAAzC,EAA6C;AAC5C;AACA;AACA;AACA;AACA;AACA,WAAK,KAAL,GAAa,CAAC,CAAC,GAAG,CAAL,IAAW,KAAK,eAA7B;AACA,WAAK,UAAL,GAAkB,KAAK,KAAL,GAAa,KAAK,OAApC;;AACA,WAAK,MAAL,CAAY,CAAZ,EAAe,mBAAf,CAAmC,KAAK,UAAxC,EAAoD,KAApD;AACA;AAED,GAlBO;AAoBR;;;AACQ,mDAAR;AACC,QAAI,CAAC,KAAK,aAAN,IAAuB,KAAK,aAAL,IAAsB,KAAK,iBAAtD,EAAyE;AACxE,WAAK,OAAL,CAAa,KAAb,CAAmB,UAAnB,GAAgC,SAAhC;AACA,WAAK,aAAL,GAAqB,IAArB;AACA,KAHD,MAGO,IAAI,KAAK,aAAL,IAAsB,KAAK,aAAL,GAAqB,KAAK,iBAApD,EAAuE;AAC7E,WAAK,OAAL,CAAa,KAAb,CAAmB,UAAnB,GAAgC,QAAhC;AACA,WAAK,aAAL,GAAqB,KAArB;AACA;AACD,GARO;AAUR;;;AACQ,kDAAR;AAEC,QAAI,CAAC,KAAK,aAAV,EAAyB;AACxB;AACA;;AAED,QAAI,KAAK,OAAT,EAAkB;AACjB,WAAK,OAAL,GAAe,CAAC,CAAD,IAAM,KAAK,WAAL,IAAoB,KAAK,aAAL,GAAqB,KAAK,iBAA9C,CAAN,CAAf;AACA,WAAK,OAAL,CAAa,KAAb,CAAmB,SAAnB,GAA+B,gBAAe,KAAK,OAApB,GAA2B,KAA1D;AACA,WAAK,OAAL,CAAa,KAAb,CAAmB,OAAnB,GAA8B,MAAG,IAAK,KAAK,KAAK,aAAL,GAAqB,KAAK,iBAA/B,CAAR,CAA9B;AACA;AAED,GAZO;AAcR;;;AACQ,gDAAR;AAEC,QAAI,CAAC,KAAK,OAAV,EAAmB;AAClB;AACA,KAJF,CAMC;AACA;;;AACA,SAAK,eAAL,GAAwB,KAAK,aAAL,GAAqB,CAA7C;;AACA,SAAK,qBAAL,CAA2B,YAA3B,CAA0C,KAAK,eAA/C;AAEA,GAXO;AAaR;;;AACQ,6CAAR,UAAwB,cAAxB,EAA8C;AAC7C,SAAK,SAAL,IAAmB,cAAc,GAAG,KAAK,KAAL,CAAW,cAA/C;AACA,GAFO;AAIR;;;AACQ,8CAAR;AAAA;;AACC,SAAK,SAAL,IAAkB,KAAK,KAAL,CAAW,gBAA7B;AACA,SAAK,iBAAL,GAAyB,KAAK,IAAL,CAAU,SAAV,CAAoB,KAAK,SAAL,GAAiB,KAAK,KAAL,CAAW,cAAhD,EAAgE,KAAK,KAAL,CAAW,WAAX,GAAyB,CAAC,CAA1F,EAA6F,KAAK,KAAL,CAAW,WAAxG,CAAzB;AACA,SAAK,iBAAL,IAA0B,CAAC,CAA3B;AACA,SAAK,gBAAL,GAAwB,KAAK,iBAAL,GAAyB,IAAI,CAAC,EAA9B,GAAmC,GAA3D;;AACA,SAAK,MAAL,CAAY,OAAZ,CACC,UAAC,IAAD,EAAmB;AAAK,iBAAI,CAAC,mBAAL,CAA0B,KAAI,CAA9B;AAAiD,KAD1E;AAGA,GARO,CA3kCT,CAqlCC;;;AACQ,mDAAR,UAA8B,IAA9B,EAA0C;AACzC,WAAO,KAAK,MAAL,CAAY,CAAZ,CAAP;AACA,GAFO,CAtlCT,CA0lCC;AACA;;;AACQ,2CAAR,UAAsB,KAAtB,EAAiD;AAEhD,QAAI,CAAC,KAAK,OAAN,IAAiB,KAAK,wBAA1B,EAAoD;AACnD;AACA;;AAED,SAAK,YAAL,CAAkB,KAAK,IAAL,CAAU,SAAV,CAAoB,KAAK,OAAL,CAAa,cAAb,KAAiC,CAAC,CAAD,GAAK,KAAK,CAAC,KAAhE,EAAwE,CAAxE,EAA2E,KAAK,MAAL,CAAY,MAAZ,GAAqB,CAAhG,CAAlB;AAEA,GARO;;AAUA,yCAAR,UAAoB,KAApB,EAA6C;AAE5C,QAAI,CAAC,KAAK,OAAV,EAAmB;AAClB;AACA;;AAED,QAAI,SAAS,GAAI,KAAK,CAAC,OAAN,KAAkB,2BAAmB,IAArC,IAA6C,KAAK,CAAC,OAAN,KAAkB,2BAAmB,OAAnF,GAA8F,CAAC,CAA/F,GAAmG,CAAnH;;AACA,SAAK,YAAL,CAAkB,KAAK,IAAL,CAAU,SAAV,CAAoB,KAAK,OAAL,CAAa,cAAb,KAAgC,SAApD,EAA+D,CAA/D,EAAkE,KAAK,MAAL,CAAY,MAAZ,GAAqB,CAAvF,CAAlB;AAEA,GATO;AAWR;;;AACQ,0CAAR,UAAqB,KAArB,EAA0C;AACzC,QAAI,KAAK,CAAC,IAAN,KAAe,iBAAS,IAA5B,EAAkC;AACjC,WAAK,cAAL,GAAsB,IAAtB;AACA;AACD,GAJO,CAlnCT,CAwnCC;AACA;;;AAEQ,2CAAR,UAA4C,MAA5C,EAAyD,SAAzD,EAAqE;AACpE,UAAM,CAAC,IAAP,CAAY,UAAS,CAAT,EAAe,CAAf,EAAmB;AAC9B,aAAQ,CAAC,CAAC,SAAD,CAAD,GAAwB,CAAC,CAAC,SAAD,CAAjC;AACA,KAFD;AAGA,WAAO,MAAP;AACA,GALO;;AAOA,iDAAR,UAA+B,MAA/B,EAA4C,SAA5C,EAA0D;AAEzD,UAAM,CAAC,IAAP,CAAY,UAAS,CAAT,EAAe,CAAf,EAAmB;AAC9B,aAAQ,CAAC,CAAC,QAAD,CAAD,CAAY,SAAZ,IAAkC,CAAC,CAAC,QAAD,CAAD,CAAY,SAAZ,CAA1C;AACA,KAFD;AAIA,WAAO,MAAP;AAEA,GARO;;AAUT;AAAC,CA5oCD,CAAoC,uBAApC;;AAAa,wC;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACzBb,sH,CAEA;AACA;;;AAEA;;AACA;;AACA;;AACA;;AACA;;AAIA;;AAGA;;AAOA;;AAEA,IAAY,iBAAZ;;AAAA,WAAY,iBAAZ,EAA6B;AAC5B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CATD,EAAY,iBAAiB,GAAjB,0DAAiB,EAAjB,CAAZ;;AA2BA;AAAA;AAAA;AAAsC;;AAuDrC,4BAAY,eAAZ,EAA8C,MAA9C,EAAmE;AAAnE,gBAEC,kBAAM,kBAAN,KAAyB,IAF1B;;AArDO,4BAA0B,GAA1B;AAIC,oBAAmB,IAAnB;AACA,qBAAoB,KAApB;AACA,6BAA4B,KAA5B,CA+C2D,CA9CnE;;AAEQ,sBAAoB,GAApB;AACA,sBAAoB,CAApB;AAkBA,mBAA8B,EAA9B;AACA,uBAAkC,EAAlC;AAEA,yBAAkC,EAAlC;AAIA,sBAAiB,EAAjB;AACA,oBAAe,EAAf;AACA,uBAAkB,EAAlB;AAEA,mBAA6B,iBAAiB,CAAC,KAA/C;AAWA,sCAAqC,KAArC;AACA,qCAAoC,KAApC;AAKP,SAAI,CAAC,sBAAL,GAA8B,IAAI,6CAAJ,EAA9B;AACA,SAAI,CAAC,gBAAL,GAAwB,eAAxB;AACA,SAAI,CAAC,IAAL,GAAY,sBAAU,GAAtB;AACA,SAAI,CAAC,OAAL,GAAe,MAAf;;AAIA;;AAED,wBAAW,0BAAX,EAAW,YAAX,EAAqB;SAArB;AACC,aAAO,KAAK,WAAZ;AACA,KAFoB;oBAAA;;AAAA,GAArB;AAIA,wBAAW,0BAAX,EAAW,UAAX,EAAmB;SAAnB;AACC,aAAO,KAAK,SAAZ;AACA,KAFkB;oBAAA;;AAAA,GAAnB;;AAIO,sCAAP,aAEC,CAFM;AAIP;;;AACO,mDAAP,UAA2B,cAA3B,EAA2D,WAA3D,EAAwF;AACvF,SAAK,MAAL;;AACA,SAAK,cAAL;;AACA,SAAK,eAAL,GAAuB,cAAvB;;AACA,SAAK,YAAL,CAAkB,cAAlB,EAAkC,WAAlC;;AACA,SAAK,QAAL,GAAgB,IAAhB;AACA,GANM;AAQP;;;AACO,yCAAP,UAAiB,MAAjB,EAAgC;AAC/B,SAAK,OAAL,GAAe,MAAf;AACA,GAFM;AAIP;;;AACO,2CAAP,UAAmB,KAAnB,EAAkC,kBAAlC,EAAqE;AAAnC;AAAA;AAAmC;;AAEpE,QAAI,CAAC,KAAK,QAAV,EAAoB;AACnB;AACA;;AAED,QAAI,CAAC,kBAAD,IAAuB,CAAC,KAAK,OAAjC,EAA0C;AACzC;AACA;;AAED,SAAK,SAAL,GAAiB,KAAjB;;AACA,SAAK,cAAL;AAEA,GAbM;AAeP;;;AACO,yCAAP,UAAiB,MAAjB,EAAsC,QAAtC,EAA6D,OAA7D,EAAmF,cAAnF,EAA8G;AAA9G;;AAEC,SAAK,QAAL,GAAgB;AACf,aAAO,EAAE,QADM;AAEf,YAAM,EAAE;AAFO,KAAhB;AAMA,SAAK,YAAL,GAAoB,CACnB;AAAC,QAAE,EAAE,OAAL;AAAc,aAAO,EAAE,MAAvB;AAA+B,aAAO,EAAE,IAAxC;AAA8C,SAAG,EAAE,IAAnD;AAAyD,SAAG,EAAE,IAA9D;AAAoE,WAAK,EAAE,KAA3E;AAAkF,eAAS,EAAE,GAA7F;AAAkG,aAAO,EAAE,GAA3G;AAAgH,WAAK,EAAE,MAAM,CAAC,WAA9H;AAA2I,mBAAa,EAAE;AAA1J,KADmB,EAEnB;AAAC,QAAE,EAAE,eAAL;AAAsB,aAAO,EAAE,cAA/B;AAA+C,aAAO,EAAE,IAAxD;AAA8D,SAAG,EAAE,IAAnE;AAAyE,SAAG,EAAE,IAA9E;AAAoF,UAAI,EAAE,KAA1F;AACA,kBAAY,EAAE;AAAQ,aAAI,CAAC,GAAL,CAAS,MAAT,EAAiB,eAAjB;AAAqC;AAD3D,KAFmB,EAKnB;AAAC,QAAE,EAAE,uBAAe,OAApB;AAA6B,aAAO,EAAE,QAAtC;AAAgD,aAAO,EAAE,KAAzD;AAAgE,SAAG,EAAE,CAAC,CAAtE;AAAyE,SAAG,EAAE,GAA9E;AAAmF,WAAK,EAAE,IAA1F;AAAgG,eAAS,EAAE,IAA3G;AAAiH,aAAO,EAAE,CAA1H;AAA6H,WAAK,EAAE,CAApI;AAAuI,mBAAa,EAAE;AAAtJ,KALmB,EAMnB;AAAC,QAAE,EAAE,uBAAe,MAApB;AAA4B,aAAO,EAAE,OAArC;AAA8C,aAAO,EAAE,KAAvD;AAA8D,SAAG,EAAE,GAAnE;AAAwE,SAAG,EAAE,CAA7E;AAAgF,WAAK,EAAE,IAAvF;AAA6F,eAAS,EAAE,KAAxG;AAA+G,aAAO,EAAE,CAAxH;AAA2H,WAAK,EAAE,OAAO,CAAC,WAA1I;AAAuJ,mBAAa,EAAE;AAAtK,KANmB,CAApB;AAWA,SAAK,mBAAL,GAA2B,QAAQ,CAAC,aAAT,CAAuB,2DAAvB,CAA3B;AACA,WAAO,CAAC,GAAR,CAAY,0BAAZ,EAAwC,KAAK,mBAA7C;AACA,SAAK,kBAAL,GAA0B,QAAQ,CAAC,aAAT,CAAuB,0DAAvB,CAA1B;AACA,SAAK,mBAAL,GAA2B,IAAI,2BAAJ,CAAiB,KAAK,mBAAtB,EAA2C,EAA3C,CAA3B;AACA,SAAK,kBAAL,GAA0B,IAAI,2BAAJ,CAAiB,KAAK,kBAAtB,EAA0C,EAA1C,CAA1B;AAGA,GA1BM;AA4BP;;;AACO,+CAAP,UAAuB,KAAvB,EAAoC;AACnC,SAAK,aAAL,GAAqB,KAArB;AACA,SAAK,MAAL;AACA,GAHM;AAKP;;;AACO,sCAAP;AAAA;;AAEC,SAAK,YAAL,GAAoB,MAAM,CAAC,WAA3B;AACA,SAAK,WAAL,GAAmB,MAAM,CAAC,UAA1B;AACA,SAAK,cAAL,GAAsB,MAAM,CAAC,WAA7B,CAJD,CAMC;;AACA,QAAI,KAAK,GAAG,KAAK,aAAL,IAAuB,OAAO,CAA9B,CAAZ;;AACA,QAAI,KAAK,GAAG,GAAZ,EAAiB;AAChB,WAAK,GAAG,GAAR;AACA,KAVF,CAYC;;;AACA,SAAK,MAAL,CAAY,OAAZ,CAAoB,UAAC,IAAD,EAAmB;AACtC,UAAI,CAAC,MAAL,CAAY,KAAI,CAAC,aAAjB,EAAgC,KAAI,CAAC,cAArC,EAAqD,KAArD,EAA4D,KAAI,CAAC,WAAjE;AACA,KAFD,EAbD,CAiBC;;;AACA,SAAK,YAAL,CAAkB,OAAlB,CAA0B,UAAC,GAAD,EAAgB;AACzC,UAAI,GAAG,CAAC,OAAJ,CAAY,WAAhB,EAA6B;AAC5B,WAAG,CAAC,KAAJ,GAAY,GAAG,CAAC,OAAJ,CAAY,WAAxB;AACA;AACD,KAJD;AAMA,GAxBM;;AA0BA,oCAAP,UAAY,UAAZ,EAAoC,WAApC,EAAiE,QAAjE,EAA0F,OAA1F,EAAoH,SAApH,EAA8I;AAA9I;;AAAY;AAAA;AAAsB;;AAAE;AAAA;AAA2B;;AAAE;AAAA;AAAuB;;AAAE;AAAA;AAAwB;;AAAE;AAAA;AAA0B;;AAE7I,QAAI,CAAC,SAAD,IAAc,KAAK,gBAAvB,EAAyC;AACxC;AACA;;AAED,SAAK,SAAL,GAAiB,QAAjB;AACA,QAAI,SAAS,GAAI,UAAU,CAAC,CAAX,GAAe,KAAK,YAArB,GAAqC,GAArD;AACA,QAAI,SAAS,GAAI,UAAU,CAAC,CAAX,GAAe,KAAK,WAArB,GAAoC,GAApD;AACA,QAAI,aAAa,GAAI,KAAK,SAAL,GAAiB,EAAtC;;AAEA,SAAK,sBAAL,CAA4B,IAA5B,CAAiC,UAAjC,EAA6C,KAAK,WAAlD,EAA+D,KAAK,aAApE,EAAmF,KAAK,cAAxF,EAAwG,KAAK,SAA7G,EAAwH,KAAK,SAA7H;;AAEA,SAAK,MAAL,CAAY,OAAZ,CAAoB,UAAC,IAAD,EAAmB;AACtC,UAAI,CAAC,IAAL,CAAU,KAAI,CAAC,SAAf,EAA0B,KAAI,CAAC,WAA/B,EAA4C,SAA5C,EAAuD,SAAvD,EAAkE,WAAlE,EAA+E,aAA/E,EAA8F,OAA9F,EAAuG,UAAvG;AACA,KAFD,EAb6I,CAiB7I;;;AACA,SAAK,cAAL,CAAoB,OAApB,EAlB6I,CAoB7I;;;AACA,SAAK,6BAAL;AAEA,GAvBM;;AAyBA,6CAAP,UAAqB,UAArB,EAA+C;AAA/C,qBAA+C,CAE9C;;;AACA,SAAK,gBAAL,GAAwB,IAAxB,CAH8C,CAK9C;AACA;;AACA,QAAI,IAAI,GAAW,KAAK,YAAL,EAAnB;;AACA,SAAK,MAAL,CAAY,OAAZ,CAAoB,UAAC,IAAD,EAAmB;AACtC;AACC,UAAI,CAAC,aAAL,CAAmB,IAAnB,EAFqC,CAGtC;AACA,KAJD,EAR8C,CAc9C;AACA;;;AACA,QAAI,UAAU,GAAgB,KAAK,kBAAL,CAAwB,UAAxB,CAA9B;;AACA,QAAI,GAAG,GAAgB,KAAK,QAAL,CAAc,UAAd,CAAvB;AACA,QAAI,CAAC,QAAL,CAAc,GAAd,CAAkB,GAAlB,EAAuB;AAAC,OAAC,EAAE,UAAU,CAAC,OAAf;AAAwB,OAAC,EAAE;AAA3B,KAAvB;AACA,SAAK,OAAL,CAAa,EAAb,GAAkB,IAAI,CAAC,QAAL,CAAc,EAAd,CAAiB,GAAjB,EAAsB,GAAtB,EAA2B;AAAC,OAAC,EAAE,IAAJ;AAAU,UAAI,EAAE,IAAI,CAAC,MAAL,CAAY;AAA5B,KAA3B,CAAlB;AACA,SAAK,SAAL,CAAe,GAAf,GAAqB,UAAU,CAAE;AAAO,kBAAI,CAAJ;AAAqB,KAA9B,EAAgC,IAAhC,CAA/B;AAEA,GAtBM;;AAwBA,+CAAP,UAAuB,UAAvB,EAAmD,KAAnD,EAAoE;AAApE;;AAAmD;AAAA;AAAiB;;AAEnE,SAAK,SAAL,GAAkB,UAAU,KAAK,uBAAe,OAA/B,GAA0C,CAA1C,GAA8C,CAA/D,CAFmE,CAInE;;AACA,SAAK,gBAAL,GAAwB,IAAxB,CALmE,CAOlE;AAED;;AAEA,QAAI,GAAG,GAAgB,KAAK,QAAL,CAAc,UAAd,CAAvB;AAEA,cAAU,CAAE;AAEZ,WAAI,CAAC,MAAL,CAAY,OAAZ,CAAoB,UAAC,IAAD,EAAmB;AACtC,YAAI,IAAI,CAAC,UAAL,KAAoB,UAAxB,EAAoC;AACnC,cAAI,CAAC,eAAL,CAAqB,KAArB;AACA;AACD,OAJD;;AAMA,WAAI,CAAC,cAAL,CAAoB,IAApB;;AACA,UAAI,UAAU,GAAgB,KAAI,CAAC,kBAAL,CAAwB,UAAxB,CAA9B;;AAEA,UAAI,CAAC,QAAL,CAAc,GAAd,CAAkB,GAAlB,EAAuB;AAAC,SAAC,EAAE,UAAU,CAAC,OAAf;AAAwB,SAAC,EAAE,KAAI,CAAC,YAAL;AAA3B,OAAvB;AACA,WAAI,CAAC,OAAL,CAAa,EAAb,GAAkB,IAAI,CAAC,QAAL,CAAc,EAAd,CAAiB,GAAjB,EAAsB,GAAtB,EAA2B;AAAC,SAAC,EAAE,CAAJ;AAAO,SAAC,EAAE,UAAU,CAAC,OAArB;AAA8B,YAAI,EAAE,IAAI,CAAC,MAAL,CAAY,OAAhD;AAAyD,aAAK,EAAE;AAAhE,OAA3B,CAAlB;AAEC,KAdS,EAcP,GAdO,CAAV;AAgBA,GA7BM;AA+BR;;;AACQ,2DAAP;AAAA,sBAEC;;;AACA,UAAM,CAAC,IAAP,CAAY,KAAK,OAAjB,EAA0B,OAA1B,CAAmC,UAAC,GAAD,EAAY;AAC9C;AACA,WAAI,CAAC,OAAL,CAAa,GAAb,EAAkB,IAAlB;AACA,KAHD,EAHD,CAQC;;AACA,SAAK,MAAL,CAAY,OAAZ,CAAoB,UAAC,IAAD,EAAmB;AACtC,UAAI,CAAC,2BAAL;AACA,KAFD;AAIA,GAbM;AAeP;;;AACO,gDAAP;AAEC,SAAK,gBAAL,GAAwB,KAAxB,CAFD,CAIC;;AACA,SAAK,MAAL,CAAY,OAAZ,CAAoB,UAAC,IAAD,EAAmB;AACtC,UAAI,CAAC,KAAL;AACA,KAFD,EALD,CASC;;;AACA,QAAI,CAAC,QAAL,CAAc,GAAd,CAAkB,CAAC,KAAK,QAAL,CAAc,OAAf,EAAwB,KAAK,QAAL,CAAc,MAAtC,CAAlB,EAAiE;AAAC,OAAC,EAAE;AAAJ,KAAjE;AAEA,GAZM;AAcP;;;AACO,6CAAP,UAAqB,UAArB,EAA+C;AAE9C,SAAK,gBAAL,GAAwB,KAAxB;;AAEA,QAAI,IAAI,GAAW,KAAK,YAAL,EAAnB,CAJ8C,CAM9C;;;AACA,SAAK,MAAL,CAAY,OAAZ,CAAoB,UAAC,IAAD,EAAmB;AACtC;AACA;AACA,UAAI,IAAI,CAAC,UAAL,KAAqB,UAAzB,EAAqC;AACpC,YAAI,CAAC,aAAL,CAAmB,IAAnB;AACA,OAFD,MAEO;AACN,YAAI,CAAC,KAAL;AACA;AACD,KARD,EAP8C,CAiB9C;;;AACA,QAAI,GAAG,GAAgB,KAAK,QAAL,CAAc,UAAd,CAAvB;AACA,QAAI,CAAC,QAAL,CAAc,GAAd,CAAkB,GAAlB,EAAwB;AAAC,OAAC,EAAE;AAAJ,KAAxB;AAEA,GArBM;AAuBP;;;AACO,+CAAP,aACC;AACA,GAFM;;AAIA,oDAAP;AACC,SAAK,gBAAL,GAAwB,KAAxB;AACA,GAFM;;AAIA,8CAAP;AACE,UAAe,CAAC,WAAhB,GAA8B,IAA9B;;AACD,SAAK,iBAAL,CAAuB,eAAvB,EAAwC,iBAAiB,CAAC,cAA1D;AACA,GAHM;;AAKA,8CAAP,UAAsB,MAAtB,EAAmC;AACjC,UAAe,CAAC,YAAhB,GAA+B,IAA/B;;AACD,SAAK,iBAAL,CAAuB,eAAvB,EAAwC,iBAAiB,CAAC,cAA1D;;AACA,SAAK,wBAAL,CAA8B,eAA9B,EAA+C,MAA/C;AACA,GAJM;;AAMA,4CAAP,UAAoB,IAApB,EAAwC;AACtC,UAAe,CAAC,YAAhB,GAA+B,KAA/B;AACD,QAAI,SAAS,GAAI,IAAI,KAAK,uBAAe,OAAzB,GAAoC,iBAAiB,CAAC,OAAtD,GAAgE,iBAAiB,CAAC,MAAlG;;AACA,SAAK,iBAAL,CAAuB,eAAvB,EAAwC,SAAxC;AACA,GAJM;;AAMA,iDAAP;AAEC,QAAM,MAAe,CAAC,aAAtB,EAAsC;AACrC;AACA;;AAED,SAAK,iBAAL,CAAuB,eAAvB,EAAwC,iBAAiB,CAAC,KAA1D;AACA,GAPM,CA5UR,CAqVC;AACA;AACA;AACA;AACA;AAEA;;;AACQ,4CAAR,UAAqB,cAArB,EAAqD,WAArD,EAAkF;AAAlF,qBAAkF,CAEjF;;;AACA,SAAK,OAAL,CAAa,SAAb,CAAuB,OAAvB,CAAgC,UAAC,YAAD,EAAoC;AACnE,UAAI,CAAC,YAAY,CAAC,OAAlB,EAA2B;AAC1B,aAAI,CAAC,eAAL,CAAqB,cAArB,EAAqC,WAArC,EAAkD,YAAlD;AACA;AACD,KAJD,EAHiF,CASjF;;;AACA,SAAK,OAAL,CAAa,OAAb,CAAqB,OAArB,CAA8B,UAAC,MAAD,EAA6B;AAC1D,WAAI,CAAC,qBAAL,CAA2B,MAA3B;AACA,KAFD;;AAIA,SAAK,cAAL;;AACA,SAAK,MAAL;AAEA,GAjBO;AAmBR;;;AACQ,+CAAR,UAAwB,cAAxB,EAAwD,WAAxD,EAAuF,YAAvF,EAA0H;AAEzH,QAAI,IAAJ;;AACA,QAAI,YAAY,CAAC,IAAb,KAAsB,yBAAiB,WAA3C,EAAyD;AAExD;AACA,UAAI,GAAG,IAAI,uBAAJ,EAAP;AACA,UAAI,GAAG,KAAK,eAAL,CAAiC,IAAjC,EAAqD,YAArD,CAAP;AACA,UAAI,CAAC,MAAL,CAAY,YAAZ,EAA0B;AACzB,iBAAS,EAAE,cADc;AAEzB,mBAAW,EAAE,WAAW,CAAC,QAAZ,CAAqB,YAAY,CAAC,WAAlC,CAFY;AAGzB,yBAAiB,EAAE,WAAW,CAAC,QAAZ,CAAqB,YAAY,CAAC,iBAAlC;AAHM,OAA1B;AAMA,KAXD,MAWO,IAAI,YAAY,CAAC,IAAb,KAAsB,yBAAiB,iBAA3C,EAA+D;AAErE;AACA,aAAO,CAAC,GAAR,CAAY,yBAAZ;AACA,UAAI,GAAG,IAAI,mCAAJ,EAAP;AACA,UAAI,GAAG,KAAK,eAAL,CAAuC,IAAvC,EAAiE,YAAjE,CAAP;AAEA,UAAI,CAAC,MAAL,CAAY,YAAZ,EAA0B;AACzB,iBAAS,EAAE,cADc;AAEzB,gBAAQ,EAAE,WAAW,CAAC;AAFG,OAA1B;AAKA,KAZM,MAYC,IAAI,YAAY,CAAC,IAAb,KAAsB,yBAAiB,KAA3C,EAAmD;AAE1D;AACA;AACA,UAAI,UAAQ,GAAyB,EAArC;AACA,kBAAY,CAAC,QAAb,CAAsB,OAAtB,CAA+B,UAAC,aAAD,EAAc;AAC5C,kBAAQ,CAAC,IAAT,CAAc,WAAW,CAAC,QAAZ,CAAqB,aAArB,CAAd;AACA,OAFD,EAL0D,CAS1D;;AACA,UAAI,GAAG,IAAI,6BAAJ,EAAP;AACA,UAAI,GAAG,KAAK,eAAL,CAAoC,IAApC,EAA2D,YAA3D,CAAP;AACA,UAAI,CAAC,MAAL,CAAY,YAAZ,EAA0B;AACzB,iBAAS,EAAE,cADc;AAEzB,gBAAQ,EAAE,UAFe;AAGzB,qBAAa,EAAE,YAAY,CAAC;AAHH,OAA1B;AAMA,KAlBO,MAkBD;AACN;AACA,UAAI,GAAG,IAAI,2BAAJ,EAAP;AACA,UAAI,GAAG,KAAK,eAAL,CAAmC,IAAnC,EAAyC,YAAzC,CAAP;AACA,UAAI,CAAC,MAAL,CAAY,YAAZ,EAA0B;AACzB,iBAAS,EAAE,cADc;AAEzB,eAAO,EAAE,WAAW,CAAC,QAAZ,CAAqB,YAAY,CAAC,OAAlC;AAFgB,OAA1B;AAKA,KArDwH,CAuDzH;;;AACA,SAAK,MAAL,CAAY,IAAZ,CAAiB,IAAjB;AAEA,GA1DO;AA4DR;;;AACQ,+CAAR,UAAgD,IAAhD,EAAyD,MAAzD,EAAsF;AAErF,QAAI,CAAC,SAAL,GAAiB,MAAM,CAAC,SAAxB;AACA,QAAI,CAAC,SAAL,GAAiB,MAAM,CAAC,SAAxB;AACA,QAAI,CAAC,SAAL,GAAiB,MAAM,CAAC,SAAxB;AACA,QAAI,CAAC,mBAAL,GAA2B,MAAM,CAAC,mBAAlC;AACA,QAAI,CAAC,kBAAL,GAA0B,MAAM,CAAC,kBAAjC;;AAEA,QAAI,MAAM,CAAC,KAAX,EAAkB;AACjB,UAAI,CAAC,KAAL,GAAa,MAAM,CAAC,KAApB;AACA;;AAED,QAAI,MAAM,CAAC,IAAX,EAAiB;AAChB,UAAI,CAAC,IAAL,GAAY,MAAM,CAAC,IAAnB;AACA;;AAED,WAAO,IAAP;AAEA,GAlBO;AAoBR;;;AACQ,8CAAR;AACC,SAAK,WAAL,GAAmB,CAAC,CAAD,IAAM,KAAK,SAAL,IAAkB,KAAK,aAAL,GAAqB,KAAK,WAA5C,CAAN,CAAnB;AACA,GAFO,CAlcT,CAscC;AACA;;;AACQ,8CAAR,UAAuB,OAAvB,EAA+C;AAA/C;;AAAuB;AAAA;AAAwB;;AAE9C,SAAK,YAAL,CAAkB,OAAlB,CAA0B,UAAC,OAAD,EAAQ;AAEjC,UAAI,OAAO,CAAC,KAAZ,EAAmB;AAClB;AACA;AACA,eAAO,CAAC,OAAR,GAAkB,KAAI,CAAC,QAAL,CAAc,OAAd,EAAuB,OAAvB,CAAlB;AACA,eAAO,CAAC,OAAR,CAAgB,KAAhB,CAAsB,SAAtB,GAAkC,iBAAe,OAAO,CAAC,OAAvB,GAA8B,aAAhE;AACA;;AAED,UAAI,CAAC,OAAO,CAAC,OAAT,IAAoB,CAAC,OAAO,CAAC,IAA7B,IAAqC,KAAI,CAAC,SAAL,GAAkB,OAAO,CAAC,GAA/D,IAAsE,KAAI,CAAC,SAAL,GAAiB,OAAO,CAAC,GAA/F,IAAsG,KAAI,CAAC,SAAL,GAAiB,IAA3H,EAAiI;AAChI,aAAI,CAAC,IAAL,CAAU,QAAV,CAAmB,OAAO,CAAC,OAA3B,EAAoC,OAApC;;AACA,eAAO,CAAC,OAAR,GAAkB,IAAlB;;AACA,YAAI,OAAO,CAAC,EAAR,KAAe,eAAnB,EAAoC;AACnC;AACA,oBAAU,CAAC;AAAM,wBAAI,CAAC,kBAAL,CAAwB,OAAxB;AAAkD,WAAzD,EAA2D,EAA3D,CAAV;AACA;AACD,OAPD,MAOO,IAAI,OAAO,CAAC,OAAR,KAAoB,KAAI,CAAC,SAAL,GAAkB,OAAO,CAAC,GAA1B,IAAiC,KAAI,CAAC,SAAL,GAAiB,OAAO,CAAC,GAA9E,CAAJ,EAAwF;AAC9F,aAAI,CAAC,IAAL,CAAU,WAAV,CAAsB,OAAO,CAAC,OAA9B,EAAuC,OAAvC;;AAGA,eAAO,CAAC,OAAR,GAAkB,KAAlB;;AACA,YAAK,OAAO,CAAC,YAAb,EAA2B;AAC1B,iBAAO,CAAC,YAAR,CAAqB,OAArB;AACA;AACD;AAED,KA1BD;AA2BA,GA7BO;;AA+BA,wCAAR,UAAiB,OAAjB,EAAsC,OAAtC,EAA8D;AAAxB;AAAA;AAAwB;;AAC7D,WAAQ,KAAK,aAAL,GAAqB,OAAO,CAAC,SAA9B,GAA2C,KAAK,WAAhD,GAA+D,OAAO,CAAC,OAAR,GAAkB,OAAO,CAAC,OAAR,CAAgB,WAAjG,GAAgH,KAAK,6BAAL,CAAmC,OAAO,CAAC,SAA3C,EAAsD,OAAO,CAAC,aAA9D,EAA6E,OAA7E,CAAvH;AACA,GAFO,CAveT,CA2eC;;;AACQ,6DAAR,UAAsC,SAAtC,EAAyD,aAAzD,EAAgF,OAAhF,EAAwG;AAAxB;AAAA;AAAwB,MACvG;;;AACA,SAAK,kBAAL,GAA0B,SAAS,GAAG,GAAtC,CAFuG,CAGvG;;AACA,SAAK,iCAAL,GAAyC,KAAK,kBAAL,IAA2B,KAAK,SAAL,GAAiB,GAA5C,CAAzC,CAJuG,CAKvG;AACA;;AACA,WAAO,KAAK,iCAAL,GAAyC,aAAzC,IAA0D,KAAK,aAAL,GAAqB,CAA/E,CAAP;AACA,GARO;AAUR;;;AACS,4CAAT;AACC,WAAQ,CAAC,CAAD,GAAK,KAAK,YAAX,GAA2B,GAAlC;AACA,GAFQ;AAIT;;;AACQ,kDAAR,UAA2B,EAA3B,EAAqC;AACpC,QAAI,OAAO,GAAe,IAA1B;;AACA,SAAK,YAAL,CAAkB,OAAlB,CAA2B,UAAC,IAAD,EAAK;AAC/B,UAAI,IAAI,CAAC,EAAL,KAAY,EAAhB,EAAqB;AACpB,eAAO,GAAG,IAAV;AACA;AACD,KAJD;;AAKA,WAAO,OAAP;AACA,GARO;AAUR;;;AACQ,qDAAR,UAA8B,MAA9B,EAA0D;AAA1D;;AACC,UAAM,CAAC,aAAP,GAAuB,KAAK,eAA5B;;AACA,UAAM,CAAC,OAAP,GAAiB,UAAC,EAAD,EAAW;AAAK,kBAAI,CAAC,kBAAL;AAA6B,KAA9D;;AACA,UAAM,CAAC,MAAP,GAAgB,UAAC,EAAD,EAAW;AAAK,kBAAI,CAAC,iBAAL;AAA4B,KAA5D;;AACA,SAAK,sBAAL,CAA4B,GAA5B,CAAiC,MAAjC;AACA,GALO;;AAQD,6CAAP;AAAA;;AACC,SAAK,MAAL,GAAc,iBAAiB,CAAC,IAAhC;;AACA,SAAK,iBAAL,CAAuB,eAAvB,EAAwC,iBAAiB,CAAC,cAA1D;;AACA,SAAK,aAAL,CAAmB,OAAnB,EAA4B,CAA5B,EAA+B,MAA/B,CAAsC,GAAtC;;AACA,QAAI,SAAS,GAAwB,KAAK,aAAL,CAAmB,gBAAnB,CAArC;;AACA,aAAS,CAAC,OAAV,CAAmB,UAAC,IAAD,EAAK;AAAM,iBAAI,CAAC,MAAL;AAAiB,KAA/C;AAEA,QAAI,CAAC,QAAL,CAAc,EAAd,CAAiB,cAAjB,EAAiC,GAAjC,EAAsC;AAAC,eAAS,EAAE,CAAZ;AAAe,UAAI,EAAE,IAAI,CAAC,MAAL,CAAY,QAAjC;AAA2C,WAAK,EAAE;AAAlD,KAAtC,EAPD,CASC;AACA;;AACA,QAAI,UAAU,GAAgB,QAAQ,CAAC,aAAT,CAAuB,iCAAvB,CAA9B,CAXD,CAYC;;AACA,SAAK,kBAAL,GAA0B,IAAI,2BAAJ,CAAiB,UAAjB,EAA6B,EAA7B,CAA1B;AACA,cAAU,CAAE;AAAO,kBAAI,CAAC,kBAAL,CAAwB,OAAxB;AAAkD,KAA3D,EAA6D,IAA7D,CAAV;AAEA,GAhBM;;AAkBC,kDAAR,UAA2B,EAA3B,EAAqC;AAEpC,QAAI,KAAK,MAAL,KAAiB,iBAAiB,CAAC,KAAvC,EAA8C;AAC7C;AACA;;AAED,QAAI,EAAE,KAAK,cAAP,IAAyB,KAAK,MAAL,KAAgB,iBAAiB,CAAC,IAA/D,EAAqE;AACpE,WAAK,gBAAL,CAAsB,cAAtB,CAAqC,IAArC;;AACA,WAAK,iBAAL,CAAuB,eAAvB,EAAwC,iBAAiB,CAAC,cAA1D;AACA;;AAED,QAAI,EAAE,KAAK,SAAX,EAAsB;AACrB,WAAK,iBAAL,CAAuB,eAAvB,EAAwC,iBAAiB,CAAC,OAA1D;;AACA,WAAK,GAAL,CAAS,MAAT,EAAiB,cAAjB,CAAgC,CAAhC;AACA,WAAK,MAAL,GAAe,iBAAiB,CAAC,OAAjC;;AACA,WAAK,gBAAL,CAAsB,cAAtB,CAAqC,KAArC;AACA,KAhBmC,CAkBpC;AACA;AACA;AACA;;;AAEA,QAAI,EAAE,KAAK,QAAX,EAAqB;AACpB,WAAK,iBAAL,CAAuB,eAAvB,EAAwC,iBAAiB,CAAC,MAA1D;;AACA,WAAK,GAAL,CAAS,MAAT,EAAiB,cAAjB,CAAgC,CAAhC;AACA,WAAK,MAAL,GAAe,iBAAiB,CAAC,MAAjC;;AACA,WAAK,gBAAL,CAAsB,cAAtB,CAAqC,KAArC;AACA;;AAED,QAAI,EAAE,KAAK,MAAX,EAAmB;AAClB,WAAK,iBAAL,CAAuB,eAAvB,EAAwC,iBAAiB,CAAC,aAA1D;;AACA,WAAK,GAAL,CAAS,MAAT,EAAiB,cAAjB,CAAgC,CAAhC;AACA,WAAK,MAAL,GAAe,iBAAiB,CAAC,IAAjC;;AACA,WAAK,gBAAL,CAAsB,cAAtB,CAAqC,KAArC;AACA;AAED,GArCO;;AAuCA,iDAAR,UAA0B,EAA1B,EAAoC;AAEnC,QAAI,KAAK,MAAL,KAAiB,iBAAiB,CAAC,KAAvC,EAA8C;AAC7C;AACA;;AAED,QAAI,EAAE,KAAK,cAAP,IAAyB,KAAK,MAAL,KAAgB,iBAAiB,CAAC,IAA/D,EAAqE;AACpE,WAAK,gBAAL,CAAsB,cAAtB,CAAqC,KAArC;;AACA,WAAK,iBAAL,CAAuB,eAAvB,EAAwC,iBAAiB,CAAC,aAA1D;AACA;AACD,GAVO;;AAYA,6CAAR,UAAsB,EAAtB,EAAgC;AAC/B,QAAI,SAAS,GAAwB,EAArC;;AAEA,SAAK,MAAL,CAAY,OAAZ,CAAqB,UAAC,YAAD,EAA2B;AAE/C,UAAI,YAAY,CAAC,EAAb,KAAoB,EAAxB,EAA4B;AAE3B,YAAI,YAAY,CAAC,IAAb,KAAsB,gCAAiB,cAAvC,IAAyD,YAAY,CAAC,IAAb,KAAsB,gCAAiB,iBAApG,EAAuH;AACtH,cAAI,cAAc,GAAI,YAA8B,CAAC,QAA/B,EAAtB;;AACA,eAAK,IAAI,CAAC,GAAG,CAAb,EAAgB,CAAC,GAAG,cAAc,CAAC,MAAnC,EAA2C,CAAC,EAA5C,EAAgD;AAC/C,qBAAS,CAAC,IAAV,CAAe,cAAc,CAAC,CAAD,CAA7B;AACA;AACD;;AAED,YAAI,YAAY,CAAC,IAAb,KAAsB,gCAAiB,QAA3C,EAAqD;AACpD,mBAAS,CAAC,IAAV,CAAe,YAAf;AACA;AACD;AAED,KAhBD;;AAkBA,WAAO,SAAP;AAEA,GAvBO;;AAyBA,iDAAR,UAA0B,WAA1B,EAA+C,aAA/C,EAA+E;AAC9E,SAAK,aAAL,CAAmB,WAAnB,EAAgC,OAAhC,CAAyC,UAAC,QAAD,EAAuB;AAC/D,cAAQ,CAAC,gBAAT,CAA0B,aAA1B;AACA,KAFD;AAGA,GAJO;;AAMA,wDAAR,UAAiC,WAAjC,EAAsD,MAAtD,EAAmE;AAClE,SAAK,aAAL,CAAmB,WAAnB,EAAgC,OAAhC,CAAyC,UAAC,QAAD,EAAuB;AAC/D,cAAQ,CAAC,uBAAT,CAAiC,MAAjC;AACA,KAFD;AAGA,GAJO;;AAMA,iDAAR,aAEC,CAFO;;AAIA,6DAAR;AAEC,QAAI,CAAC,KAAK,yBAAN,IAAmC,KAAK,SAAL,GAAiB,IAAxD,EAA8D;AAC7D,WAAK,yBAAL,GAAiC,IAAjC;;AACA,WAAK,mBAAL,CAAyB,OAAzB,CAAiC,SAAjC;AACA,KAHD,MAGO,IAAI,KAAK,yBAAL,IAAkC,KAAK,SAAL,IAAkB,IAAxD,EAA8D;AACpE,WAAK,yBAAL,GAAiC,KAAjC,CADoE,CAEpE;;AACA,WAAK,mBAAL,CAAyB,OAAzB,CAAiC,EAAjC;AACA;;AAED,QAAI,CAAC,KAAK,wBAAN,IAAkC,KAAK,SAAL,GAAiB,IAAvD,EAA6D;AAC5D,WAAK,wBAAL,GAAgC,IAAhC;;AACA,WAAK,kBAAL,CAAwB,OAAxB,CAAgC,SAAhC;AACA,KAHD,MAGO,IAAI,KAAK,wBAAL,IAAiC,KAAK,SAAL,IAAkB,IAAvD,EAA6D;AACnE,WAAK,wBAAL,GAAgC,KAAhC,CADmE,CAEnE;;AACA,WAAK,kBAAL,CAAwB,OAAxB,CAAgC,EAAhC;AACA;AAED,GApBO;;AAsBT;AAAC,CAnpBD,CAAsC,uBAAtC;;AAAa,4C;;;;;;;;;;;;;;;;;;ACpDb;AAAA;AAAA;AAAA,wBA2BC,CA3BD,CAEC;;;AACuB,mCAA+B,sBAA/B;AACA,+BAA2B,kBAA3B;AACA,sCAAkC,yBAAlC;AACA,wCAAoC,2BAApC;AAEA,yBAAqB,YAArB,CARxB,CAUC;;AACuB,6BAAyB,gBAAzB;AACA,+BAA2B,kBAA3B;AACA,gCAA4B,mBAA5B,CAbxB,CAeC;;AACuB,sCAAkC,yBAAlC;AACA,+BAA2B,kBAA3B;AAEA,4BAAwB,eAAxB;AACA,+BAA2B,kBAA3B;AACA,qCAAiC,wBAAjC;AAEA,+CAA2C,kCAA3C;AACA,gCAA4B,mBAA5B;AACA,6BAAyB,gBAAzB;AAExB;AAAC,CA3BD;;AAAa,8B;;;;;;;;;;;;;;;;;ACAb,IAAY,WAAZ;;AAAA,WAAY,WAAZ,EAAuB;AAAE;AAAe;AAAe;AAAqB;AAAc,CAA1F,EAAY,WAAW,GAAX,8CAAW,EAAX,CAAZ;;AACA,IAAY,eAAZ;;AAAA,WAAY,eAAZ,EAA2B;AAAE;AAAiB;AAAmB;AAAqB;AAAc,CAApG,EAAY,eAAe,GAAf,sDAAe,EAAf,CAAZ;;AACA,IAAY,cAAZ;;AAAA,WAAY,cAAZ,EAA0B;AAAE;AAAqB;AAAkB,CAAnE,EAAY,cAAc,GAAd,oDAAc,EAAd,CAAZ;;AACA,IAAY,iBAAZ;;AAAA,WAAY,iBAAZ,EAA6B;AAAE;AAAe;AAAqB;AAAkB,CAArF,EAAY,iBAAiB,GAAjB,0DAAiB,EAAjB,CAAZ;;AACA,IAAY,QAAZ;;AAAA,WAAY,QAAZ,EAAoB;AAAE;AAAe;AAAqB;AAAmB;AAAqB;AAAc,CAAhH,EAAY,QAAQ,GAAR,wCAAQ,EAAR,CAAZ;;AAEA,IAAY,kBAAZ;;AAAA,WAAY,kBAAZ,EAA8B;AAAE;AAAW;AAAe;AAAoB;AAAwB;AAAe;AAAgB,CAArI,EAAY,kBAAkB,GAAlB,4DAAkB,EAAlB,CAAZ;;AACA,IAAY,aAAZ;;AAAA,WAAY,aAAZ,EAAyB;AAAE;AAAe;AAAkB,CAA5D,EAAY,aAAa,GAAb,kDAAa,EAAb,CAAZ;;AAEA,IAAY,eAAZ;;AAAA,WAAY,eAAZ,EAA2B;AAC1B;AACA;AACA;AACA;AACA,CALD,EAAY,eAAe,GAAf,sDAAe,EAAf,CAAZ;;AAOA,IAAY,gBAAZ;;AAAA,WAAY,gBAAZ,EAA4B;AAC3B;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CARD,EAAY,gBAAgB,GAAhB,wDAAgB,EAAhB,CAAZ;;AAUA,IAAY,gBAAZ;;AAAA,WAAY,gBAAZ,EAA4B;AAC3B;AACA;AACA;AACA;AACA,CALD,EAAY,gBAAgB,GAAhB,wDAAgB,EAAhB,CAAZ;;AAOA,IAAY,iBAAZ;;AAAA,WAAY,iBAAZ,EAA6B;AAC5B;AACA;AACA,CAHD,EAAY,iBAAiB,GAAjB,0DAAiB,EAAjB,CAAZ;;AAKA,IAAY,YAAZ;;AAAA,WAAY,YAAZ,EAAwB;AAAE;AAAuB;AAAkB,CAAnE,EAAY,YAAY,GAAZ,gDAAY,EAAZ,CAAZ,E;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACtCA;;AAOA;AAAA;AAAA;AAAyC;;AAKxC,+BAAa,UAAb,EAAqD;WACpD,kBAAM,UAAN,KAAiB,I;AACjB;;AALa,kCAAoB,wBAApB;AAOf;AAAC,CATD,CAAyC,uBAAzC;;AAAa,kD;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACPb;;AAUA;AAAA;AAAA;AAAuC;;AAQtC,6BAAa,UAAb,EAAmD;WAClD,kBAAM,UAAN,KAAiB,I;AACjB;;AARa,gCAAoB,qBAApB;AAUf;AAAC,CAZD,CAAuC,uBAAvC;;AAAa,8C;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACVb;;AAOA;AAAA;AAAA;AAAwC;;AAKvC,8BAAa,UAAb,EAAoD;WACnD,kBAAM,UAAN,KAAiB,I;AACjB;;AALa,iCAAoB,gBAApB;AAOf;AAAC,CATD,CAAwC,uBAAxC;;AAAa,gD;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACPb;;AAMA;AAAA;AAAA;AAA0C;;AAKzC,gCAAa,UAAb,EAAsD;WACrD,kBAAM,UAAN,KAAiB,I;AACjB;;AALa,mCAAoB,mBAApB;AAOf;AAAC,CATD,CAA0C,uBAA1C;;AAAa,oD;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACNb;;AAOA;AAAA;AAAA;AAAgD;;AAK/C,sCAAa,UAAb,EAA4D;WAC3D,kBAAM,UAAN,KAAiB,I;AACjB;;AALa,yCAAoB,yBAApB;AAOf;AAAC,CATD,CAAgD,uBAAhD;;AAAa,gE;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACPb;;AAQA;AAAA;AAAA;AAAmC;;AAMlC,yBAAa,UAAb,EAA+C;WAC9C,kBAAM,UAAN,KAAiB,I;AACjB;;AANa,4BAAoB,iBAApB;AAQf;AAAC,CAVD,CAAmC,uBAAnC;;AAAa,sC;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACRb;;AAQA;AAAA;AAAA;AAA2C;;AAM1C,iCAAa,UAAb,EAAuD;WACtD,kBAAM,UAAN,KAAiB,I;AACjB;;AANgB,oCAAoB,2BAApB;AAQlB;AAAC,CAVD,CAA2C,uBAA3C;;AAAa,sD;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACRb;;AAOA;AAAA;AAAA;AAAqC;;AAMpC,2BAAa,UAAb,EAAiD;WAChD,kBAAM,UAAN,KAAiB,I;AACjB;;AANa,8BAAoB,mBAApB;AAQf;AAAC,CAVD,CAAqC,uBAArC;;AAAa,0C;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACPb;;AAUA;AAAA;AAAA;AAAyC;;AAOxC,+BAAa,UAAb,EAAqD;WACpD,kBAAM,UAAN,KAAiB,I;AACjB;;AAPa,kCAAoB,uBAApB;AASf;AAAC,CAXD,CAAyC,uBAAzC;;AAAa,kD;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACVb;;AAOA;AAAA;AAAA;AAA0C;;AAMzC,gCAAa,UAAb,EAAsD;WACrD,kBAAM,UAAN,KAAiB,I;AACjB;;AANa,mCAAoB,yBAApB;AAQf;AAAC,CAVD,CAA0C,uBAA1C;;AAAa,oD;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACPb;;AAQA;AAAA;AAAA;AAAwC;;AAMvC,8BAAa,UAAb,EAAoD;WACnD,kBAAM,UAAN,KAAiB,I;AACjB;;AANa,iCAAoB,sBAApB;AAQf;AAAC,CAVD,CAAwC,uBAAxC;;AAAa,gD;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACRb;;AAOA;AAAA;AAAA;AAAwC;;AAKvC,8BAAa,UAAb,EAAoD;WACnD,kBAAM,UAAN,KAAiB,I;AACjB;;AALa,iCAAoB,uBAApB;AAOf;AAAC,CATD,CAAwC,uBAAxC;;AAAa,gD;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACPb;;AAOA;AAAA;AAAA;AAAoC;;AAKnC,0BAAa,UAAb,EAAgD;WAC/C,kBAAM,UAAN,KAAiB,I;AACjB;;AALa,6BAAoB,kBAApB;AAOf;AAAC,CATD,CAAoC,uBAApC;;AAAa,wC;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACNb;;AACA;;AACA;;AAEA;AAEA;;;AACA;AAAA;AAAA;AAA+B;;AAA/B;AAAA;;AAEQ,mBAAS;AACf,qBAAe,EAAE,IADF;AAEf,mBAAa,EAAE,CAFA;AAGf,sBAAgB,EAAE,EAHH;AAIf,eAAS,EAAE,KAJI;AAKf,mBAAa,EAAE,CALA;AAMf,iBAAW,EAAE,MANE;AAOf,sBAAgB,EAAE;AAPH,KAAT;AAYC,eAAa,CAAb,CAdT,CAcmC;;AAC1B,qBAAmB,CAAnB,CAfT,CAeuC;;AAC9B,uBAAqB,CAArB,CAhBT,CAgByC;;AAGhC,qBAAoB,KAApB;AACA,sBAAoB,CAApB;;AAiGR;;AA/FO,+BAAP;AACC,SAAK,UAAL,GAAkB,KAAK,MAAL,CAAY,gBAA9B;AACA,SAAK,MAAL,GAAc,KAAK,UAAL,CAAgB,aAAhB,CAA8B,kBAA9B,CAAd;;AACA,SAAK,MAAL,CAAY,gBAAZ,CAA6B,QAA7B,EAAuC,KAAK,SAAL,CAAe,IAAf,CAAoB,IAApB,CAAvC;;AACA,SAAK,UAAL,CAAgB,gBAAhB,CAAiC,WAAjC,EAA8C,KAAK,YAAL,CAAkB,IAAlB,CAAuB,IAAvB,CAA9C;AACA,SAAK,UAAL,CAAgB,gBAAhB,CAAiC,UAAjC,EAA6C,KAAK,WAAL,CAAiB,IAAjB,CAAsB,IAAtB,CAA7C;;AACA,SAAK,kBAAL;;AACA,SAAK,SAAL;;AAEA,QAAI,MAAM,CAAC,UAAP,GAAoB,IAAxB,EAA8B;AAC7B,WAAK,MAAL,CAAY,aAAZ,GAA4B,CAA5B;AACA,WAAK,MAAL,CAAY,gBAAZ,GAA+B,CAA/B;AACA;AACD,GAbM;;AAeA,gCAAP;AACC,SAAK,MAAL,CAAY,mBAAZ,CAAgC,QAAhC,EAA0C,KAAK,SAAL,CAAe,IAAf,CAAoB,IAApB,CAA1C;;AACA,SAAK,UAAL,CAAgB,mBAAhB,CAAoC,WAApC,EAAiD,KAAK,YAAL,CAAkB,IAAlB,CAAuB,IAAvB,CAAjD;AACA,SAAK,UAAL,CAAgB,mBAAhB,CAAoC,UAApC,EAAgD,KAAK,WAAL,CAAiB,IAAjB,CAAsB,IAAtB,CAAhD;AACA,SAAK,MAAL,GAAc,IAAd;;AACA,qBAAM,OAAN,CAAa,IAAb,CAAa,IAAb;AACA,GANM;;AAQA,+BAAP;AACC,SAAK,SAAL;AACA,GAFM;;AAIA,6BAAP;AAEC,QAAI,CAAC,KAAK,QAAN,IAAkB,KAAK,UAAL,CAAgB,WAAtC,EAAmD;AAClD,WAAK,SAAL;;AACA,WAAK,QAAL,GAAgB,IAAhB;AACA;;AAED,QAAI,KAAK,QAAT,EAAmB;AAClB,WAAK,gBAAL;AACA;AAED,GAXM,CAjDR,CA8DC;AACA;;;AACQ,kCAAR;AACC,SAAK,MAAL,GAAc,KAAK,MAAL,CAAY,WAA1B;AACA,SAAK,UAAL,GAAmB,CAAC,CAAD,IAAM,KAAK,MAAL,GAAc,KAAK,UAAL,CAAgB,WAApC,CAAnB;;AACA,SAAK,eAAL,CAAqB,eAArB,CAAqC,KAAK,MAA1C;;AACA,SAAK,IAAL,CAAU,SAAV,CAAoB,KAAK,QAAzB,EAAmC,KAAK,UAAxC,EAAoD,CAApD;AACA,GALO;;AAOA,qCAAR,UAAqB,CAArB,EAAkC;AACjC,oBAAO,QAAP,CAAgB,IAAI,qCAAJ,CAAsB;AAAC,UAAI,EAAE,SAAP;AAAkB,YAAM,EAAE,IAA1B;AAAgC,QAAE,EAAE,KAAK,EAAzC;AAA6C,WAAK,EAAE,KAAK,MAAL,CAAY;AAAhE,KAAtB,CAAhB;AACA,GAFO;;AAIA,oCAAR,UAAoB,CAApB,EAAiC;AAChC,oBAAO,QAAP,CAAgB,IAAI,qCAAJ,CAAsB;AAAC,UAAI,EAAE,SAAP;AAAkB,YAAM,EAAE,KAA1B;AAAiC,QAAE,EAAE,KAAK,EAA1C;AAA8C,WAAK,EAAE,KAAK,MAAL,CAAY;AAAjE,KAAtB,CAAhB;AACA,GAFO;;AAIA,2CAAR;AAAA;;AAEC,SAAK,eAAL,GAAuB,IAAI,iCAAJ,CAAoB,CAApB,EAAuB,KAAvB,EAA8B,CAA9B,EAAiC,KAAjC,EAAwC,KAAK,UAA7C,CAAvB;;AACA,SAAK,eAAL,CAAqB,kBAArB,CAAwC,KAAK,MAAL,CAAY,eAApD;;AACA,SAAK,eAAL,CAAqB,SAArB,GAAiC,CAAjC;AACA,SAAK,eAAL,CAAqB,gBAArB,GAAwC,CAAxC;;AAEA,SAAK,eAAL,CAAqB,iBAArB,CAAuC,IAAvC;;AAEA,SAAK,eAAL,CAAqB,SAArB,GAAiC,KAAjC;;AACA,SAAK,eAAL,CAAqB,WAArB,CAAiC,KAAK,MAAL,CAAY,aAA7C;;AACA,SAAK,eAAL,CAAqB,SAArB,CAA+B,IAA/B,EAXD,CAaC;;;AACA,SAAK,eAAL,CAAqB,MAArB,GAA8B,UAAC,aAAD,EAAsB;AACnD,WAAI,CAAC,QAAL,GAAiB,aAAa,GAAG,KAAI,CAAC,UAAtC;AACA,KAFD;;AAIA,SAAK,eAAL,CAAqB,WAArB,GAAmC;AAClC,sBAAO,QAAP,CAAgB,IAAI,qCAAJ,CAAsB;AAAC,YAAI,EAAE,MAAP;AAAe,cAAM,EAAE,IAAvB;AAA6B,UAAE,EAAE,KAAI,CAAC;AAAtC,OAAtB,CAAhB;AACA,WAAI,CAAC,UAAL,GAAkB,KAAI,CAAC,MAAL,CAAY,aAA9B;AACA,KAHD;;AAKA,SAAK,eAAL,CAAqB,UAArB,GAAkC;AACjC,sBAAO,QAAP,CAAgB,IAAI,qCAAJ,CAAsB;AAAC,YAAI,EAAE,MAAP;AAAe,cAAM,EAAE,KAAvB;AAA8B,UAAE,EAAE,KAAI,CAAC;AAAvC,OAAtB,CAAhB;AACA,WAAI,CAAC,UAAL,GAAkB,KAAI,CAAC,MAAL,CAAY,gBAA9B;AACA,KAHD;AAIA,GA3BO;;AA6BA,yCAAR;AACC,SAAK,EAAL,GAAU,KAAK,EAAL,GAAY,CAAE,KAAK,QAAL,GAAgB,KAAK,EAAvB,IAA8B,KAAK,UAAzD;AACA,SAAK,MAAL,CAAY,KAAZ,CAAkB,SAAlB,GAA8B,iBAAe,KAAK,EAApB,GAAsB,WAApD;AACA,GAHO;;AAKA,yCAAR;AACC,SAAK,SAAL,IAAkB,KAAK,MAAL,CAAY,gBAA9B;AACA,GAFO;;AAIT;AAAC,CArHD,CAA+B,eAA/B;;AAAa,8B;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACRb;;AACA;;AACA;AAAA;AAAA;AAA6B;;AAA7B;AAAA;;AAEQ,mBAAc;AACpB,cAAQ,EAAE,IADU;AAEpB,cAAQ,EAAE,IAFU;AAGpB,gBAAU,EAAE,IAHQ;AAIpB,gBAAU,EAAE,EAJQ;AAKpB,gBAAU,EAAE,EALQ;AAMpB,iBAAW,EAAE,EANO;AAOpB,oBAAc,EAAE,EAPI;AAQpB,UAAI,EAAE,gBARc;AASpB,WAAK,EAAE,EATa;AAUpB,WAAK,EAAE,CAVa;AAWpB,UAAI,EAAE;AAXc,KAAd;AAkBC,uBAAqB,CAArB;;AAgGR;;AA9FA;AACC,WAAO,CAAC,GAAR,CAAY,QAAZ,EAAsB,KAAK,EAA3B;AACA,GAFD;;AAIA,wBAAW,iBAAX,EAAW,aAAX,EAAsB;SAAtB;AACC,aAAO,KAAK,YAAZ;AACA,KAFqB;oBAAA;;AAAA,GAAtB;AAIA;;AACO,qCAAP,UAAsB,KAAtB,EAAgC;AAC/B,SAAK,eAAL,GAAuB;AAAC,OAAC,EAAE,KAAK,CAAC,CAAV;AAAc,OAAC,EAAE,KAAK,CAAC;AAAvB,KAAvB;;AACA,SAAK,oBAAL,CAA0B,KAAK,eAA/B;;AACA,QAAI,KAAK,eAAT,EAA0B;AACzB,WAAK,YAAL,GAAoB,IAApB;AACA;AACD,GANM;;AAQA,8BAAP;AACC,SAAK,MAAL;AACA,GAFM;AAIP;;;AACO,uCAAP,UAAwB,KAAxB,EAAkC;AACjC,SAAK,oBAAL,CAA0B,KAA1B;;AACA,QAAK,KAAK,YAAL,IAAsB,KAAK,eAAhC,EAAiD;AAChD,WAAK,OAAL;;AACA,WAAK,cAAL;;AACA,WAAK,mBAAL,CAAyB,KAAzB;AACA;AACD,GAPM;AASP;;;AACO,kCAAP,UAAmB,CAAnB,EAA8B,CAA9B,EAAyC,KAAzC,EAAsD;AACpD,SAAK,UAAL,CAAgC,KAAhC,CAAsC,SAAtC,GAAkD,iBAAe,CAAf,GAAgB,MAAhB,GAAuB,CAAvB,GAAwB,aAAxB,GAAsC,KAAtC,GAA2C,GAA7F;AACD,GAFM,CAtDR,CA0DC;AACA;;AAEA;;;AACQ,2CAAR,UAA6B,KAA7B,EAAuC;AACtC,SAAK,KAAL,GAAa,KAAK,UAAL,CAAgB,qBAAhB,EAAb;AACA,SAAK,eAAL,GAAyB,KAAK,KAAL,CAAW,CAAX,IAAgB,KAAK,CAAC,CAAtB,IAA2B,KAAK,CAAC,CAAN,IAAW,KAAK,KAAL,CAAW,CAAX,GAAe,KAAK,KAAL,CAAW,KAAhE,IACZ,KAAK,KAAL,CAAW,CAAX,IAAgB,KAAK,CAAC,CADV,IACgB,KAAK,CAAC,CAAN,IAAY,KAAK,KAAL,CAAW,CAAX,GAAe,KAAK,KAAL,CAAW,MAD/E;AAEA,GAJO;AAMR;;;AACQ,0CAAR,UAA4B,KAA5B,EAAsC;AAErC,QAAI,CAAC,KAAK,YAAV,EAAwB;AACvB;AACA;;AAED,QAAK,IAAI,CAAC,GAAL,CAAS,KAAK,CAAC,CAAN,GAAU,KAAK,eAAL,CAAqB,CAAxC,IAA8C,KAAK,MAAL,CAAY,UAA1D,IACJ,IAAI,CAAC,GAAL,CAAS,KAAK,CAAC,CAAN,GAAU,KAAK,eAAL,CAAqB,CAAxC,IAA8C,KAAK,MAAL,CAAY,UAD3D,EACuE;AACtE,WAAK,MAAL;;AACA,UAAI,KAAK,MAAL,CAAY,QAAhB,EAA0B;AACzB,aAAK,MAAL,CAAY,QAAZ;AACA;AACD;AAED,GAdO;AAgBR;;;AACQ,8BAAR;AACC,SAAK,UAAL,IAAmB,CAAnB;;AACA,QAAI,KAAK,MAAL,CAAY,QAAZ,IAAwB,KAAK,UAAL,GAAkB,KAAK,MAAL,CAAY,WAA1D,EAAuE;AAEtE,WAAK,MAAL,CAAY,QAAZ,CAAqB;AACpB,aAAK,EAAE,KAAK,UADQ;AAEpB,aAAK,EAAE,IAAI,CAAC,GAAL,CAAS,CAAT,EAAY,CAAC,KAAK,UAAL,GAAkB,KAAK,MAAL,CAAY,WAA/B,KAA+C,KAAK,MAAL,CAAY,cAAZ,GAA6B,KAAK,MAAL,CAAY,WAAxF,CAAZ;AAFa,OAArB;AAKA;AACD,GAVO;AAYR;;;AACQ,qCAAR;AACC,QAAI,KAAK,UAAL,IAAmB,KAAK,MAAL,CAAY,cAAnC,EAAmD;AAClD,WAAK,MAAL;;AACA,UAAI,KAAK,MAAL,CAAY,UAAhB,EAA4B;AAC3B,aAAK,MAAL,CAAY,UAAZ,CAAuB,KAAK,MAA5B;AACA;AACD;AACD,GAPO;AASR;;;AACQ,6BAAR;AACC,SAAK,UAAL,GAAkB,CAAlB;AACA,SAAK,YAAL,GAAoB,KAApB;AACA,SAAK,eAAL,GAAuB,KAAvB;AACA,SAAK,eAAL,GAAuB,IAAvB;AACA,GALO;;AAOT;AAAC,CApHD,CAA6B,eAA7B;;AAAa,0B;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACFb,0G,CACA;;;AAEA;AAAA;AAAA;AAAmC;;AAAnC;;AAyBC;;AArBO,mCAAP;AACC,SAAK,YAAL,GAAoB,KAAK,UAAL,CAAgB,aAAhB,CAA8B,4BAA9B,CAApB;AACA,GAFM;;AAIA,qCAAP,UAAgB,KAAhB,EAA6B;AAC5B,QAAI,KAAK,GAAW,MAAM,KAA1B;AACA,QAAI,CAAC,QAAL,CAAc,EAAd,CAAiB,KAAK,YAAtB,EAAoC,CAApC,EAAuC;AAAC,WAAK,EAAE;AAAR,KAAvC;AACA,GAHM;;AAKA,uCAAP;AACC;AACA;AACA,QAAI,CAAC,QAAL,CAAc,EAAd,CAAiB,oBAAjB,EAAuC,GAAvC,EAA4C;AAAC,eAAS,EAAE,CAAZ;AAAe,WAAK,EAAC,CAArB;AAAwB,UAAI,EAAE,IAAI,CAAC,MAAL,CAAY;AAA1C,KAA5C;AACA,GAJM;;AAMA,sCAAP;AACC;AACA;AACA,QAAI,CAAC,QAAL,CAAc,EAAd,CAAiB,oBAAjB,EAAuC,GAAvC,EAA4C;AAAC,eAAS,EAAE,CAAZ;AAAe,WAAK,EAAC,CAArB;AAAwB,UAAI,EAAE,IAAI,CAAC,MAAL,CAAY;AAA1C,KAA5C;AACA,GAJM;;AAMR;AAAC,CAzBD,CAAmC,eAAnC;;AAAa,sC;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACHb;;AACA,0G,CACA;;;AACA;;AAEA;AAAA;AAAA;AAA4B;;AAA5B;AAAA;;AAEQ,mBAAS;AACf,iBAAW,EAAE,CADE;AAEf,8BAAwB,EAAE,CAFX;AAGf,WAAK,EAAE;AAHQ,KAAT;AAUC,wBAAsB,CAAtB;AAEA,4BAA0B,CAA1B;AACA,yBAAwB,KAAxB;;AAwMR;;AAtMO,4BAAP;AAEC,SAAK,OAAL,GAAe,KAAK,UAAL,CAAgB,gBAAhB,CAAiC,mBAAjC,CAAf;AACA,SAAK,GAAL,CAAS,QAAT,CAAkB,KAAK,UAAvB,EAAmC,YAAU,KAAK,OAAL,CAAa,MAA1D;AACA,SAAK,GAAL,CAAS,QAAT,CAAkB,KAAK,OAAL,CAAa,KAAK,MAAL,CAAY,WAAzB,CAAlB,EAAyD,WAAzD;AAEA,SAAK,WAAL,GAAmB,KAAK,MAAL,CAAY,WAA/B;AAEA,QAAI,YAAY,GAAG,MAAI,KAAK,EAAT,GAAW,oBAA9B;AACA,oBAAO,EAAP,CAAU,OAAV,EAAmB,YAAnB,EAAiC,KAAK,UAAL,CAAgB,IAAhB,CAAqB,IAArB,CAAjC;AACA,oBAAO,EAAP,CAAU,WAAV,EAAuB,YAAvB,EAAqC,UAAC,CAAD,EAAc;AAAK,cAAC,CAAD;AAAkB,KAA1E;;AAEA,QAAK,KAAK,GAAL,CAAS,QAAT,CAAkB,KAAK,UAAvB,EAAmC,QAAnC,CAAL,EAAmD;AAClD,WAAK,gBAAL;AACA;AAED,GAhBM;;AAkBA,kCAAP,UAAoB,KAApB,EAAmC;AAClC,SAAK,QAAL,GAAgB,KAAhB;AACA,GAFM;AAIP;;;AACO,kCAAP,UAAoB,OAApB,EAAwC;AACvC,SAAK,UAAL,GAAkB,OAAlB;AACA,SAAK,OAAL,GAAe,IAAf;AACA,GAHM;;AAKA,0BAAP,UAAY,IAAZ,EAAsC,KAAtC,EAAuD;AAA3C;AAAA;AAAwB;;AAAE;AAAA;AAAiB;;AACtD,QAAI,IAAI,KAAK,SAAb,EAAwB;AACvB,UAAI,CAAC,QAAL,CAAc,GAAd,CAAkB,MAAI,KAAK,EAAT,GAAW,oBAA7B,EAAmD;AAAC,SAAC,EAAE,EAAJ;AAAQ,iBAAS,EAAE;AAAnB,OAAnD;AACA,KAFD,MAEO,IAAI,IAAI,KAAK,MAAb,EAAqB;AAC3B,UAAI,CAAC,QAAL,CAAc,EAAd,CAAiB,KAAK,UAAtB,EAAkC,GAAlC,EAAuC;AAAC,iBAAS,EAAE,CAAZ;AAAe,YAAI,EAAE,IAAI,CAAC,MAAL,CAAY,QAAjC;AAA2C,aAAK,EAAE;AAAlD,OAAvC;AACA;AACD,GANM;;AAQA,0BAAP,UAAY,IAAZ,EAAsC,KAAtC,EAAuD;AAA3C;AAAA;AAAwB;;AAAE;AAAA;AAAiB;;AAEtD,QAAI,CAAC,QAAL,CAAc,GAAd,CAAkB,KAAK,UAAvB,EAAmC;AAAC,aAAO,EAAE;AAAV,KAAnC;;AAEA,QAAI,IAAI,KAAK,SAAb,EAAwB;AACvB,UAAI,CAAC,QAAL,CAAc,GAAd,CAAkB,KAAK,UAAvB,EAAmC;AAAC,iBAAS,EAAE;AAAZ,OAAnC;AACA,UAAI,CAAC,QAAL,CAAc,GAAd,CAAkB,MAAI,KAAK,EAAT,GAAW,oBAA7B,EAAmD;AAAC,SAAC,EAAE,EAAJ;AAAQ,iBAAS,EAAE;AAAnB,OAAnD;AACA,UAAI,CAAC,QAAL,CAAc,SAAd,CAAwB,MAAI,KAAK,EAAT,GAAW,oBAAnC,EAAyD,GAAzD,EAA8D;AAC9D,SAAC,EAAE,CAD2D;AACvD,iBAAS,EAAE,CAD4C;AACzC,YAAI,EAAE,IAAI,CAAC,IAAL,CAAU,OADyB;AAChB,aAAK,EAAE;AADS,OAA9D,EAC6D,IAD7D;AAEA,KALD,MAKO,IAAI,IAAI,KAAK,MAAb,EAAqB;AAC3B,UAAI,CAAC,QAAL,CAAc,GAAd,CAAkB,KAAK,UAAvB,EAAmC;AAAC,iBAAS,EAAE;AAAZ,OAAnC;AACA,UAAI,CAAC,QAAL,CAAc,EAAd,CAAiB,KAAK,UAAtB,EAAkC,GAAlC,EAAuC;AAAC,iBAAS,EAAE,CAAZ;AAAe,YAAI,EAAE,IAAI,CAAC,MAAL,CAAY,QAAjC;AAA2C,aAAK,EAAE;AAAlD,OAAvC;AACA,UAAI,CAAC,QAAL,CAAc,GAAd,CAAkB,MAAI,KAAK,EAAT,GAAW,oBAA7B,EAAmD;AAAC,SAAC,EAAE,CAAJ;AAAO,iBAAS,EAAE;AAAlB,OAAnD;AACA;AAED,GAfM;;AAiBA,oCAAP,UAAsB,KAAtB,EAAqC,sBAArC,EAA4E;AAAvC;AAAA;AAAuC;;AAE3E,QAAI,QAAQ,GAAG,KAAK,MAAL,CAAY,WAA3B;;AAEA,QAAI,CAAC,sBAAL,EAA8B;AAC7B,WAAK,MAAL,CAAY,WAAZ,GAA0B,KAA1B;AACA,KAFD,MAEO;AACN,cAAQ,GAAG,KAAK,cAAhB;AACA;;AAED,SAAK,MAAL,CAAY,WAAZ,GAA0B,KAA1B;AAEA,SAAK,GAAL,CAAS,WAAT,CAAqB,KAAK,OAAL,CAAa,QAAb,CAArB,EAA6C,WAA7C;;AAEA,QAAI,KAAK,GAAG,QAAZ,EAAsB;AACrB,WAAK,GAAL,CAAS,QAAT,CAAkB,KAAK,OAAL,CAAa,QAAb,CAAlB,EAA0C,UAA1C;AACA,WAAK,GAAL,CAAS,WAAT,CAAqB,KAAK,OAAL,CAAa,KAAb,CAArB,EAA0C,UAA1C;AACA,KAHD,MAGO;AACN,WAAK,GAAL,CAAS,WAAT,CAAqB,KAAK,OAAL,CAAa,QAAb,CAArB,EAA6C,UAA7C;AACA,WAAK,GAAL,CAAS,QAAT,CAAkB,KAAK,OAAL,CAAa,KAAb,CAAlB,EAAuC,UAAvC;AACA;;AAED,SAAK,GAAL,CAAS,QAAT,CAAkB,KAAK,OAAL,CAAa,KAAb,CAAlB,EAAuC,WAAvC;AAEA,GAxBM;;AA0BA,oCAAP;AAEC,QAAI,KAAK,cAAT,EAAyB;AACxB,aAAO,CAAP;AACA;;AAED,WAAO,KAAK,MAAL,CAAY,WAAnB;AACA,GAPM;AASP;;;AACO,mCAAP,UAAqB,KAArB,EAAkC;AACjC,WAAO,KAAK,OAAL,CAAa,KAAb,EAAoB,YAApB,CAAiC,WAAjC,CAAP;AACA,GAFM;AAIP;;;AACO,yCAAP,UAA2B,KAA3B,EAAwC;AAEvC,SAAK,WAAL,GAAmB,IAAI,CAAC,KAAL,CAAW,KAAK,OAAL,CAAa,MAAb,GAAsB,KAAjC,CAAnB;;AAEA,QAAI,KAAK,WAAL,KAAqB,KAAK,MAAL,CAAY,WAArC,EAAmD;AAClD,WAAK,cAAL,CAAoB,KAAK,WAAzB;AACA;;AAED,WAAO,KAAK,MAAL,CAAY,WAAnB;AAEA,GAVM;AAYP;;;AACO,sCAAP;AAAA;;AACC,SAAK,GAAL,CAAS,QAAT,CAAkB,KAAK,UAAvB,EAAmC,QAAnC;AACA,iBAAa,CAAC,KAAK,cAAN,CAAb;AACA,SAAK,cAAL,GAAsB,WAAW,CAAC;AACjC,WAAI,CAAC,WAAL;AACA,KAFgC,EAE9B,GAF8B,CAAjC;AAGA,GANM;AAQP;;;AACO,uCAAP,UAAyB,WAAzB,EAAmD;AAA1B;AAAA;AAA0B;;AAClD,iBAAa,CAAC,KAAK,cAAN,CAAb;AACA,SAAK,cAAL,GAAsB,IAAtB;AACA,SAAK,GAAL,CAAS,WAAT,CAAqB,KAAK,UAA1B,EAAsC,QAAtC;;AACA,QAAI,WAAW,KAAK,IAApB,EAA0B;AACzB,WAAK,cAAL,CAAoB,WAApB;AACA;AACD,GAPM;AAUP;;;AACO,2BAAP;AACC,iBAAa,CAAC,KAAK,cAAN,CAAb;AACA,SAAK,WAAL,GAAmB,CAAnB;AACA,GAHM;AAKP;;;AACO,+BAAP,UAAiB,MAAjB,EAAgC;AAE/B,QAAI,MAAJ,EAAY;AACX,WAAK,GAAL,CAAS,QAAT,CAAkB,KAAK,UAAvB,EAAmC,SAAnC;AACA;AACA;;AAED,SAAK,GAAL,CAAS,WAAT,CAAqB,KAAK,UAA1B,EAAsC,SAAtC;AAEA,GATM;AAWP;;;AACO,8BAAP,UAAgB,SAAhB,EAAiC;AAChC,SAAK,GAAL,CAAS,QAAT,CAAkB,KAAK,UAAvB,EAAmC,SAAnC;AACA,GAFM;;AAIA,iCAAP,UAAmB,SAAnB,EAAoC;AACnC,SAAK,GAAL,CAAS,WAAT,CAAqB,KAAK,UAA1B,EAAsC,SAAtC;AACA,GAFM,CAtKR,CA0KC;AACA;AACA;AACA;AACA;;;AAEQ,gCAAR,UAAmB,CAAnB,EAAgC;AAAhC;;AAEC,KAAC,CAAC,cAAF;;AAEA,QAAI,KAAK,YAAT,EAAuB;AACtB,aAAO,KAAP;AACA;;AAED,QAAI,KAAK,GAAG,QAAQ,CAAC,KAAK,GAAL,CAAS,YAAT,CAAsB,CAAC,CAAC,MAAxB,EAAgC,YAAhC,CAAD,CAApB;;AACA,QAAI,KAAK,QAAT,EAAmB;AAClB,WAAK,QAAL,CAAc,KAAd;AACA;;AAED,QAAI,KAAK,MAAL,CAAY,KAAhB,EAAuB;AACtB,cAAG,KAAH,CAAS,IAAT,EAAe,cAAf,EAA+B,WAAS,KAAxC;AACA;;AAED,QAAI,KAAK,MAAL,CAAY,wBAAZ,GAAuC,CAA3C,EAA8C;AAC7C,WAAK,YAAL,GAAoB,IAApB;AACA,gBAAU,CAAE;AAAO,oBAAI,CAAC,YAAL;AAA0B,OAAnC,EAAqC,KAAK,MAAL,CAAY,wBAAZ,GAAuC,IAA5E,CAAV;AACA;;AAED,WAAO,KAAP;AAEA,GAxBO;;AA0BA,iCAAR;AAEC,SAAK,cAAL,GAAsB,KAAK,WAA3B;AACA,SAAK,WAAL,IAAoB,KAAK,eAAzB;;AAEA,QAAI,KAAK,WAAL,KAAqB,KAAK,OAAL,CAAa,MAAb,GAAsB,CAA3C,IAAgD,KAAK,WAAL,KAAqB,CAAzE,EAA4E;AAC3E,WAAK,eAAL,IAAwB,CAAC,CAAzB;AACA;;AAED,SAAK,cAAL,CAAoB,KAAK,WAAzB,EAAsC,IAAtC;AAEA,GAXO;;AAaT;AAAC,CAvND,CAA4B,eAA5B;;AAAa,wB;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACLb,sH,CAEA;AAEA;;;AACA;AAAA;AAAA;AAAgC;;AAAhC;;AAkBC;;AAbO,gCAAP,UAAc,UAAd,EAAiD,QAAjD,EAA6E;AAC5E,qBAAM,MAAN,CAAY,IAAZ,CAAY,IAAZ,EAAa,UAAb,EAAyB,QAAzB;;AACA,SAAK,WAAL,GAAmB,IAAI,IAAI,CAAC,MAAT,CAAgB,QAAQ,CAAC,iBAAzB,CAAnB;AACA,SAAK,KAAL,GAAa,IAAI,IAAI,CAAC,MAAT,CAAgB,QAAQ,CAAC,WAAzB,CAAb;;AAEA,SAAK,KAAL,CAAW,MAAX,CAAkB,GAAlB,CAAsB,GAAtB,EAA2B,GAA3B;;AACA,SAAK,WAAL,CAAiB,MAAjB,CAAwB,GAAxB,CAA4B,GAA5B,EAAiC,GAAjC;;AACA,SAAK,OAAL,CAAa,MAAb,CAAoB,GAApB,CAAwB,GAAxB,EAA6B,GAA7B;;AACA,SAAK,OAAL,CAAa,QAAb,CAAsB,KAAK,WAA3B,EAAwC,KAAK,KAA7C;;AACA,SAAK,WAAL,CAAiB,IAAjB,GAAwB,KAAK,KAA7B;AAEA,GAXM;;AAaR;AAAC,CAlBD,CAAgC,2BAAhC;;AAAa,gC;;;;;;;;;;;;;;;;;;ACLb;;AAKA;;AACA;;AAEA;AAAA;AAAA;AA+CC,2BAAY,MAAZ,EAAkC,iBAAlC,EAA2E,gBAA3E,EAAkH,cAAlH,EAAuJ;AAArH;AAAA;AAAsC;;AAAG;AAAA;AAAqC;;AAAE;AAAA;AAAqC;;AA7C/I,kBAA6B,qCAAkB,KAA/C;AAQA,wBAAuB,CAAvB;AACA,wBAAuB,CAAvB;AACA,kBAAiB,CAAjB;AACA,kBAAiB,CAAjB;AAGA,mBAAkB,CAAlB;AACA,mBAAkB,CAAlB;AACA,mBAAkB,CAAlB;AACA,mBAAkB,CAAlB;AAEA,0BAAyB,CAAzB;AACA,0BAAyB,CAAzB;AAQA,wBAAwB,KAAxB;AACA,yBAAyB,KAAzB;AAkBP,SAAK,MAAL,GAAc,sBAAU,UAAV,CAAqB,GAArB,CAAyB,OAAzB,CAAd;AACA,SAAK,KAAL,GAAa,sBAAU,IAAvB;AACA,SAAK,OAAL,GAAe,MAAf;AACA,SAAK,kBAAL,GAA0B,iBAA1B;AACA,SAAK,iBAAL,GAAyB,gBAAzB;AACA,SAAK,eAAL,GAAuB,cAAvB;AAEA,SAAK,YAAL,GAAoB,MAAO,IAAI,CAAC,MAAL,KAAgB,GAA3C;AACA,SAAK,YAAL,GAAoB,CAApB,CAVsJ,CAWtJ;;AACA,SAAK,cAAL,GAAsB,IAAK,IAAI,CAAC,MAAL,KAAgB,CAA3C,CAZsJ,CActJ;;AACA,SAAK,kBAAL,GAA0B,MAAO,IAAI,CAAC,MAAL,KAAgB,GAAjD,CAfsJ,CAgBtJ;;AACA,SAAK,kBAAL,GAA0B,OAAQ,IAAI,CAAC,MAAL,KAAgB,GAAlD,CAjBsJ,CAmBtJ;AACA;AACA;AAEA;;AACA,SAAK,cAAL,GAAsB,CAAtB;AACA,SAAK,cAAL,GAAsB,CAAtB,CAzBsJ,CA2BtJ;AACA;AAEA;AACA;;AAEA,SAAK,sBAAL,GAA8B,IAAI,mDAAJ,CAC7B,CAAC,IAAD,GAAS,IAAI,CAAC,MAAL,KAAgB,IADI,EAE7B,MAAM,IAAI,CAAC,MAAL,KAAgB,GAFO,CAA9B,CAjCsJ,CAsCtJ;;AACA,SAAK,qBAAL,GAA6B,IAAI,mDAAJ,CAC5B,OAAQ,IAAI,CAAC,MAAL,KAAgB,IADI,EAE5B,IAAI,CAAC,MAAL,KAAgB,CAFY,CAA7B;AAKA;;AApDD,wBAAW,yBAAX,EAAW,aAAX,EAAsB;SAAtB,aAAuB,CAAvB,EAAkC;AACjC,WAAK,YAAL,GAAoB,CAApB;AACA,KAFqB;oBAAA;;AAAA,GAAtB;AAIA,wBAAW,yBAAX,EAAW,cAAX,EAAuB;SAAvB,aAAwB,CAAxB,EAAmC;AAClC,WAAK,aAAL,GAAqB,CAArB;AACA,KAFsB;oBAAA;;AAAA,GAAvB;;AAkDO,qCAAP,UAAc,cAAd,EAAsC,eAAtC,EAA6D;AAC5D,SAAK,sBAAL,CAA4B,MAA5B,CAAmC,cAAnC,EAAmD,eAAnD;;AACA,SAAK,qBAAL,CAA2B,MAA3B,CAAkC,cAAlC,EAAkD,eAAlD;AAEA,GAJM;;AAMA,mCAAP,UAAY,UAAZ,EAA+B,SAA/B,EAAkD,UAAlD,EAAsE,SAAtE,EAAyF,YAAzF,EAA+G,WAA/G,EAAkI;AAE9H;AACA,SAAK,SAAL,GAAiB,KAAK,KAAL,CAAW,QAAX,CAChB;AAAC,OAAC,EAAE,UAAU,CAAC,CAAX,GAAe,KAAK,cAAxB;AAAwC,OAAC,EAAE,UAAU,CAAC,CAAX,GAAe,KAAK;AAA/D,KADgB,EAEhB;AAAC,OAAC,EAAE,KAAK,OAAL,CAAa,CAAjB;AAAoB,OAAC,EAAE,KAAK,OAAL,CAAa;AAApC,KAFgB,CAAjB;AAKG,SAAK,yBAAL,GAAiC,CAAjC;AAEA,QAAI,WAAW,GAAY,KAAK,MAAL,KAAgB,qCAAkB,cAAnC,GAAqD,GAArD,GAA2D,EAArF;AACA,QAAI,SAAS,GAAW,CAAxB;;AAEA,QAAI,KAAK,MAAL,KAAgB,qCAAkB,iBAAtC,EAAyD;AACxD,iBAAW,GAAG,GAAd;AACA,KAFD,MAEO,IAAI,KAAK,MAAL,KAAgB,qCAAkB,MAAtC,EAA8C;AACpD,iBAAW,GAAG,IAAd;AAAmB;AACnB,eAAS,GAAG,EAAZ;AACA,KAlB0H,CAoB5H;AAEL;AACA;AAEA;;;AAIA,QAAM,KAAK,SAAL,GAAiB,KAAK,kBAAtB,IAA6C,KAAK,MAAL,KAAgB,qCAAkB,cAAhF,IAAmG,KAAK,MAAL,KAAgB,qCAAkB,iBAArI,IAA0J,KAAK,MAAL,KAAgB,qCAAkB,MAA5L,IAAsM,KAAK,MAAL,KAAgB,qCAAkB,OAA7O,EAAsP;AAErP,WAAK,kBAAL,CAAwB,SAAxB,CAAkC,IAAlC;;AACA,WAAK,iBAAL,CAAuB,SAAvB,CAAiC,KAAjC;;AACA,WAAK,eAAL,CAAqB,SAArB,CAA+B,IAA/B;;AAGC,WAAK,yBAAL,GAAiC,KAAK,SAAL,GAAiB,KAAK,kBAAvD;;AACA,UAAI,KAAK,yBAAL,GAAiC,CAArC,EAAwC;AACvC,aAAK,yBAAL,GAAiC,CAAjC;AACA,OAVmP,CAYpP;;;AACA,WAAK,yBAAL,GAAiC,IAAI,KAAK,yBAA1C;AAEA,WAAK,YAAL,GAAqB,UAAU,CAAC,CAAX,IAAgB,SAAS,GAAG,UAA5B,IAA0C,KAAK,cAA/C,GAAgE,YAAhE,GAA+E,WAApG;AACA,WAAK,YAAL,GAAqB,UAAU,CAAC,CAAX,GAAe,SAAf,GAA2B,KAAK,cAArD;;AAEA,UAAI,KAAK,MAAL,KAAgB,qCAAkB,MAAtC,EAA8C;AAE7C;AACA,aAAK,qBAAL,CAA2B,MAA3B,CACC,UAAU,GAAG,KAAK,cAAlB,GAAmC,YAAnC,GAAkD,WADnD,EAEC,KAAK,cAFN,EAH6C,CAQ7C;AACA;;;AACA,aAAK,YAAL,GAAqB,KAAK,qBAAL,CAA2B,CAA3B,IAAgC,SAAS,GAAG,UAA5C,IAA0D,KAAK,cAA/D,GAAgF,YAAhF,GAA+F,WAApH;AACA,aAAK,YAAL,GAAqB,KAAK,qBAAL,CAA2B,CAA3B,GAA+B,SAA/B,GAA2C,KAAK,cAArE;AAEA;;AAEC,UAAI,KAAK,MAAL,KAAgB,qCAAkB,OAAtC,EAA+C;AAEhD,aAAK,sBAAL,CAA4B,MAA5B,CACC,UAAU,GAAG,YAAb,GAA4B,WAD7B,EAEC,KAAK,cAFN;;AAKA,aAAK,YAAL,GAAqB,KAAK,sBAAL,CAA4B,CAA5B,IAAiC,SAAS,GAAG,UAA7C,IAA2D,KAAK,cAAhE,GAAiF,YAAjF,GAAgG,WAArH;AACA,aAAK,YAAL,GAAqB,KAAK,sBAAL,CAA4B,CAA5B,GAAgC,SAAhC,GAA4C,KAAK,cAAtE;AAEA;;AAED,UAAM,MAAe,CAAC,WAAhB,IAA+B,CAAC,KAAK,YAA3C,EAAyD;AACzD,aAAK,YAAL,GAAoB,CAApB;AACA,aAAK,YAAL,GAAoB,CAApB;AACA;AAEA,KAlDF,MAkDS;AAEP,WAAK,kBAAL,CAAwB,SAAxB,CAAkC,KAAlC;;AACA,WAAK,iBAAL,CAAuB,SAAvB,CAAiC,IAAjC;;AACA,WAAK,eAAL,CAAqB,SAArB,CAA+B,KAA/B;;AACA,WAAK,YAAL,GAAqB,CAArB;AACA,WAAK,YAAL,GAAoB,CAApB;AAEA;;AAEF,SAAK,iBAAL,GAAyB,KAAK,cAAL,GAAuB,SAAS,GAAG,KAAK,yBAAjE,CAzFiI,CA2FjI;AACA;AAEA;AACA;;AAGA,QAAI,KAAK,YAAL,GAAoB,KAAK,MAAzB,GAAkC,WAAtC,EAAmD;AAClD,WAAK,YAAL,GAAoB,KAAK,MAAL,GAAc,WAAlC;AACA,KAFD,MAEO,IAAI,KAAK,YAAL,GAAoB,KAAK,MAAzB,GAAkC,CAAC,WAAvC,EAAoD;AAC1D,WAAK,YAAL,GAAoB,KAAK,MAAL,GAAc,WAAlC;AACA;;AAED,QAAI,KAAK,YAAL,GAAoB,KAAK,MAAzB,GAAkC,WAAtC,EAAmD;AAClD,WAAK,YAAL,GAAoB,KAAK,MAAL,GAAc,WAAlC;AACA,KAFD,MAEO,IAAI,KAAK,YAAL,GAAoB,KAAK,MAAzB,GAAkC,CAAC,WAAvC,EAAoD;AAC1D,WAAK,YAAL,GAAoB,KAAK,MAAL,GAAc,WAAlC;AACA;;AAED,SAAK,MAAL,GAAe,KAAK,MAAL,GAAe,CAAC,KAAK,YAAL,GAAoB,KAAK,MAA1B,IAAsC,KAAK,iBAAzE;AACA,SAAK,MAAL,GAAe,KAAK,MAAL,GAAe,CAAC,KAAK,YAAL,GAAoB,KAAK,MAA1B,IAAqC,KAAK,iBAAxE;AAEA,GAjHM;;AAmHA,mCAAP;AACC,WAAO,KAAK,MAAZ;AACA,GAFM;;AAIA,mCAAP;AACC,WAAO,KAAK,MAAZ;AACA,GAFM;AAIP;;;AACO,+CAAP,UAAyB,KAAzB,EAAiD;AAChD,SAAK,MAAL,GAAc,KAAd;AACA,GAFM;;AAIR;AAAC,CAnOD;;AAAa,0C;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACRb;;AAEA,mF,CAEA;;;AAEA,IAAY,cAAZ;;AAAA,WAAY,cAAZ,EAA0B;AAAE;AAAmB;AAAc,CAA7D,EAAY,cAAc,GAAd,oDAAc,EAAd,CAAZ,E,CAEA;;;AACA;AAAA;AAAA;AAAmC;;AAAnC;AAAA,0EAEC;;;AACQ,4BAAuC,EAAvC;AACA,0BAAwB,CAAxB;AACA,wBAA8B,cAAc,CAAC,MAA7C;;AAsMR;;AApMO,mCAAP,UAAc,UAAd,EAAiD,QAAjD,EAA6E;AAC5E;AACA,SAAK,WAAL,GAAoB,UAAU,CAAC,UAAZ,GAA0B,UAAU,CAAC,UAArC,GAAkD,cAAc,CAAC,MAApF;AACA,SAAK,EAAL,GAAW,UAAU,CAAC,EAAtB;AACA,SAAK,IAAL,GAAY,gCAAiB,cAA7B;AACA,SAAK,aAAL,GAAqB,IAArB;AACA,SAAK,UAAL,GAAmB,KAAK,SAAL,GAAiB,GAAlB,GAAyB,uBAAe,OAAxC,GAAkD,uBAAe,MAAnF;;AACA,SAAK,qBAAL,CAA2B,UAA3B,EAAuC,QAAvC;AACA,GARM;;AAUA,mCAAP,UAAc,cAAd,EAAsC,eAAtC,EAA+D,YAA/D,EAAqF,UAArF,EAAuG;AACtG,SAAK,eAAL,CAAqB,OAArB,CAA8B,UAAC,QAAD,EAAS;AACtC,cAAQ,CAAC,MAAT,CAAgB,cAAhB,EAAgC,eAAhC,EAAiD,YAAjD,EAA+D,UAA/D;AACA,KAFD;AAGA,GAJM;;AAMA,iCAAP,UAAY,cAAZ,EAAoC,UAApC,EAAwD,WAAxD,EAA6E,WAA7E,EAAkG,WAAlG,EAAgI,aAAhI,EAA2J,OAA3J,EAAqL,UAArL,EAA6M,SAA7M,EAAkO;AAAhI;AAAA;AAA4B;;AAAE;AAAA;AAAyB;;AAAE;AAAA;AAAwB;;AAAE;AAAA;AAAsB;;AAAE;AAAA;AAAqB;;AACjO,SAAK,eAAL,CAAqB,OAArB,CAA8B,UAAC,QAAD,EAAS;AACtC,cAAQ,CAAC,IAAT,CAAc,cAAd,EAA8B,UAA9B,EAA0C,WAA1C,EAAuD,WAAvD,EAAoE,WAApE,EAAiF,aAAjF,EAAgG,OAAhG,EAAyG,UAAzG,EAAqH,SAArH;AACA,KAFD;AAGA,GAJM;;AAMA,0CAAP,UAAqB,KAArB,EAAoC,KAApC,EAAqD;AAAjB;AAAA;AAAiB;;AACpD,SAAK,eAAL,CAAqB,OAArB,CAA8B,UAAC,QAAD,EAAS;AACtC,cAAQ,CAAC,aAAT,CAAuB,KAAvB,EAA8B,KAA9B;AACA,KAFD;AAGA,GAJM;;AAMA,4CAAP,UAAuB,KAAvB,EAA0C;AAAnB;AAAA;AAAmB;;AACzC,SAAK,eAAL,CAAqB,OAArB,CAA8B,UAAC,QAAD,EAAS;AACtC,cAAQ,CAAC,eAAT,CAAyB,KAAzB;AACA,KAFD;AAGA,GAJM;;AAMA,wDAAP;AACC,SAAK,eAAL,CAAqB,OAArB,CAA8B,UAAC,QAAD,EAAS;AACtC,cAAQ,CAAC,2BAAT;AACA,KAFD;AAGA,GAJM;;AAMA,kCAAP;AACC,SAAK,eAAL,CAAqB,OAArB,CAA8B,UAAC,QAAD,EAAS;AACtC,cAAQ,CAAC,KAAT;AACA,KAFD;AAGA,GAJM;;AAMA,0CAAP,UAAqB,IAArB,EAAiC;AAChC,SAAK,eAAL,CAAqB,OAArB,CAA8B,UAAC,QAAD,EAAS;AACtC,cAAQ,CAAC,aAAT,CAAuB,IAAvB;AACA,KAFD;AAGA,GAJM;;AAMA,qCAAP;AACC,WAAO,KAAK,eAAZ;AACA,GAFM,CA3DR,CA+DC;AACA;;;AACQ,kDAAR,UAA8B,YAA9B,EAAmE,QAAnE,EAA+F;AAE9F,QAAI,SAAJ;AACA,QAAI,SAAJ;AACA,QAAI,SAAJ;AACA,QAAI,mBAAJ;AACA,QAAI,kBAAJ;AACA,QAAI,aAAa,GAAW,YAAY,CAAC,SAAb,GAAyB,YAAY,CAAC,QAAlE;AACA,QAAI,aAAa,GAAW,YAAY,CAAC,SAAb,GAAyB,YAAY,CAAC,QAAlE;AACA,QAAI,iBAAiB,GAAY,YAAY,CAAC,QAAb,GAAwB,CAAzD;AACA,QAAI,kBAAkB,GAAW,YAAY,CAAC,QAAb,GAAwB,CAAzD;AACA,QAAI,IAAI,GAAW,EAAnB;AACA,QAAI,IAAI,GAAW,IAAI,CAAC,KAAL,CAAW,YAAY,CAAC,aAAb,GAA6B,IAAxC,CAAnB;AACA,QAAI,YAAY,GAAW,iBAAiB,GAAG,IAA/C;AACA,QAAI,YAAY,GAAW,kBAAkB,GAAG,IAAhD;AACA,QAAI,QAAQ,GAAW,CAAvB;AACA,QAAI,QAAQ,GAAW,CAAvB;AACA,QAAI,mBAAmB,GAAW,CAAlC;AACA,QAAI,cAAc,GAAW,IAAI,IAAjC;;AAEA,SAAK,IAAI,CAAC,GAAG,CAAb,EAAgB,CAAC,GAAG,YAAY,CAAC,aAAjC,EAAgD,CAAC,EAAjD,EAAqD;AAEpD,UAAI,KAAK,WAAL,KAAqB,cAAc,CAAC,MAAxC,EAAgD;AAC/C,iBAAS,GAAG,KAAK,2BAAL,CAAiC,YAAY,CAAC,SAA9C,EAAyD,YAAY,CAAC,QAAtE,EAAgF,IAAhF,CAAZ;AACA,iBAAS,GAAG,KAAK,2BAAL,CAAiC,YAAY,CAAC,SAA9C,EAAyD,YAAY,CAAC,QAAtE,EAAgF,IAAhF,CAAZ;AACA,iBAAS,GAAI,KAAK,2BAAL,CAAiC,YAAY,CAAC,SAA9C,EAAyD,YAAY,CAAC,QAAtE,CAAb;AACA,2BAAmB,GAAG,KAAK,2BAAL,CAAiC,YAAY,CAAC,mBAA9C,EAAmE,YAAY,CAAC,UAAhF,CAAtB;AACA,0BAAkB,GAAG,KAAK,2BAAL,CAAiC,YAAY,CAAC,mBAA9C,EAAmE,YAAY,CAAC,YAAhF,CAArB;AACA,OAND,MAMO,IAAI,KAAK,WAAL,KAAqB,cAAc,CAAC,IAAxC,EAA8C;AACpD,iBAAS,GAAI,aAAa,GAAI,QAAQ,GAAG,YAAzC;AACA,iBAAS,GAAI,aAAa,GAAI,QAAQ,GAAG,YAAzC,CAFoD,CAGpD;;AACA,iBAAS,GAAG,YAAY,CAAC,SAAzB;AACA,2BAAmB,GAAG,YAAY,CAAC,mBAAnC,CALoD,CAMpD;;AACA,0BAAkB,GAAG,CAAC,CAAD,GAAM,YAAY,CAAC,kBAAxC;AACA,2BAAmB,GAAG,QAAQ,GAAG,cAAjC;AACA,gBAAQ;;AACR,YAAI,QAAQ,KAAK,IAAjB,EAAuB;AACtB,kBAAQ,GAAG,CAAX;AACA,kBAAQ;AACR;AACD;;AAED,UAAI,MAAM,GAA0B;AACnC,UAAE,EAAK,YAAY,CAAC,EAAb,GAAe,YAAf,GAA4B,CADA;AAEnC,iBAAS,EAAE,SAFwB;AAGnC,iBAAS,EAAE,SAHwB;AAInC,iBAAS,EAAE,SAJwB;AAKnC,2BAAmB,EAAE,mBALc;AAMnC,0BAAkB,EAAE,kBANe;AAOnC,iBAAS,EAAE,YAAY,CAAC,SAPW;AAQnC,kBAAU,EAAE,YAAY,CAAC,UARU;AASnC,iBAAS,EAAE,YAAY,CAAC,SATW;AAUnC,sBAAc,EAAE,YAAY,CAAC,cAVM;AAWnC,kBAAU,EAAG,YAAY,CAAC,UAXS;AAYnC,gBAAQ,EAAG,YAAY,CAAC,QAZW;AAanC,gBAAQ,EAAG,YAAY,CAAC,QAbW;AAcnC,iBAAS,EAAG,YAAY,CAAC,SAdU;AAenC,cAAM,EAAE,IAf2B;AAgBnC,aAAK,EAAE,YAAY,CAAC,KAhBe;AAiBnC,mBAAW,EAAG,YAAY,CAAC,WAAd,GAA6B,YAAY,CAAC,WAA1C,GAAwD,IAjBlC;AAkBnC,mBAAW,EAAG,YAAY,CAAC,WAAd,GAA6B,YAAY,CAAC,WAA1C,GAAwD,IAlBlC;AAmBnC,YAAI,EAAG,YAAY,CAAC,IAAd,GAAsB,YAAY,CAAC,IAAnC,GAA0C,IAnBb;AAoBnC,YAAI,EAAG,YAAY,CAAC,IAAd,GAAsB,YAAY,CAAC,IAAnC,GAA0C,IApBb;AAqBnC,qBAAa,EAAG,YAAY,CAAC,aAAd,GAA+B,YAAY,CAAC,aAA5C,GAA4D,IArBxC;AAsBnC,2BAAmB,EAAE;AAtBc,OAApC;;AAyBA,UAAI,OAAO,GAAiB,KAAK,WAAL,CAAiB,QAAQ,CAAC,QAA1B,CAA5B;;AAEA,WAAK,eAAL,CAAqB,IAArB,CAA2B,KAAK,oBAAL,CAA0B,MAA1B,EAAkC,OAAlC,EAA2C,QAAQ,CAAC,SAApD,CAA3B;AAEA;AAED,GA3EO;;AA6EA,wDAAR,UAAoC,IAApC,EAAkD,IAAlD,EAAgE,OAAhE,EAAwF;AAAxB;AAAA;AAAwB;;AAEvF,QAAI,SAAS,GAAY,IAAI,CAAC,MAAL,KAAgB,GAAjB,GAAwB,CAAC,CAAzB,GAA6B,CAArD;AACA,QAAI,WAAJ;;AAEA,QAAI,OAAJ,EAAa;AACZ,iBAAW,GAAM,KAAK,IAAI,GAAG,IAAI,CAAC,MAAL,EAAZ,CAAjB;AACA,KAFD,MAEO;AACN,iBAAW,GAAG,IAAI,IAAI,IAAI,GAAG,IAAI,CAAC,MAAL,EAAX,CAAlB;AACA;;AAED,WAAO,IAAI,GAAI,WAAW,GAAG,SAA7B;AACA,GAZO;;AAcA,wCAAR,UAAoB,QAApB,EAAiD;AAEhD,QAAI,OAAO,GAAiB,QAAQ,CAAC,KAAK,aAAN,CAApC;AAEA,SAAK,aAAL;;AACA,QAAI,KAAK,aAAL,KAAuB,QAAQ,CAAC,MAApC,EAA4C;AAC3C,WAAK,aAAL,GAAqB,CAArB;AACA;;AAED,WAAO,OAAP;AAEA,GAXO;;AAaA,iDAAR,UAA6B,MAA7B,EAA4D,OAA5D,EAAmF,SAAnF,EAA4G;AAE3G;AACA,QAAI,IAAI,GAAG,IAAI,2BAAJ,EAAX;AAEA,QAAI,CAAC,SAAL,GAAiB,MAAM,CAAC,SAAxB;AACA,QAAI,CAAC,SAAL,GAAiB,MAAM,CAAC,SAAxB;AACA,QAAI,CAAC,SAAL,GAAiB,MAAM,CAAC,SAAxB;AACA,QAAI,CAAC,mBAAL,GAA2B,MAAM,CAAC,mBAAlC;AACA,QAAI,CAAC,kBAAL,GAA0B,MAAM,CAAC,kBAAjC;;AAEA,QAAI,MAAM,CAAC,KAAX,EAAkB;AACjB,UAAI,CAAC,KAAL,GAAa,MAAM,CAAC,KAApB;AACA;;AAED,QAAI,MAAM,CAAC,IAAX,EAAiB;AAChB,UAAI,CAAC,IAAL,GAAY,MAAM,CAAC,IAAnB;AACA,KAjB0G,CAoB3G;AACC;AACD;;;AAGA,QAAI,CAAC,MAAL,CAAY,MAAZ,EAAoB;AACnB,eAAS,EAAE,SADQ;AAEnB,aAAO,EAAE;AAFU,KAApB;AAKA,WAAO,IAAP;AAEA,GAhCO;;AAkCT;AAAC,CA3MD,CAAmC,2BAAnC;;AAAa,sC;;;;;;;;;;;;;;;;;;ACJb;AAAA;AAAA;AAaC,wBAAY,MAAZ,EAAkC,WAAlC,EAAwD,YAAxD,EAA+E,QAA/E,EAAiG,QAAjG,EAAiH;AAChH,SAAK,OAAL,GAAe,MAAf;AACA,SAAK,YAAL,GAAoB,WAApB;AACA,SAAK,aAAL,GAAqB,YAArB;AACA,SAAK,SAAL,GAAiB,QAAjB;AACA,SAAK,SAAL,GAAiB,QAAjB;AACA,SAAK,WAAL,GAAmB,KAAK,SAAL,GAAiB,KAAK,SAAzC;AACA;;AAEM,gCAAP,UAAY,UAAZ,EAA6B;AAE5B,SAAK,UAAL,GAAkB,UAAU,CAAC,CAAX,GAAe,KAAK,OAAL,CAAa,QAAb,CAAsB,CAAvD;AACA,SAAK,UAAL,GAAkB,UAAU,CAAC,CAAX,GAAe,KAAK,OAAL,CAAa,QAAb,CAAsB,CAAvD;AACA,SAAK,SAAL,GAAiB,IAAI,CAAC,IAAL,CAAW,KAAK,UAAL,GAAkB,KAAK,UAAxB,GAAuC,KAAK,UAAL,GAAkB,KAAK,UAAxE,CAAjB;;AAEA,QAAI,KAAK,SAAL,GAAiB,KAAK,YAA1B,EAAwC;AACpC,WAAK,OAAL,CAAa,KAAb,GAAsB,KAAK,SAA3B;AACA,KAFJ,MAEU;AACN,WAAK,OAAL,CAAa,KAAb,GAAuB,KAAK,SAAL,IAAkB,KAAK,WAAL,GAAqB,KAAK,WAAL,IAAoB,KAAK,SAAL,GAAiB,KAAK,aAA1C,CAAvC,CAAvB;;AACA,UAAI,KAAK,OAAL,CAAa,KAAb,GAAqB,KAAK,SAA9B,EAAyC;AACxC,aAAK,OAAL,CAAa,KAAb,GAAqB,KAAK,SAA1B;AACA;AACD;AAEJ,GAfM;;AAiBR;AAAC,CAvCD;;AAAa,oC;;;;;;;;;;;;;;;;;;ACLb;;AAQA,IAAY,aAAZ;;AAAA,WAAY,aAAZ,EAAyB;AAAE;AAAmB;AAAwB,CAAtE,EAAY,aAAa,GAAb,kDAAa,EAAb,CAAZ;;AAEA;AAAA;AAAA;AAmCC,wBAAY,MAAZ,EAAiC,IAAjC,EAAsD,SAAtD,EAA6E,eAA7E,EAA2G;AAArD;AAAA;AAAqB;;AAAE;AAAA;AAA8B,MAjC3G;;;AACQ,kBAA6B,qCAAkB,KAA/C;AAEA,mBAAmB,IAAnB;AAEA,iBAAsB,EAAtB;AACA,sBAAqB,CAArB;AACA,uBAAsB,GAAtB;AACA,uBAAsB,GAAtB;AACA,sBAAqB,CAArB;AAEA,uBAAsB,CAAtB;AACA,4BAA2B,CAA3B;AACA,kCAAiC,CAAjC;AACA,gCAA+B,CAA/B;AACA,qBAAoB,CAApB;AACA,sBAAqB,CAArB;AACA,sBAAqB,CAArB;AAEA,2BAA2B,CAA3B;AACA,2BAA2B,CAA3B;AAEA,wBAAwB,KAAxB;AACA,yBAAyB,KAAzB,CAUmG,CAE1G;;AACA,SAAK,OAAL,GAAe,MAAf;AACA,SAAK,KAAL,GAAa,IAAb;AACA,SAAK,UAAL,GAAmB,IAAI,CAAC,MAAL,KAAgB,GAAjB,GAAwB,CAAxB,GAA4B,CAAC,CAA/C;AACA,SAAK,UAAL,GAAkB,CAAlB;AACA,SAAK,UAAL,GAAkB,IAAI,CAAC,MAAL,EAAlB;AAEA,SAAK,WAAL,GAAoB,KAAM,IAAI,CAAC,MAAL,KAAgB,GAA1C;AACA,SAAK,WAAL,GAAmB,KAAM,IAAI,CAAC,MAAL,KAAgB,GAAzC,CAV0G,CAW1G;AACA;;AAEA,QAAI,IAAI,KAAK,aAAa,CAAC,MAA3B,EAAmC;AAClC,WAAK,OAAL;AACA,KAFD,MAEO,IAAI,IAAI,KAAK,aAAa,CAAC,SAA3B,EAAsC;AAC5C,WAAK,SAAL,CAAe,eAAf;AACA;AACD;;AA3BD,wBAAW,sBAAX,EAAW,aAAX,EAAsB;SAAtB,aAAuB,CAAvB,EAAkC;AACjC,WAAK,YAAL,GAAoB,CAApB;AACA,KAFqB;oBAAA;;AAAA,GAAtB;AAIA,wBAAW,sBAAX,EAAW,cAAX,EAAuB;SAAvB,aAAwB,CAAxB,EAAmC;AAClC,WAAK,aAAL,GAAqB,CAArB;AACA,KAFsB;oBAAA;;AAAA,GAAvB;AAyBA,wBAAW,sBAAX,EAAW,QAAX,EAAiB;SAAjB;AACC,aAAO,KAAK,OAAZ;AACA,KAFgB;oBAAA;;AAAA,GAAjB;;AAIO,gCAAP,UAAY,UAAZ,EAAoC;AAAxB;AAAA;AAAwB;;AAEnC,SAAK,UAAL,IAAmB,KAAK,UAAxB;;AAEA,QAAI,KAAK,UAAL,IAAmB,KAAK,KAAL,CAAW,MAAlC,EAA0C;AACzC,WAAK,UAAL,GAAkB,CAAlB;AACA,KAFD,MAEO,IAAI,KAAK,UAAL,IAAmB,CAAvB,EAA2B;AACjC,WAAK,UAAL,GAAkB,KAAK,KAAL,CAAW,MAAX,GAAoB,CAAtC;AACA;;AAED,SAAK,WAAL,IAAoB,KAAK,UAAzB;;AAEA,QAAI,KAAK,WAAL,IAAoB,KAAK,KAAL,CAAW,MAAnC,EAA2C;AAC1C,WAAK,WAAL,GAAmB,CAAnB;AACA,KAFD,MAEO,IAAI,KAAK,WAAL,IAAoB,CAAxB,EAA4B;AAClC,WAAK,WAAL,GAAmB,KAAK,KAAL,CAAW,MAAX,GAAoB,CAAvC;AACA;;AAED,QAAI,CAAC,UAAL,EAAiB;AAChB,WAAK,sBAAL,GAAiC,MAAc,CAAC,WAAlB,GAAkC,KAAK,oBAAL,GAA4B,CAA9D,GAAkE,KAAK,oBAAL,GAA4B,CAA5H;;AACA,UAAM,MAAe,CAAC,WAAhB,IAA+B,CAAC,KAAK,YAA3C,EAAyD;AACxD,aAAK,sBAAL,GAA8B,CAA9B;AACA;AAED,KAND,MAMO;AAEN;;;;;;;AAQA,WAAK,sBAAL,GAAiC,MAAc,CAAC,WAAf,IAA8B,KAAK,MAAL,KAAgB,qCAAkB,aAAnE,GAAqF,KAAK,oBAAL,GAA4B,CAAjH,GAAqH,KAAK,oBAAL,GAA4B,CAA/K;AAGA;;AAED,QAAM,MAAe,CAAC,WAAhB,IAAgC,MAAe,CAAC,YAAtD,EAAqE;AACpE,WAAK,sBAAL,GAA8B,KAAK,sBAAL,GAA8B,GAA5D;;AACA,UAAK,MAAe,CAAC,YAArB,EAAoC;AACnC,aAAK,sBAAL,GAA8B,KAAK,sBAAL,GAA8B,GAA5D;AACA;;AACD,UAAM,MAAc,CAAC,WAArB,EAAmC,CAClC;AACA;AACD,KA/CkC,CAiDnC;;;AACA,QAAI,KAAK,MAAL,KAAgB,qCAAkB,iBAAtC,EAAyD;AACxD,WAAK,sBAAL,GAA8B,GAA9B;AACA;;AAED,QAAI,KAAK,MAAL,KAAgB,qCAAkB,MAAtC,EAA8C;AAC7C,WAAK,sBAAL,GAA8B,GAA9B;AACA;;AAED,QAAI,KAAK,MAAL,KAAgB,qCAAkB,KAAtC,EAA6C;AAC5C,WAAK,sBAAL,GAA8B,GAA9B;AACA;;AAED,SAAK,gBAAL,GAAyB,KAAK,gBAAL,GAAyB,CAAC,KAAK,sBAAL,GAA8B,KAAK,gBAApC,IAAyD,EAA3G,CA9DmC,CAgEnC;AACA;AAEA,GAnEM;;AAqEA,qCAAP,UAAiB,MAAjB,EAAgC;AAC/B,SAAK,OAAL,GAAe,MAAf;;AACA,QAAI,KAAK,KAAL,KAAe,aAAa,CAAC,SAAjC,EAA4C;AAC3C,WAAK,oBAAL,GAA6B,MAAD,GAAW,CAAX,GAAe,CAA3C;AACA;AACA;;AAED,SAAK,oBAAL,GAA6B,MAAD,GAAW,CAAX,GAAe,IAA3C,CAP+B,CAQ/B;AACA,GATM;;AAWA,gCAAP;AACC,WAAO,KAAK,KAAL,CAAW,KAAK,UAAhB,EAA4B,CAA5B,IAAiC,KAAK,WAAL,GAAmB,KAAK,gBAAzD,CAAP;AACA,GAFM;;AAIA,gCAAP;AACC,WAAO,KAAK,KAAL,CAAW,KAAK,UAAhB,EAA4B,CAA5B,IAAiC,KAAK,WAAL,GAAmB,KAAK,gBAAzD,CAAP;AACA,GAFM;;AAIA,oCAAP;AAEC,QAAI,KAAK,MAAL,KAAgB,qCAAkB,KAAtC,EAA6C;AAC5C,aAAO,CAAP;AACA;;AAED,QAAI,KAAK,MAAL,KAAgB,qCAAkB,iBAAtC,EAAyD;AACxD,aAAO,MAAQ,QAAQ,KAAK,WAAL,GAAmB,KAAK,KAAL,CAAW,MAAtC,CAAf;AACA;;AAED,QAAI,KAAK,MAAL,KAAgB,qCAAkB,MAAtC,EAA8C;AAC7C,aAAO,MAAQ,QAAQ,KAAK,WAAL,GAAmB,KAAK,KAAL,CAAW,MAAtC,CAAf;AACA;;AAED,QAAI,KAAK,KAAL,KAAe,aAAa,CAAC,SAA7B,IAA0C,KAAK,OAAnD,EAA4D;AAC3D;AACA,aAAO,KAAK,KAAL,CAAW,KAAK,UAAhB,EAA4B,KAAnC;AACA;;AAED,QAAM,MAAe,CAAC,WAAhB,IAA+B,CAAC,KAAK,YAA3C,EAAyD;AACxD,aAAO,CAAP;AACA;;AAED,QAAM,MAAe,CAAC,YAAhB,IAAgC,CAAC,KAAK,aAA5C,EAA2D;AAC1D,aAAO,CAAP;AACA;;AAED,QAAM,MAAe,CAAC,YAAhB,IAAgC,KAAK,aAA3C,EAA0D;AACzD,aAAO,MAAQ,OAAO,KAAK,WAAL,GAAmB,KAAK,KAAL,CAAW,MAArC,CAAf;AACA;;AAED,WAAO,MAAQ,OAAO,KAAK,WAAL,GAAmB,KAAK,KAAL,CAAW,MAArC,CAAf;AAEA,GAjCM;;AAmCE,mCAAT;AACC,QAAI,KAAK,GAAW,KAAK,IAAI,CAAC,KAAL,CAAW,IAAI,CAAC,MAAL,KAAgB,GAA3B,CAAzB;;AACA,SAAK,IAAI,CAAC,GAAG,CAAb,EAAgB,CAAC,GAAG,KAApB,EAA2B,CAAC,EAA5B,EAAgC;AAC/B,WAAK,KAAL,CAAW,IAAX,CAAgB;AACf,SAAC,EAAG,IAAI,IAAI,IAAI,CAAC,GAAL,CAAS,IAAI,IAAI,CAAC,EAAT,GAAc,CAAd,GAAkB,KAA3B,CADG;AAEf,SAAC,EAAG,IAAI,IAAI,IAAI,CAAC,GAAL,CAAS,IAAI,IAAI,CAAC,EAAT,GAAc,CAAd,GAAkB,KAA3B;AAFG,OAAhB;AAIA;;AAED,SAAK,UAAL,GAAkB,IAAI,CAAC,KAAL,CAAW,IAAI,CAAC,MAAL,KAAgB,KAAhB,GAAwB,CAAnC,CAAlB,CATD,CAUC;;AACA,SAAK,WAAL,GAAmB,IAAI,CAAC,KAAL,CAAW,KAAK,KAAL,CAAW,MAAX,GAAoB,KAAK,UAApC,CAAnB,CAXD,CAYC;AACA,GAbQ;;AAeD,qCAAR,UAAmB,eAAnB,EAAiD;AAA9B;AAAA;AAA8B,MAEhD;;;AACA,SAAK,WAAL,GAAmB,KAAO,IAAI,CAAC,MAAL,KAAgB,EAA1C;AACA,SAAK,WAAL,GAAmB,CAAC,CAAD,GAAM,IAAI,CAAC,MAAL,KAAgB,EAAzC;AACG,QAAI,KAAK,GAAW,GAApB;AACA,QAAI,MAAM,GAAW,CAArB;AACA,QAAI,KAAK,GAAW,CAApB;AAEA,QAAI,CAAC,GAAG,CAAR;AACA,QAAI,CAAC,GAAG,CAAR;AACA,QAAI,SAAS,GAAG,GAAhB;AACA,QAAI,SAAS,GAAG,EAAhB;AACA,QAAI,CAAC,GAAW,CAAhB;AACA,QAAI,IAAI,GAAY,KAApB;AAGA,QAAI,SAAS,GAAW,MAAO,IAAI,CAAC,KAAL,CAAW,IAAI,CAAC,MAAL,KAAgB,IAA3B,CAA/B;AACA,QAAI,KAAK,GAAW,IAAI,CAAC,MAAL,KAAgB,EAApC,CAlB6C,CAoB7C;;AACC,WAAO,CAAC,GAAG,KAAJ,IAAa,CAAC,IAArB,EAA2B;AACxB,OAAC,GAAI,SAAS,GAAG,IAAI,CAAC,GAAL,CAAS,CAAC,GAAG,SAAb,CAAjB;AACA,OAAC,IAAI,KAAL;;AACA,WAAK,KAAL,CAAW,IAAX,CAAgB;AACrB,SAAC,EAAE,CADkB;AAErB,SAAC,EAAE,CAFkB;AAGrB,aAAK,EAAE,SAAS,GAAI,SAAS,IAAK,CAAC,CAAC,GAAG,GAAL,IAAa,GAAlB;AAHR,OAAhB;;AAKN,OAAC;;AACD,UAAI,CAAC,IAAI,KAAT,EAAgB;AACf,YAAI,CAAC,GAAG,CAAJ,IAAS,CAAC,GAAG,IAAjB,EAAuB;AACtB,cAAI,GAAG,IAAP;AACA;AACD;AACE;;AAED,QAAI,eAAe,KAAK,IAAxB,EAA+B;AACjC,WAAK,UAAL,GAAkB,IAAI,CAAC,KAAL,CAAW,eAAe,GAAG,KAA7B,CAAlB;AACA;AAED,GAzCO;AA2CR;;;AACO,4CAAP,UAAyB,KAAzB,EAAiD;AAChD,SAAK,MAAL,GAAc,KAAd;AACA,GAFM;;AAIR;AAAC,CAtPD;;AAAa,oC;;;;;;;;;;;;;;;;;;ACVb;;AAGA;AAAA;AAAA;AAyBC,0BAAY,MAAZ,EAAkC,iBAAlC,EAAkE,SAAlE,EAAwF;AAAtD;AAAA;AAA8B;;AAAE;AAAA;AAAsB;;AAlBhF,wBAAuB,CAAvB;AACA,wBAAuB,CAAvB;AACA,kBAAiB,CAAjB;AACA,kBAAiB,CAAjB;AACA,mBAAkB,CAAlB;AACA,mBAAkB,CAAlB;AAGA,uBAAsB,CAAtB;AACA,wBAAuB,EAAvB;AAKA,mBAAmB,IAAnB;AAKP,SAAK,KAAL,GAAa,sBAAU,IAAvB;AAEA,SAAK,OAAL,GAAe,MAAf;AACA,SAAK,kBAAL,GAA0B,iBAA1B;AACA,SAAK,UAAL,GAAkB,SAAlB;AACA,SAAK,iBAAL,GAAyB,EAAzB;AACA,SAAK,WAAL,GAAmB,IAAK,IAAI,CAAC,MAAL,KAAgB,GAAxC;AACA,SAAK,aAAL,GAAqB,KAAM,IAAI,CAAC,MAAL,KAAgB,EAA3C;AACA,SAAK,kBAAL,GAA0B,KAAM,IAAI,CAAC,MAAL,KAAgB,EAAhD;AACA,SAAK,mBAAL,GAA2B,KAAM,IAAI,CAAC,MAAL,KAAgB,EAAjD;AAEA,SAAK,OAAL,GAAe;AACd,OAAC,EAAE,MAAM,CAAC,UAAP,GAAoB,CADT;AAEd,OAAC,EAAE,MAAM,CAAC,WAAP,GAAqB;AAFV,KAAf;AAKA;;AAEM,uCAAP,UAAiB,MAAjB,EAAgC;AAC/B,SAAK,OAAL,GAAe,MAAf;AACA,GAFM;;AAIA,sCAAP,UAAgB,UAAhB,EAAmC,WAAnC,EAAqD;AAEpD,QAAI,CAAC,KAAK,OAAV,EAAmB;AAClB,aAAO,WAAP;AACA;;AAED,SAAK,aAAL,GAAyB,MAAe,CAAC,WAAhB,IAAiC,MAAe,CAAC,YAApD,GAAqE,KAAK,OAA1E,GAAoF,UAA1G;AAEG,SAAK,SAAL,GAAiB,IAAI,CAAC,IAAL,CAAU,IAAI,CAAC,GAAL,CAAS,WAAW,CAAC,CAAZ,GAAgB,KAAK,aAAL,CAAmB,CAA5C,EAA+C,CAA/C,IAAoD,IAAI,CAAC,GAAL,CAAS,WAAW,CAAC,CAAZ,GAAgB,KAAK,aAAL,CAAmB,CAA5C,EAA+C,CAA/C,CAA9D,CAAjB;AAEH,SAAK,YAAL,GAAuB,MAAe,CAAC,WAAnB,GAAmC,EAAnC,GAAwC,EAA5D;AACA,SAAK,mBAAL,GAA8B,MAAe,CAAC,WAAnB,GAAmC,KAAK,kBAAxC,GAA6D,KAAK,aAA7F;;AAEA,QAAK,MAAc,CAAC,YAApB,EAAmC;AAClC,WAAK,YAAL,GAAoB,EAApB;AACA,WAAK,mBAAL,GAA4B,KAAK,mBAAjC,CAFkC,CAGlC;AACA;;AAEE,QAAI,KAAK,SAAL,GAAiB,KAAK,YAA1B,EAAwC;AACvC,UAAI,OAAO,GAAG,IAAI,CAAC,KAAL,CAAW,WAAW,CAAC,CAAZ,GAAgB,KAAK,aAAL,CAAmB,CAA9C,EAAiD,WAAW,CAAC,CAAZ,GAAgB,KAAK,aAAL,CAAmB,CAApF,CAAd;AACC,iBAAW,CAAC,CAAZ,GAAiB,KAAK,aAAL,CAAmB,CAAnB,GAAwB,IAAI,CAAC,GAAL,CAAS,OAAT,IAAqB,KAAK,mBAAnE;AACD,iBAAW,CAAC,CAAZ,GAAgB,KAAK,aAAL,CAAmB,CAAnB,GAAyB,IAAI,CAAC,GAAL,CAAS,OAAT,IAAqB,KAAK,mBAAnE;AACA;;AAED,WAAO,WAAP;AAEH,GA3BM;;AA6BA,qDAAP,UAA+B,MAA/B,EAA4C;AAC3C,SAAK,OAAL,GAAe,MAAf;AACA,GAFM;;AAIA,kCAAP;AACC,WAAO,KAAK,MAAZ;AACA,GAFM;;AAIA,kCAAP;AACC,WAAO,KAAK,MAAZ;AACA,GAFM;;AAIR;AAAC,CAzFD;;AAAa,wC;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACHb;;AAEA,mF,CACA;;;AAEA;AAAA;AAAA;AAAsC;;AAAtC;AAAA,0EAEC;;;AACQ,4BAAuC,EAAvC;;AA2IR;;AAzIO,sCAAP,UAAc,UAAd,EAAiD,QAAjD,EAA6E;AAC5E;AACA,SAAK,EAAL,GAAW,UAAU,CAAC,EAAtB;AACA,SAAK,IAAL,GAAY,gCAAiB,iBAA7B;AACA,SAAK,aAAL,GAAqB,IAArB;AACA,SAAK,UAAL,GAAmB,KAAK,SAAL,GAAiB,GAAlB,GAAyB,uBAAe,OAAxC,GAAkD,uBAAe,MAAnF;;AACA,SAAK,qBAAL,CAA2B,UAA3B,EAAuC,QAAvC;AACA,GAPM;;AASA,sCAAP,UAAc,cAAd,EAAsC,eAAtC,EAA+D,YAA/D,EAAqF,UAArF,EAAuG;AACtG,SAAK,eAAL,CAAqB,OAArB,CAA8B,UAAC,QAAD,EAAS;AACtC,cAAQ,CAAC,MAAT,CAAgB,cAAhB,EAAgC,eAAhC,EAAiD,YAAjD,EAA+D,UAA/D;AACA,KAFD;AAGA,GAJM;;AAMA,oCAAP,UAAY,cAAZ,EAAoC,UAApC,EAAwD,WAAxD,EAA6E,WAA7E,EAAkG,WAAlG,EAAgI,aAAhI,EAA2J,OAA3J,EAAqL,UAArL,EAA6M,SAA7M,EAAkO;AAAhI;AAAA;AAA4B;;AAAE;AAAA;AAAyB;;AAAE;AAAA;AAAwB;;AAAE;AAAA;AAAsB;;AAAE;AAAA;AAAqB;;AACjO,SAAK,eAAL,CAAqB,OAArB,CAA8B,UAAC,QAAD,EAAS;AACtC,cAAQ,CAAC,IAAT,CAAc,cAAd,EAA8B,UAA9B,EAA0C,WAA1C,EAAuD,WAAvD,EAAoE,WAApE,EAAiF,aAAjF,EAAgG,OAAhG,EAAyG,UAAzG,EAAqH,SAArH;AACA,KAFD;AAGA,GAJM;;AAMA,6CAAP,UAAqB,KAArB,EAAoC,KAApC,EAAqD;AAAjB;AAAA;AAAiB;;AACpD,SAAK,eAAL,CAAqB,OAArB,CAA8B,UAAC,QAAD,EAAS;AACtC,cAAQ,CAAC,aAAT,CAAuB,KAAvB,EAA8B,KAA9B;AACA,KAFD;AAGA,GAJM;;AAMA,+CAAP,UAAuB,KAAvB,EAA0C;AAAnB;AAAA;AAAmB;;AACzC,SAAK,eAAL,CAAqB,OAArB,CAA8B,UAAC,QAAD,EAAS;AACtC,cAAQ,CAAC,eAAT,CAAyB,KAAzB;AACA,KAFD;AAGA,GAJM;;AAMA,2DAAP;AACC,SAAK,eAAL,CAAqB,OAArB,CAA8B,UAAC,QAAD,EAAS;AACtC,cAAQ,CAAC,2BAAT;AACA,KAFD;AAGA,GAJM;;AAMA,qCAAP;AACC,SAAK,eAAL,CAAqB,OAArB,CAA8B,UAAC,QAAD,EAAS;AACtC,cAAQ,CAAC,KAAT;AACA,KAFD;AAGA,GAJM;;AAMA,wCAAP;AACC,WAAO,KAAK,eAAZ;AACA,GAFM;;AAIA,6CAAP,UAAqB,IAArB,EAAiC;AAChC,SAAK,eAAL,CAAqB,OAArB,CAA8B,UAAC,QAAD,EAAS;AACtC,cAAQ,CAAC,aAAT,CAAuB,IAAvB;AACA,KAFD;AAGA,GAJM,CAtDR,CA4DC;AACA;;;AACQ,qDAAR,UAA8B,YAA9B,EAAmE,QAAnE,EAA+F;AAA/F;;AAEC,QAAI,KAAK,GAAW,YAAY,CAAC,SAAjC;AACA,QAAI,MAAM,GAAW,YAAY,CAAC,qBAAlC;AAEA,QAAI,KAAK,GAAW,YAAY,CAAC,SAAjC;AACA,QAAI,MAAM,GAAW,YAAY,CAAC,sBAAlC;AAEA,gBAAY,CAAC,QAAb,CAAsB,OAAtB,CAA+B,UAAC,KAAD,EAA+B,KAA/B,EAA4C;AAE1E,UAAI,MAAM,GAA0B;AACnC,UAAE,EAAK,YAAY,CAAC,EAAb,GAAe,YAAf,GAA4B,KADA;AAEnC,iBAAS,EAAE,KAAK,GAAI,KAAK,CAAC,SAAN,GAAkB,MAFH;AAGnC,iBAAS,EAAE,KAAK,GAAI,KAAK,CAAC,SAAN,GAAkB,MAHH;AAInC,iBAAS,EAAE,YAAY,CAAC,SAJW;AAKnC,2BAAmB,EAAE,YAAY,CAAC,mBALC;AAMnC,0BAAkB,EAAE,CANe;AAOnC,iBAAS,EAAE,YAAY,CAAC,SAPW;AAQnC,kBAAU,EAAE,YAAY,CAAC,UARU;AASnC,iBAAS,EAAE,YAAY,CAAC,SATW;AAUnC,sBAAc,EAAE,YAAY,CAAC,cAVM;AAWnC,kBAAU,EAAG,YAAY,CAAC,UAXS;AAYnC,gBAAQ,EAAG,YAAY,CAAC,QAZW;AAanC,gBAAQ,EAAG,YAAY,CAAC,QAbW;AAcnC,iBAAS,EAAG,YAAY,CAAC,SAdU;AAenC,aAAK,EAAG,YAAY,CAAC,KAfc;AAgBnC,YAAI,EAAG,YAAY,CAAC,IAhBe;AAiBnC,cAAM,EAAE,KAjB2B;AAkBnC,sBAAc,EAAE,YAAY,CAAC,cAlBM;AAmBnC,wBAAgB,EAAE,YAAY,CAAC,gBAnBI;AAoBnC,2BAAmB,EAAE,YAAY,CAAC;AApBC,OAApC;AAuBA,UAAI,OAAO,GAAiB,QAAQ,CAAC,QAAT,CAAkB,KAAK,CAAC,OAAxB,CAA5B;;AACA,WAAI,CAAC,eAAL,CAAqB,IAArB,CAA2B,KAAI,CAAC,oBAAL,CAA0B,MAA1B,EAAkC,OAAlC,EAA2C,QAAQ,CAAC,SAApD,CAA3B;AAEA,KA5BD;AA8BA,GAtCO;;AAwCA,oDAAR,UAA6B,MAA7B,EAA4D,OAA5D,EAAmF,SAAnF,EAA4G;AAE3G;AACA,QAAI,IAAI,GAAG,IAAI,2BAAJ,EAAX;AAEA,QAAI,CAAC,SAAL,GAAiB,MAAM,CAAC,SAAxB;AACA,QAAI,CAAC,SAAL,GAAiB,MAAM,CAAC,SAAxB;AACA,QAAI,CAAC,SAAL,GAAiB,MAAM,CAAC,SAAxB;AACA,QAAI,CAAC,mBAAL,GAA2B,MAAM,CAAC,mBAAlC;AACA,QAAI,CAAC,kBAAL,GAA0B,CAA1B;;AAEA,QAAI,MAAM,CAAC,KAAX,EAAkB;AACjB,UAAI,CAAC,KAAL,GAAa,MAAM,CAAC,KAApB;AACA;;AAED,QAAI,MAAM,CAAC,IAAX,EAAiB;AAChB,UAAI,CAAC,IAAL,GAAY,MAAM,CAAC,IAAnB;AACA;;AAED,QAAK,MAAM,CAAC,gBAAZ,EAA8B;AAC7B,UAAI,CAAC,gBAAL,GAAwB,MAAM,CAAC,gBAA/B;AACA;;AAED,QAAK,MAAM,CAAC,cAAZ,EAA4B;AAC3B,UAAI,CAAC,cAAL,GAAsB,MAAM,CAAC,cAA7B;AACA;;AAED,QAAK,MAAM,CAAC,mBAAZ,EAAiC;AAChC,UAAI,CAAC,mBAAL,GAA2B,MAAM,CAAC,mBAAlC;AACA;;AAED,QAAI,CAAC,MAAL,CAAY,MAAZ,EAAoB;AACnB,eAAS,EAAE,SADQ;AAEnB,aAAO,EAAE;AAFU,KAApB;AAKA,WAAO,IAAP;AAEA,GAtCO;;AAwCT;AAAC,CA9ID,CAAsC,2BAAtC;;AAAa,4C;;;;;;;;;;;;CCLb;;;;;;AAIA;;AACA,iG,CAEA;;;AACA;;AACA;;AACA;;AACA;;AACA;;AAaA,IAAY,gBAAZ;;AAAA,WAAY,gBAAZ,EAA4B;AAAE;AAAU;AAAgB;AAAkB,CAA1E,EAAY,gBAAgB,GAAhB,wDAAgB,EAAhB,CAAZ,E,CAEA;AACA;AACA;AACA;;;AACA;AAAA;AAAA;AAAA;AAGQ,gBAAyB,gBAAgB,CAAC,QAA1C;AAIA,iBAAgB,CAAhB,CAPR,CAO+B;;AACvB,qBAAoB,EAApB;AAEA,+BAA8B,CAA9B;AACA,8BAA6B,GAA7B,CAXR,CAW4C;;AAInC,uBAAmB,EAAnB;AACE,cAAa,CAAb,CAhBX,CAgB+B;;AAGpB,wBAAuB,CAAvB,CAnBX,CAmBuC;;AAC5B,oBAAmB,CAAnB,CApBX,CAoBoC;;AAC3B,oBAAmB,CAAnB;AACE,0BAAyB,CAAzB,CAtBX,CAsBwC;;AAC7B,0BAAyB,CAAzB,CAvBX,CAuBwC;;AAE7B,yBAAwB,CAAxB;AACA,+BAA8B,CAA9B;AAUF,wCAAuC,EAAvC;AACA,kCAAiC,CAAjC;AAEE,kBAAiB,CAAjB;AACA,wBAAuB,CAAvB;AACA,yBAAwB,CAAxB;AAEA,2BAA0B,CAA1B;AACA,qBAAoB,CAApB;AAEF,kBAAiB,CAAjB;AASA,0BAA0B,KAA1B;AACA,wBAAuB,GAAvB;AACA,yBAAwB,CAAxB;AACA,8BAA6B,CAA7B;AACA,2BAA0B,CAA1B;AACA,2BAA0B,GAA1B;AAEA,uBAAsB,CAAtB;AACA,0BAAyB,CAAzB;AAEE,yBAAyB,KAAzB;AACF,6BAA6B,KAA7B;AACA,mBAAgB;AACvB,WAAK,EAAE,CADgB;AAEpB,WAAK,EAAE,CAFa;AAGvB,YAAM,EAAE,CAHe;AAIvB,YAAM,EAAE,CAJe;AAKpB,YAAM,EAAE,GALY;AAMpB,eAAS,EAAE,CANS;AAOpB,eAAS,EAAE,CAPS;AAQpB,cAAQ,EAAE,CARU;AASpB,YAAM,EAAE,CATY;AAUpB,YAAM,EAAE,CAVY;AAWpB,WAAK,EAAE,CAXa;AAYpB,WAAK,EAAE,CAZa;AAcpB;AACA,gBAAU,EAAE,GAfQ;AAgBpB,mBAAa,EAAE,CAhBK;AAiBpB,mBAAa,EAAE,CAjBK;AAkBpB,kBAAY,EAAE,CAlBM;AAmBpB,gBAAU,EAAE,CAnBQ;AAoBpB,gBAAU,EAAE,CApBQ;AAqBpB,eAAS,EAAE,CArBS;AAsBpB,eAAS,EAAE;AAtBS,KAAhB;AA0BA,2BAA0B,GAA1B;AAEA,oCAAmC,EAAnC;AACA,gCAA+B,EAA/B;AAIA,wBAAuB,IAAvB;AACA,wBAAuB,IAAvB;AASA,wBAAuB,CAAvB;AAEA,8BAA6B,GAA7B;AA+gBR;;AA7gBA,wBAAW,sBAAX,EAAW,kBAAX,EAA2B;SAA3B,aAA4B,CAA5B,EAAsC;AACrC,WAAK,wBAAL,GAAgC,CAAhC;AACA,KAF0B;oBAAA;;AAAA,GAA3B;AAIA,wBAAW,sBAAX,EAAW,gBAAX,EAAyB;SAAzB,aAA0B,CAA1B,EAAoC;AACnC,WAAK,sBAAL,GAA8B,CAA9B;AACA,KAFwB;oBAAA;;AAAA,GAAzB;AAIA,wBAAW,sBAAX,EAAW,qBAAX,EAA8B;SAA9B,aAA+B,CAA/B,EAAyC;AACxC,WAAK,oBAAL,GAA4B,CAA5B;AACA,KAF6B;oBAAA;;AAAA,GAA9B;;AAIO,kCAAP,UAAc,UAAd,EAAiD,QAAjD,EAA6E;AAE5E,SAAK,EAAL,GAAU,UAAU,CAAC,EAArB;AACA,SAAK,KAAL,GAAa,UAAb;AACA,SAAK,iBAAL,GAAyB,sBAAU,MAAV,CAAiB,gBAA1C;AAEA,SAAK,cAAL,GAAuB,KAAK,KAAL,CAAW,SAAX,IAAyB,KAAK,KAAL,CAAW,UAApC,IAAmD,KAAK,KAAL,CAAW,SAArF;AAEA,SAAK,eAAL,GAAuB,IAAI,mDAAJ,CAA6B,UAAU,CAAC,SAAxC,EAAmD,UAAU,CAAC,SAA9D,CAAvB;;AAEA,QAAI,UAAU,CAAC,cAAf,EAA+B;AAC9B,WAAK,cAAL,GAAuB,IAAI,CAAC,MAAL,KAAgB,GAAhB,GAAsB,IAAI,CAAC,EAA3B,GAAgC,GAAvD;;AACA,UAAK,IAAI,CAAC,MAAL,KAAgB,GAArB,EAA2B;AAC1B,aAAK,cAAL,IAAuB,CAAC,CAAxB;AACA;AAED;;AAED,QAAI,UAAU,CAAC,QAAf,EAAyB;AACxB,UAAI,KAAK,GAAW,UAAU,CAAC,QAAX,GAAsB,UAAU,CAAC,QAArD;AACA,WAAK,WAAL,GAAmB,UAAU,CAAC,QAAX,GAAuB,KAAK,GAAG,IAAI,CAAC,MAAL,EAAlD;AACA;;AAED,QAAI,KAAK,cAAT,EAAyB;AACxB,WAAK,kBAAL,GAA2B,KAAK,cAAL,GAAuB,KAAK,KAAL,CAAW,aAAX,GAA2B,IAAI,CAAC,EAAhC,GAAqC,GAA5D,IAAsE,KAAK,cAAL,GAAwB,CAAC,CAAD,IAAM,IAAI,CAAC,MAAL,KAAgB,EAAhB,GAAqB,IAAI,CAAC,EAA1B,GAA+B,GAArC,CAAzH;AACA,WAAK,eAAL,GAAwB,KAAK,KAAL,CAAW,UAAX,IAA0B,CAAlD;AACA,WAAK,eAAL,GAAwB,KAAK,KAAL,CAAW,UAAX,IAA0B,GAAlD;AACA,WAAK,aAAL,GAAqB,KAAK,KAAL,CAAW,YAAX,IAA4B,CAAjD;AACA;;AAED,SAAK,OAAL,GAAe,IAAI,IAAI,CAAC,MAAT,EAAf;AACA,SAAK,OAAL,CAAa,WAAb,GAA2B,KAA3B;;AACA,SAAK,OAAL,CAAa,MAAb,CAAoB,GAApB,CAAwB,GAAxB,EAA6B,GAA7B;;AACA,QAAI,QAAQ,CAAC,OAAb,EAAsB;AACrB,WAAK,OAAL,CAAa,OAAb,GAAuB,QAAQ,CAAC,OAAhC;AACA;;AAED,YAAQ,CAAC,SAAT,CAAmB,QAAnB,CAA4B,KAAK,OAAjC;;AAEA,QAAI,KAAK,KAAL,CAAW,IAAf,EAAqB;AACpB,WAAK,OAAL,CAAa,IAAb,GAAoB,KAAK,IAAzB;AACA;;AAED,QAAI,KAAK,KAAL,CAAW,KAAf,EAAsB;AACrB,WAAK,OAAL,CAAa,KAAb,GAAqB,KAAK,KAA1B;AACA;;AAID,QAAI,UAAU,CAAC,WAAf,EAA4B;AAC3B,WAAK,YAAL,GAAoB,UAAU,CAAC,WAA/B;AACA,WAAK,YAAL,GAAoB,UAAU,CAAC,WAA/B;AACA;;AAED,QAAI,WAAW,GAAa,IAAI,CAAC,MAAL,KAAgB,IAA5C;AACA,QAAI,YAAY,GAAa,IAAI,CAAC,MAAL,KAAgB,IAA7C,CAvD4E,CAyD5E;;AACA,QAAI,UAAU,CAAC,IAAf,EAAqB;AACpB,UAAI,SAAS,GAAI,UAAU,CAAC,aAAZ,GAA6B,UAAU,CAAC,aAAxC,GAAyD,CAAzE;AACA,UAAI,cAAc,GAAI,UAAU,CAAC,mBAAZ,GAAmC,UAAU,CAAC,mBAA9C,GAAoE,CAAzF;AAEA,WAAK,kBAAL,GAA0B,IAAI,2BAAJ,CAAiB,KAAK,OAAtB,EAA+B,6BAAc,MAA7C,EAAqD,SAArD,CAA1B;AACA,WAAK,kBAAL,CAAwB,WAAxB,GAAsC,WAAtC;AACA,WAAK,kBAAL,CAAwB,YAAxB,GAAuC,YAAvC;AAGA,WAAK,iBAAL,GAAyB,IAAI,2BAAJ,CAAiB,KAAK,OAAtB,EAA+B,6BAAc,SAA7C,EAAwD,SAAxD,EAAmE,cAAnE,CAAzB;AAEA;;AAED,QAAI,UAAU,CAAC,IAAf,EAAqB;AACpB,WAAK,aAAL,GAAqB,IAAI,2BAAJ,CACpB,KAAK,OADe,EAEpB,GAFoB,EAGpB,GAHoB,EAIpB;AACA;AACA;AACA,SAPoB,EAQpB,GARoB,CAArB;AAUA;;AAED,QAAI,UAAU,CAAC,IAAf,EAAqB;AACpB,WAAK,sBAAL,GAA8B,IAAI,+BAAJ,CAAmB,KAAK,OAAxB,CAA9B;AACA,WAAK,gBAAL,GAAwB,IAAI,iCAAJ,CAAoB,KAAK,OAAzB,EAAkC,KAAK,kBAAvC,EAA2D,KAAK,iBAAhE,EAAmF,KAAK,sBAAxF,CAAxB;AACA,WAAK,gBAAL,CAAsB,WAAtB,GAAoC,WAApC;AACA,WAAK,gBAAL,CAAsB,YAAtB,GAAqC,YAArC;AAEA,KAND,MAMO;AACN,UAAK,KAAK,KAAL,CAAW,MAAhB,EAAwB;AACvB,aAAK,aAAL,GAAqB,IAArB;AACA;AACD;;AAED,QAAI,UAAU,CAAC,QAAX,IAAuB,UAAU,CAAC,QAAtC,EAAgD;AAC/C,UAAI,QAAQ,GAAW,UAAU,CAAC,QAAX,IAAuB,UAAU,CAAC,QAAlC,IAA8C,CAArE;AACA,UAAI,QAAQ,GAAW,UAAU,CAAC,QAAX,IAAuB,CAA9C;AACA,UAAI,KAAK,GAAG,QAAQ,GAAG,QAAvB;AACA,WAAK,YAAL,GAAqB,KAAK,MAAL,GAAc,QAAQ,GAAI,IAAI,CAAC,MAAL,KAAgB,KAA/D;AACA,KArG2E,CAuG5E;;;AACA,SAAK,UAAL,GAAmB,KAAK,SAAL,GAAiB,GAAlB,GAAyB,uBAAe,OAAxC,GAAkD,uBAAe,MAAnF;AAEA,SAAK,YAAL,GAAoB,MAAO,IAAI,CAAC,MAAL,KAAgB,GAA3C;AAEA,SAAK,oBAAL,GAA4B,KAAM,IAAI,CAAC,MAAL,KAAgB,EAAlD;AACA,SAAK,kBAAL,GAA0B,KAAM,IAAI,CAAC,MAAL,KAAgB,GAAhD;AAEA,GA/GM;;AAiHA,kCAAP,UAAc,KAAd,EAA2B;AAC1B,QAAI,CAAC,QAAL,CAAc,EAAd,CAAiB,KAAK,OAAtB,EAA+B,GAA/B,EAAoC;AAAC,WAAK,EAAE,CAAR;AAAW,WAAK,EAAE,KAAlB;AAAyB,UAAI,EAAE,IAAI,CAAC,MAAL,CAAY;AAA3C,KAApC;AACA,GAFM,CA/OR,CAmPC;AACA;AACA;;;AACO,kCAAP,UAAc,cAAd,EAAsC,eAAtC,EAA+D,YAA/D,EAAqF,UAArF,EAAuG;AAEtG;AACA,SAAK,gBAAL,GAAwB,eAAxB;AACA,SAAK,eAAL,GAAuB,cAAvB;AACA,SAAK,UAAL,GAAkB,eAAe,GAAG,KAAK,SAAzC;;AAEA,SAAK,eAAL,CAAqB,MAArB,CAA4B,KAAK,eAAjC,EAAkD,KAAK,gBAAvD;;AAEA,QAAI,KAAK,gBAAT,EAA2B;AAC1B,WAAK,gBAAL,CAAsB,MAAtB,CAA6B,KAAK,eAAlC,EAAmD,KAAK,gBAAxD;AACA;;AAED,SAAK,aAAL,GAAqB,YAArB;AACA,SAAK,WAAL,GAAmB,UAAnB;AAEA,SAAK,eAAL,GAAwB,KAAK,sBAA7B;AACA,SAAK,iBAAL,GAA0B,KAAK,wBAA/B;AACA,SAAK,gBAAL,GAAyB,CAAzB;;AAEA,QAAI,KAAK,WAAL,GAAmB,GAAvB,EAA4B;AAC3B,WAAK,eAAL,GAAwB,KAAK,sBAAL,GAA8B,GAAtD;AACA,WAAK,gBAAL,GAAwB,GAAxB;AACA,KAHD,MAGO,IAAI,sBAAU,MAAV,CAAiB,aAArB,EAAoC;AAC1C,WAAK,eAAL,GAAwB,KAAK,sBAAL,GAA8B,GAAtD;AACA,WAAK,gBAAL,GAAwB,CAAxB;AACA;;AAED,QAAI,KAAK,cAAT,EAAyB;AACxB,WAAK,YAAL,GAAoB,KAAK,KAAL,CAAW,SAAX,GAAuB,KAAK,WAA5B,IAA2C,OAAO,KAAK,WAA3E;AACA;AAED,GAhCM,CAtPR,CAwRC;;;AACO,gCAAP,UAAY,cAAZ,EAAoC,UAApC,EAAwD,WAAxD,EAA6E,WAA7E,EAAkG,WAAlG,EAAgI,aAAhI,EAA2J,OAA3J,EAAqL,UAArL,EAA6M,YAA7M,EAAqO;AAEpO;AACA;AAHiG;AAAA;AAA4B;;AAAE;AAAA;AAAyB;;AAAE;AAAA;AAAwB;;AAAE;AAAA;AAAsB;;AAAE;AAAA;AAAwB,MAMpO;AACA;;;AAEA,SAAK,yBAAL;;AACA,SAAK,cAAL,CAAoB,WAApB,EAAiC,OAAjC;;AACA,SAAK,6BAAL,CAAmC,cAAnC,EAAmD,KAAK,eAAxD;;AAEA,QAAI,KAAK,aAAT,EAAwB;AACvB,WAAK,cAAL,CAAoB,UAApB,EAAgC,YAAhC;AACA,KAfmO,CAiBpO;AACA;AAEA;AACA;;;AACA,QAAI,CAAC,sBAAU,MAAV,CAAiB,gBAAtB,EAAwC;AACvC,WAAK,cAAL,GAAsB,CAAC,CAAD,IAAM,WAAW,IAAI,KAAK,gBAAL,IAAyB,KAAK,kBAAL,GAA0B,KAAK,WAAL,CAAiB,CAApE,CAAJ,CAAjB,CAAtB;AACA,WAAK,QAAL,GAAgB,KAAK,QAAL,GAAiB,CAAC,KAAK,cAAL,GAAsB,KAAK,QAA5B,IAAyC,KAAK,WAAL,CAAiB,KAA3F;AAEA,WAAK,mBAAL,GAA2B,CAAC,CAAD,IAAM,WAAW,IAAI,KAAK,gBAAL,IAA0B,KAAK,kBAAL,GAA0B,CAApD,CAAJ,CAAjB,CAA3B;AACA,WAAK,aAAL,GAAqB,KAAK,aAAL,GAAsB,CAAC,KAAK,mBAAL,GAA2B,KAAK,aAAjC,IAAmD,KAAK,WAAL,CAAiB,KAA/G;AAEA,KA7BmO,CA+BpO;;;AACA,SAAK,QAAL,GAAgB,UAAU,GAAG,KAAK,YAAlB,GAAiC,KAAK,aAAtC,GAAsD,KAAK,OAAL,CAAa,KAAnF,CAhCoO,CAkCpO;;AACA,SAAK,eAAL,CAAqB,MAArB,CAA4B,KAAK,QAAjC,EAA2C,KAAK,QAAL,GAAiB,KAAK,OAAL,CAAa,KAA9B,GAAsC,KAAK,OAAL,CAAa,SAA9F,EAnCoO,CAqCpO;AACA;;;AAEA,QAAI,KAAK,kBAAT,EAA6B;AAC5B,WAAK,kBAAL,CAAwB,IAAxB;;AACA,UAAI,KAAK,kBAAL,CAAwB,MAA5B,EAAoC;AACnC,aAAK,YAAL,GAAoB,KAAK,kBAAL,CAAwB,QAAxB,EAApB;AACA;;AACD,WAAK,eAAL,CAAqB,QAArB,CAA+B,KAAK,kBAAL,CAAwB,IAAxB,EAA/B,EAAgE,KAAK,kBAAL,CAAwB,IAAxB,EAAhE;AACA;;AAED,QAAI,KAAK,iBAAT,EAA4B;AAC3B,WAAK,iBAAL,CAAuB,IAAvB,CAA4B,UAA5B;;AACA,WAAK,eAAL,CAAqB,QAArB,CAA+B,KAAK,iBAAL,CAAuB,IAAvB,EAA/B,EAA+D,KAAK,iBAAL,CAAuB,IAAvB,EAA/D;;AACA,UAAI,KAAK,iBAAL,CAAuB,MAA3B,EAAmC;AAClC,aAAK,YAAL,GAAoB,KAAK,iBAAL,CAAuB,QAAvB,EAApB;AACA;AAED;;AAED,QAAI,cAAc,GAAG,CAArB;AACA,QAAI,cAAc,GAAG,CAArB,CA1DoO,CA2DpO;;AACA,QAAI,KAAK,gBAAT,EAA2B;AAC1B;AACA,WAAK,gBAAL,CAAsB,IAAtB,CAA2B,UAA3B,EAAuC,KAAK,eAAL,CAAqB,SAA5D,EAAuE,UAAvE,EAAmF,KAAK,eAAL,CAAqB,SAAxG,EAAmH,KAAK,aAAxH,EAAuI,KAAK,YAA5I;;AACA,WAAK,eAAL,CAAqB,QAArB,CAA8B,KAAK,gBAAL,CAAsB,IAAtB,EAA9B,EAA6D,KAAK,gBAAL,CAAsB,IAAtB,EAA7D;AACA;;AAED,QAAI,KAAK,gBAAT,EAA2B;AAC1B,UAAI,MAAM,GAAG,KAAK,sBAAL,CAA4B,QAA5B,CAAqC,UAArC,EAAiD;AAC7D,SAAC,EAAE,KAAK,eAAL,CAAqB,CADqC;AAE7D,SAAC,EAAE,KAAK,eAAL,CAAqB;AAFqC,OAAjD,CAAb;;AAKA,WAAK,eAAL,CAAqB,WAArB,CAAiC,MAAjC;AACA;;AAED,SAAK,EAAL,GAAW,KAAK,EAAL,GAAY,CAAE,KAAK,eAAL,CAAqB,CAArB,GAAyB,KAAK,EAAhC,IAAuC,KAAK,WAAL,CAAiB,CAA/E,CA3EoO,CA8EpO;AACA;AACA;AAEA;;AACA,QAAI,KAAK,cAAT,EAAyB;AAExB,UAAI,KAAK,KAAL,CAAW,SAAf,EAA2B;AAC1B,YAAI,KAAK,UAAL,KAAoB,uBAAe,OAAnC,IAA8C,KAAK,EAAL,GAAU,KAAK,YAAjE,EAA+E;AAC9E,eAAK,YAAL,GAAsB,KAAK,eAAL,GAA0B,CAAC,KAAK,WAAL,GAAmB,KAAK,eAAzB,IAA6C,IAAI,CAAC,GAAL,CAAS,CAAT,EAAY,IAAI,CAAC,GAAL,CAAS,KAAK,WAAd,EAA2B,KAAK,EAAL,GAAU,KAAK,YAA1C,CAAZ,CAA7F;AACA,SAFD,MAEO,IAAI,KAAK,UAAL,KAAoB,uBAAe,MAAnC,IAA6C,KAAK,EAAL,GAAW,KAAK,WAAL,GAAmB,KAAK,YAApF,EAAmG;AAEzG,cAAI,SAAS,GAAG,KAAK,YAArB;AACA,cAAI,KAAK,GAAG,KAAK,EAAjB;AACA,cAAI,SAAS,GAAG,KAAK,WAArB;;AACA,cAAI,KAAK,aAAT,EAAwB;AACvB,gBAAI,YAAY,GAAG,KAAK,WAAL,GAAmB,KAAK,aAA3C;AACA,qBAAS,GAAG,KAAK,YAAL,GAAoB,YAAhC;AACA,qBAAS,GAAG,KAAK,WAAL,GAAmB,YAA/B;AACA;;AAED,eAAK,YAAL,GAAsB,KAAK,eAAL,GAA0B,CAAC,KAAK,WAAL,GAAmB,KAAK,eAAzB,IAA6C,IAAI,CAAC,GAAL,CAAS,CAAT,EAAY,IAAI,CAAC,GAAL,CAAS,KAAK,WAAd,EAA2B,CAAC,SAAS,GAAG,KAAK,EAAlB,IAAwB,SAAnD,CAAZ,CAA7F;AACA;AACD;;AAED,UAAI,KAAK,KAAL,CAAW,SAAf,EAA0B;AAEzB,YAAI,KAAK,UAAL,KAAoB,uBAAe,OAAnC,IAA8C,KAAK,EAAL,GAAU,KAAK,YAAjE,EAA+E;AAC9E,eAAK,MAAL,GAAe,KAAK,eAAL,GAA0B,CAAC,MAAM,KAAK,eAAZ,IAA+B,IAAI,CAAC,GAAL,CAAS,CAAT,EAAY,IAAI,CAAC,GAAL,CAAS,CAAT,EAAY,KAAK,EAAL,GAAU,KAAK,YAA3B,CAAZ,CAAxE;AACA,SAFD,MAEO,IAAI,KAAK,UAAL,KAAoB,uBAAe,MAAnC,IAA6C,KAAK,EAAL,GAAW,KAAK,WAAL,GAAmB,KAAK,YAApF,EAAmG;AACzG,eAAK,MAAL,GAAe,KAAK,eAAL,GAAyB,CAAC,MAAM,KAAK,eAAZ,IAA+B,IAAI,CAAC,GAAL,CAAS,CAAT,EAAY,IAAI,CAAC,GAAL,CAAS,CAAT,EAAY,CAAC,KAAK,WAAL,GAAmB,KAAK,EAAzB,IAA+B,KAAK,YAAhD,CAAZ,CAAvE;AACA;;AAED,aAAK,OAAL,CAAa,KAAb,GAAqB,KAAK,MAA1B;AAEA;;AAED,UAAI,KAAK,KAAL,CAAW,UAAf,EAA2B;AAE1B,YAAI,KAAK,UAAL,KAAoB,uBAAe,OAAnC,IAA8C,KAAK,EAAL,GAAU,KAAK,YAAjE,EAA+E;AAC9E,eAAK,eAAL,GAAwB,KAAK,cAAL,GAAuB,KAAK,kBAAL,GAA0B,IAAI,CAAC,GAAL,CAAS,CAAT,EAAY,IAAI,CAAC,GAAL,CAAS,CAAT,EAAa,CAAC,KAAK,YAAL,GAAoB,KAAK,EAA1B,IAAgC,KAAK,YAAlD,CAAZ,CAAzE;AACA,SAFD,MAEO,IAAI,KAAK,UAAL,KAAoB,uBAAe,MAAnC,IAA6C,KAAK,EAAL,GAAW,KAAK,WAAL,GAAmB,KAAK,YAApF,EAAmG,CACzG;AACA;AAED;AAED;;AAED,SAAK,MAAL,GAAc,KAAK,MAAL,GAAe,CAAC,KAAK,YAAL,GAAoB,KAAK,MAA1B,IAAqC,KAAK,WAAL,CAAiB,KAAnF,CA/HoO,CAiIpO;AACA;AACA;;AACA,SAAK,SAAL,GAAiB,KAAK,SAAL,GAAkB,CAAC,KAAK,eAAL,GAAuB,KAAK,SAA7B,IAA2C,KAAK,WAAL,CAAiB,QAA/F,CApIoO,CAsIpO;;AACA,SAAK,OAAL,CAAa,QAAb,CAAsB,GAAtB,CAA0B,KAAK,EAA/B,EAAmC,KAAK,eAAL,CAAqB,CAAxD;;AACA,SAAK,OAAL,CAAa,KAAb,CAAmB,GAAnB,CAAuB,KAAK,MAAL,GAAc,KAAK,aAA1C,EAAyD,KAAK,MAAL,GAAc,KAAK,aAA5E;;AACA,SAAK,OAAL,CAAa,QAAb,GAAwB,KAAK,SAA7B,CAzIoO,CA2IpO;;AACA,QAAI,KAAK,aAAT,EAAwB;AACvB,WAAK,aAAL,CAAmB,IAAnB,CAAwB,UAAxB;AACA;AAED,GAhJM;AAkJP;;;;;;;AAKO,yCAAP,UAAqB,KAArB,EAAoC,KAApC,EAAqD;AAArD;;AAAoC;AAAA;AAAiB;;AAEpD,QAAI,KAAK,sBAAT,EAAiC;AAChC,WAAK,sBAAL,CAA4B,SAA5B,CAAsC,KAAtC;AACA;;AAED,SAAK,MAAL,GAAc,IAAI,CAAC,QAAL,CAAc,EAAd,CAAiB,KAAK,OAAtB,EAA+B,IAAK,MAAM,KAAK,mBAA/C,EACb;AAAC,OAAC,EAAE,KAAJ;AAAW,UAAI,EAAE,IAAI,CAAC,MAAL,CAAY,MAA7B;AAAqC,WAAK,EAAE,KAA5C;AAAmD,gBAAU,EAAE;AAAM,oBAAI,CAAJ;AAA2B;AAAhG,KADa,CAAd;AAGA,GATM;AAWP;;;;;;AAIO,2CAAP,UAAuB,KAAvB,EAA0C;AAA1C;;AAAuB;AAAA;AAAmB;;AACzC,QAAI,CAAC,GAAW,KAAK,eAAL,CAAqB,SAArB,GAAiC,KAAK,QAAtD;AACA,SAAK,MAAL,GAAc,IAAI,CAAC,QAAL,CAAc,EAAd,CAAiB,KAAK,OAAtB,EAA+B,IAAK,MAAM,KAAK,mBAA/C,EACb;AAAC,OAAC,EAAE,CAAJ;AAAO,UAAI,EAAE,IAAI,CAAC,MAAL,CAAY,OAAzB;AAAkC,WAAK,EAAE,KAAzC;AAAgD,gBAAU,EAAE;AAAM,oBAAI,CAAJ;AAA2B;AAA7F,KADa,CAAd;AAGA,GALM;AAOP;;;AACO,uDAAP;AACC,QAAI,KAAK,MAAT,EAAiB;AAChB,WAAK,MAAL,CAAY,IAAZ;AACA;AACD,GAJM;AAMP;;;AACO,iCAAP;AACC,SAAK,OAAL,CAAa,CAAb,GAAiB,KAAK,eAAL,CAAqB,SAArB,GAAiC,KAAK,QAAvD;AACA,GAFM;AAIP;;;;;;AAIO,yCAAP,UAAqB,IAArB,EAAiC;AAChC,SAAK,OAAL,CAAa,CAAb,GAAiB,IAAjB;AACA,GAFM;AAIP;;;AACO,4CAAP,UAAwB,KAAxB,EAAgD;AAE/C,QAAK,KAAK,gBAAV,EAA6B;AAC5B,WAAK,gBAAL,CAAsB,gBAAtB,CAAuC,KAAvC;AACA;;AAED,QAAK,KAAK,kBAAV,EAA+B;AAC9B,WAAK,kBAAL,CAAwB,gBAAxB,CAAyC,KAAzC;AACA;;AAED,QAAK,KAAK,iBAAV,EAA8B;AAC7B,WAAK,iBAAL,CAAuB,gBAAvB,CAAwC,KAAxC;AACA;AAED,GAdM;;AAgBA,mDAAP,UAA+B,MAA/B,EAA4C;AAE3C,QAAK,KAAK,sBAAV,EAAmC;AAClC,WAAK,sBAAL,CAA4B,uBAA5B,CAAoD,MAApD;AACA;AACD,GALM,CA3eR,CAkfC;AACA;AACA;AACA;AACA;AAEA;;;AACQ,yDAAR,UAAsC,QAAtC,EAAwD,cAAxD,EAA8E;AAC7E;AACA,SAAK,kBAAL,GAA0B,KAAK,SAAL,GAAiB,GAA3C,CAF6E,CAG7E;;AACA,SAAK,iCAAL,GAAyC,KAAK,kBAAL,IAA2B,QAAQ,GAAG,GAAtC,CAAzC,CAJ6E,CAK7E;;AACA,SAAK,YAAL,GAAqB,KAAK,iCAAL,GAAyC,KAAK,mBAA9C,IAAqE,cAAc,GAAG,CAAtF,CAArB;AACA,GAPO;;AASA,0CAAR,UAAuB,WAAvB,EAA6C,OAA7C,EAAqE;AAAxB;AAAA;AAAwB,MAEpE;;;AACA,QAAI,OAAJ,EAAa;AACZ,WAAK,WAAL,CAAiB,KAAjB,GAAyB,CAAzB;AACA,WAAK,WAAL,CAAiB,CAAjB,GAAqB,CAArB;AACA,WAAK,WAAL,CAAiB,CAAjB,GAAqB,CAArB;AACA,WAAK,WAAL,CAAiB,KAAjB,GAAyB,CAAzB;AACA,WAAK,WAAL,CAAiB,QAAjB,GAA4B,CAA5B;AACA;AACA;;AAED,SAAK,WAAL,CAAiB,KAAjB,GAA0B,WAAD,GAAgB,IAAI,KAAK,sBAAzB,GAAkD,KAAK,KAAK,sBAArF;AACA,SAAK,WAAL,CAAiB,CAAjB,GAAqB,IAAI,KAAK,sBAA9B;AACA,SAAK,WAAL,CAAiB,CAAjB,GAAqB,IAAI,KAAK,sBAA9B;AACA,SAAK,WAAL,CAAiB,KAAjB,GAAyB,IAAI,KAAK,sBAAlC;AACA,SAAK,WAAL,CAAiB,QAAjB,GAA4B,IAAI,KAAK,sBAArC;AAEA,GAlBO;AAoBR;;;AACQ,gDAAR;AACC,SAAK,sBAAL,GAA8B,KAAK,4BAAnC;AACA,GAFO;AAIR;;;AACQ,qDAAR;AACC,QAAI,KAAK,sBAAL,GAA8B,CAAlC,EAAqC;AACpC,WAAK,sBAAL,IAA+B,GAA/B;AACA;AACD,GAJO;AAMR;;;AACQ,0CAAR,UAAuB,UAAvB,EAAwC,SAAxC,EAAsD;AAElD;AACA,QAAI,CAAC,sBAAU,MAAV,CAAiB,gBAAtB,EAAwC;AACvC,WAAK,mBAAL,CAAyB,UAAzB;AACA;AAEJ,GAPO;;AASA,+CAAR,UAA4B,UAA5B,EAA2C;AAE1C;AACA;AAEA,SAAK,OAAL,CAAa,SAAb,GAA0B,UAAU,CAAC,CAAX,GAAe,KAAK,EAA9C;AACG,SAAK,OAAL,CAAa,SAAb,GAAyB,UAAU,CAAC,CAAX,IAAgB,KAAK,UAAL,GAAkB,KAAK,QAAvC,CAAzB;AACA,SAAK,OAAL,CAAa,QAAb,GAAwB,IAAI,CAAC,IAAL,CAAW,KAAK,OAAL,CAAa,SAAb,GAAyB,KAAK,OAAL,CAAa,SAAvC,GAAqD,KAAK,OAAL,CAAa,SAAb,GAAyB,KAAK,OAAL,CAAa,SAArG,CAAxB;AACG,SAAK,OAAL,CAAa,MAAb,GAAwB,KAAK,OAAL,CAAa,SAAb,GAAyB,KAAK,OAAL,CAAa,QAAvC,GAAmD,KAAK,OAAL,CAAa,MAAhE,GAAyE,KAAK,OAAL,CAAa,QAA7G;AACA,SAAK,OAAL,CAAa,MAAb,GAAuB,KAAK,OAAL,CAAa,SAAb,GAAyB,KAAK,OAAL,CAAa,QAAvC,GAAmD,KAAK,OAAL,CAAa,MAAhE,GAAyE,KAAK,OAAL,CAAa,QAA5G,CAToC,CAWpC;;AAEA,QAAI,KAAK,GAAG,CAAZ;;AACL,QAAK,KAAK,OAAL,CAAa,QAAb,GAAwB,KAAK,kBAAlC,EAAsD;AAErD,WAAK,OAAL,CAAa,WAAb,GAA4B,KAAK,OAAL,CAAa,MAAb,GAAsB,CAAC,KAAK,iBAAxD;AACA,WAAK,OAAL,CAAa,WAAb,GAA4B,KAAK,OAAL,CAAa,MAAb,GAAsB,CAAC,KAAK,iBAAxD,CAHqD,CAKrD;AACA;;AAEA;;;;;;;;;AAaA;AACA,KAtBD,MAsBQ;AACP,WAAK,OAAL,CAAa,WAAb,GAA4B,KAAK,OAAL,CAAa,WAAb,GAA2B,CAAvD;AACA;;AAIF,QAAI,KAAK,GAAG,KAAK,oBAAL,GAA6B,MAAM,KAA/C;AACA,SAAK,OAAL,CAAa,KAAb,GAAsB,KAAK,OAAL,CAAa,KAAb,GAAsB,CAAC,KAAK,OAAL,CAAa,WAAb,GAA2B,KAAK,OAAL,CAAa,KAAzC,IAAoD,KAAhG;AACA,SAAK,OAAL,CAAa,KAAb,GAAsB,KAAK,OAAL,CAAa,KAAb,GAAsB,CAAC,KAAK,OAAL,CAAa,WAAb,GAA2B,KAAK,OAAL,CAAa,KAAzC,IAAmD,KAA/F;AAEA;;;;;;;;;;AAWA,GAzDO;;AA2DA,8CAAR,UAA4B,SAA5B,EAA0C;AAEzC,QAAK,CAAC,SAAN,EAAkB;AACjB;AACA;;AAED,SAAK,OAAL,CAAa,aAAb,GAA8B,SAAS,CAAC,CAAV,GAAc,KAAK,EAAjD;AACG,SAAK,OAAL,CAAa,aAAb,GAA6B,SAAS,CAAC,CAAV,IAAe,KAAK,UAAL,GAAkB,KAAK,QAAtC,CAA7B;AACA,SAAK,OAAL,CAAa,YAAb,GAA4B,IAAI,CAAC,IAAL,CAAW,KAAK,OAAL,CAAa,aAAb,GAA6B,KAAK,OAAL,CAAa,aAA3C,GAA6D,KAAK,OAAL,CAAa,aAAb,GAA6B,KAAK,OAAL,CAAa,aAAjH,CAA5B;AACG,SAAK,OAAL,CAAa,UAAb,GAA4B,KAAK,OAAL,CAAa,aAAb,GAA6B,KAAK,OAAL,CAAa,YAA3C,GAA2D,KAAK,OAAL,CAAa,UAAxE,GAAqF,KAAK,OAAL,CAAa,YAA7H;AACA,SAAK,OAAL,CAAa,UAAb,GAA2B,KAAK,OAAL,CAAa,aAAb,GAA6B,KAAK,OAAL,CAAa,YAA3C,GAA2D,KAAK,OAAL,CAAa,UAAxE,GAAqF,KAAK,OAAL,CAAa,YAA5H;;AAEN,QAAK,KAAK,OAAL,CAAa,aAAb,GAA6B,KAAK,eAAvC,EAAwD;AACtD,WAAK,OAAL,CAAa,eAAb,GAAgC,KAAK,OAAL,CAAa,UAAb,GAA0B,CAAC,KAAK,gBAAhE;AACA,WAAK,OAAL,CAAa,eAAb,GAAgC,KAAK,OAAL,CAAa,UAAb,GAA0B,CAAC,KAAK,gBAAhE;AACD,KAHD,MAGS;AACP,WAAK,OAAL,CAAa,eAAb,GAAgC,KAAK,OAAL,CAAa,eAAb,GAA+B,CAA/D;AACD;;AAEA,SAAK,OAAL,CAAa,SAAb,GAA0B,KAAK,OAAL,CAAa,SAAb,GAA0B,CAAC,KAAK,OAAL,CAAa,eAAb,GAA+B,KAAK,OAAL,CAAa,SAA7C,IAA2D,EAA/G;AACA,SAAK,OAAL,CAAa,SAAb,GAA0B,KAAK,OAAL,CAAa,SAAb,GAA0B,CAAC,KAAK,OAAL,CAAa,eAAb,GAA+B,KAAK,OAAL,CAAa,SAA7C,IAA2D,EAA/G;AAED,GAtBO;;AAwBT;AAAC,CA/nBD;;AAAa,oC;;;;;;;;;;;;;;;;;AC9Bb,IAAY,kBAAZ;;AAAA,WAAY,kBAAZ,EAA8B;AAAE;AAAyB;AAAsB,CAA/E,EAAY,kBAAkB,GAAlB,4DAAkB,EAAlB,CAAZ;;AAmBA;AAAA;AAAA;AAeC,0BAAmB,MAAnB,EAA+C;AAPvC,yBAAyB,KAAzB;AACA,oBAAoB,KAApB;AAOP,SAAK,GAAL,GAAW,MAAM,CAAC,EAAlB;AACA,SAAK,KAAL,GAAa,MAAM,CAAC,IAApB;AACA,SAAK,KAAL,GAAa,MAAM,CAAC,IAAP,IAAe,IAA5B;AACA,SAAK,MAAL,GAAc,MAAM,CAAC,KAAP,IAAgB,IAA9B;AACA,SAAK,QAAL,GAAgB,MAAM,CAAC,OAAvB;AACA,SAAK,OAAL,GAAe,MAAM,CAAC,MAAtB;AACA;;AAXD,wBAAW,wBAAX,EAAW,IAAX,EAAa;SAAb;AACC,aAAO,KAAK,GAAZ;AACA,KAFY;oBAAA;;AAAA,GAAb;;AAaO,kCAAP,UAAY,UAAZ,EAAoC,QAApC,EAAsD,QAAtD,EAAsE;AAErE,QAAI,KAAK,KAAL,KAAe,kBAAkB,CAAC,SAAtC,EAAiD;AAChD,WAAK,iBAAL,CAAuB,UAAvB,EAAmC,QAAnC;AACA,KAFD,MAEO,IAAI,KAAK,KAAL,KAAe,kBAAkB,CAAC,QAAtC,EAAgD;AACtD,WAAK,gBAAL,CAAsB,QAAtB;AACA;AAED,GARM;;AAUC,+CAAR,UAA0B,UAA1B,EAAkD,QAAlD,EAAkE;AAEjE,SAAK,aAAL,GACC,UAAU,CAAC,IAAX,GAAkB,KAAK,KAAL,CAAW,CAA7B,IACG,UAAU,CAAC,IAAX,GAAkB,KAAK,KAAL,CAAW,CAAX,GAAe,KAAK,KAAL,CAAW,CAD/C,IAEG,UAAU,CAAC,IAAX,GAAkB,KAAK,KAAL,CAAW,CAFhC,IAGG,UAAU,CAAC,IAAX,GAAkB,KAAK,KAAL,CAAW,CAAX,GAAe,KAAK,KAAL,CAAW,CAJhD;;AAOA,SAAK,gBAAL,CAAsB,QAAtB,EAAgC,IAAhC;AACA,GAVO;;AAYC,8CAAT,UAA0B,QAA1B,EAA0C;AACzC,SAAK,aAAL,GAAsB,QAAQ,GAAG,KAAK,MAAL,CAAY,GAAvB,IAA8B,QAAQ,IAAI,KAAK,MAAL,CAAY,GAA5E;;AACA,SAAK,gBAAL;AACA,GAHQ;;AAKD,8CAAR,UAAyB,QAAzB,EAA+C,UAA/C,EAA0E;AAAjD;AAAA;AAAoB;;AAAE;AAAA;AAA2B;;AAEzE,QAAI,SAAS,GAAa,UAAU,IAAK,MAAc,CAAC,WAAxD;;AACA,QAAI,CAAC,KAAK,QAAN,IAAkB,KAAK,aAAvB,IAAwC,IAAI,CAAC,GAAL,CAAS,QAAT,IAAqB,IAA7D,IAAqE,CAAC,SAA1E,EAAqF;AACpF,WAAK,QAAL,GAAgB,IAAhB;;AACA,WAAK,QAAL,CAAc,KAAK,GAAnB;AACA,KAHD,MAGO,IAAK,KAAK,QAAL,IAAiB,CAAC,KAAK,aAA5B,EAA2C;AACjD,WAAK,QAAL,GAAgB,KAAhB;;AACA,WAAK,OAAL,CAAa,KAAK,GAAlB;AACA;AACD,GAVO;;AAYT;AAAC,CA/DD;;AAAa,wC;;;;;;;;;;;;;;;;;;ACpBb;;AAGA;AAAA;AAAA;AAAA;AAES,oBAAkC,EAAlC;AAmBR;;AAjBO,wCAAP,UAAW,MAAX,EAAuC;AACtC,SAAK,QAAL,CAAc,IAAd,CAAoB,IAAI,+BAAJ,CAAmB,MAAnB,CAApB;AACA,GAFM;;AAIA,yCAAP,UAAY,UAAZ,EAA+B,UAA/B,EAAmD,cAAnD,EAA2E,eAA3E,EAA4F,QAA5F,EAA8G,QAA9G,EAA8H;AAE7H,SAAK,QAAL,CAAc,OAAd,CAAuB,UAAC,MAAD,EAAuB;AAC7C,YAAM,CAAC,IAAP,CAAY;AACX,SAAC,EAAE,UAAU,CAAC,CADH;AAEX,SAAC,EAAE,UAAU,CAAC,CAFH;AAGX,YAAI,EAAG,CAAC,IAAI,CAAC,GAAL,CAAS,UAAT,IAAuB,UAAU,CAAC,CAAnC,IAAwC,cAHpC;AAIX,YAAI,EAAG,UAAU,CAAC,CAAX,GAAe;AAJX,OAAZ,EAKG,QALH,EAKa,QALb;AAMA,KAPD;AASA,GAXM;;AAaR;AAAC,CArBD;;AAAa,sD;;;;;;;;;;;;;;;;;;ACFb;AAEA;;;AACA;AAAA;AAAA;AAAA;AAES,0BAA2C,IAAI,mDAAJ,EAA3C;AA6BR;;AArBO,mDAAP,UAAsB,MAAtB,EAAqC,MAArC,EAAmD;AAClD,SAAK,OAAL,GAAe,MAAf;AACA,SAAK,OAAL,GAAe,MAAf;AACA,GAHM;;AAKA,0CAAP,UAAa,aAAb,EAAiC;AAC7B,SAAK,SAAL,GAAiB,KAAK,cAAL,CAAoB,OAApB,CAA4B,aAA5B,EAA2C,KAAK,OAAhD,CAAjB;;AACA,QAAI,KAAK,SAAL,IAAkB,KAAK,OAA3B,EAAoC;AAChC,aAAO;AAAC,SAAC,EAAE,aAAa,CAAC,CAAlB;AAAqB,SAAC,EAAE,aAAa,CAAC;AAAtC,OAAP;AACH,KAFD,MAEO;AACH,WAAK,EAAL,GAAU,aAAa,CAAC,CAAd,GAAkB,KAAK,OAAL,CAAa,CAAzC;AACA,WAAK,EAAL,GAAW,aAAa,CAAC,CAAd,GAAkB,KAAK,OAAL,CAAa,CAA1C;AACA,WAAK,QAAL,GAAgB,IAAI,CAAC,KAAL,CAAW,KAAK,EAAhB,EAAoB,KAAK,EAAzB,CAAhB;AACA,aAAO;AACH,SAAC,EAAE,IAAI,CAAC,GAAL,CAAS,KAAK,QAAd,IAA0B,KAAK,OAA/B,GAAyC,KAAK,OAAL,CAAa,CADtD;AAEH,SAAC,EAAE,IAAI,CAAC,GAAL,CAAS,KAAK,QAAd,IAA0B,KAAK,OAA/B,GAAyC,KAAK,OAAL,CAAa;AAFtD,OAAP;AAIH;AAED,GAdG;;AAgBR;AAAC,CA/BD;;AAAa,sD;;;;;;;;;;;;;;;;;ACFb;;AACA;AAAA;AAAA;AAAA,uCAMC;;AAJO,+CAAP,UAAe,EAAf,EAA0B,EAA1B,EAAmC;AAClC,WAAO,IAAI,CAAC,IAAL,CAAW,IAAI,CAAC,GAAL,CAAS,EAAE,CAAC,CAAH,GAAO,EAAE,CAAC,CAAnB,EAAsB,CAAtB,IAA2B,IAAI,CAAC,GAAL,CAAS,EAAE,CAAC,CAAH,GAAO,EAAE,CAAC,CAAnB,EAAsB,CAAtB,CAAtC,CAAP;AACA,GAFM;;AAIR;AAAC,CAND;;AAAa,4D;;;;;;;;;;;;;;;;;ACAb;;AACA;AAAA;AAAA;AAEC,oCAAqB,UAArB,EAAiD,UAAjD,EAAmE;AAA9C;AAA4B;AAAsB;;AAOvE,wBAAW,kCAAX,EAAW,GAAX,EAAY;SAAZ;AACC,aAAO,KAAK,EAAZ;AACA,KAFW;oBAAA;;AAAA,GAAZ;AAIA,wBAAW,kCAAX,EAAW,GAAX,EAAY;SAAZ;AACC,aAAO,KAAK,EAAZ;AACA,KAFW;oBAAA;;AAAA,GAAZ;AAIA,wBAAW,kCAAX,EAAW,WAAX,EAAoB;SAApB;AACC,aAAO,KAAK,UAAZ;AACA,KAFmB;oBAAA;;AAAA,GAApB;AAIA,wBAAW,kCAAX,EAAW,WAAX,EAAoB;SAApB;AACC,aAAO,KAAK,UAAZ;AACA,KAFmB;oBAAA;;AAAA,GAApB;;AAIO,8CAAP,UAAc,cAAd,EAAsC,eAAtC,EAA6D;AAC5D,SAAK,UAAL,GAAkB,cAAc,GAAG,KAAK,UAAxC;AACA,SAAK,UAAL,GAAkB,eAAe,GAAG,KAAK,UAAzC;AACA,GAHM;;AAKA,8CAAP,UAAc,OAAd,EAA+B,OAA/B,EAA8C;AAC7C,SAAK,EAAL,GAAU,KAAK,UAAL,GAAkB,OAA5B;AACA,SAAK,EAAL,GAAU,KAAK,UAAL,GAAkB,OAA5B;AACA,GAHM;;AAKA,gDAAP,UAAgB,CAAhB,EAA2B,CAA3B,EAAoC;AACnC,SAAK,EAAL,IAAW,CAAX;AACA,SAAK,EAAL,IAAW,CAAX;AACA,GAHM;;AAKA,mDAAP,UAAmB,KAAnB,EAA+B;AAC9B,SAAK,EAAL,GAAU,KAAK,CAAC,CAAhB;AACA,SAAK,EAAL,GAAU,KAAK,CAAC,CAAhB;AACA,GAHM;;AAKR;AAAC,CA7CD;;AAAa,4D;;;;;;;;;;;;CCJb;AACA;;;;IAEA;AACA;AACA;;AAEA;AAAA;AAAA;AAUE,wBAAY,EAAZ,EAAgB,KAAhB,EAAqB;AAEnB,SAAK,KAAL,GAAa,EAAb;AACA,SAAK,EAAL,GAAU,EAAV;AACA,SAAK,KAAL,GAAa,6BAAb;AACA,SAAK,MAAL,GAAc,KAAK,MAAL,CAAY,IAAZ,CAAiB,IAAjB,CAAd;;AAEA,QAAI,KAAJ,EAAW;AACT,WAAK,KAAL,GAAa,KAAb;AACD;AAEF;;AACD,6CAAQ,OAAR,EAAe;AAAf;;AACE,QAAM,OAAO,GAAG,KAAK,EAAL,CAAQ,SAAxB;AACA,QAAM,MAAM,GAAG,IAAI,CAAC,GAAL,CAAS,OAAO,CAAC,MAAjB,EAAyB,OAAO,CAAC,MAAjC,CAAf;AACA,QAAM,OAAO,GAAG,IAAI,OAAJ,CAAY,UAAC,OAAD,EAAQ;AAAK,kBAAI,CAAC,OAAL;AAAsB,KAA/C,CAAhB;AACA,SAAK,KAAL,GAAa,EAAb;;AACA,SAAK,IAAI,CAAC,GAAG,CAAb,EAAgB,CAAC,GAAG,MAApB,EAA4B,CAAC,EAA7B,EAAiC;AAC/B,UAAM,IAAI,GAAG,OAAO,CAAC,CAAD,CAAP,IAAc,EAA3B;AACA,UAAM,EAAE,GAAG,OAAO,CAAC,CAAD,CAAP,IAAc,EAAzB;AACA,UAAM,KAAK,GAAG,IAAI,CAAC,KAAL,CAAW,IAAI,CAAC,MAAL,KAAgB,KAAK,KAAhC,CAAd;AACA,UAAM,GAAG,GAAG,KAAK,GAAG,IAAI,CAAC,KAAL,CAAW,IAAI,CAAC,MAAL,KAAgB,KAAK,KAAhC,CAApB;AACA,WAAK,KAAL,CAAW,IAAX,CAAgB;AAAE,YAAI,MAAN;AAAQ,UAAE,IAAV;AAAY,aAAK,OAAjB;AAAmB,WAAG;AAAtB,OAAhB;AACD;;AACD,wBAAoB,CAAC,KAAK,YAAN,CAApB;AACA,SAAK,KAAL,GAAa,CAAb;AACA,SAAK,MAAL;AACA,WAAO,OAAP;AACD,GAhBD;;AAiBA;AACE,QAAI,MAAM,GAAG,EAAb;AACA,QAAI,QAAQ,GAAG,CAAf;;AACA,SAAK,IAAI,CAAC,GAAG,CAAR,EAAW,CAAC,GAAG,KAAK,KAAL,CAAW,MAA/B,EAAuC,CAAC,GAAG,CAA3C,EAA8C,CAAC,EAA/C,EAAmD;AAC7C;AAAA,UAAE,cAAF;AAAA,UAAQ,UAAR;AAAA,UAAY,gBAAZ;AAAA,UAAmB,YAAnB;AAAA,UAAwB,cAAxB;;AACJ,UAAI,KAAK,KAAL,IAAc,GAAlB,EAAuB;AACrB,gBAAQ;AACR,cAAM,IAAI,EAAV;AACD,OAHD,MAGO,IAAI,KAAK,KAAL,IAAc,KAAlB,EAAyB;AAC9B,YAAI,CAAC,IAAD,IAAS,IAAI,CAAC,MAAL,KAAgB,IAA7B,EAAmC;AACjC,cAAI,GAAG,KAAK,UAAL,EAAP;AACA,eAAK,KAAL,CAAW,CAAX,EAAc,IAAd,GAAqB,IAArB;AACD;;AACD,cAAM,IAAI,yBAAqB,IAArB,GAAyB,SAAnC;AACD,OANM,MAMA;AACL,cAAM,IAAI,IAAV;AACD;AACF;;AACD,SAAK,EAAL,CAAQ,SAAR,GAAoB,MAApB;;AACA,QAAI,QAAQ,KAAK,KAAK,KAAL,CAAW,MAA5B,EAAoC;AAClC,WAAK,OAAL;AACD,KAFD,MAEO;AACL,WAAK,YAAL,GAAoB,qBAAqB,CAAC,KAAK,MAAN,CAAzC;AACA,WAAK,KAAL;AACD;AACF,GAzBD;;AA0BA;AACE,WAAO,KAAK,KAAL,CAAW,IAAI,CAAC,KAAL,CAAW,IAAI,CAAC,MAAL,KAAgB,KAAK,KAAL,CAAW,MAAtC,CAAX,CAAP;AACD,GAFD;;AAGF;AAAC,CApED;;AAAa,oC;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACPb;;AACA;;AAQA;AAAA;AAAA;AAA+B;;AAA/B;AAAA;;AAEQ,mBAAS;AACf,SAAG,EAAE,UADU;AAEf,UAAI,EAAE,CAAC,QAFQ;AAGf,WAAK,EAAE,CAAC;AAAC,uBAAc,KAAf;AAAqB,uBAAc,kBAAnC;AAAsD,mBAAU,CAAC;AAAC,wBAAa;AAAd,SAAD,EAAmB;AAAC,mBAAQ;AAAT,SAAnB,EAAuC;AAAC,uBAAY;AAAb,SAAvC;AAAhE,OAAD,EAA2H;AAAC,uBAAc,KAAf;AAAqB,uBAAc,oBAAnC;AAAwD,mBAAU,CAAC;AAAC,wBAAa;AAAd,SAAD,EAAqB;AAAC,mBAAQ;AAAT,SAArB,EAAyC;AAAC,uBAAY;AAAb,SAAzC;AAAlE,OAA3H,EAAyP;AAAC,uBAAc,KAAf;AAAqB,uBAAc,aAAnC;AAAiD,mBAAU,CAAC;AAAC,wBAAa;AAAd,SAAD;AAA3D,OAAzP,EAA4U;AAAC,uBAAc,gBAAf;AAAgC,uBAAc,eAA9C;AAA8D,mBAAU,CAAC;AAAC,mBAAQ;AAAT,SAAD,EAAqB;AAAC,uBAAY;AAAb,SAArB;AAAxE,OAA5U,EAA4b;AAAC,uBAAc,gBAAf;AAAgC,uBAAc,iBAA9C;AAAgE,mBAAU,CAAC;AAAC,mBAAQ;AAAT,SAAD,EAAqB;AAAC,uBAAY;AAAb,SAArB,EAAsC;AAAC,oBAAS;AAAV,SAAtC;AAA1E,OAA5b,EAA6jB;AAAC,uBAAc,WAAf;AAA2B,uBAAc,UAAzC;AAAoD,mBAAU,CAAC;AAAC,mBAAQ;AAAT,SAAD,EAAqB;AAAC,uBAAY;AAAb,SAArB;AAA9D,OAA7jB,EAAmqB;AAAC,uBAAc,KAAf;AAAqB,uBAAc,UAAnC;AAA8C,mBAAU,CAAC;AAAC,mBAAQ;AAAT,SAAD,EAAqB;AAAC,uBAAY;AAAb,SAArB;AAAxD,OAAnqB,EAAmwB;AAAC,uBAAc,cAAf;AAA8B,uBAAc,eAA5C;AAA4D,mBAAU,CAAC;AAAC,mBAAQ;AAAT,SAAD,EAAqB;AAAC,uBAAY;AAAb,SAArB;AAAtE,OAAnwB,EAAi3B;AAAC,uBAAc,cAAf;AAA8B,uBAAc,iBAA5C;AAA8D,mBAAU,CAAC;AAAC,mBAAQ;AAAT,SAAD,EAAqB;AAAC,uBAAY;AAAb,SAArB,EAAsC;AAAC,oBAAS;AAAV,SAAtC;AAAxE,OAAj3B,EAAg/B;AAAC,uBAAc,eAAf;AAA+B,uBAAc,UAA7C;AAAwD,mBAAU,CAAC;AAAC,mBAAQ;AAAT,SAAD,EAAqB;AAAC,uBAAY;AAAb,SAArB;AAAlE,OAAh/B,EAA0lC;AAAC,uBAAc,YAAf;AAA4B,uBAAc,UAA1C;AAAqD,mBAAU,CAAC;AAAC,mBAAQ;AAAT,SAAD,EAAqB;AAAC,uBAAY;AAAb,SAArB;AAA/D,OAA1lC,EAAisC;AAAC,uBAAc,SAAf;AAAyB,uBAAc,UAAvC;AAAkD,mBAAU,CAAC;AAAC,mBAAQ;AAAT,SAAD,EAAqB;AAAC,uBAAY;AAAb,SAArB;AAA5D,OAAjsC,EAAqyC;AAAC,uBAAc,OAAf;AAAuB,uBAAc,UAArC;AAAgD,mBAAU,CAAC;AAAC,mBAAQ;AAAT,SAAD,EAAqB;AAAC,uBAAY;AAAb,SAArB;AAA1D,OAAryC,CAHQ;AAIf,UAAI,EAAE,EAJS;AAKf,UAAI,EAAE,SALS;AAMf,aAAO,EAAE,aANM;AAOf,sBAAgB,EAAE,SAPH;AAQf,iBAAW,EAAE,+BARE;AASf,iBAAW,EAAE,KATE;AAUf,wBAAkB,EAAE,IAVL;AAWf,oBAAc,EAAE,IAXD;AAYf,kBAAY,EAAE,wBAZC;AAaf,qBAAe,EAAE;AAbF,KAAT;AAgBC,wBAAkC,EAAlC,CAlBT,CAqBC;;AACQ,4BAA0B,CAA1B;;AA8PR;;AAjPO,+BAAP;AAEC,QAAI,KAAK,MAAL,CAAY,YAAZ,IAA6B,MAAM,CAAC,UAAP,IAAqB,KAAK,MAAL,CAAY,cAAlE,EAAkF;AACjF,WAAK,WAAL;;AACA,WAAK,OAAL;AACA;AACA;;AAED,SAAK,UAAL,GARD,CASC;;;AACC,SAAK,gBAAL;;AACA,SAAK,cAAL,GAXF,CAYC;;;AACA,QAAI,KAAK,MAAL,CAAY,kBAAhB,EAAoC;AACnC,WAAK,gBAAL;AACA;;AACD,SAAK,MAAL;AACA,GAjBM;;AAoBA,+BAAP;AACE,SAAK,UAAL,CAAgC,KAAhC,CAAsC,MAAtC,GAAkD,MAAM,CAAC,WAAP,GAAqB,GAArB,GAAwB,IAA1E;AACD,GAFM,CAvDR,CA2DC;AACA;;;AACQ,mCAAR;AAEC,QAAI,MAAM,GAAG,IAAI,MAAM,CAAC,IAAP,CAAY,MAAhB,CAAuB,KAAK,MAAL,CAAY,GAAnC,EAAwC,KAAK,MAAL,CAAY,IAApD,CAAb;AACA,QAAI,UAAU,GAA2B;AAClC,UAAI,EAAE,KAAK,MAAL,CAAY,IADgB;AAElC,YAAM,EAAE,MAF0B;AAGlC,eAAS,EAAE,MAAM,CAAC,IAAP,CAAY,SAAZ,CAAsB,KAAK,MAAL,CAAY,IAAlC,CAHuB;AAIlC,oBAAc,EAAE,KAJkB;AAKlC,gBAAU,EAAE,KALsB;AAMxC,iBAAW,EAAE,KAAK,MAAL,CAAY,WANe;AAOvC,YAAM,EAAG,KAAK,MAAL,CAAY,KAPkB;AAQ/B,wBAAkB,EAAE;AAChB,aAAK,EAAE,MAAM,CAAC,IAAP,CAAY,gBAAZ,CAA6B,KADpB;AAEhB,gBAAQ,EAAE,MAAM,CAAC,IAAP,CAAY,eAAZ,CAA4B,KAAK,MAAL,CAAY,OAAxC;AAFM,OARW;AAY9B,8BAAwB,EAAG;AAAE,gBAAQ,EAAG,MAAM,CAAC,IAAP,CAAY,eAAZ,CAA4B,KAAK,MAAL,CAAY,OAAxC;AAAb,OAZG;AAa9B,qBAAe,EAAE,KAAK,MAAL,CAAY;AAbC,KAAzC;AAgBG,SAAK,IAAL,GAAY,IAAI,MAAM,CAAC,IAAP,CAAY,GAAhB,CAAoB,KAAK,UAAzB,EAAqC,UAArC,CAAZ;AAEH,GArBO;;AAuBA,yCAAR;AACC,SAAK,WAAL,CAAiB,IAAjB,CAAsB;AAAC,SAAG,EAAE,KAAK,MAAL,CAAY,GAAlB;AAAuB,UAAI,EAAE,KAAK,MAAL,CAAY,IAAzC;AAA+C,WAAK,EAAE,KAAK,MAAL,CAAY;AAAlE,KAAtB;AACA,GAFO;;AAIA,uCAAR;AAAA;;AAEC,QAAI,KAAK,WAAL,CAAiB,MAAjB,KAA4B,CAAhC,EAAmC;AAClC;AACA;;AAED,SAAK,WAAL,CAAiB,OAAjB,CAA0B,UAAC,IAAD,EAAkB;AAAK,kBAAI,CAAC,aAAL;AAAwB,KAAzE;AAEA,GARO;;AAUA,sCAAR,UAAsB,IAAtB,EAAuC;AAEtC,QAAI,IAAI,GAAG;AACV,SAAG,EAAE,IAAI,CAAC,KADA;AAEV,gBAAU,EAAE,IAAI,MAAM,CAAC,IAAP,CAAY,IAAhB,CAAqB,EAArB,EAAyB,EAAzB,CAFF;AAGV,YAAM,EAAE,IAAI,MAAM,CAAC,IAAP,CAAY,KAAhB,CAAsB,CAAtB,EAAyB,CAAzB,CAHE;AAIV,YAAM,EAAE,IAAI,MAAM,CAAC,IAAP,CAAY,KAAhB,CAAsB,EAAtB,EAA0B,EAA1B,CAJE,CAI4B;;AAJ5B,KAAX;AAOA,QAAI,KAAK,GAAI,IAAI,MAAM,CAAC,IAAP,CAAY,MAAhB,CAAuB,IAAI,CAAC,GAA5B,EAAiC,IAAI,CAAC,IAAtC,CAAb;AACA,QAAI,MAAM,GAAG,IAAI,MAAM,CAAC,IAAP,CAAY,MAAhB,CAAuB;AACnC,eAAS,EAAE,KADwB;AAEnC,UAAI,EAAE,IAF6B;AAGnC,SAAG,EAAE,KAAK,IAHyB;AAInC,cAAQ,EAAE;AAJyB,KAAvB,CAAb;AAMA,GAhBO;;AAkBA,yCAAR;AAAA;;AAEC,SAAK,qBAAL,GAA6B,QAAQ,CAAC,aAAT,CAAuB,KAAK,MAAL,CAAY,kBAAnC,CAA7B;AAEA,SAAK,kBAAL,GAA0B,IAAI,MAAM,CAAC,IAAP,CAAY,iBAAhB,EAA1B;AACM,SAAK,kBAAL,GAA0B,IAAI,MAAM,CAAC,IAAP,CAAY,kBAAhB,CAAmC;AAC/D,qBAAe,EAAE;AACf,mBAAW,EAAE,SADE;AAEf,oBAAY,EAAE;AAFC,OAD8C;AAK/D,mBAAa,EAAE;AAAC,eAAO,EAAE,KAAV;AAAiB,gBAAQ,EAAE;AAA3B;AALgD,KAAnC,CAA1B;;AAQJ,SAAK,kBAAL,CAAwB,MAAxB,CAA+B,KAAK,IAApC,EAbH,CAeG;;;AACA,SAAK,aAAL,GAAqB,IAAI,MAAM,CAAC,IAAP,CAAY,MAAZ,CAAmB,YAAvB,CACtB,KAAK,qBAAL,CAA2B,aAA3B,CAAyC,0BAAzC,CADsB,EAEtB;AAAC,WAAK,EAAE,CAAC,SAAD;AAAR,KAFsB,CAArB,CAhBH,CAqBC;AACA;;AACA,SAAK,aAAL,CAAmB,WAAnB,CAA+B,eAA/B,EAAgD;AAAM,kBAAI,CAAJ;AAAqB,KAA3E,EAvBD,CAyBC;;;AACA,oBAAO,EAAP,CAAU,OAAV,EAAsB,KAAK,MAAL,CAAY,kBAAZ,GAA8B,yBAApD,EAA+E,UAAC,CAAD,EAAc;AAC5F;AACA,UAAI,IAAI,GAAa,CAAC,CAAC,MAAF,CAAyB,YAAzB,CAAsC,kBAAtC,CAArB;AACA,UAAI,UAAU,GAA2B,MAAM,CAAC,IAAP,CAAY,UAAZ,CAAuB,IAAvB,CAAzC;;AAEA,WAAI,CAAC,cAAL,CAAoB,UAApB;;AACA,aAAO,KAAP;AACA,KAPD;AASA,oBAAO,EAAP,CAAU,OAAV,EAAmB,KAAG,KAAK,MAAL,CAAY,kBAAlC,EAAwD,UAAC,CAAD,EAAc;AACrE,WAAI,CAAC,sBAAL;;AACA,aAAO,KAAP;AACA,KAHD,EAnCD,CAwCC;;AACA,SAAK,iBAAL,GAA0B,KAAK,qBAAL,CAA2B,aAA3B,CAAyC,yBAAzC,CAA1B;AACA,SAAK,wBAAL,GAAiC,KAAK,qBAAL,CAA2B,aAA3B,CAAyC,0BAAzC,CAAjC;AACA,SAAK,iBAAL,GAA0B,KAAK,qBAAL,CAA2B,aAA3B,CAAyC,mBAAzC,CAA1B;AAEA,GA7CO;;AA+CA,+CAAR;AAEC,QAAI,KAAK,eAAL,GAAuB,CAA3B,EAA8B;AAC7B;AACA;;AAED,SAAK,oBAAL,CAA0B,KAAK,eAAL,GAAuB,CAAjD;AAEA,GARO;;AAUA,uCAAR;AACC;AACA,SAAK,MAAL,GAAc,KAAK,aAAL,CAAmB,QAAnB,EAAd;AAEA,QAAI,KAAJ;;AAEA,QAAK,KAAK,MAAL,CAAY,QAAjB,EAA2B;AACxB,UAAI,GAAG,GAAG,KAAK,MAAL,CAAY,QAAZ,CAAqB,QAArB,CAA8B,GAA9B,EAAV;;AACC,UAAI,GAAG,GAAG,KAAK,MAAL,CAAY,QAAZ,CAAqB,QAArB,CAA8B,GAA9B,EAAV;;AACA,WAAK,GAAG,IAAI,MAAM,CAAC,IAAP,CAAY,MAAhB,CAAuB,GAAvB,EAA4B,GAA5B,CAAR;AACH,KAJD,MAIO;AACN,WAAK,GAAG,KAAK,MAAL,CAAY,IAApB;AACA;;AAED,SAAK,yBAAL,CAA+B,KAA/B;AACA,GAfO;;AAiBA,sDAAR,aACC;AACA,GAFO;;AAIA,oDAAR,aACC;AACA,GAFO;;AAIA,uCAAR,UAAuB,IAAvB,EAAmD;AAElD,SAAK,WAAL,GAAmB,IAAnB;;AACA,SAAK,oBAAL,CAA0B,KAAK,eAAL,GAAuB,CAAjD;AAEA,GALO;;AAOA,kDAAR,UAAkC,gBAAlC,EAA+E;AAA/E;;AAEC,QAAI,WAAW,GAAuB,IAAI,MAAM,CAAC,IAAP,CAAY,MAAhB,CAAuB,KAAK,MAAL,CAAY,GAAnC,EAAwC,KAAK,MAAL,CAAY,IAApD,CAAtC;;AAEA,SAAK,kBAAL,CAAwB,KAAxB,CAA8B;AACrB,YAAM,EAAE,WADa;AAErB,iBAAW,EAAE,gBAFQ;AAGrB,gBAAU,EAAE,KAAK;AAHI,KAA9B,EAIU,UAAC,QAAD,EAAW,MAAX,EAA+C;AAChD,UAAI,MAAM,KAAK,MAAM,CAAC,IAAP,CAAY,gBAAZ,CAA6B,EAA5C,EAAgD;AAC9C,aAAI,CAAC,kBAAL,CAAwB,aAAxB,CAAsC,QAAtC;;AACA,aAAI,CAAC,oBAAL,CAA0B,CAA1B;AAED,OAJD,MAIO;AACL,cAAM,CAAC,KAAP,CAAa,6CAAb,EADK,CAEL;AACD;AACN,KAbJ;AAeA,GAnBO;;AAqBA,6CAAR,UAA6B,IAA7B,EAAyC;AAExC,SAAK,eAAL,GAAuB,IAAvB;;AAEA,QAAI,KAAK,eAAL,KAAyB,CAA7B,EAAgC;AAE/B;AACA,WAAK,wBAAL,CAA8B,KAA9B,CAAoC,OAApC,GAA8C,MAA9C;AACA,UAAI,CAAC,QAAL,CAAc,EAAd,CAAiB,KAAK,qBAAtB,EAA6C,GAA7C,EAAkD;AAAC,cAAM,EAAE;AAAT,OAAlD;AACA,WAAK,GAAL,CAAS,OAAT,CAAiB,KAAK,iBAAtB,EAAyC,qBAAzC;AAEA,KAPD,MAOO,IAAI,KAAK,eAAL,KAAyB,CAA7B,EAAgC;AAEtC;AACA,WAAK,iBAAL,CAAuB,KAAvB,CAA6B,OAA7B,GAAuC,cAAvC;AACA,WAAK,GAAL,CAAS,OAAT,CAAiB,KAAK,iBAAtB,EAAyC,oBAAzC,EAJsC,CAMtC;;AACA,UAAI,CAAC,QAAL,CAAc,EAAd,CAAiB,KAAK,qBAAtB,EAA6C,GAA7C,EAAmD;AAAC,cAAM,EAAE;AAAT,OAAnD;AACA,UAAI,CAAC,QAAL,CAAc,GAAd,CAAkB,KAAK,iBAAvB,EAA0C;AAAC,iBAAS,EAAE;AAAZ,OAA1C;AACA,WAAK,GAAL,CAAS,QAAT,CAAkB,KAAK,iBAAvB,EAA0C,SAA1C;AACA,UAAI,CAAC,QAAL,CAAc,aAAd,CAA+B,KAAK,MAAL,CAAY,kBAAZ,GAA8B,yBAA7D,EAAwF,GAAxF,EAA6F;AAAC,aAAK,EAAE;AAAR,OAA7F,EAAyG;AAAC,aAAK,EAAE,CAAR;AAAW,aAAK,EAAE;AAAlB,OAAzG,EAAkI,IAAlI;AAEA,KAZM,MAYA,IAAI,KAAK,eAAL,KAAyB,CAA7B,EAAgC;AACtC;AACA,WAAK,iBAAL,CAAuB,KAAvB,CAA6B,OAA7B,GAAuC,MAAvC;AACA,WAAK,wBAAL,CAA8B,KAA9B,CAAoC,OAApC,GAA8C,cAA9C;AACA,WAAK,wBAAL,CAA8B,KAA9B,GAAsC,EAAtC;AACA,UAAI,CAAC,QAAL,CAAc,MAAd,CAAqB,KAAK,wBAA1B,EAAoD,GAApD,EAAyD;AAAC,iBAAS,EAAE,CAAZ;AAAe,SAAC,EAAE;AAAlB,OAAzD,EAAiF;AAAC,iBAAS,EAAE,CAAZ;AAAe,SAAC,EAAE;AAAlB,OAAjF;AACA,WAAK,GAAL,CAAS,OAAT,CAAiB,KAAK,iBAAtB,EAAyC,wBAAzC;AACA;;AAED,QAAI,CAAC,QAAL,CAAc,MAAd,CAAqB,KAAK,iBAA1B,EAA6C,GAA7C,EAAkD;AAAC,eAAS,EAAE;AAAZ,KAAlD,EAAmE;AAAC,eAAS,EAAE;AAAZ,KAAnE;AAEA,GAlCO;;AAoCA,oCAAR;AAEC,QAAI,cAAc,GAAI,KAAK,MAAL,CAAY,eAAb,GAAgC,QAAQ,CAAC,aAAT,CAAuB,KAAK,MAAL,CAAY,eAAnC,CAAhC,GAAsF,KAAK,GAAL,CAAS,MAAT,CAAgB,KAAK,UAArB,CAA3G;AACA,QAAI,UAAU,GAAW,eAAa,KAAK,MAAL,CAAY,YAAzB,GAAqC,sCAA9D;;AAEA,QAAI,KAAK,MAAL,CAAY,eAAhB,EAAiC;AAChC,WAAK,GAAL,CAAS,OAAT,CAAiB,cAAjB,EAAiC,UAAjC;AACA,KAFD,MAEO;AACN,WAAK,UAAL,CAAgB,MAAhB;AACA,WAAK,GAAL,CAAS,MAAT,CAAgB,cAAhB,EAAgC,UAAhC;AACA;AAED,GAZO;;AAcT;AAAC,CApRD,CAA+B,eAA/B;;AAAa,8B;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACTb;;AAGA;AAAA;AAAA;AAAmC;;AAAnC;AAAA;;AAEQ,mBAAS;AACf,WAAK,EAAE,QADQ;AAEf,UAAI,EAAE,IAFS;AAGf,cAAQ,EAAE;AAHK,KAAT;;AAoBP;;AAdO,mCAAP;AAAA;;AAEC,QAAI,KAAK,MAAL,CAAY,IAAhB,EAAsB;AACrB,UAAI,OAAK,GAAqB,KAAK,UAAL,CAAgB,aAAhB,CAA8B,KAA9B,CAA9B;AACA,UAAI,CAAC,QAAL,CAAc,GAAd,CAAkB,OAAlB,EAAyB;AAAC,iBAAS,EAAE;AAAZ,OAAzB;AACA,aAAK,CAAC,gBAAN,CAAuB,MAAvB,EAA+B,UAAC,CAAD,EAAE;AAChC,eAAK,CAAC,MAAN,GAAe,IAAf;AACA,YAAI,CAAC,QAAL,CAAc,EAAd,CAAiB,OAAjB,EAAwB,KAAI,CAAC,MAAL,CAAY,QAApC,EAA8C;AAAC,mBAAS,EAAE,CAAZ;AAAe,cAAI,EAAE,IAAI,CAAC,MAAL,CAAY;AAAjC,SAA9C;;AACA,aAAI,CAAC,OAAL;AACA,OAJD;AAKA;AAED,GAZM;;AAcR;AAAC,CAtBD,CAAmC,eAAnC;;AAAa,sC;;;;;;;;;;;;;;;;;;ACHb;;AAEA;;AACA;;AAYA;AAAA;AAAA;AAKC,sBAAoB,SAApB,EAAmD,GAAnD,EAAiE;AAA7C;AAA+B;AAF3C,wBAAuB,CAAvB;AAGP,oBAAO,EAAP,CAAU,OAAV,EAAmB,4BAAnB,EAAiD,KAAK,YAAL,CAAkB,IAAlB,CAAuB,IAAvB,CAAjD;AACA;;AAEM,gCAAP,UAAc,SAAd,EAA0C;AACzC,SAAK,gBAAL,CAAsB,SAAtB;AACA,GAFM;;AAIA,iCAAP;AACC,SAAK,MAAL,GAAc,IAAd;AACA,GAFM;;AAIA,8BAAP;AACC,QAAI,CAAC,QAAL,CAAc,MAAd,CAAqB,KAAK,SAA1B,EAAqC,GAArC,EAA0C;AAAC,eAAS,EAAE;AAAZ,KAA1C,EAA0D;AAAC,eAAS,EAAE,CAAZ;AAAe,UAAI,EAAE,IAAI,CAAC,MAAL,CAAY,QAAjC;AAA2C,WAAK,EAAE;AAAlD,KAA1D;AACA,GAFM;;AAIA,8BAAP;AACC,QAAI,CAAC,QAAL,CAAc,EAAd,CAAiB,KAAK,SAAtB,EAAiC,GAAjC,EAAsC;AAAC,eAAS,EAAE,CAAZ;AAAe,UAAI,EAAE,IAAI,CAAC,MAAL,CAAY,QAAjC;AAA2C,WAAK,EAAE;AAAlD,KAAtC;AACA,GAFM;;AAIA,qCAAP,UAAmB,KAAnB,EAAkC,KAAlC,EAA0D;AAEzD,QAAI,KAAK,KAAK,0BAAkB,IAAhC,EAAsC;AACrC,WAAK,GAAL,CAAS,QAAT,CAAkB,KAAK,SAAvB,EAAkC,OAAlC;AACA,KAFD,MAEO;AACN,WAAK,GAAL,CAAS,WAAT,CAAqB,KAAK,SAA1B,EAAqC,OAArC;AACA;;AAED,SAAK,YAAL,CAAkB,KAAlB;AAEA,GAVM,CAzBR,CAqCC;AACA;;;AACQ,sCAAR,UAAqB,CAArB,EAAkC;AACjC,KAAC,CAAC,cAAF;;AACA,SAAK,YAAL,CAAmB,QAAQ,CAAE,CAAC,CAAC,MAAF,CAAyB,YAAzB,CAAsC,YAAtC,CAAF,EAAuD,EAAvD,CAA3B;;AACA,oBAAO,QAAP,CAAgB,IAAI,2CAAJ,CAAyB;AACxC,WAAK,EAAE,KAAK,YAD4B;AAExC,oBAAc,EAAE,KAAK,MAAL,CAAY,KAAK,YAAjB,EAA+B;AAFP,KAAzB,CAAhB;AAIA,WAAO,KAAP;AACA,GARO;;AAUA,sCAAR,UAAqB,KAArB,EAAkC;AACjC,SAAK,YAAL,GAAoB,KAApB;;AACA,SAAK,iBAAL;AACA,GAHO;;AAKA,0CAAR,UAAyB,SAAzB,EAAqD;AAArD;;AACC,QAAI,IAAI,GAAG,EAAX;AACA,aAAS,CAAC,OAAV,CAAkB,UAAC,MAAD,EAAqB,KAArB,EAAkC;AACnD,UAAI,IAAI,KAAI,CAAC,eAAL,CAAqB,MAArB,EAA6B,KAA7B,CAAR;AACA,KAFD;AAGA,SAAK,GAAL,CAAS,OAAT,CAAiB,KAAK,SAAtB,EAAiC,IAAjC,EAAuC;AAAM,kBAAI,CAAC,YAAL;AAA4B,KAAzE;AACA,GANO;;AAQA,yCAAR,UAAwB,MAAxB,EAA4C,KAA5C,EAAyD;AACxD,WAAO,+CAA6C,KAA7C,GAAkD,gBAAlD,GAAmE,KAAnE,GAAwE,mBAAxE,GACL,MAAM,CAAC,KADF,GACO,YADd;AAGA,GAJO;;AAMA,sCAAR,UAAqB,SAArB,EAAiD;AAAjD;;AACC,SAAK,MAAL,GAAc,EAAd;AACA,aAAS,CAAC,OAAV,CAAkB,UAAC,MAAD,EAAqB,KAArB,EAAkC;AACnD,WAAI,CAAC,MAAL,CAAY,IAAZ,CAAiB;AAChB,cAAM,EAAE,KAAI,CAAC,SAAL,CAAe,aAAf,CAA6B,sCAAoC,KAAjE,CADQ;AAEhB,sBAAc,EAAE,MAAM,CAAC;AAFP,OAAjB;AAIA,KALD;AAMA,GARO;;AAUA,2CAAR;AAAA;;AACC,SAAK,MAAL,CAAY,OAAZ,CAAoB,UAAC,IAAD,EAAa,KAAb,EAA0B;AAC7C,UAAI,KAAK,KAAK,KAAI,CAAC,YAAnB,EAAiC;AAChC,aAAI,CAAC,GAAL,CAAS,QAAT,CAAkB,IAAI,CAAC,MAAvB,EAA+B,WAA/B;AACA,OAFD,MAEO;AACN,aAAI,CAAC,GAAL,CAAS,WAAT,CAAqB,IAAI,CAAC,MAA1B,EAAkC,WAAlC;AACA;AACD,KAND;AAOA,GARO;;AAUT;AAAC,CAxFD;;AAAa,gC;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACfb;;AACA;AAAA;AAAA;AAAiC;;AAAjC;AAAA;;AAEQ,mBAAS;AACf,gBAAU,EAAE,IADG;AAEf,eAAS,EAAE;AAFI,KAAT;;AAgBP;;AAXO,iCAAP;AAEC,QAAI,GAAG,GAAI,KAAK,MAAL,CAAY,gBAAb,GAAiC,KAAK,MAAL,CAAY,SAA7C,GAAyD,KAAK,MAAL,CAAY,UAA/E;AACA,SAAK,UAAL,CAAgB,aAAhB,CAA8B,QAA9B,EAAwC,YAAxC,CAAqD,KAArD,EAA4D,GAA5D;AACC,SAAK,UAAL,CAAqC,IAArC,GAJF,CAMC;;AACA,SAAK,OAAL;AAEA,GATM;;AAWR;AAAC,CAlBD,CAAiC,eAAjC;;AAAa,kC;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACDb;;AACA;;AACA;;AAEA;AAAA;AAAA;AAA8B;;AAA9B;AAAA;;AAEQ,mBAAS;AACf,WAAK,EAAE,IADQ;AAEf,iBAAW,EAAE,CAFE;AAGf,eAAS,EAAE,CAHI;AAIf,YAAM,EAAE,EAJO;AAKf,cAAQ,EAAE,mBALK;AAMf,oBAAc,EAAG;AANF,KAAT;;AAuDP;;AA1CO,8BAAP;AAAA;;AACC,SAAK,kBAAL,GAA0B,KAAK,UAAL,CAAgB,aAAhB,CAA8B,KAAK,MAAL,CAAY,QAA1C,CAA1B;AACA,SAAK,QAAL,GAAgB,QAAQ,CAAC,aAAT,CAAuB,KAAK,MAAL,CAAY,cAAnC,CAAhB;AACA,SAAK,QAAL,GAAgB,gBAAO,EAAP,CAAU,OAAV,EAAmB,KAAK,QAAxB,EAAkC;AAAM,kBAAI,CAAJ;AAAgB,KAAxD,CAAhB;AACA,GAJM;;AAMA,+BAAP;AACC,oBAAO,OAAP,CAAgB,KAAK,QAArB;AACA,SAAK,kBAAL,GAA2B,IAA3B;AACA,SAAK,QAAL,GAAiB,IAAjB;;AACA,qBAAM,OAAN,CAAa,IAAb,CAAa,IAAb;AACA,GALM;;AAOC,iCAAR;AAEC,QAAI,IAAI,GAAW,EAAnB;AACA,QAAI,UAAU,GAAW,KAAK,MAAL,CAAY,WAAZ,GAA0B,CAAnD;AACA,SAAK,MAAL,CAAY,WAAZ,GAA2B,UAAU,GAAI,KAAK,MAAL,CAAY,SAA1B,GAAuC,KAAK,MAAL,CAAY,KAApD,GAA8D,UAAU,GAAI,KAAK,MAAL,CAAY,SAAxF,GAAoG,KAAK,MAAL,CAAY,KAA1I;;AAEA,SAAK,IAAI,CAAC,GAAG,UAAb,EAAyB,CAAC,IAAI,KAAK,MAAL,CAAY,WAA1C,EAAuD,CAAC,EAAxD,EAA4D;AAC3D,UAAI,MAAM,GAAG,sBAAU,MAAV,CAAiB,QAAjB,CAA0B,KAAK,MAAL,CAAY,MAAtC,EAA8C;AAAC,SAAC,EAAE;AAAJ,OAA9C,CAAb;AACA,UAAI,IAAI,KAAK,IAAL,CAAU,MAAV,CAAR;AACA;;AAED,0BAAU,GAAV,CAAc,MAAd,CAAqB,KAAK,kBAA1B,EAA8C,IAA9C;;AAEA,QAAI,KAAK,MAAL,CAAY,WAAZ,IAA2B,KAAK,MAAL,CAAY,KAA3C,EAAkD;AACjD,UAAI,CAAC,QAAL,CAAc,EAAd,CAAiB,KAAK,QAAtB,EAAgC,GAAhC,EAAqC;AAAC,iBAAS,EAAE;AAAZ,OAArC;AACA;AAED,GAjBO;;AAmBA,4BAAR,UAAa,GAAb,EAAwB;AACvB,WAAO,uJAGQ,GAHR,GAGW,+CAHlB;AAOA,GARO;;AAUT;AAAC,CAzDD,CAA8B,eAA9B;;AAAa,4B;;;;;;;;;;;;;;;;;;ACiCb;AAAA;AAAA;AAsBC,6BAAqB,MAArB,EAAuD,WAAvD,EAA4F,OAA5F,EAAwH;AAAnG;AAAkC;AAAqC;AARpF,2BAA0B,CAA1B;AACA,yBAAwB,CAAxB;AAEA,mBAAkB,EAAlB;AACA,qBAAiB,EAAjB;AAEA,sBAAqB,GAArB,CAEgH,CAFpF;;AAGnC,SAAK,OAAL,CAAa,UAAb,GAA0B,GAA1B;AACA,SAAK,OAAL,CAAa,QAAb,GAAwB,GAAxB;AACA,SAAK,OAAL,CAAa,UAAb,GAA0B,IAA1B;AACA,SAAK,OAAL,CAAa,QAAb,GAAwB,IAAxB;AACA,SAAK,OAAL,CAAa,eAAb,GAA+B,MAAM,KAAK,OAAL,CAAa,UAAlD;AACA,SAAK,OAAL,CAAa,aAAb,GAA6B,MAAM,KAAK,OAAL,CAAa,QAAhD;AACA,SAAK,OAAL,CAAa,eAAb,GAA+B,MAAM,KAAK,OAAL,CAAa,UAAlD;AACA,SAAK,OAAL,CAAa,aAAb,GAA6B,MAAM,KAAK,OAAL,CAAa,QAAhD;AACA,GA/BF,CAiCC;;;AACO,wCAAP,UAAe,IAAf,EAA2B;AAC1B,SAAK,KAAL,GAAa,IAAb;AACA,GAFM,CAlCR,CAsCC;;;AACO,4CAAP,UAAmB,QAAnB,EAAsD;AACrD,SAAK,SAAL,GAAiB,QAAjB;AACA,GAFM,CAvCR,CA2CC;;;AACQ,uCAAR;AACC,SAAK,kBAAL;;AACA,SAAK,iBAAL;AACA,GAHO,CA5CT,CAiDC;AACA;;;AACO,uCAAP,UAAc,QAAd,EAAgC,QAAhC,EAAwD,cAAxD,EAAuF;AAAvD;AAAA;AAAsB;;AAAE;AAAA;AAA+B;;AAEtF,QAAI,QAAQ,GAAI,MAAO,KAAK,UAAL,GAAkB,CAAzC,EAAgD;AAC/C,WAAK,kBAAL,GAA0B,QAAQ,IAAI,MAAO,KAAK,UAAL,GAAkB,CAA7B,CAAlC;AACA,WAAK,MAAL,GAAc,KAAK,OAAL,CAAa,UAAb,GAA2B,KAAK,OAAL,CAAa,eAAb,GAAgC,KAAK,kBAA9E;AACA,WAAK,MAAL,GAAc,KAAK,OAAL,CAAa,UAAb,GAA2B,KAAK,OAAL,CAAa,eAAb,GAA+B,KAAK,kBAA7E;AACA,KAJD,MAIO,IAAI,QAAQ,GAAI,MAAO,KAAK,UAAL,GAAkB,CAAzC,EAAgD;AACtD,cAAQ,IAAK,MAAO,KAAK,UAAL,GAAkB,CAAtC;AACA,WAAK,kBAAL,GAA0B,QAAQ,IAAI,MAAO,KAAK,UAAL,GAAkB,CAA7B,CAAlC;AACA,WAAK,MAAL,GAAc,MAAQ,KAAK,kBAAL,GAA0B,KAAK,OAAL,CAAa,aAA7D;AACA,WAAK,MAAL,GAAc,MAAQ,KAAK,kBAAL,GAA0B,KAAK,OAAL,CAAa,aAA7D;AACA,KALM,MAKA;AACN,WAAK,MAAL,GAAc,GAAd;AACA,WAAK,MAAL,GAAc,GAAd;AACA;;AAED,QAAI,cAAJ,EAAoB;AACnB;AACA;;AAED,QAAI,KAAK,eAAL,GAAuB,CAA3B,EAA8B;AAC7B,WAAK,eAAL,IAAwB,KAAxB;AACA;;AAED,SAAK,MAAL,IAAe,KAAK,eAApB,CAxBsF,CA0BtF;AACA;AACA;AACA;AAEA;;AACA,SAAK,UAAL,CAAgB,KAAhB,GAAwB,MAAM,KAAK,MAAnC;;AACA,SAAK,gBAAL,CAAsB,KAAtB,CAA4B,GAA5B,CAAgC,KAAK,MAAL,GAAc,KAAK,aAAnD,EAAkE,KAAK,MAAL,GAAc,KAAK,aAArF;;AACA,SAAK,MAAL,CAAY,KAAZ,CAAkB,GAAlB,CAAsB,KAAK,MAAL,GAAc,KAAK,aAAzC,EAAwD,KAAK,MAAL,GAAc,KAAK,aAA3E;;AACA,SAAK,UAAL,CAAgB,KAAhB,CAAsB,GAAtB,CAA0B,KAAK,MAAL,GAAc,KAAK,aAA7C,EAA4D,KAAK,MAAL,GAAc,KAAK,aAA/E;;AAEA,SAAK,MAAL,CAAY,KAAZ,GAAoB,CAApB;AAEA,SAAK,gBAAL,CAAsB,QAAtB,GAAiC,KAAK,MAAL,CAAY,QAAZ,GAAwB,KAAK,UAAL,CAAgB,QAAhB,GAA4B,QAArF;AAEA,GAzCM,CAnDR,CA8FC;;;AACO,8CAAP,UAAqB,OAArB,EAA+C,MAA/C,EAAmE,KAAnE,EAAsF;AAAjE;AAAA;AAAwB;;AAAsB;AAAA;AAAmB;;AAErF,SAAK,gBAAL,CAAsB,aAAtB,GAAsC,KAAtC;AAEA,QAAI,SAAS,GAAY,OAAD,GAAY,GAAZ,GAAkB,GAA1C;AAEA,SAAK,OAAL,CAAa,KAAb,GAAqB,IAAI,CAAC,QAAL,CAAc,EAAd,CAAiB,KAAK,OAAtB,EAA+B,SAA/B,EACrB;AAAC,UAAI,EAAE;AAAC,cAAM,EAAE,MAAM,CAAC,UAAhB;AAA6B,cAAM,EAAE,MAAM,CAAC;AAA5C,OAAP;AAAgE,UAAI,EAAE,IAAI,CAAC,MAAL,CAAY,SAAlF;AAA6F,WAAK,EAAE;AAApG,KADqB,CAArB;AAIA,SAAK,OAAL,CAAa,IAAb,GAAoB,IAAI,CAAC,QAAL,CAAc,EAAd,CAAiB,CAAC,KAAK,MAAN,EAAc,KAAK,MAAnB,EAA2B,KAAK,OAAhC,EAAyC,KAAK,UAA9C,CAAjB,EAA4E,SAA5E,EAAuF;AAC1G,UAAI,EAAE;AAAC,cAAM,EAAE,MAAM,CAAC,UAAhB;AAA6B,cAAM,EAAE,MAAM,CAAC;AAA5C,OADoG;AAC1C,UAAI,EAAE,IAAI,CAAC,MAAL,CAAY,SADwB;AACb,WAAK,EAAE;AADM,KAAvF,CAApB;AAIA,SAAK,OAAL,CAAa,OAAb,GAAwB,IAAI,CAAC,QAAL,CAAc,EAAd,CAAiB,CAAC,KAAK,gBAAN,EAAwB,KAAK,MAA7B,EAAsC,KAAK,UAA3C,CAAjB,EAAyE,SAAzE,EACxB;AAAC,OAAC,EAAE,MAAM,CAAC,MAAX;AAAmB,OAAC,EAAE,MAAM,CAAC,MAA7B;AAAqC,UAAI,EAAE,IAAI,CAAC,MAAL,CAAY,SAAvD;AAAkE,WAAK,EAAE,KAAzE;AACA,UAAI,EAAE;AAAC,cAAM,EAAE,CAAT;AAAa,cAAM,EAAE;AAArB;AADN,KADwB,CAAxB;AAKA,SAAK,OAAL,CAAa,QAAb,GAAyB,IAAI,CAAC,QAAL,CAAc,EAAd,CAAiB,KAAK,UAAtB,EAAkC,SAAlC,EAA6C;AAAC,WAAK,EAAE;AAAR,KAA7C,CAAzB;AAEA,GArBM,CA/FR,CAsHC;;;AACO,gDAAP;AAEC;;;;;AAFD,sBAQC;AACA;;AAEC;;;;;;;;;;;;;;;;AAmBD,SAAK,OAAL,CAAa,KAAb,CAAmB,OAAnB;;AACA,SAAK,OAAL,CAAa,IAAb,CAAkB,OAAlB;;AACA,SAAK,OAAL,CAAa,OAAb,CAAqB,OAArB;;AACA,SAAK,OAAL,CAAa,QAAb,CAAsB,OAAtB;;AACA,SAAK,SAAL,CAAe,IAAf,GAAsB,UAAU,CAAE;AAAM,kBAAI,CAAC,gBAAL,CAAsB,aAAtB;AAA0C,KAAlD,EAAoD,IAApD,CAAhC;AAEA,GApCM,CAvHR,CA6JC;;;AACO,8CAAP;AACC,WAAO;AACN,WAAK,EAAE,KAAK,OAAL,CAAa,OAAb,CAAqB,KADtB;AAEN,YAAM,EAAE,KAAK,OAAL,CAAa,OAAb,CAAqB;AAFvB,KAAP;AAIA,GALM,CA9JR,CAqKC;;;AACO,6CAAP;AACC,WAAO;AACN,WAAK,EAAE,KAAK,MAAL,CAAY,OAAZ,CAAoB,KADrB;AAEN,YAAM,EAAE,KAAK,MAAL,CAAY,OAAZ,CAAoB;AAFtB,KAAP;AAIA,GALM,CAtKR,CA6KC;;;AACO,gDAAP;AACC,WAAO,KAAK,aAAZ;AACA,GAFM;;AAIA,+CAAP;AACC,WAAO,KAAK,MAAL,GAAc,KAAK,aAA1B;AACA,GAFM;;AAIA,kDAAP,UAAyB,KAAzB,EAAsC;AACrC,SAAK,eAAL,GAAuB,KAAK,GAAG,IAA/B;AACA,GAFM,CAtLR,CA0LC;;;AACO,uCAAP,UAAc,gBAAd,EAAsC,WAAtC,EAAkE;AAA5B;AAAA;AAA4B;;AAEjE,SAAK,iBAAL,GAAyB,gBAAzB;;AACA,SAAK,gBAAL;;AAEA,QAAK,WAAL,EAAmB;AAClB;AACA;;AAED,SAAK,eAAL;;AACA,SAAK,kBAAL;AAEA,GAZM,CA3LR,CAyMC;;;AACO,sDAAP;AACC,WAAO,KAAK,iBAAZ;AACA,GAFM,CA1MR,CA8MC;AACA;AACA;AACA;AACA;AAEA;;;AACQ,mDAAR;AAEC;AACA,SAAK,gBAAL,GAAwB,IAAI,IAAI,CAAC,SAAT,EAAxB;AAEA,SAAK,MAAL,GAAc,IAAI,IAAI,CAAC,MAAT,CAAiB,KAAK,SAAL,CAAe,IAAhC,CAAd;AACA,SAAK,OAAL,GAAe,IAAI,IAAI,CAAC,MAAT,CAAgB,KAAK,SAAL,CAAe,KAA/B,CAAf;AAEA,SAAK,OAAL,CAAa,OAAb,GAAuB,KAAvB;AAEA,SAAK,UAAL,GAAkB,IAAI,IAAI,CAAC,MAAT,CAAiB,KAAK,SAAL,CAAe,KAAhC,CAAlB;AACA,SAAK,MAAL,GAAc,IAAI,IAAI,CAAC,MAAT,CAAiB,KAAK,SAAL,CAAe,IAAhC,CAAd;AACA,SAAK,MAAL,CAAY,IAAZ,GAAmB,KAAK,KAAxB;AAEA,SAAK,OAAL,GAAe,IAAI,IAAI,CAAC,MAAT,CAAgB,KAAK,SAAL,CAAe,KAA/B,CAAf;;AACA,SAAK,OAAL,CAAa,MAAb,CAAoB,GAApB,CAAwB,GAAxB,EAA6B,GAA7B;;AACA,SAAK,OAAL,CAAa,IAAb,GAAoB,KAAK,MAAzB;AAEA,SAAK,OAAL,CAAa,WAAb,GAA2B,IAA3B;AACA,SAAK,OAAL,CAAa,OAAb,GAAuB,IAAI,IAAI,CAAC,SAAT,CAAoB,CAApB,EAAuB,CAAvB,EAA0B,MAA1B,EAAkC,MAAlC,CAAvB;;AAEA,SAAK,OAAL,CACE,EADF,CACK,WADL,EACkB;AAAM,oBAAO,CAAC,GAAR;AAAiC,KADzD,EAEE,EAFF,CAEK,YAFL,EAEmB;AAAM,oBAAO,CAAC,GAAR;AAA4B,KAFrD;;AAIA,SAAK,MAAL,CACE,EADF,CACK,WADL,EACkB;AAAM,oBAAO,CAAC,GAAR;AAAiC,KADzD,EAEE,EAFF,CAEK,YAFL,EAEmB;AAAM,oBAAO,CAAC,GAAR;AAA4B,KAFrD;;AAIA,SAAK,WAAL,CAAiB,QAAjB,CAA0B,KAAK,MAA/B,EAAuC,KAAK,gBAA5C,EAA8D,KAAK,UAAnE;;AACA,SAAK,gBAAL,CAAsB,QAAtB,CAA+B,KAAK,OAApC,EAA6C,KAAK,MAAlD,EAA0D,KAAK,OAA/D,EA9BD,CAgCC;;;AACA,SAAK,gBAAL;;AACA,SAAK,eAAL,GAlCD,CAoCC;;;AACA,SAAK,gBAAL,CAAsB,aAAtB,GAAsC,IAAtC;AAEA,GAvCO;;AAyCA,kDAAR,aACC;AACA;AACA,GAHO,CA9PT,CAmQC;;;AACQ,mDAAR;AAEC,QAAI,CAAC,KAAK,gBAAV,EAA4B;AAC3B;AACA;;AAED,QAAI,MAAM,GAAG,KAAK,gBAAL,CAAsB,SAAtB,EAAb;;AACA,SAAK,gBAAL,CAAsB,KAAtB,CAA4B,CAA5B,GAAgC,MAAM,CAAC,KAAP,GAAe,CAA/C;AACA,SAAK,gBAAL,CAAsB,KAAtB,CAA4B,CAA5B,GAAgC,MAAM,CAAC,MAAP,GAAgB,CAAhD;AAEA,GAVO,CApQT,CAgRC;;;AACQ,iDAAR;AAEC,QAAI,QAAQ,GAAS,KAAK,YAAL,EAArB;;AAEA,QAAI,CAAC,QAAQ,CAAC,KAAV,IAAmB,CAAC,KAAK,iBAA7B,EAAgD;AAC/C;AACA;;AAED,SAAK,aAAL,GAAqB,GAArB;;AAEA,QAAI,QAAQ,CAAC,KAAT,GAAiB,KAAK,iBAAL,CAAuB,KAAxC,IAAiD,QAAQ,CAAC,MAAT,GAAkB,KAAK,iBAAL,CAAuB,MAA9F,EAAsG;AACrG,UAAI,EAAE,GAAW,KAAK,iBAAL,CAAuB,KAAvB,GAA+B,QAAQ,CAAC,KAAzD;AACA,UAAI,EAAE,GAAY,KAAK,iBAAL,CAAuB,MAAvB,GAAgC,QAAQ,CAAC,MAA3D;AACA,WAAK,aAAL,GAAsB,EAAE,GAAG,EAAN,GAAY,EAAZ,GAAiB,EAAtC;AACA;AAED,GAhBO,CAjRT,CAmSC;;;AACQ,gDAAR;AAEC,QAAI,CAAC,KAAK,iBAAV,EAA6B;AAC5B;AACA;;AAED,SAAK,gBAAL,CAAsB,CAAtB,GAA0B,KAAK,MAAL,CAAY,CAAZ,GAAgB,KAAK,UAAL,CAAgB,CAAhB,GAAoB,KAAK,iBAAL,CAAuB,KAAvB,GAA+B,CAA7F;AACA,SAAK,gBAAL,CAAsB,CAAtB,GAA2B,KAAK,MAAL,CAAY,CAAZ,GAAgB,KAAK,UAAL,CAAgB,CAAhB,GAAqB,KAAK,iBAAL,CAAuB,MAAvB,GAAgC,CAAhG;AAGG,SAAK,MAAL,CAAY,CAAZ,GAAiB,KAAK,MAAL,CAAY,KAAZ,CAAkB,CAAlB,GAAsB,KAAK,MAAL,CAAY,KAAnC,GAA4C,CAA5D;AACH,SAAK,MAAL,CAAY,CAAZ,GAAiB,KAAK,MAAL,CAAY,KAAZ,CAAkB,CAAlB,GAAsB,KAAK,MAAL,CAAY,MAAnC,GAA6C,CAA7D;AAEA,SAAK,OAAL,CAAa,CAAb,GAAkB,KAAK,OAAL,CAAa,CAAb,GAAkB,KAAK,MAAL,CAAY,CAAhD;AACA,SAAK,OAAL,CAAa,CAAb,GAAiB,KAAK,OAAL,CAAa,CAAb,GAAiB,KAAK,MAAL,CAAY,CAA9C;;AAEA,SAAK,OAAL,CAAa,KAAb,CAAmB,GAAnB,CAAuB,IAAvB,EAA6B,IAA7B;AAEA,GAlBO;;AAoBA,+CAAR;AACC;AACA,SAAK,OAAL,CAAa,KAAb,CAAmB,OAAnB;;AACA,SAAK,OAAL,CAAa,IAAb,CAAkB,OAAlB;AACA,GAJO;;AAMT;AAAC,CA9TD;;AAAa,8C;;;;;;;;;;;;;;;;;;ACDb;AAAA;AAAA;AAcC,gCAAqB,MAArB,EAAuD,WAAvD,EAAoF,MAApF,EAAkH;AAA7F;AAAkC;AAN/C,0BAAyB,CAAzB;AACA,8BAA6B,EAA7B;AACA,yBAAwB,CAAxB;AAMP,SAAK,OAAL,GAAe;AAAC,aAAO,EAAE,MAAM,CAAC;AAAjB,KAAf;AAEA,QAAI,CAAC,GAAG,GAAR;AACA,SAAK,OAAL,CAAa,KAAb,GAAqB;AACpB,WAAK,EAAG,CADY;AAEpB,WAAK,EAAG,CAAC,MAAM,CAAC,SAAT,GAAsB,CAAtB,GAA0B,CAFb;AAGpB,SAAG,EAAG,CAAC,MAAM,CAAC,SAAT,GAAsB,CAAtB,GAA0B;AAHX,KAArB;AAMA,SAAK,OAAL,CAAa,KAAb,CAAmB,UAAnB,GAAgC,KAAK,OAAL,CAAa,KAAb,CAAmB,KAAnB,GAA2B,KAAK,OAAL,CAAa,KAAb,CAAmB,KAA9E;AACA,SAAK,OAAL,CAAa,KAAb,CAAmB,QAAnB,GAA8B,KAAK,OAAL,CAAa,KAAb,CAAmB,KAAnB,GAA2B,KAAK,OAAL,CAAa,KAAb,CAAmB,GAA5E;AAEA,KAAC,GAAG,CAAJ;AACA,SAAK,OAAL,CAAa,KAAb,GAAqB;AACpB,WAAK,EAAE,CADa;AAEpB,WAAK,EAAG,CAAC,MAAM,CAAC,SAAT,GAAsB,CAAtB,GAA2B,CAFd;AAGpB,SAAG,EAAG,CAAC,MAAM,CAAC,SAAT,GAAsB,CAAtB,GAA0B;AAHX,KAArB;AAMA,SAAK,OAAL,CAAa,KAAb,CAAmB,UAAnB,GAAgC,KAAK,OAAL,CAAa,KAAb,CAAmB,KAAnB,GAA2B,KAAK,OAAL,CAAa,KAAb,CAAmB,KAA9E;AACA,SAAK,OAAL,CAAa,KAAb,CAAmB,QAAnB,GAA8B,KAAK,OAAL,CAAa,KAAb,CAAmB,KAAnB,GAA2B,KAAK,OAAL,CAAa,KAAb,CAAmB,GAA5E;AACA,QAAI,CAAC,GAAG,KAAM,IAAI,CAAC,MAAL,KAAiB,IAA/B,CAvBiH,CAyBjH;AACA;;AACA,SAAK,OAAL,CAAa,CAAb,GAAiB;AAAC,WAAK,EAAE,CAAR;AAAW,WAAK,EAAE,CAAlB;AAAqB,SAAG,EAAE,CAA1B;AAA6B,SAAG,EAAE,MAAM,CAAC;AAAzC,KAAjB;AAEA,QAAI,MAAM,GAAI,MAAM,CAAC,KAAR,GAAiB,MAAM,CAAC,KAAxB,GAAgC,MAAM,CAAC,IAApD;AACA,QAAI,IAAI,GAAI,MAAM,CAAC,MAAR,GAAkB,MAAM,CAAC,MAAzB,GAAkC,MAAM,CAAC,IAApD;AACA,SAAK,OAAL,CAAa,CAAb,GAAiB;AAAC,WAAK,EAAE,CAAR;AAAW,WAAK,EAAE,MAAlB;AAA0B,SAAG,EAAE,IAA/B;AAAqC,SAAG,EAAE,MAAM,CAAC;AAAjD,KAAjB,CA/BiH,CAiCjH;;AACA,QAAI,CAAC,GAAG,CAAR;AACA,SAAK,OAAL,CAAa,QAAb,GAAwB;AACvB,WAAK,EAAE,CADgB;AAEvB,WAAK,EAAG,CAAC,MAAM,CAAC,UAAT,GAAuB,CAAvB,GAA2B,CAAC,GAAG,IAAI,CAAC,MAAL,KAAgB,EAAhB,GAAqB,IAAI,CAAC,EAA1B,GAA+B,GAF9C;AAGvB,SAAG,EAAG,CAAC,MAAM,CAAC,UAAT,GAAuB,CAAvB,GAA2B,CAAC,GAAG,IAAI,CAAC,MAAL,KAAgB,EAAhB,GAAqB,IAAI,CAAC,EAA1B,GAA+B;AAH5C,KAAxB;AAMA,SAAK,OAAL,CAAa,QAAb,CAAsB,UAAtB,GAAmC,KAAK,OAAL,CAAa,QAAb,CAAsB,KAAtB,GAA8B,KAAK,OAAL,CAAa,QAAb,CAAsB,KAAvF;AACA,SAAK,OAAL,CAAa,QAAb,CAAsB,QAAtB,GAAiC,KAAK,OAAL,CAAa,QAAb,CAAsB,KAAtB,GAA8B,KAAK,OAAL,CAAa,QAAb,CAAsB,GAArF,CA1CiH,CA4CjH;;AACA,QAAI,MAAM,CAAC,KAAX,EAAkB;AACjB,WAAK,cAAL,GAAsB,MAAM,CAAC,KAA7B;AACA;;AAED,SAAK,eAAL;AAEA,GAjEF,CAmEC;AACA;;;AACO,0CAAP,UAAc,QAAd,EAA8B;AAE7B,QAAI,QAAQ,GAAG,GAAf,EAAoB;AACnB,WAAK,kBAAL,GAA0B,QAAQ,GAAG,GAArC;AACA,WAAK,MAAL,GAAc,KAAK,OAAL,CAAa,KAAb,CAAmB,KAAnB,GAA4B,KAAK,OAAL,CAAa,KAAb,CAAmB,UAAnB,GAAiC,KAAK,kBAAhF;AACA,WAAK,MAAL,GAAc,KAAK,OAAL,CAAa,KAAb,CAAmB,KAAnB,GAA4B,KAAK,OAAL,CAAa,KAAb,CAAmB,UAAnB,GAAgC,KAAK,kBAA/E;AACA,WAAK,EAAL,GAAU,KAAK,OAAL,CAAa,CAAb,CAAe,KAAf,IAAwB,KAAK,OAAL,CAAa,CAAb,CAAe,UAAf,GAA6B,KAAK,OAAL,CAAa,CAAb,CAAe,UAAf,GAA4B,KAAK,kBAAtF,CAAV;AACA,WAAK,EAAL,GAAU,KAAK,OAAL,CAAa,CAAb,CAAe,KAAf,GAAwB,KAAK,OAAL,CAAa,CAAb,CAAe,UAAf,IAA6B,MAAM,KAAK,kBAAxC,CAAlC;AACA,WAAK,SAAL,GAAiB,KAAK,OAAL,CAAa,QAAb,CAAsB,KAAtB,GAAgC,KAAK,OAAL,CAAa,QAAb,CAAsB,UAAtB,GAAmC,KAAK,kBAAzF;AACA,KAPD,MAOO;AAEN,cAAQ,IAAI,GAAZ;AACA,WAAK,kBAAL,GAA0B,QAAQ,GAAG,GAArC;AACA,WAAK,MAAL,GAAc,KAAK,OAAL,CAAa,KAAb,CAAmB,KAAnB,GAA6B,KAAK,kBAAL,GAA0B,KAAK,OAAL,CAAa,KAAb,CAAmB,QAAxF;AACA,WAAK,MAAL,GAAc,KAAK,OAAL,CAAa,KAAb,CAAmB,KAAnB,GAA6B,KAAK,kBAAL,GAA0B,KAAK,OAAL,CAAa,KAAb,CAAmB,QAAxF;AACA,WAAK,EAAL,GAAU,KAAK,OAAL,CAAa,CAAb,CAAe,KAAf,GAAyB,KAAK,kBAAL,GAA0B,KAAK,OAAL,CAAa,CAAb,CAAe,QAA5E;AACA,WAAK,EAAL,GAAU,KAAK,OAAL,CAAa,CAAb,CAAe,KAAf,GAA0B,KAAK,kBAAL,GAA0B,KAAK,OAAL,CAAa,CAAb,CAAe,QAA7E;AACA,WAAK,SAAL,GAAiB,KAAK,OAAL,CAAa,QAAb,CAAsB,KAAtB,GAAgC,KAAK,kBAAL,GAA0B,KAAK,OAAL,CAAa,QAAb,CAAsB,QAAjG;AACA,KAlB4B,CAoB7B;;;AACA,SAAK,OAAL,CAAa,KAAb,GAAqB,KAAK,MAA1B;;AACA,SAAK,OAAL,CAAa,KAAb,CAAmB,GAAnB,CAAuB,KAAK,MAAL,GAAc,KAAK,aAA1C,EAAyD,KAAK,MAAL,GAAc,KAAK,aAA5E;;AACA,SAAK,OAAL,CAAa,QAAb,CAAsB,GAAtB,CAA0B,KAAK,OAAL,CAAa,CAAb,GAAmB,CAAE,KAAK,EAAL,GAAU,KAAK,OAAL,CAAa,CAAzB,IAAgC,KAAK,kBAAlF,EAAwG,KAAK,EAA7G;;AACA,SAAK,OAAL,CAAa,QAAb,GAAwB,KAAK,SAA7B;AAEA,GA1BM,CArER,CAiGC;;;AACO,0CAAP,UAAc,iBAAd,EAAyC,SAAzC,EAA0D,SAA1D,EAAyE;AACxE,SAAK,aAAL,GAAqB,iBAArB;;AACA,SAAK,2BAAL,CAAiC,SAAjC,EAA4C,SAA5C;AACA,GAHM;AAKP;;;AACO,iDAAP;AACC,QAAI,CAAC,QAAL,CAAc,EAAd,CAAiB,KAAK,OAAtB,EAA+B,GAA/B,EAAoC;AAAC,UAAI,EAAE;AAAC,cAAM,EAAE,CAAT;AAAY,cAAM,EAAE,CAApB;;AAAuB;AAA6B,aAAK,EAAE;AAA3D;AAAP,KAApC;AACA,GAFM;AAIP;;;AACO,mDAAP;AACC,QAAI,CAAC,QAAL,CAAc,EAAd,CAAiB,KAAK,OAAtB,EAA+B,GAA/B,EAAoC;AACnC,WAAK,EAAE,GAD4B;AACvB,UAAI,EAAE,IAAI,CAAC,MAAL,CAAY,OADK;AAEnC,UAAI,EAAE;AAAC,cAAM,EAAE,KAAK,MAAL,GAAc,KAAK,aAA5B;AAA2C,cAAM,EAAE,KAAK,MAAL,GAAc,KAAK,aAAtE;AAAqF,aAAK,EAAE;AAA5F;AAF6B,KAApC;AAIA,GALM,CA7GR,CAoHC;AACA;AACA;AACA;AACA;AAEA;;;AACQ,mDAAR;AAEC,SAAK,OAAL,GAAe,IAAI,IAAI,CAAC,MAAT,CAAiB,KAAK,OAAL,CAAa,OAA9B,CAAf;AACA,SAAK,OAAL,CAAa,MAAb,CAAoB,CAApB,GAAwB,GAAxB;AACA,SAAK,OAAL,CAAa,MAAb,CAAoB,CAApB,GAAwB,GAAxB;;AACA,SAAK,WAAL,CAAiB,QAAjB,CAA0B,KAAK,OAA/B;;AAEA,SAAK,OAAL,CAAa,CAAb,GAAiB,KAAK,OAAL,CAAa,CAAb,CAAe,KAAhC;AACA,SAAK,OAAL,CAAa,CAAb,GAAiB,KAAK,OAAL,CAAa,CAAb,CAAe,KAAhC;AAEA,GAVO,CA3HT,CAuIC;;;AACQ,+DAAR,UAAoC,SAApC,EAAqD,SAArD,EAAoE;AAEnE;AACA;AACA,SAAK,OAAL,CAAa,CAAb,CAAe,KAAf,GAAwB,SAAS,CAAC,KAAV,GAAkB,CAAnB,GAA0B,SAAS,CAAC,KAAV,GAAkB,CAAnB,GAAwB,KAAK,OAAL,CAAa,CAAb,CAAe,GAAvF;AACA,SAAK,OAAL,CAAa,CAAb,CAAe,KAAf,GAAwB,SAAS,CAAC,MAAV,GAAmB,CAApB,GAA2B,SAAS,CAAC,MAAV,GAAmB,CAApB,GAAyB,KAAK,OAAL,CAAa,CAAb,CAAe,GAAzF;AAEA,SAAK,OAAL,CAAa,CAAb,CAAe,KAAf,GAAuB,KAAK,OAAL,CAAa,CAAb,CAAe,KAAtC,CAPmE,CAQnE;AAEA;;AACA,SAAK,OAAL,CAAa,CAAb,CAAe,QAAf,GAA0B,SAAS,CAAC,KAAV,GAAkB,KAAK,cAAjD,CAXmE,CAYnE;;AACA,SAAK,OAAL,CAAa,CAAb,CAAe,QAAf,GAA2B,KAAK,OAAL,CAAa,CAAb,CAAe,KAAf,IAA0B,SAAS,CAAC,MAAV,GAAmB,CAApB,GAA2B,SAAS,CAAC,MAAV,GAAmB,CAApB,GAAyB,KAAK,OAAL,CAAa,CAAb,CAAe,GAA3F,CAA3B;AAEA,SAAK,OAAL,CAAa,CAAb,CAAe,UAAf,GAA4B,SAAS,CAAC,KAAV,GAAkB,KAAK,cAAnD;AACA,SAAK,OAAL,CAAa,CAAb,CAAe,UAAf,GAA+B,SAAS,CAAC,MAAV,GAAmB,CAApB,GAA2B,SAAS,CAAC,MAAV,GAAmB,CAApB,GAAyB,KAAK,OAAL,CAAa,CAAb,CAAe,KAApE,GAA+E,KAAK,OAAL,CAAa,CAAb,CAAe,KAA1H;AAEA,GAlBO;;AAoBT;AAAC,CA5JD;;AAAa,oD;;;;;;;;;;;;;;;;;;ACpCb;;AAOA;;AACA;;AA2BA;AAAA;AAAA;AAkEC,wBAAqB,KAArB,EAAoD,MAApD,EAA4E,KAA5E,EAA6G,eAA7G,EAA8I,eAA9I,EAA0K;AAArJ;AAA+B;AAAwB;AAAiC;AAxDrG,sBAA2C,EAA3C;AAKA,wBAAwB,KAAxB;AAOA,qBAAoB,CAApB;AACA,iCAAiC,CAAjC;AAEA,kBAAiB,IAAjB;AACA,mBAAkB,GAAlB;AAKA,uBAAuB,IAAvB;AACA,wBAAwB,IAAxB;AACA,qBAAqB,IAArB;AACA,sBAAsB,GAAtB;AACA,6BAA6B,GAA7B;AAEA,qBAAoB,GAApB;AACA,2BAA0B,GAA1B;AACA,wBAAuB,GAAvB;AACA,yBAAwB,GAAxB;AACA,wBAAuB,CAAC,GAAxB;AACA,4BAA2B,CAAC,GAA5B;AAEA,6BAA4B,GAA5B;AAGA,6BAA6B,KAA7B;AACA,0BAA0B,KAA1B;AAIA,qBAAiB,EAAjB;AACA,mBAAe,EAAf;AACA,sBAAkB,EAAlB;AAEA,6BAAoB;AAC3B,WAAK,EAAE,GADoB;AAE3B,SAAG,EAAE,GAFsB;AAG3B,WAAK,EAAE;AAHoB,KAApB,CAUkK,CAJ1K;AACA;;AACQ,mCAAmC,KAAnC,CAEkK,CAEzK;;AACA,QAAI,CAAC,KAAL,EAAY;AACX,WAAK,cAAL,GAAsB,IAAtB;AACA;AACA;;AAED,SAAK,WAAL,GAAmB,MAAM,CAAC,UAA1B;AACA,SAAK,YAAL,GAAoB,MAAM,CAAC,WAA3B;AAEA,SAAK,MAAL,GAAc,KAAK,CAAC,OAAN,EAAd;AACA,SAAK,MAAL,GAAc,eAAe,CAAC,aAAhB,CAA8B,4BAA0B,MAAxD,CAAd;AACA,SAAK,iBAAL,GAAyB,KAAK,MAAL,CAAY,aAAZ,CAA0B,wBAA1B,CAAzB,CAbyK,CAezK;AACA;AACA;AAEA,GArFF,CAuFC;;;AACO,2CAAP,UAAuB,SAAvB,EAAoD,WAApD,EAAiF;AAChF,SAAK,aAAL,GAAqB;AACpB,eAAS,EAAE,SADS;AAEpB,iBAAW,EAAE;AAFO,KAArB;AAIA,GALM;AAOP;;;AACO,sCAAP,UAAkB,IAAlB,EAA+B;AAA/B;;AAEC,SAAK,SAAL,GAAiB,IAAjB;;AAEA,QAAI,KAAK,SAAT,EAAoB;AACnB,WAAK,SAAL,CAAe,MAAf,CAAsB,QAAtB,GAAiC,UAAC,QAAD,EAAc;AAC9C,aAAI,CAAC,YAAL,CAAkB,iBAAlB,CAAoC,QAAQ,CAAC,KAA7C;;AACA,aAAI,CAAC,qBAAL,GAA6B,QAAQ,CAAC,KAAtC;AACA,aAAI,CAAC,iBAAL,CAAuB,KAAvB,CAA6B,SAA7B,GAAyC,YAAU,KAAI,CAAC,qBAAf,GAAoC,GAA7E;AACA,OAJD;;AAKA,WAAK,SAAL,CAAe,MAAf,CAAsB,UAAtB,GAAmC,UAAC,IAAD,EAAK;AACvC,aAAI,CAAC,gBAAL,CAAsB,IAAtB;AACA,OAFD;AAGA;AAED,GAfM;;AAiBP,wBAAW,sBAAX,EAAW,WAAX,EAAoB;SAApB;AACC,aAAQ,KAAK,WAAL,IAAoB,KAAK,WAAL,CAAiB,OAA7C;AACA,KAFmB;oBAAA;;AAAA,GAApB;AAIA,wBAAW,sBAAX,EAAW,kBAAX,EAA2B;SAA3B;AACC,aAAQ,KAAK,SAAL,IAAkB,KAAK,SAAL,CAAe,WAAzC;AACA,KAF0B;oBAAA;;AAAA,GAA3B,EArHD,CAyHC;;AACO,kCAAP;AAEC,SAAK,gBAAL,GAFD,CAIC;;;AACA,SAAK,gBAAL,CAAsB,CAAC,CAAvB;;AACA,SAAK,kBAAL;;AACA,SAAK,gBAAL,CAAsB,CAAtB,EAPD,CASC;;;AACA,SAAK,MAAL;AACA,GAXM,CA1HR,CAuIC;;;AACO,+CAAP,UAA2B,KAA3B,EAA0C,UAA1C,EAAqE;AAA3B;AAAA;AAA2B;;AAEpE,QAAI,KAAK,cAAT,EAAyB;AACxB;AACA,KAJmE,CAMpE;;;AACA,QAAI,CAAC,UAAL,EAAiB;AAChB,UAAI,KAAK,KAAK,KAAK,SAAf,IAA4B,KAAK,cAArC,EAAqD;AACpD;AACA;AACD;;AAED,QAAI,KAAK,qBAAL,GAA6B,CAA7B,IAAkC,CAAC,KAAK,gBAA5C,EAA8D;AAC7D,WAAK,qBAAL,GAA6B,IAAI,CAAC,GAAL,CAAS,CAAT,EAAY,KAAK,qBAAL,GAA6B,IAAzC,CAA7B;AACA,WAAK,iBAAL,CAAuB,KAAvB,CAA6B,SAA7B,GAAyC,YAAU,KAAK,qBAAf,GAAoC,GAA7E;AACA;;AAED,SAAK,SAAL,GAAiB,KAAjB,CAlBoE,CAoBpE;;AACA,SAAK,QAAL,CAAc,KAAK,SAAnB;;AACA,SAAK,oBAAL,CAA0B,KAAK,SAA/B;;AACA,SAAK,eAAL,CAAqB,KAAK,SAA1B;AAEA,GAzBM;;AA2BA,kCAAP,UAAc,WAAd,EAA0C;AAA5B;AAAA;AAA4B;;AAEzC,QAAI,KAAK,cAAT,EAAyB;AACxB;AACA,KAJwC,CAMzC;;;AACA,SAAK,WAAL,GAAmB,MAAM,CAAC,UAA1B;AACA,SAAK,YAAL,GAAoB,MAAM,CAAC,WAA3B,CARyC,CAUzC;;AACA,SAAK,WAAL;;AACA,SAAK,eAAL,CAAqB,WAArB;;AACA,SAAK,gBAAL;;AAEA,SAAK,cAAL,CAAoB,KAAK,SAAzB;;AACA,SAAK,cAAL;;AACA,SAAK,SAAL;;AACA,SAAK,mBAAL;;AACA,SAAK,QAAL,CAAc,KAAK,SAAnB;AAEA,GArBM;;AAuBA,4CAAP;AACC,SAAK,cAAL,GAAsB,IAAtB;;AACA,SAAK,cAAL;;AACA,0BAAU,GAAV,CAAc,WAAd,CAA0B,KAAK,MAA/B,EAAuC,OAAvC;AACA,GAJM;;AAMA,2CAAP;AAAA;;AACC,SAAK,gBAAL;;AACA,SAAK,SAAL,CAAe,aAAf,GAA+B,UAAU,CAAE;AAAM,kBAAI,CAAC,cAAL;AAA2B,KAAnC,EAAqC,IAArC,CAAzC;AACA,SAAK,SAAL,CAAe,OAAf,GAAyB,UAAU,CAAE;AAAM,mCAAU,GAAV,CAAc,QAAd,CAAuB,KAAI,CAAC,MAA5B;AAA4C,KAApD,EAAsD,GAAtD,CAAnC;AACA,GAJM;AAMP;;;AACO,qCAAP,UAAiB,KAAjB,EAA2B;AAC1B,QAAI,KAAK,SAAT,EAAoB;AACnB,WAAK,SAAL,CAAe,cAAf,CAA8B,KAA9B;AACA;AAED,GALM;;AAOA,mCAAP;AACC,QAAI,KAAK,SAAT,EAAoB;AACnB,WAAK,SAAL,CAAe,OAAf;AACA;AACD,GAJM;AAMP;;;AACO,4CAAP,UAAwB,KAAxB,EAAkC;AACjC,QAAI,KAAK,SAAL,CAAe,WAAnB,EAAgC;AAC/B,WAAK,SAAL,CAAe,gBAAf,CAAgC,KAAhC;AACA;AACD,GAJM,CArNR,CA2NC;;AAEA;;;AACO,iCAAP;AACC,0BAAU,GAAV,CAAc,WAAd,CAA0B,KAAK,MAA/B,EAAuC,OAAvC;AACA,GAFM,CA9NR,CAkOC;;;AAEO,0CAAP;AAAA;;AACC,SAAK,iBAAL,GAAyB,IAAzB;AACA,QAAI,CAAC,QAAL,CAAc,EAAd,CAAiB,KAAK,WAAtB,EAAmC,GAAnC,EAAwC;AAAC,WAAK,EAAE,CAAR;AAAW,gBAAU,EAAE;AAAM,oBAAI,CAAC,WAAL,CAAiB,OAAjB;AAAgC,OAA7D;AAA+D,UAAI,EAAE,IAAI,CAAC,MAAL,CAAY;AAAjF,KAAxC;AACA,GAHM;AAKP;;;AACO,2CAAP;AAEC,SAAK,iBAAL,GAAyB,KAAzB;AACA,SAAK,WAAL,CAAiB,OAAjB,GAA4B,IAA5B;AACA,QAAI,CAAC,QAAL,CAAc,GAAd,CAAkB,KAAK,WAAvB,EAAoC;AAAC,WAAK,EAAE;AAAR,KAApC,EAJD,CAMC;;AACA,QAAI,KAAK,cAAT,EAAyB;AACxB,WAAK,gBAAL;AACA;;AACD,SAAK,cAAL,GAAsB,KAAtB;AAEA,GAZM;;AAcA,2CAAP;AACC,SAAK,iBAAL,GAAyB,KAAzB;AACA,SAAK,WAAL,CAAiB,OAAjB,GAA2B,IAA3B,EACA,IAAI,CAAC,QAAL,CAAc,EAAd,CAAiB,KAAK,WAAtB,EAAmC,GAAnC,EAAwC;AAAC,WAAK,EAAE,CAAR;AAAW,WAAK,EAAE,GAAlB;AAAuB,UAAI,EAAE,IAAI,CAAC,MAAL,CAAY;AAAzC,KAAxC,CADA;AAEA,GAJM;;AAMA,+CAAP,UAA2B,QAA3B,EAA2C;AAE1C,QAAI,KAAK,cAAT,EAAyB;AACxB;AACA;;AAED,SAAK,iBAAL,GAAyB,QAAzB;AAEA,GARM,CA9PR,CAwQC;AACA;AACA;AACA;AACA;AAEA;;;AACQ,uCAAR;AAEC;AACA;AACA,SAAK,MAAL,GAAe,KAAK,WAAL,GAAmB,KAAK,WAAxB,GAAsC,KAAK,SAA5C,GAAyD,KAAK,WAAL,GAAmB,KAAK,WAAjF,GAA+F,KAAK,SAAlH;AACA,SAAK,OAAL,GAAgB,KAAK,YAAL,GAAoB,KAAK,YAAzB,GAAwC,KAAK,UAA9C,GAA4D,KAAK,YAAL,GAAoB,KAAK,YAArF,GAAoG,KAAK,UAAxH;;AAEA,QAAK,sBAAU,MAAV,CAAiB,aAAtB,EAAsC;AACrC,WAAK,MAAL,GAAe,KAAK,WAAL,GAAmB,GAAlC;AACA;;AAED,QAAI,KAAK,uBAAL,IAAgC,KAAK,gBAAzC,EAA2D;AAC1D,WAAK,sBAAL;AACA;AAED,GAfO,CA/QT,CAgSC;AACA;;;AACQ,2CAAR,UAAwB,WAAxB,EAAoD;AAA5B;AAAA;AAA4B,MAEnD;;;AACA,QAAI,EAAE,GAAG,GAAT;AACA,QAAI,EAAE,GAAG,GAAT,CAJmD,CAMnD;;AACA,QAAI,sBAAU,MAAV,CAAiB,gBAArB,EAAuC;AACtC,QAAE,GAAG,GAAL;AACA,QAAE,GAAG,GAAL;AACA;;AAED,SAAK,SAAL,GAAiB;AAChB,WAAK,EAAE,KAAK,MAAL,GAAc,EADL;AAEhB,YAAM,EAAE,KAAK,OAAL,GAAe;AAFP,KAAjB;;AAKA,SAAK,YAAL,CAAkB,MAAlB,CAAyB,KAAK,SAA9B,EAAyC,WAAzC;AAEA,GAnBO,CAlST,CAuTC;;;AACQ,4CAAR;AAAA;;AAEC,QAAI,iBAAiB,GAAY,KAAK,YAAL,CAAkB,eAAlB,EAAjC;;AACA,QAAI,gBAAgB,GAAS,KAAK,YAAL,CAAkB,YAAlB,EAA7B,CAHD,CAKC;;;AACA,oBAAgB,CAAC,KAAjB,IAA0B,iBAA1B;AACA,oBAAgB,CAAC,MAAjB,IAA2B,iBAA3B;;AAEA,SAAK,UAAL,CAAgB,OAAhB,CAAyB,UAAC,QAAD,EAAS;AACjC,cAAQ,CAAC,MAAT,CAAgB,iBAAhB,EAAmC,gBAAnC,EAAqD,KAAI,CAAC,SAA1D;AACA,KAFD;AAIA,GAbO,CAxTT,CAuUC;;;AACQ,4CAAR;AAEC,SAAK,WAAL,GAAmB,IAAI,IAAI,CAAC,SAAT,EAAnB,CAFD,CAGC;AACA;;AACA,SAAK,WAAL,CAAiB,OAAjB,GAA2B,KAA3B;;AACA,SAAK,eAAL,CAAqB,QAArB,CAA+B,KAAK,WAApC;;AAEA,QAAI,KAAK,uBAAT,EAAkC;AACjC,WAAK,gBAAL,GAAwB,IAAI,IAAI,CAAC,QAAT,EAAxB;;AACA,WAAK,WAAL,CAAiB,QAAjB,CAA0B,KAAK,gBAA/B;;AACA,WAAK,sBAAL;AACA;;AAED,SAAK,eAAL,CAAqB,OAArB,GAA+B,IAA/B;AAEA,GAhBO,CAxUT,CA0VC;;;AACQ,kDAAR;AACC;AACA,QAAI,OAAO,GAAG,CAAC,QAAD,EAAU,QAAV,EAAmB,QAAnB,EAA4B,QAA5B,EAAqC,QAArC,EAA8C,QAA9C,EAAuD,QAAvD,EAAgE,QAAhE,CAAd;;AACA,SAAK,gBAAL,CAAsB,KAAtB;;AACA,SAAK,gBAAL,CAAsB,SAAtB,CAAgC,OAAO,CAAC,KAAK,MAAN,CAAvC,EAJD,CAIwD;AACvD;;;AACA,SAAK,gBAAL,CAAsB,QAAtB,CAA+B,EAA/B,EAAmC,GAAnC,EAAwC,KAAK,MAA7C,EAAqD,KAAK,OAAL,GAAe,GAApE,EAND,CAM2E;;;AAC1E,SAAK,gBAAL,CAAsB,OAAtB;;AACA,SAAK,gBAAL,CAAsB,KAAtB,GAA8B,GAA9B;AACA,GATO,CA3VT,CAsWC;;;AACQ,8CAAR;AAEC,QAAI,MAAM,GAAwB,EAAlC;AACA,SAAK,YAAL,GAAoB,IAAI,qCAAJ,CAAsB,KAAK,MAA3B,EAAmC,KAAK,WAAxC,EAAqD,MAArD,CAApB;;AACA,SAAK,YAAL,CAAkB,OAAlB,CAA0B,KAAK,KAAL,CAAW,IAArC;;AACA,SAAK,YAAL,CAAkB,WAAlB,CAA8B;AAC7B,eAAS,KAAK,aAAL,CAAmB,WAAnB,CAA+B,QAA/B,CAAwC,KAAK,KAAL,CAAW,KAAnD,CADoB;AAE7B,cAAQ,KAAK,aAAL,CAAmB,SAAnB,CAA6B,QAA7B,CAAsC,UAAtC,CAFqB;AAG7B;AACA,eAAS,KAAK,aAAL,CAAmB,SAAnB,CAA6B,QAA7B,CAAsC,WAAtC,CAJoB;AAK7B,eAAS,KAAK,aAAL,CAAmB,SAAnB,CAA6B,QAA7B,CAAsC,WAAtC,CALoB;AAM7B,cAAQ,KAAK,aAAL,CAAmB,SAAnB,CAA6B,QAA7B,CAAsC,UAAtC;AANqB,KAA9B;;AAQA,SAAK,YAAL,CAAkB,MAAlB;AAEA,GAfO;AAiBR;;;AACQ,4CAAR,UAAyB,KAAzB,EAA0C;AAA1C;;AAAyB;AAAA;AAAiB;;AAEzC,SAAK,KAAL,CAAW,SAAX,CAAqB,OAArB,CAA8B,UAAC,QAAD,EAAmC;AAEhE,UAAK,KAAK,KAAK,QAAQ,CAAC,KAAxB,EAA+B;AAE9B,YAAI,MAAM,GAA2B;AACpC,iBAAO,EAAG,KAAI,CAAC,aAAL,CAAmB,SAAnB,CAA6B,QAA7B,CAAsC,QAAQ,CAAC,OAA/C,CAD0B;AAEpC,cAAI,EAAE,QAAQ,CAAC,CAFqB;AAGpC,cAAI,EAAE,QAAQ,CAAC,CAHqB;AAIpC,eAAK,EAAG,QAAQ,CAAC,KAJmB;AAKpC,mBAAS,EAAE,QAAQ,CAAC,SALgB;AAMpC,oBAAU,EAAE,QAAQ,CAAC,UANe;AAOpC,mBAAS,EAAE,QAAQ,CAAC;AAPgB,SAArC;;AAUA,YAAI,QAAQ,CAAC,KAAb,EAAoB;AACnB,gBAAM,CAAC,KAAP,GAAe,QAAQ,CAAC,KAAxB;AACA;;AAED,YAAI,QAAQ,CAAC,MAAb,EAAqB;AACpB,gBAAM,CAAC,MAAP,GAAgB,QAAQ,CAAC,MAAzB;AACA;;AAED,YAAI,YAAY,GAAG,IAAI,2CAAJ,CAAyB,KAAI,CAAC,MAA9B,EAAsC,KAAI,CAAC,WAA3C,EAAwD,MAAxD,CAAnB;;AACA,aAAI,CAAC,UAAL,CAAgB,IAAhB,CAAqB,YAArB;AAEA;AAED,KA3BD;AA6BA,GA/BO;;AAiCA,oCAAR,UAAiB,OAAjB,EAAgC;AAE/B,QAAI,KAAK,WAAL,CAAiB,OAArB,EAA8B;AAE7B;AACA,WAAK,cAAL,CAAoB,OAApB;;AACA,WAAK,SAAL;;AACA,WAAK,mBAAL,GAL6B,CAO7B;;;AACA,UAAI,mBAAiB,GAAa,sBAAU,IAAV,CAAe,SAAf,CAAyB,OAAzB,EAAkC,CAAlC,EAAqC,GAArC,CAAlC;;AACA,WAAK,YAAL,CAAkB,MAAlB,CAAyB,mBAAzB,EAA4C,KAAK,iBAAjD;;AACA,WAAK,UAAL,CAAgB,OAAhB,CAAyB,UAAC,QAAD,EAAS;AAAM,gBAAQ,CAAC,MAAT,CAAgB,mBAAhB;AAAqC,OAA7E;;AAEA,UAAG,KAAK,gBAAR,EAA0B;AACzB,aAAK,gBAAL,CAAsB,KAAtB,CAA4B,CAA5B,GAAgC,IAAK,IAAI,CAAC,GAAL,CAAS,MAAM,mBAAf,IAAoC,CAAzE;AACA,aAAK,gBAAL,CAAsB,CAAtB,GAA0B,OAAO,IAAI,KAAK,gBAAL,CAAsB,KAAtB,CAA4B,CAAvC,CAA1B;AACA,OAf4B,CAiB7B;;AAEA;AAED,GAvBO;;AAyBA,gDAAR,UAA6B,QAA7B,EAA6C;AAE5C,QAAI,KAAK,iBAAT,EAA4B;AAC3B;AACA;;AAED,QAAI,KAAK,WAAL,CAAiB,OAAjB,KAA6B,QAAQ,GAAG,CAAC,GAAZ,IAAmB,QAAQ,GAAG,GAA3D,CAAJ,EAAuE;AACtE,WAAK,WAAL,CAAiB,OAAjB,GAA2B,KAA3B;AACA,KAFD,MAEO,IAAI,CAAC,KAAK,WAAL,CAAiB,OAAlB,IAA8B,QAAQ,IAAI,CAAC,GAAb,IAAoB,QAAQ,IAAI,GAAlE,EAA0E;AAChF,WAAK,WAAL,CAAiB,OAAjB,GAA2B,IAA3B;AACA;AAED,GAZO,CAnbT,CAkcC;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;;;AACQ,0CAAR,UAAuB,QAAvB,EAAuC;AACtC,SAAK,WAAL,CAAiB,CAAjB,GAAqB,sBAAU,IAAV,CAAe,aAAf,CAA6B,QAA7B,EAAuC,CAAC,CAAD,GAAK,KAAK,MAAjD,EAAyD,KAAK,WAA9D,CAArB;AACA,GAFO;;AAIA,0CAAR;AACC,SAAK,WAAL,CAAiB,CAAjB,GAAsB,sBAAU,MAAV,CAAiB,gBAAlB,GAAsC,GAAtC,GAA4C,CAAE,KAAK,YAAL,GAAoB,EAArB,GAA2B,KAAK,OAAjC,IAA4C,CAA7G;AACA,GAFO,CA/cT,CAmdC;;;AACQ,2CAAR,UAAwB,eAAxB,EAA+C;AAC9C,QAAI,KAAK,YAAL,KAAsB,eAAe,GAAG,IAAlB,IAA0B,eAAe,GAAG,IAAlE,CAAJ,EAA+E;AAC9E,WAAK,YAAL,GAAoB,KAApB;AACA,4BAAU,GAAV,CAAc,WAAd,CAA0B,KAAK,MAA/B,EAAuC,OAAvC;;AACA,WAAK,eAAL,CAAqB,MAArB,EAA6B,GAA7B;AACA,KAJD,MAIO,IAAI,CAAC,KAAK,YAAN,IAAuB,eAAe,IAAI,IAAnB,IAA2B,eAAe,IAAI,IAAzE,EAAkF;AACxF,WAAK,YAAL,GAAoB,IAApB;AACA,4BAAU,GAAV,CAAc,QAAd,CAAuB,KAAK,MAA5B,EAAoC,OAApC;;AACA,WAAK,eAAL,CAAqB,OAArB,EAA8B,CAA9B;AACA;AAED,GAXO,CApdT,CAieC;;;AACQ,qCAAR;AACC,SAAK,MAAL,GAAe,sBAAU,MAAV,CAAiB,gBAAlB,GAAwC,EAAxC,GAA8C,KAAK,WAAL,CAAiB,CAAjB,GAAsB,KAAK,MAAL,GAAc,IAAhG;;AACA,QAAI,KAAK,WAAL,CAAiB,OAAjB,IAA4B,KAAK,MAAL,GAAc,KAAK,WAAL,GAAmB,GAA7D,IAAoE,KAAK,MAAL,GAAc,CAAC,GAAvF,EAA4F;AAC3F,WAAK,MAAL,GAAgB,sBAAU,MAAV,CAAiB,gBAAlB,GAAuC,IAAvC,GAA8C,MAA7D;AACA,WAAK,MAAL,CAAY,KAAZ,CAAkB,SAAlB,GAA8B,gBAAc,KAAK,MAAnB,GAAyB,iBAAzB,GAA2C,KAAK,MAAhD,GAAsD,GAApF;AACA;AACD,GANO,CAleT,CA0eC;;;AACQ,2CAAR,UAAwB,OAAxB,EAAyC,IAAzC,EAAqD;AAArD;;AAEC,gBAAY,CAAC,KAAK,WAAN,CAAZ;;AAEA,QAAI,IAAI,KAAK,CAAb,EAAgB;AACf,WAAK,MAAL,CAAY,KAAZ,CAAkB,OAAlB,GAA4B,OAA5B;AACA;AACA;;AAED,SAAK,WAAL,GAAmB,UAAU,CAAC;AAC7B,WAAI,CAAC,MAAL,CAAY,KAAZ,CAAkB,OAAlB,GAA4B,OAA5B;AACA,KAF4B,EAE1B,IAF0B,CAA7B;AAIA,GAbO;AAeR;;;AACQ,+CAAR;AAEC,QAAI,CAAC,KAAK,SAAV,EAAqB;AACpB;AACA;;AAED,SAAK,KAAL,GAAc,CAAC,sBAAU,MAAV,CAAiB,gBAAnB,GAAwC,KAAK,WAAL,CAAiB,CAAjB,GAAsB,KAAK,MAAL,GAAc,IAA5E,GAAoF,KAAK,WAAL,CAAiB,CAAjB,GAAsB,KAAK,MAAL,GAAc,GAArI;AACA,SAAK,KAAL,GAAe,CAAC,sBAAU,MAAV,CAAiB,gBAAnB,GAAuC,KAAvC,GAA+C,KAA7D;;AACA,SAAK,SAAL,CAAe,WAAf,CAA2B,KAAK,KAAhC,EAAuC,KAAK,KAA5C,EAAmD,KAAK,YAAL,CAAkB,cAAlB,EAAnD;AAEA,GAVO;;AAYA,0CAAR,UAAuB,OAAvB,EAA+C;AAAxB;AAAA;AAAwB;;AAE9C,QAAI,MAAM,GAAe,KAAK,cAAL,EAAzB;;AACA,QAAI,QAAQ,GAAY,OAAD,GAAY,GAAZ,GAAkB,GAAzC;AAEA,SAAK,UAAL,GAAkB,IAAI,CAAC,QAAL,CAAc,EAAd,CAAiB,KAAK,WAAtB,EAAmC,QAAnC,EACjB;AAAC,UAAI,EAAE;AAAC,SAAC,EAAE,MAAM,CAAC,KAAX;AAAkB,SAAC,EAAE,MAAM,CAAC;AAA5B,OAAP;AACA,UAAI,EAAE,IAAI,CAAC,MAAL,CAAY,SADlB;AAEA,WAAK,EAAE;AAFP,KADiB,CAAlB;;AAMA,SAAK,YAAL,CAAkB,aAAlB,CAAgC,OAAhC,EAAyC,MAAzC;;AAEA,SAAK,UAAL,CAAgB,OAAhB,CAAyB,UAAC,QAAD,EAAS;AACjC,cAAQ,CAAC,aAAT;AACA,KAFD,EAb8C,CAiB9C;AACA;;;AACA,QAAI,UAAU,GAAG,KAAK,YAAL,CAAkB,aAAlB,EAAjB;;AAEA,SAAK,KAAL,CAAW,oBAAX,CAAgC;AAC/B,WAAK,EAAE,MAAM,CAAC,UAAP,GAAoB,UAAU,CAAC,KADP;AAE/B,YAAM,EAAE,MAAM,CAAC,UAAP,GAAoB,UAAU,CAAC;AAFR,KAAhC;AAKA,GA1BO,CAvgBT,CAmiBC;;;AACQ,4CAAR;AAEC,SAAK,UAAL,CAAgB,OAAhB;;AACA,SAAK,YAAL,CAAkB,eAAlB;;AAEA,SAAK,UAAL,CAAgB,OAAhB,CAAyB,UAAC,QAAD,EAAS;AACjC,cAAQ,CAAC,eAAT;AACA,KAFD;AAIA,GATO,CApiBT,CA+iBC;;;AACQ,0CAAR;AAEC,QAAI,SAAS,GAAS,KAAK,YAAL,CAAkB,YAAlB,EAAtB;;AAEA,WAAO;AACN,WAAK,EAAG,KAAK,WAAL,GAAmB,CAApB,GAA0B,KAAK,MAAL,GAAc,CADzC;AAEN,WAAK,EAAG,KAAK,YAAL,GAAoB,CAArB,GAA2B,KAAK,OAAL,GAAe,CAF3C;AAGN,YAAM,EAAG,KAAK,MAAL,GAAc,CAHjB;AAIN,YAAM,EAAG,KAAK,OAAL,GAAe,CAJlB;AAKN;AACA,gBAAU,EAAE,sBAAU,IAAV,CAAe,eAAf,CAA+B,KAAK,YAAL,CAAkB,aAAlB,EAA/B,EAAmE;AAAC,aAAK,EAAE,KAAK,WAAb;AAA0B,cAAM,EAAE,KAAK;AAAvC,OAAnE,CANN;AAON;AACA,gBAAU,EAAI,CAAC,KAAK,WAAL,GAAoB,KAAK,WAAL,GAAmB,IAAxC,IAAiD,SAAS,CAAC,KARnE;AASN,gBAAU,EAAI,CAAC,KAAK,YAAL,GAAqB,KAAK,YAAL,GAAoB,IAA1C,IAAoD,SAAS,CAAC;AATtE,KAAP;AAYA,GAhBO;AAkBR;;;;;;AAIQ,mDAAR;AACC,QAAI,CAAC,KAAK,MAAV,EAAkB;AACjB,UAAI;AACH,cAAM,IAAI,KAAJ,CAAU,qCAAmC,KAAK,MAAxC,GAA8C,kCAAxD,CAAN;AACA,OAFD,CAEE,OAAO,CAAP,EAAU;AACX,eAAO,CAAC,GAAR,CAAY,CAAZ;AACA;;AACD,aAAO,KAAP;AACA;;AAED,WAAO,IAAP;AACA,GAXO;;AAaT;AAAC,CAnlBD;;AAAa,oC;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACnCb;;AAKA;AAAA;AAAA;AAAA,mCAUC;;AARO,uCAAP,UAAW,GAAX,EAAsB;AACrB,WAAO,CAAC,GAAR,CAAY,GAAZ;AACA,GAFM;;AAIA,+CAAP,UAAmB,GAAnB,EAA2B;AAC1B,WAAO,CAAC,GAAR,CAAY,cAAZ,EAA4B,GAA5B;AACA,GAFM;;AANK,sBAAoB,eADhC,wBACgC,GAApB,oBAAoB,CAApB;AAUb;AAAC,CAVD;;AAAa,oD;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACLb;;AAEA;;AAGA;AAAA;AAAA;AAAA,4BAQC;;AAJO,gCAAP,UAAW,GAAX,EAAsB;AACrB,SAAK,cAAL,CAAoB,WAApB,CAAgC,GAAhC;AACA,GAFM;;AAFsB,cAA5B,mBAAO,cAAM,aAAb,CAA4B,E,iCAAA,G,uBAAA,E,gBAAA,E,KAAsC,CAAtC;;AAFjB,eAAa,eADzB,wBACyB,GAAb,aAAa,CAAb;AAQb;AAAC,CARD;;AAAa,sC;;;;;;;;;;;;;;;;ICLb;AACA;AACA;AACA;;AACA;;AAaA;AAAA;AAAA;AAAA,wBAgDC;;AA5CA,wBAAkB,SAAlB,EAAkB,YAAlB,EAA4B;SAA5B;AACC,aAAO,SAAS,CAAC,GAAV,CAAc,UAArB;AACA,KAF2B;oBAAA;;AAAA,GAA5B;AAIA,wBAAkB,SAAlB,EAAkB,OAAlB,EAAuB;SAAvB;AACC,aAAO,SAAS,CAAC,GAAV,CAAc,KAArB;AACA,KAFsB;oBAAA;;AAAA,GAAvB;AAIA,wBAAkB,SAAlB,EAAkB,OAAlB,EAAuB;SAAvB;AACC,aAAO,SAAS,CAAC,GAAV,CAAc,KAArB;AACA,KAFsB;oBAAA;;AAAA,GAAvB;AAIA,wBAAkB,SAAlB,EAAkB,QAAlB,EAAwB;SAAxB;AACC,aAAO,SAAS,CAAC,GAAV,CAAc,MAArB;AACA,KAFuB;oBAAA;;AAAA,GAAxB;AAIA,wBAAkB,SAAlB,EAAkB,WAAlB,EAA2B;SAA3B;AACC,aAAO,SAAS,CAAC,GAAV,CAAc,SAArB;AACA,KAF0B;oBAAA;;AAAA,GAA3B;AAIA,wBAAkB,SAAlB,EAAkB,KAAlB,EAAqB;SAArB;AACC,aAAO,SAAS,CAAC,GAAV,CAAc,GAArB;AACA,KAFoB;oBAAA;;AAAA,GAArB;AAIA,wBAAkB,SAAlB,EAAkB,QAAlB,EAAwB;SAAxB;AACC,aAAO,SAAS,CAAC,GAAV,CAAc,MAArB;AACA,KAFuB;oBAAA;;AAAA,GAAxB;AAIA,wBAAkB,SAAlB,EAAkB,MAAlB,EAAsB;SAAtB;AACC,aAAO,SAAS,CAAC,GAAV,CAAc,IAArB;AACA,KAFqB;oBAAA;;AAAA,GAAtB;AAIA,wBAAkB,SAAlB,EAAkB,WAAlB,EAA2B;SAA3B;AACC,aAAO,SAAS,CAAC,GAAV,CAAc,SAArB;AACA,KAF0B;oBAAA;;AAAA,GAA3B;AAIA,wBAAkB,SAAlB,EAAkB,QAAlB,EAAwB;SAAxB;AACC,aAAO,SAAS,CAAC,GAAV,CAAc,MAArB;AACA,KAFuB;oBAAA;;AAAA,GAAxB;;AAIc,mBAAd;AACC,aAAS,CAAC,GAAV,CAAc,IAAd;AACA,GAFa;;AAIf;AAAC,CAhDD;;AAAa;;AAkDb,IAAI,CAAC,SAAS,CAAC,GAAf,EAAqB;AACpB,WAAS,CAAC,GAAV,GAAgB,IAAI,2BAAJ,EAAhB;AACA,C;;;;;;;;;;;;;;;;ICrED;AACA;AACA;;AACA;;AACA;;AACA;;AACA;;AACA;;AACA,wI,CACA;;;AAEA;;AACA;;AACA;;AACA;;AACA;;AAEA;;AAEA;;AAEA;;AAEA;AAAA;AAAA;AAmBC;AAFA,iBAAgB,CAAhB;AAGC,oBAAO,IAAP;;AACA,SAAK,gBAAL;;AACA,SAAK,eAAL;;AACA,SAAK,aAAL;AACA;;AAEM,gCAAP;AACC,SAAK,kBAAL,CAAwB,IAAxB;;AACA,SAAK,aAAL,CAAmB,IAAnB;AACA,GAHM;;AAKP,wBAAW,sBAAX,EAAW,YAAX,EAAqB;SAArB;AACC,aAAO,KAAK,kBAAZ;AACA,KAFoB;oBAAA;;AAAA,GAArB;AAIA,wBAAW,sBAAX,EAAW,OAAX,EAAgB;SAAhB;AACC,aAAO,KAAK,aAAZ;AACA,KAFe;oBAAA;;AAAA,GAAhB;AAIA,wBAAW,sBAAX,EAAW,OAAX,EAAgB;SAAhB;AACC,aAAO,KAAK,aAAZ;AACA,KAFe;oBAAA;;AAAA,GAAhB;AAIA,wBAAW,sBAAX,EAAW,WAAX,EAAoB;SAApB;AACC,aAAO,KAAK,iBAAZ;AACA,KAFmB;oBAAA;;AAAA,GAApB;AAIA,wBAAW,sBAAX,EAAW,QAAX,EAAiB;SAAjB;AACC,aAAO,KAAK,cAAZ;AACA,KAFgB;oBAAA;;AAAA,GAAjB;AAIA,wBAAW,sBAAX,EAAW,KAAX,EAAc;SAAd;AACC,aAAO,KAAK,UAAZ;AACA,KAFa;oBAAA;;AAAA,GAAd;AAIA,wBAAW,sBAAX,EAAW,QAAX,EAAiB;SAAjB;AACC,aAAO,KAAK,aAAZ;AACA,KAFgB;oBAAA;;AAAA,GAAjB;AAIA,wBAAW,sBAAX,EAAW,MAAX,EAAe;SAAf;AACC,aAAO,KAAK,WAAZ;AACA,KAFc;oBAAA;;AAAA,GAAf;AAIA,wBAAW,sBAAX,EAAW,WAAX,EAAoB;SAApB;AACC,aAAO,KAAK,gBAAZ;AACA,KAFmB;oBAAA;;AAAA,GAApB;AAIA,wBAAW,sBAAX,EAAW,QAAX,EAAiB;SAAjB;AACC,aAAO,KAAK,aAAZ;AACA,KAFgB;oBAAA;;AAAA,GAAjB;;AAIQ,2CAAR;AAEC,SAAK,kBAAL,GAA0B,IAAI,qCAAJ,EAA1B;AACA,SAAK,aAAL,GAAqB,IAAI,2BAAJ,EAArB;AACA,SAAK,aAAL,CAAmB,iBAAnB,GAAuC,KAAK,kBAA5C;AACA,SAAK,aAAL,GAAqB,IAAI,2BAAJ,EAArB;AACA,SAAK,cAAL,GAAsB,IAAI,6BAAJ,EAAtB;AACA,SAAK,iBAAL,GAAyB,IAAI,mCAAJ,EAAzB;AAEA,SAAK,aAAL,GAAqB,IAAI,2BAAJ,EAArB;AACA,SAAK,aAAL,GAAqB,IAAI,2BAAJ,EAArB;AACA,SAAK,WAAL,GAAmB,IAAI,uBAAJ,EAAnB,CAXD,CAYC;;AACA,SAAK,UAAL,GAAkB,IAAI,qBAAJ,EAAlB;AACA,SAAK,gBAAL,GAAwB,IAAI,iCAAJ,EAAxB;AACA,GAfO,CAvET,CAwFC;;;AACQ,yCAAR;AACC,oBAAO,KAAP,CAAa,KAAK,WAAL,CAAiB,IAAjB,CAAsB,IAAtB,CAAb;AACA,oBAAO,IAAP,CAAY,KAAK,OAAL,CAAa,IAAb,CAAkB,IAAlB,CAAZ;AACA,oBAAO,SAAP,CAAiB,KAAK,YAAL,CAAkB,IAAlB,CAAuB,IAAvB,CAAjB;AACA,oBAAO,MAAP,CAAc,KAAK,SAAL,CAAe,IAAf,CAAoB,IAApB,CAAd;AACA,oBAAO,MAAP,CAAc,KAAK,SAAL,CAAe,IAAf,CAAoB,IAApB,CAAd;AACA,GANO,CAzFT,CAiGC;;;AACQ,mCAAR;AACC,SAAK,cAAL,CAAoB,IAApB;;AACA,SAAK,kBAAL,CAAwB,IAAxB;AACA,GAHO;;AAKA,uCAAR;AACC,SAAK,kBAAL,CAAwB,QAAxB;;AACA,SAAK,cAAL,CAAoB,QAApB,GAFD,CAGC;;AACA,GAJO;;AAMA,wCAAR;AACC,SAAK,kBAAL,CAAwB,UAAxB;;AACA,SAAK,cAAL,CAAoB,UAApB,GAFD,CAGC;;AACA,GAJO;;AAMA,qCAAR,UAAkB,CAAlB,EAA2B;AAC1B,SAAK,UAAL,CAAgB,MAAhB,CAAuB,CAAvB;;AACA,SAAK,kBAAL,CAAwB,MAAxB,CAA+B,CAA/B;;AACA,SAAK,cAAL,CAAoB,MAApB,CAA2B,CAA3B,EAH0B,CAI1B;;AACA,GALO;;AAOA,qCAAR,UAAkB,KAAlB,EAAuB;AACtB,SAAK,aAAL,CAAmB,MAAnB;;AACA,SAAK,UAAL,CAAgB,MAAhB,CAAuB,KAAvB;;AACA,SAAK,kBAAL,CAAwB,MAAxB,CAA+B,KAA/B;;AACA,SAAK,cAAL,CAAoB,MAApB,CAA2B,KAA3B,EAJsB,CAKtB;;AACA,GANO;;AAQA,4CAAR;AACC,SAAK,cAAL,GAAsB,gCAAa,GAAb,CAAyB,cAAM,MAA/B,CAAtB;;AACA,SAAK,cAAL,CAAoB,GAApB,CAAwB,OAAxB;AACA,GAHO;;AAKT;AAAC,CAvID;;AAAa,oC;;;;;;;;;;;;;;;;ICvBb;AACA;;AACA;;AASA;AAAA;AAAA;AAgBC;AACA,sBAAY,EAAZ,EAAsB;AAdf,kBAAkB,KAAlB;AAEA,sBAAsB,KAAtB;AAaN,SAAK,GAAL,GAAW,qBAAX;AACA,SAAK,EAAL,GAAU,EAAV;AACA,SAAK,KAAL,GAAa,sBAAU,KAAvB;AACA,SAAK,GAAL,GAAW,sBAAU,GAArB;AACA,SAAK,IAAL,GAAY,sBAAU,IAAtB;AACA,SAAK,MAAL,GAAc,sBAAU,MAAxB;AACA,SAAK,MAAL,GAAc,sBAAU,MAAxB;AACA,GAzBF,CA2BC;AACA;AACA;AAEA;;;AACO,8BAAP,UAAY,MAAZ,EAAwB,CAAU,CAA3B;;AAA2B;;AAC3B,kCAAP,aAA0B,CAAnB;;AAAmB;;AACnB,oCAAP,aAA4B,CAArB;;AAAqB;;AACrB,wCAAP,aAAgC,CAAzB;;AAAyB;;AACzB,gCAAP,aAAwB,CAAjB;;AAAiB;;AACjB,gCAAP,UAAc,OAAd,EAA6B,CAAU,CAAhC;;AAAgC;;AAEhC,+BAAP,UAAa,YAAb,EAA4B,UAA5B,EAAuD;AAA3B;AAAA;AAA2B;AAAU,GAA1D;;AAA0D;;AAC1D,8BAAP,UAAY,YAAZ,EAA2B,UAA3B,EAAsD;AAA3B;AAAA;AAA2B;AAAU,GAAzD;;AAAyD;;AACzD,8BAAP,UAAY,SAAZ,EAAsB,CAAU,CAAzB;;AAAyB;;AAEzB,8BAAP,aAAsB,CAAf;;AAAe;;AACf,+BAAP,aAAuB,CAAhB;;AAAgB;;AAChB,iCAAP,aAAyB,CAAlB;;AAAkB;;AAElB,sCAAP;AACC,QAAI,KAAK,iBAAT,EAA4B;AAC3B,WAAK,SAAL,GAAkB,QAAQ,CAAC,aAAT,CAAuB,KAAK,iBAA5B,CAAlB;AACA;;AACD,SAAK,UAAL,GAAkB,IAAlB;AACA,SAAK,QAAL;AACA,GANM;;AAQA,iCAAP;AACC,SAAK,EAAL,GAAU,IAAV;AACA,SAAK,GAAL,GAAW,IAAX;AACA,SAAK,KAAL,GAAa,IAAb;AACA,SAAK,MAAL,GAAc,IAAd;AACA,GALM,CAvDR,CA8DC;AACA;AACA;AAEA;AACA;;;AACU,6BAAV,UAAc,YAAd,EAAkC;AACjC,WAAO,sBAAU,UAAV,CAAqB,GAArB,CAAyB,YAAzB,CAAP;AACA,GAFS;;AAIA,6BAAV;AACC;AACA,WAAO,IAAP;AACA,GAHS;;AAKX;AAAC,CA7ED;;AAAsB,gC;;;;;;;;;;;;;;;;;;ACXtB;AAAA;AAAA;AAIC,sBAAa,UAAb,EAAmC;AAAtB;AAAA;AAAsB;;AAClC,SAAK,IAAI,CAAT,IAAc,UAAd,EAA0B;AACzB,WAAK,CAAL,IAAU,UAAU,CAAC,CAAD,CAApB;AACA;AACD;;AAMD,wBAAI,oBAAJ,EAAI,qBAAJ,EAAuB;AAJvB;;;;SAIA;AACC,aAAO,KAAK,WAAL,CAAiB,WAAjB,CAAP;AACA,KAFsB;oBAAA;;AAAA,GAAvB;AAID;AAAC,CAlBD;;AAAsB,gC;;;;;;;;;;;;;;;;;;ACAtB;;AASA;AAAA;AAAA;AAiBC;AAXO,mBAAmB,KAAnB;AACA,qBAAsB,KAAtB;AACA,mBAAmB,KAAnB;AACA,kBAAkB,IAAlB;AACA,kBAAc,EAAd;AAQN,SAAK,KAAL,GAAa,sBAAU,KAAvB;AACA,SAAK,IAAL,GAAY,sBAAU,IAAtB;AACA,SAAK,GAAL,GAAW,sBAAU,GAArB;AACA,SAAK,MAAL,GAAc,sBAAU,MAAxB;AACA;;AAEM,4BAAP,aAAyB,CAAlB;;AACA,0BAAP,aAAuB,CAAhB;;AACA,8BAAP,aAAyB,CAAlB;;AAGA,6BAAP;AACC,SAAK,KAAL,GAAa,IAAb;AACA,SAAK,GAAL,GAAW,IAAX;AACA,SAAK,MAAL,GAAc,IAAd;AACA,SAAK,IAAL,GAAY,IAAZ;AACA,GALM;;AAOA,4BAAP,UAAc,OAAd,EAA6B,CAE5B,CAFM;;AAIA,4BAAP,UAAc,KAAd,EAAwB,CAEvB,CAFM,CAxCR,CA4CC;;;AACU,wCAAV,UAA6B,MAA7B,EAA6C,IAA7C,EAA+D,OAA/D,EAAsF;AAAzC;AAAA;AAAgB;;AAAE;AAAA;AAAuB;;AAErF,QAAI,CAAC,OAAD,IAAY,KAAK,UAArB,EAAiC;AAChC,aAAO,GAAG,KAAK,UAAf;AACA;;AAED,QAAI,CAAC,IAAL,EAAW;AACV,UAAI,GAAG,IAAP;AACA;;AAED,QAAI,CAAC,OAAL,EAAc;AACb;AACA;AAED,GAdS;;AAgBF,iCAAR;AACC,SAAK,kBAAL,CAAwB,KAAK,UAA7B;AACA,SAAK,QAAL;;AACA,SAAK,UAAL;AACA,GAJO;;AAMA,gCAAR,aAA4B,CAApB;;AAET;AAAC,CArED;;AAAsB,wB;;;;;;;;;;;;;;;;;;ACTtB;AAAA;AAAA;AAAA,yBAaC;;AAXuB,qBAAQ,OAAR;AACA,sBAAS,QAAT;AACA,sBAAS,QAAT;AACA,oBAAO,MAAP;AACA,yBAAY,WAAZ;AACA,2BAAc,aAAd;AACA,8BAAiB,gBAAjB;AACA,+BAAkB,iBAAlB;AACA,+BAAkB,iBAAlB;AACA,iCAAoB,mBAApB;AAExB;AAAC,CAbD;;AAAa,gC;;;;;;;;;;;;;;;;;;ACAb;;AAEA,IAAM,aAAN;;AAAA,WAAM,aAAN,EAAmB;AAAG;AAAQ;AAAS;AAAU,CAAjD,EAAM,aAAa,KAAb,aAAa,MAAnB;;AAGA;AAAA;AAAA;AASC,yBAAoB,IAApB,EAAyC,MAAzC,EAAuG,QAAvG,EAAyI,QAAzI,EAA6J;AAAtD;AAAA;AAAgC;;AAAE;AAAA;AAAoB;;AAAzI;AAAqB;AAA8D;AAPhG,wBAA8B,IAA9B,CAOsJ,CAE5J;;AACA,QAAI,KAAK,QAAL,KAAkB,IAAtB,EAA4B;AAC3B,WAAK,YAAL,GAAqB,KAAK,gBAAL,CAAsB,KAAK,QAA3B,CAArB;;AACA,WAAK,GAAL;AACA;;AAED,QAAI,KAAK,MAAT,EAAiB;AAChB,WAAK,eAAL,GAAuB,KAAK,MAAL,CAAY,QAAZ,EAAvB;AACA;AAED;;AAEM,oCAAP;AAEC,QAAI,KAAK,YAAL,KAAsB,IAA1B,EAAgC;AAC/B,WAAK,IAAL;AACA;;AAED,SAAK,IAAL,GAAY,IAAZ;AACA,SAAK,QAAL,GAAgB,IAAhB;AACA,SAAK,MAAL,GAAc,IAAd;AACA,SAAK,eAAL,GAAuB,IAAvB;AACA,GAVM;;AAYA,qCAAP,UAAgB,IAAhB,EAAkC,QAAlC,EAAsD;AAAtD;;AAAgB;AAAA;AAAgB;;AAAE;AAAA;AAAoB;;AAErD,QAAI,QAAQ,IAAI,QAAQ,CAAC,KAAzB,EAAgC;AAC/B,gBAAU,CAAE;AAAM,eAAC,KAAI,CAAC,MAAL,CAAD,IAAC,CAAD;AAA+B,OAAvC,EAA0C,QAAQ,CAAC,KAAT,GAAiB,IAA3D,CAAV;AACA;AACA,KALoD,CAOrD;;;AACC,SAAK,MAAL,CAAyB,IAAzB;AAED,GAVM;;AAYA,kCAAP,UAAa,IAAb,EAA2B,QAA3B,EAA6D,MAA7D,EAAyH;AAA9F;AAAA;AAAgC;;AAAE;AAAA;AAA4D;;AAExH,QAAI,aAAa,GAAY,IAA7B,CAFwH,CAGxH;AACA;;AACA,QAAI,MAAM,IAAI,MAAM,KAAK,KAAK,MAA9B,EAAsC;AACrC,mBAAa,GAAG,KAAhB;AACA;;AAED,QAAK,KAAK,IAAL,KAAc,IAAd,IAAsB,QAAQ,KAAK,KAAK,QAAxC,IAAoD,aAAzD,EAAwE;AACvE,aAAO,IAAP;AACA;;AAED,WAAO,KAAP;AAEA,GAfM,CA/CR,CAgEC;AACA;AACA;AACA;AACA;;;AAEQ,gCAAR;AAAA;;AAEC,QAAI,KAAK,YAAL,KAAsB,aAAa,CAAC,MAAxC,EAAgD;AAC/C,4BAAG,KAAK,IAAR,EAAc,KAAK,QAAnB,EAA6B,KAAK,MAAlC;AACA,KAFD,MAEO,IAAI,KAAK,YAAL,KAAsB,aAAa,CAAC,OAAxC,EAAiD;AACtD,WAAK,QAAL,CAA0B,gBAA1B,CAA2C,KAAK,IAAhD,EAAuD,KAAK,MAA5D;AACD,KAFM,MAEA,IAAI,KAAK,YAAL,KAAsB,aAAa,CAAC,SAAxC,EAAmD;AACxD,WAAK,QAAL,CAAsC,OAAtC,CAA8C,UAAC,IAAD,EAAc;AAC5D,YAAI,CAAC,gBAAL,CAAsB,KAAI,CAAC,IAA3B,EAAkC,KAAI,CAAC,MAAvC;AACA,OAFA;AAGD;AAED,GAZO;;AAcA,iCAAR;AAAA;;AAEC,QAAI,KAAK,YAAL,KAAsB,aAAa,CAAC,MAAxC,EAAgD;AAC/C,6BAAI,KAAK,IAAT,EAAe,KAAK,QAApB,EAA8B,KAAK,MAAnC;AACA,KAFD,MAEO,IAAI,KAAK,YAAL,KAAsB,aAAa,CAAC,OAAxC,EAAiD;AACtD,WAAK,QAAL,CAA0B,mBAA1B,CAA8C,KAAK,IAAnD,EAA0D,KAAK,MAA/D;AACD,KAFM,MAEA,IAAI,KAAK,YAAL,KAAsB,aAAa,CAAC,SAAxC,EAAmD;AACxD,WAAK,QAAL,CAAsC,OAAtC,CAA8C,UAAC,IAAD,EAAc;AAC5D,YAAI,CAAC,mBAAL,CAAyB,KAAI,CAAC,IAA9B,EAAqC,KAAI,CAAC,MAA1C;AACA,OAFA;AAGD;AAED,GAZO;;AAcA,6CAAR,UAAyB,QAAzB,EAAkD;AAEjD,QAAI,OAAO,QAAP,KAAoB,QAApB,IAAgC,QAAQ,YAAY,MAAxD,EAAgE;AAC/D,aAAO,aAAa,CAAC,MAArB;AACA,KAFD,MAEO,IAAI,QAAQ,YAAY,OAApB,IAA+B,QAAQ,YAAY,QAAnD,IAA+D,QAAQ,YAAY,MAAvF,EAA+F;AACrG,aAAO,aAAa,CAAC,OAArB;AACA;;AAED,WAAO,aAAa,CAAC,SAArB;AAEA,GAVO;;AAYT;AAAC,CA9GD;;AAAa,sC;;;;;;;;;;;;;;;;ICLb;;AACA;;AACA;;AACA;;AAGA;AAAA;AAAA;AAAA,qBAqPC;;AAhPc,gBAAd;AACC,UAAM,CAAC,iBAAP;AACA,GAFa;;AAYA,cAAd,UACC,IADD,EAEC,gBAFD,EAGC,MAHD,EAG6D;AAA5D;AAAA;AAA4D;;AAE5D,QAAI,YAAJ,CAF4D,CAI5D;;AACA,QAAK,EAAE,OAAO,IAAP,KAAgB,QAAlB,CAAL,EAAmC;AAClC,UAAI,WAAW,GAAS,IAAxB;AACA,kBAAY,GAAG,WAAW,CAAC,SAAZ,IAAyB,WAAW,CAAC,mBAApD;;AACA,YAAM,CAAC,gBAAP,CAAwB,WAAxB;AACA,KAJD,MAIO;AACN,kBAAY,GAAG,IAAf;AACA;;AAED,QAAI,eAAe,GAAG,IAAtB;;AAEA,QAAI,MAAM,KAAK,IAAf,EAAqB;AACpB,YAAM,GAAI,gBAAV;AACA,KAFD,MAEO;AACN,qBAAe,GAAI,gBAAnB;AACA;;AAED,QAAI,MAAM,KAAK,SAAX,IAAwB,MAAM,CAAC,KAAP,CAAa,YAAb,EAA2B,eAA3B,EAA4C,MAA5C,EAAoD,MAApD,KAA+D,CAA3F,EAA8F;AAC7F,UAAI,QAAQ,GAAG,IAAI,6BAAJ,CAAkB,YAAlB,EAAgC,MAAhC,EAAwC,eAAxC,CAAf;AACA,cAAQ,CAAC,EAAT,GAAc,KAAK,QAAnB;;AACA,YAAM,CAAC,UAAP,CAAkB,IAAlB,CAAuB,QAAvB;;AACA,WAAK,QAAL;AACA,aAAO,QAAQ,CAAC,EAAhB;AACA;;AAED,WAAO,IAAP;AAEA,GAlCa;;AAwCA,eAAd,UACC,IADD,EAEC,gBAFD,EAGC,MAHD,EAG6D;AAA5D;AAAA;AAA4D;;AAE5D,QAAI,YAAJ,CAF4D,CAI5D;;AACA,QAAK,EAAE,OAAO,IAAP,KAAgB,QAAlB,CAAL,EAAmC;AAClC,UAAI,WAAW,GAAS,IAAxB;AACA,kBAAY,GAAG,WAAW,CAAC,SAAZ,IAAyB,WAAW,CAAC,mBAApD;;AACA,YAAM,CAAC,gBAAP,CAAwB,WAAxB;AACA,KAJD,MAIO;AACN,kBAAY,GAAG,IAAf;AACA;;AAED,QAAI,eAAe,GAAG,IAAtB;;AAEA,QAAI,MAAM,KAAK,IAAf,EAAqB;AACpB,YAAM,GAAI,gBAAV;AACA,KAFD,MAEO;AACN,qBAAe,GAAI,gBAAnB;AACA;;AAED,QAAI,OAAO,GAAG,MAAM,CAAC,KAAP,CAAa,YAAb,EAA2B,eAA3B,EAA4C,MAA5C,CAAd;;AAEA,SAAK,IAAI,CAAC,GAAG,CAAb,EAAgB,CAAC,GAAG,OAAO,CAAC,MAA5B,EAAoC,CAAC,EAArC,EAAyC;AACxC,aAAO,CAAC,CAAD,CAAP,CAAW,OAAX;AACA;;AAED,UAAM,CAAC,MAAP;AAEA,GAhCa;;AAkCA,mBAAd;AAAsB;;SAAA,U,EAAA,qB,EAAA,I,EAAqB;AAArB;;;AACrB,SAAK,IAAI,CAAC,GAAG,CAAb,EAAgB,CAAC,GAAG,MAAM,CAAC,UAAP,CAAkB,MAAtC,EAA8C,CAAC,EAA/C,EAAmD;AAClD,UAAI,GAAG,CAAC,OAAJ,CAAY,MAAM,CAAC,UAAP,CAAkB,CAAlB,EAAqB,EAAjC,MAAyC,CAAC,CAA9C,EAAiD;AAChD,cAAM,CAAC,UAAP,CAAkB,CAAlB,EAAqB,OAArB;AACA;AACD;;AACD,UAAM,CAAC,MAAP;AACA,GAPa;;AASA,oBAAd,UAAuB,KAAvB,EAA4C,IAA5C,EAA8D,QAA9D,EAAkF;AAAtC;AAAA;AAAgB;;AAAE;AAAA;AAAoB;;AAEjF,QAAI,YAAJ;AACA,QAAI,SAAJ,CAHiF,CAKjF;;AACA,QAAK,EAAE,OAAO,KAAP,KAAiB,QAAnB,CAAL,EAAoC;AAEnC,UAAI,WAAW,GAAS,KAAxB;AACA,kBAAY,GAAG,WAAW,CAAC,SAAZ,IAAyB,WAAW,CAAC,mBAApD;AACA,eAAS,GAAG,WAAZ;;AACA,YAAM,CAAC,gBAAP,CAAwB,WAAxB,EALmC,CAOnC;;;AACA,cAAQ,GAAG,IAAX;AAEA,KAVD,MAUO;AACN,kBAAY,GAAG,KAAf;AACA,eAAS,GAAG,IAAZ;AACA;;AAED,QAAI,OAAO,GAAoB,KAAK,KAAL,CAAW,YAAX,EAAyB,IAAzB,CAA/B;AACA,WAAO,CAAC,OAAR,CAAgB,UAAS,KAAT,EAA6B;AAC5C,WAAK,CAAC,QAAN,CAAe,SAAf,EAA0B,QAA1B;AACA,KAFD;AAIA,GA1Ba;;AA4BA,iBAAd,UAAoB,IAApB,EAAkC,QAAlC,EAAoE,MAApE,EAAgI;AAA9F;AAAA;AAAgC;;AAAE;AAAA;AAA4D;;AAE/H,WAAQ,MAAM,CAAC,UAAP,CAAkB,MAAlB,CACP,oBAAQ;AAAI,qBAAQ,CAAC,KAAT,CAAe,IAAf,EAAqB,QAArB;AAAsC,KAD3C,CAAR;AAGA,GALa;;AAOA,iBAAd,UAAoB,QAApB,EAAsC;AACrC,UAAM,CAAC,EAAP,CAAU,wBAAW,KAArB,EAA4B,QAA5B;AACA,GAFa;;AAIA,gBAAd,UAAmB,QAAnB,EAAqC;AACpC,UAAM,CAAC,EAAP,CAAU,wBAAW,IAArB,EAA2B,QAA3B;AACA,GAFa;;AAIA,qBAAd,UAAwB,QAAxB,EAA0C;AACzC,UAAM,CAAC,EAAP,CAAU,wBAAW,WAArB,EAAkC,QAAlC;AACA,GAFa;;AAIP,kBAAP,UAAc,QAAd,EAAgC;AAC/B,UAAM,CAAC,EAAP,CAAU,wBAAW,MAArB,EAA6B,QAA7B;AACA,GAFM;;AAIA,kBAAP,UAAe,QAAf,EAAiC;AAChC,UAAM,CAAC,EAAP,CAAU,wBAAW,MAArB,EAA6B,QAA7B;AACA,GAFM,CAvJR,CA2JC;AACA;AACA;AACA;AACA;;;AACe,6BAAf;AACC,SAAK,MAAL;;AACA,SAAK,OAAL;;AACA,SAAK,OAAL;;AACA,SAAK,KAAL;AACA,GALc;;AAOA,kBAAf;AACC,YAAQ,CAAC,kBAAT,GAA+B;AAC9B,UAAI,QAAQ,CAAC,UAAT,KAAwB,aAA5B,EAA2C;AAC1C,cAAM,CAAC,QAAP,CAAgB,wBAAW,KAA3B,EAD0C,CAE1C;;AACA,cAAM,CAAC,KAAP,CAAa,wBAAW,KAAxB,EAA+B,OAA/B,CAAwC,UAAC,QAAD,EAAwB;AAAK,yBAAQ,CAAR;AAAkB,SAAvF,EAH0C,CAI1C;;AACA,cAAM,CAAC,MAAP;AACA;AACD,KARD;AASA,GAVc;;AAYA,mBAAf;AAEC,QAAI,aAAa,GAAG,KAApB;AACA,QAAI,OAAO,GAAG,CAAd;AAEA,UAAM,CAAC,gBAAP,CAAwB,QAAxB,EAAkC,UAAC,CAAD,EAAE;AAEnC,aAAO,CAAC,MAAR,CAAe;AAAO,eAAO,GAAG,MAAM,CAAC,OAAjB;AAA2B,OAAjD;;AAEA,UAAI,CAAC,aAAL,EAAoB;AACnB,cAAM,CAAC,qBAAP,CAA6B;AAC5B,gBAAM,CAAC,QAAP,CAAgB,wBAAW,MAA3B,EAAmC,OAAnC;AACA,uBAAa,GAAG,KAAhB;AACA,SAHD;AAIA,qBAAa,GAAG,IAAhB;AACA;AAED,KAZD;AAcA,GAnBc;;AAqBA,mBAAf;AAEC,QAAI,KAAK,GAAG,IAAZ;AAEA,UAAM,CAAC,gBAAP,CAAwB,QAAxB,EAAkC,UAAC,CAAD,EAAE;AACnC,aAAO,CAAC,KAAR,CAAc,KAAd;AACA,WAAK,GAAG,OAAO,CAAC,MAAR,CAAe;AACtB,cAAM,CAAC,QAAP,CAAgB,wBAAW,MAA3B,EAAmC;AAAC,eAAK,EAAE,MAAM,CAAC,UAAf;AAA2B,gBAAM,EAAE,MAAM,CAAC;AAA1C,SAAnC;AACA,aAAK,GAAG,IAAR;AACA,OAHO,CAAR;AAIA,KAND;AAQA,GAZc;;AAcA,iBAAf;AACC,UAAM,CAAC,qBAAP,CAA6B,KAAK,OAAL,CAAa,IAAb,CAAkB,IAAlB,CAA7B;AACA,GAFc;;AAIA,mBAAf;AACC,UAAM,CAAC,QAAP,CAAgB,wBAAW,IAA3B;AACA,UAAM,CAAC,qBAAP,CAA6B,KAAK,OAAL,CAAa,IAAb,CAAkB,IAAlB,CAA7B;AACA,GAHc;;AAKA,kBAAf;AACC,UAAM,CAAC,UAAP,GAAoB,MAAM,CAAC,UAAP,CAAkB,MAAlB,CAAyB,oBAAQ;AAAI,qBAAQ,CAAR;AAAa,KAAlD,CAApB;AACA,GAFc;AAIf;;;;;;;AAKe,4BAAf,UAAgC,KAAhC,EAA0C;AAEzC,QAAI,SAAS,GAAW,KAAK,CAAC,SAAN,IAAmB,KAAK,CAAC,mBAAjD;;AACA,QAAI,CAAC,SAAD,IAAc,SAAS,KAAK,EAAhC,EAAoC;AACnC,UAAI;AACH,YAAI,MAAI,GAAY,KAAK,CAAC,IAAN,IAAc,KAAK,CAAC,WAAN,CAAkB,IAApD;AACA,cAAM,IAAI,KAAJ,CAAU,iBAAgB,MAAhB,GAAqB,gCAA/B,CAAN;AACA,OAHD,CAGE,OAAO,CAAP,EAAU;AACX,eAAO,CAAC,GAAR,CAAY,CAAZ;AACA;AACD;AACD,GAXc;;AAtOA,sBAAoC,EAApC;AACA,oBAAmB,CAAnB;AAkPhB;AAAC,CArPD;;AAAa,wB;;;;;;;;;;;;CCNb;AACA;AACA;;;;IAEA;;AAEA;;AAEA;AAAA;AAAA;AAMC;AACC,SAAK,YAAL,GADD,CAEC;AACE;AACD;AACD;;AACA;;AAEM,qCAAP,UAAqB,OAArB,EAAuC,IAAvC,EAAqD,KAArD,EAAkE;AACjE,WAAO,CAAC,YAAR,CAAqB,IAArB,EAA2B,KAA3B;AACA,GAFM;;AAIA,yCAAP,UAAwB,OAAxB,EAA0C,IAA1C,EAAsD;AACrD,WAAO,CAAC,eAAR,CAAwB,IAAxB;AACA,GAFM;;AAIA,qCAAP,UAAoB,OAApB,EAAoD,QAApD,EAAoE;AACnE,QAAK,CAAC,OAAD,IAAY,CAAC,QAAlB,EAA4B;AAC3B;AACA;AACA;;AACD,WAAQ,OAAmB,CAAC,YAApB,CAAkC,QAAlC,CAAR;AACA,GANM;;AAQA,sCAAP,UAAqB,OAArB,EAAmD;AAElD,QAAK,CAAC,OAAN,EAAgB;AACf;AACA;AACA;;AAED,QAAI,IAAI,GAAG,EAAX;;AACA,SAAK,IAAI,CAAC,GAAG,CAAb,EAAgB,CAAC,GAAI,OAAmB,CAAC,UAApB,CAA+B,MAApD,EAA4D,CAAC,EAA7D,EAAiE;AAChE,UAAI,CAAE,OAAmB,CAAC,UAApB,CAA+B,CAA/B,EAAkC,IAApC,CAAJ,GAAiD,OAAmB,CAAC,UAApB,CAA+B,CAA/B,EAAkC,KAAnF;AACA;;AACD,WAAO,IAAP;AACA,GAZM,CA9BR,CA4CC;AACA;;;AACO,+BAAP,UAAc,IAAd,EAAuB;AACtB,SAAK,WAAL,GAAmB,IAAI,CAAC,KAAxB;AACA,SAAK,UAAL,GAAkB,IAAI,CAAC,MAAvB;AACA,GAHM;;AAKA,+BAAP,UAAc,CAAd,EAAuB;AACtB,SAAK,OAAL,GAAe,CAAf;AACA,GAFM;;AAIA,gCAAP,UAAe,OAAf,EAAqC,IAArC,EAAmD,QAAnD,EAA4E;AAAzB;AAAA;AAAyB;;AAE3E,QAAI,CAAC,OAAD,IAAY,CAAC,IAAjB,EAAuB;AACtB;AACA;AACA;;AAED,WAAO,CAAC,MAAR,CAAe;AACd,aAAO,CAAC,SAAR,GAAoB,IAApB;;AACA,UAAI,QAAJ,EAAc;AACb,gBAAQ;AACR;AACD,KALD;AAMA,GAbM;;AAeA,gCAAP,UAAe,OAAf,EAAqC,IAArC,EAAiD;AAEhD,QAAI,CAAC,OAAD,IAAY,CAAC,IAAjB,EAAuB;AACtB;AACA;AACA;;AAED,WAAO,CAAC,MAAR,CAAe;AAAO,aAAO,CAAC,SAAR,GAAoB,IAApB;AAA2B,KAAjD;AACA,GARM;;AAUA,+BAAP,UAAc,OAAd,EAA+C,UAA/C,EAAmF,QAAnF,EAA4G;AAAzB;AAAA;AAAyB;;AAE3G,QAAI,CAAC,UAAL,EAAiB;AAChB;AACA;AACA;;AAED,QAAI,OAAO,UAAP,KAAsB,QAA1B,EAAqC;AACpC,aAAO,CAAC,MAAR,CAAe;AACd,eAAO,CAAC,kBAAR,CAA4B,WAA5B,EAA0C,UAA1C;;AACA,YAAI,QAAJ,EAAc;AACb,kBAAQ;AACR;AACD,OALD;AAMA,KAPD,MAOO;AACN,aAAO,CAAC,MAAR,CAAe;AACd,eAAO,CAAC,WAAR,CAAsB,UAAtB;;AACA,YAAI,QAAJ,EAAc;AACb,kBAAQ;AACR;AACD,OALD;AAMA;AAED,GAvBM;;AAyBA,sCAAP,UAAqB,OAArB,EAAsD,QAAtD,EAA+E;AAAzB;AAAA;AAAyB;;AAE9E,QAAK,CAAC,OAAN,EAAgB;AACf;AACA;AACA;;AAED,WAAO,CAAC,MAAR,CAAe;AACd,aAAO,CAAC,UAAR,CAAmB,WAAnB,CAA+B,OAA/B;;AACA,UAAI,QAAJ,EAAc;AACb,gBAAQ;AACR;AACD,KALD;AAOA,GAdM;;AAgBA,iCAAP,UAAgB,OAAhB,EAAgD,SAAhD,EAAiE;AAEhE,QAAK,CAAC,OAAN,EAAgB;AACf;AACA;AACA;;AAED,WAAO,CAAC,MAAR,CAAe;AACd,UAAI,OAAO,CAAC,SAAZ,EAAuB;AACtB,eAAO,CAAC,SAAR,CAAkB,GAAlB,CAAsB,SAAtB;AACA,OAFD,MAEQ;AACP,eAAO,CAAC,SAAR,IAAqB,MAAM,SAA3B;AACA;AACD,KAND;AAOA,GAdM;;AAgBA,oCAAP,UAAmB,OAAnB,EAAmD,SAAnD,EAAoE;AAEnE,QAAK,CAAC,OAAD,IAAa,CAAC,SAAD,IAAc,SAAS,KAAK,EAA9C,EAAoD;AACnD;AACA;AACA;;AAED,WAAO,CAAC,MAAR,CAAe;AAEd,UAAI,OAAO,CAAC,SAAZ,EAAuB;AACtB,eAAO,CAAC,SAAR,CAAkB,MAAlB,CAAyB,SAAzB;AACA,OAFD,MAEQ;AACP,eAAO,CAAC,SAAR,GAAoB,OAAO,CAAC,SAAR,CAAkB,OAAlB,CAA0B,MAAM,SAAhC,EAA2C,EAA3C,CAApB;AACA;AACD,KAPD;AAQA,GAfM;;AAiBA,oCAAP,UAAmB,OAAnB,EAAmD,SAAnD,EAAsE,GAAtE,EAAyF;AAAnB;AAAA;AAAmB;;AAExF,QAAK,CAAC,OAAD,IAAa,CAAC,SAAD,IAAc,SAAS,KAAK,EAA9C,EAAoD;AACnD;AACA;AACA;;AAED,QAAI,GAAJ,EAAS;AACR,WAAK,QAAL,CAAc,OAAd,EAAuB,SAAvB;AACA,KAFD,MAEO;AACN,WAAK,WAAL,CAAiB,OAAjB,EAA0B,SAA1B;AACA;AACD,GAZM;;AAcA,4BAAP,UAAW,QAAX,EAA6B;AAC5B,WAAO,OAAO,CAAC,MAAR,CAAe;AACrB,cAAQ;AACR,KAFM,CAAP;AAGA,GAJM;;AAMA,iCAAP,UAAgB,EAAhB,EAAuB;AACtB,WAAO,CAAC,KAAR,CAAc,EAAd;AACA,GAFM;;AAIA,iCAAP,UAAgB,OAAhB,EAAgD,SAAhD,EAAiE;AAChE,WAAO,OAAO,CAAC,SAAR,CAAkB,QAAlB,CAA2B,SAA3B,CAAP;AACA,GAFM;;AAIA,+BAAP,UAAc,OAAd,EAA4C;AAC3C,WAAO,OAAO,CAAC,UAAf;AACA,GAFM;;AAIA,iCAAP,UAAgB,OAAhB,EAAgD,KAAhD,EAAmF;AAAnC;AAAA;AAAmC;;AAElF,QAAI,KAAK,KAAK,IAAd,EAAoB;AACnB,WAAK,GAAG,QAAQ,CAAC,IAAjB;AACA;;AAED,WAAO,KAAK,CAAC,QAAN,CAAe,OAAf,CAAP;AAEA,GARM;;AAUA,8BAAP,UAAa,OAAb,EAA8C,QAA9C,EAAgE;AAE/D,WAAO,CAAC,OAAR,CAAgB;AACf,UAAI,IAAI,GAAe,OAAO,CAAC,qBAAR,EAAvB;AACA,cAAQ,CAAC;AACR,gBAAQ,EAAE;AAAC,cAAI,EAAG,OAAuB,CAAC,UAAhC;AAA4C,aAAG,EAAG,OAAuB,CAAC;AAA1E,SADF;AAER,YAAI,EAAE,IAFE;AAGR,aAAK,EAAE,IAAI,CAAC,KAHJ;AAIR,cAAM,EAAE,IAAI,CAAC;AAJL,OAAD,CAAR;AAMA,KARD;AAUA,GAZM;;AAcC,qCAAR;AAAA;;AACC,WAAO,CAAC,OAAR,CAAgB;AACf,WAAI,CAAC,WAAL,GAAmB,MAAM,CAAC,WAA1B;AACA,WAAI,CAAC,UAAL,GAAkB,MAAM,CAAC,UAAzB;AACA,KAHD;AAIA,GALO;;AAOT;AAAC,CAzND;;AAAa,8B;;;;;;;;;;;;;;;;;;ACRb;;AAMA;AAAA;AAAA;AAAA,8BAyCC,CAzCD,CAEC;;;AACO,kDAAP,UAA2B,OAA3B,EAA2C;AAE1C,QAAI,IAAI,GAAG,sBAAU,GAAV,CAAc,aAAd,CAA4B,OAA5B,CAAX;;AAEA,SAAK,IAAI,CAAT,IAAc,IAAd,EAAoB;AACnB,UAAI,CAAC,CAAD,CAAJ,GAAU,sBAAU,MAAV,CAAiB,OAAjB,CAAyB,IAAI,CAAC,CAAD,CAA7B,CAAV;AACA;;AAED,WAAO,IAAP;AAEA,GAVM;;AAYA,iDAAP,UAA0B,QAA1B,EAAkD,UAAlD,EAAmE,KAAnE,EAA+E;AAAZ;AAAA;AAAY;;AAE9E,QAAI,IAAJ;AACA,QAAI,CAAJ;AACA,QAAI,OAAJ;AACA,QAAI,KAAJ;;AAEA,SAAK,CAAL,IAAU,UAAV,EAAsB;AAErB,aAAO,GAAG,IAAV;;AACA,UAAI,KAAK,IAAI,CAAC,sBAAU,MAAV,CAAiB,QAAjB,CAA0B,CAA1B,EAA6B,KAA7B,CAAd,EAAmD;AAClD,eAAO,GAAG,KAAV;AACA;;AAED,UAAI,OAAJ,EAAa;AACZ,aAAK,GAAI,sBAAU,MAAV,CAAiB,MAAjB,CAAwB,CAAxB,EAA2B,KAAK,GAAG,GAAnC,CAAT;AACA,YAAI,GAAG,sBAAU,MAAV,CAAiB,gBAAjB,CAAkC,KAAlC,CAAP;AACA,gBAAQ,CAAC,MAAT,CAAgB,IAAhB,IAAwB,UAAU,CAAC,CAAD,CAAlC;AACA;AAED;AAED,GAtBM;;AA0BR;AAAC,CAzCD;;AAAa,0C;;;;;;;;;;;;;;;;;;ACIb;AAAA;AAAA;AAAA,yBAsFC;;AAhFA,wBAAW,oBAAX,EAAW,WAAX,EAAoB;SAApB;AACC,aAAO,KAAK,UAAZ;AACA,KAFmB;oBAAA;;AAAA,GAApB;AAIA,wBAAW,oBAAX,EAAW,WAAX,EAAoB;SAApB;AACC,aAAO,KAAK,UAAZ;AACA,KAFmB;oBAAA;;AAAA,GAApB,EAVD,CAcC;;AACO,oCAAP,UAAkB,UAAlB,EAAsC,UAAtC,EAA0D,UAA1D,EAA8E,GAA9E,EAA2F,GAA3F,EAAsG;AACrG,WAAO,CAAC,UAAU,GAAG,UAAd,KAA6B,UAAU,GAAG,GAA1C,KAAkD,GAAG,GAAG,GAAxD,IAA+D,UAAtE;AACA,GAFM;;AAIA,sCAAP,UAAoB,KAApB,EAAmC,YAAnC,EAAyD,SAAzD,EAA0E;AACzE,QAAI,KAAK,GAAG,SAAS,GAAG,YAAxB;AACA,QAAI,OAAO,GAAG,CAAC,KAAK,GAAG,YAAT,IAAyB,KAAvC;AACA,WAAO,OAAP;AACA,GAJM;;AAMA,mCAAP,UAAiB,KAAjB,EAAgC,GAAhC,EAA6C,GAA7C,EAAwD;AACvD,QAAI,KAAK,GAAG,GAAZ,EAAiB;AAChB,WAAK,GAAG,GAAR;AACA,KAFD,MAEO,IAAI,KAAK,GAAG,GAAZ,EAAiB;AACvB,WAAK,GAAG,GAAR;AACA;;AACD,WAAO,KAAP;AACA,GAPM,CAzBR,CAkCC;AACA;AACA;;;AACO,uCAAP,UAAqB,KAArB,EAAoC,UAApC,EAAwD,QAAxD,EAAwE;AACvE,QAAI,KAAK,GAAW,QAAQ,GAAG,UAA/B;AACA,WAAO,UAAU,GAAI,KAAK,GAAG,KAA7B;AACA,GAHM,CArCR,CA0CC;AAEA;;;AACO,yCAAP,UAAuB,eAAvB,EAA8C,mBAA9C,EAAuE;AAEtE,QAAI,KAAK,GAAG,GAAZ;AACA,QAAI,WAAW,GAAG,eAAe,CAAC,KAAhB,GAAwB,eAAe,CAAC,MAA1D;AACA,QAAI,WAAW,GAAG,mBAAmB,CAAC,KAApB,GAA4B,mBAAmB,CAAC,MAAlE;;AAEA,QAAI,WAAW,GAAG,WAAlB,EAA+B;AAC9B,WAAK,GAAI,mBAAmB,CAAC,KAApB,GAA4B,eAAe,CAAC,KAArD;AACA,KAFD,MAEO;AACN,WAAK,GAAI,mBAAmB,CAAC,MAApB,GAA6B,eAAe,CAAC,MAAtD;AACA;;AAED,WAAO,KAAP;AAEA,GAdM;AAgBP;;;AACO,sCAAP,UAAoB,eAApB,EAA2C,mBAA3C,EAAoE;AAEnE,QAAI,cAAc,GAAG;AACnB,WAAK,EAAE,mBAAmB,CAAC,KAApB,GAA4B,eAAe,CAAC,KADhC;AAEnB,YAAM,EAAE,mBAAmB,CAAC,MAApB,GAA6B,eAAe,CAAC;AAFlC,KAArB,CAFmE,CAOnE;;AACA,QAAI,UAAU,GAAG,IAAI,CAAC,GAAL,CAAS,cAAc,CAAC,KAAxB,EAA+B,cAAc,CAAC,MAA9C,CAAjB,CARmE,CAUnE;;AACA,WAAO;AACN,WAAK,EAAE,eAAe,CAAC,KAAhB,GAAwB,UADzB;AAEN,YAAM,EAAE,eAAe,CAAC,MAAhB,GAAyB;AAF3B,KAAP;AAKA,GAhBM;;AAkBA,kCAAP,UAAgB,MAAhB,EAA+B,MAA/B,EAA4C;AAC3C,SAAK,UAAL,GAAkB,MAAM,CAAC,CAAP,GAAW,MAAM,CAAC,CAApC;AACA,SAAK,UAAL,GAAkB,MAAM,CAAC,CAAP,GAAW,MAAM,CAAC,CAApC;AACA,WAAQ,IAAI,CAAC,IAAL,CAAW,KAAK,UAAL,GAAkB,KAAK,UAAxB,GAAuC,KAAK,UAAL,GAAkB,KAAK,UAAxE,CAAR;AACA,GAJM;;AAMR;AAAC,CAtFD;;AAAa,gC;;;;;;;;;;;;;;;;;;ACVb;AAAA;AAAA;AAAA,2BAyDC;;AAvDO,4CAAP,UAAwB,GAAxB,EAAmC;AAClC,WAAO,GAAG,CAAC,OAAJ,CAAY,SAAZ,EAAuB,UAAS,CAAT,EAAU;AAAI,aAAO,CAAC,CAAC,CAAD,CAAD,CAAK,WAAL,EAAP;AAA4B,KAAjE,CAAP;AACA,GAFM;;AAIA,4CAAP,UAAwB,GAAxB,EAAmC;AAClC,WAAO,KAAK,qBAAL,CAA4B,KAAK,gBAAL,CAAsB,GAAtB,CAA5B,CAAP;AACA,GAFM;;AAIA,iDAAP,UAA6B,GAA7B,EAAwC;AACvC,WAAO,GAAG,CAAC,MAAJ,CAAW,CAAX,EAAc,WAAd,KAA8B,GAAG,CAAC,KAAJ,CAAU,CAAV,CAArC;AACA,GAFM;;AAIA,oCAAP,UAAgB,GAAhB,EAA6B,KAA7B,EAA4C,KAA5C,EAA6D;AAAjB;AAAA;AAAiB;;AAC5D,WAAQ,GAAG,CAAC,OAAJ,CAAY,KAAZ,EAAmB,KAAnB,MAA8B,CAAC,CAAvC;AACA,GAFM;;AAIA,kCAAP,UAAc,GAAd,EAA2B,MAA3B,EAAyC;AACxC,QAAI,EAAE,GAAG,IAAI,MAAJ,CAAW,KAAK,aAAL,CAAmB,MAAnB,CAAX,EAAuC,GAAvC,CAAT;AACA,WAAO,GAAG,CAAC,OAAJ,CAAY,EAAZ,EAAgB,EAAhB,CAAP;AACA,GAHM;;AAKA,qCAAP,UAAiB,GAAjB,EAAqC;AACpC,WAAO,CAAC,KAAK,CAAC,UAAU,CAAE,GAAF,CAAX,CAAN,IAAuC,QAAQ,CAAE,GAAF,CAAtD;AACA,GAFM,CAvBR,CA2BC;;;AACO,mCAAP,UAAe,GAAf,EAA4B,2BAA5B,EAAuE;AAA3C;AAAA;AAA2C;;AAEtE,QAAI,SAAS,GAA8B,GAA3C,CAFsE,CAItE;;AACA,QAAM,2BAA2B,IAAI,GAAG,KAAK,EAAxC,IAA+C,GAAG,CAAC,WAAJ,OAAsB,MAA1E,EAAkF;AACjF,eAAS,GAAG,IAAZ;AACA,KAFD,MAEO,IAAI,GAAG,CAAC,WAAJ,OAAsB,OAA1B,EAAmC;AACzC,eAAS,GAAG,KAAZ;AACA,KAFM,MAEA,IAAI,KAAK,SAAL,CAAe,GAAf,CAAJ,EAA0B;AAChC,eAAS,GAAI,UAAU,CAAC,GAAD,CAAvB;AACA;;AACD,WAAO,SAAP;AAEA,GAdM;;AAgBA,oCAAP,UAAgB,GAAhB,EAA6B,GAA7B,EAAqC;AACpC,SAAK,IAAI,CAAT,IAAc,GAAd,EAAmB;AACT,UAAI,EAAE,GAAI,IAAI,MAAJ,CAAW,OAAO,CAAP,GAAW,IAAtB,EAA4B,GAA5B,CAAV;AACA,SAAG,GAAI,GAAG,CAAC,OAAJ,CAAY,EAAZ,EAAgB,GAAG,CAAC,CAAD,CAAnB,CAAP;AACH;;AACD,WAAO,GAAP;AACN,GANM;;AAQC,yCAAR,UAAsB,GAAtB,EAAiC;AAChC,WAAO,GAAG,CAAC,OAAJ,CAAY,0BAAZ,EAAwC,MAAxC,CAAP;AACA,GAFO;;AAKT;AAAC,CAzDD;;AAAa,oC;;;;;;;;;;;;;;;;;;ACAb;AAAA;AAAA;AAUC;AARO,0BAA0B,KAA1B;AASN,SAAK,MAAL;AACA;;AAED,wBAAW,sBAAX,EAAW,YAAX,EAAqB;SAArB;AACC,aAAQ,KAAK,WAAb;AACA,KAFoB;oBAAA;;AAAA,GAArB;AAIA,wBAAW,sBAAX,EAAW,aAAX,EAAsB;SAAtB;AACC,aAAQ,KAAK,YAAb;AACA,KAFqB;oBAAA;;AAAA,GAAtB;AAIA,wBAAW,sBAAX,EAAW,kBAAX,EAA2B;SAA3B;AACC,aAAQ,KAAK,iBAAb;AACA,KAF0B;oBAAA;;AAAA,GAA3B;AAIA,wBAAW,sBAAX,EAAW,eAAX,EAAwB;SAAxB;AACC,aAAQ,KAAK,cAAb;AACA,KAFuB;oBAAA;;AAAA,GAAxB;;AAIO,kCAAP;AACC,SAAK,WAAL,GAAmB,MAAM,CAAC,UAA1B;AACA,SAAK,YAAL,GAAoB,MAAM,CAAC,WAA3B;AACA,SAAK,iBAAL,GAA0B,MAAM,CAAC,UAAP,GAAoB,IAApB,IAA4B,MAAM,CAAC,UAAP,GAAoB,MAAM,CAAC,WAAjF;AACA,SAAK,cAAL,GAAwB,MAAM,CAAC,UAAP,GAAoB,GAA5C;AACA,GALM;;AAOR;AAAC,CArCD;;AAAa,oC;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ICAb;AACA;;AACA;;AACA;;AAGA;AAAA;AAAA;AAAyC;;AAAzC;AAAA;;AAGQ,mBAAiB,KAAjB;AACA,iBAAY,IAAZ;;AAiDP;;AA/CO,8BAAP;AACC,SAAK,KAAL;AACA,GAFM,CANR,CAUC;AACA;AACA;AACA;AACA;;;AAEU,0CAAV,UAA2B,IAA3B,EAAoC;AACnC,SAAK,QAAL,CAAc,IAAd;AACA,GAFS;;AAUV,wBAAY,oBAAZ,EAAY,WAAZ,EAAqB;AANrB;AACA;AACA;AACA;AACA;SAEA;AACC,aAAQ,KAAK,MAAL,KAAgB,KAAjB,GAA0B,KAAK,IAA/B,GAAuC,IAA9C;AACA,KAFoB;oBAAA;;AAAA,GAArB;AAIA,wBAAY,oBAAZ,EAAY,UAAZ,EAAoB;SAApB;AACC,aAAQ,KAAK,MAAL,KAAgB,KAAjB,GAA0B,KAAK,IAA/B,GAAuC,IAA9C;AACA,KAFmB;oBAAA;;AAAA,GAApB,EA9BD,CAkCC;;AACQ,+BAAR;AAAA;;AAEC,oBAAO;AACN,YAAM,EAAE,KAAK,MADP;AAEN,SAAG,EAAE,KAAK,GAFJ;AAGN,UAAI,EAAE,KAAK,QAHL;AAIN,YAAM,EAAE,KAAK,SAJP;AAKN,wBAAkB,EAAE,KAAK;AALnB,KAAP,EAOE,IAPF,CAOQ,UAAC,QAAD,EAAS;AACb,WAAI,CAAC,gBAAL,CAAsB,QAAtB;AACD,KATH,EAUG,KAVH,CAUU,UAAC,KAAD,EAAM;AACZ,WAAI,CAAC,KAAL,CAAW,KAAX;AACD,KAZH;AAcA,GAhBO;;AAkBT;AAAC,CArDD,CAAyC,eAAzC;;AAAsB,gC;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ICNtB;;AACA;;AAEA;AAAA;AAAA;AAAgC;;AAAhC;;AAiBC;;AAZU,0CAAV,UAA2B,QAA3B,EAAwC;AAEvC,SAAK,IAAL,GAAY,QAAQ,CAAC,IAArB;;AAEA,QAAI,KAAK,OAAT,EAAkB;AACjB,WAAK,OAAL,CAAa,SAAb,GAAyB,KAAK,IAA9B;AACA;;AAED,SAAK,QAAL,CAAc,KAAK,EAAnB;AAEA,GAVS;;AAYX;AAAC,CAjBD,CAAgC,uBAAhC;;AAAa,gC;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ICHb;;AACA;;AAEA;AAAA;AAAA;AAAiC;;AAAjC;AAAA;;AAIW,mBAAiB,CAAjB;;AAmEV;;AAjEO,+BAAP;AACC,SAAK,IAAI,CAAC,GAAG,CAAb,EAAgB,CAAC,GAAG,KAAK,OAAL,CAAa,MAAjC,EAAyC,CAAC,EAA1C,EAA8C;AAC7C,WAAK,YAAL,CAAkB,KAAK,OAAL,CAAa,CAAb,CAAlB;AACA;AACD,GAJM;;AAMA,yCAAP;AACC,WAAQ,KAAK,OAAN,GAAiB,KAAK,OAAL,CAAa,MAA9B,GAAuC,CAA9C;AACA,GAFM;;AAIA,0CAAP;AACC,WAAO,KAAK,MAAZ;AACA,GAFM,CAhBR,CAoBC;AACA;AACA;AACA;AACA;;;AAEU,sCAAV,UAAsB,GAAtB,EAA8B;AAA9B;;AAEC,SAAK,MAAL;AACA,SAAK,WAAL,CAAiB,GAAjB;AAEA,OAAG,CAAC,mBAAJ,CAAwB,MAAxB,EAAgC,UAAC,CAAD,EAAE;AAAK,kBAAI,CAAC,YAAL,CAAkB,CAAC,CAAnB;AAA2B,KAAlE;AACA,OAAG,CAAC,mBAAJ,CAAwB,OAAxB,EAAiC,UAAC,KAAD,EAAM;AAAM,kBAAI,CAAC,WAAL;AAAuB,KAApE;AAEA,QAAI,WAAW,GAAG,KAAK,cAAL,EAAlB;AACA,QAAI,YAAY,GAAG,KAAK,eAAL,EAAnB;AACA,QAAI,KAAK,GAAG,YAAY,GAAG,WAA3B;AAEA,SAAK,QAAL,CAAc;AACb,QAAE,EAAE,KAAK,EADI;AAEb,WAAK,EAAE,KAFM;AAGb,WAAK,EAAE,WAHM;AAIb,YAAM,EAAE;AAJK,KAAd;;AAOA,QAAI,WAAW,KAAK,YAApB,EAAkC;AACjC,WAAK,QAAL,CAAc,KAAK,EAAnB;AACA;AAED,GAvBS;;AAyBA,qCAAV,UAAqB,KAArB,EAA+B;AAC9B,SAAK,OAAL,CAAa,KAAb;AACA,GAFS;;AAIA,uCAAV,UAAuB,MAAvB,EAAkC,CAAU,CAAlC;;AACA,sCAAV,UAAsB,KAAtB,EAAmC,CAElC,CAFS;;AAIF,uCAAR,UAAqB,GAArB,EAA0C;AAA1C;;AACC,QAAI,GAAG,CAAC,QAAR,EAAkB;AACjB,WAAK,WAAL,CAAiB,GAAjB;AACA,KAFD,MAEO;AACN,SAAG,CAAC,gBAAJ,CAAqB,MAArB,EAA6B,UAAC,CAAD,EAAE;AAAK,oBAAI,CAAC,WAAL,CAAiB,CAAC,CAAlB;AAA0B,OAA9D;AACA,SAAG,CAAC,gBAAJ,CAAqB,OAArB,EAA8B,UAAC,KAAD,EAAM;AAAM,oBAAI,CAAC,UAAL;AAAsB,OAAhE;AACA;AACD,GAPO;;AAWT;AAAC,CAvED,CAAiC,eAAjC;;AAAa,kC;;;;;;;;;;;;;;;;;;ACHb;AAAA;AAAA;AAEC,0BAAoB,OAApB,EAAmC;AAAf;AAAmB;;AAEvC,mDAAY,IAAZ,EAAwB;AAAE;;SAAA,U,EAAA,qB,EAAA,I,EAAc;AAAd;;;AACzB,QAAI,QAAQ,GAAG,MAAM,CAAC,MAAP,CAAc,KAAK,OAAL,CAAa,IAAb,EAAmB,SAAjC,CAAf;AACA,YAAQ,CAAC,WAAT,CAAqB,KAArB,CAA2B,QAA3B,EAAqC,IAArC;AACA,WAAW,QAAX;AACA,GAJD;;AAKD;AAAC,CATD;;AAAa,wC;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ICAb;;AACA;;AAEA;AAAA;AAAA;AAAgC;;AAAhC;;AAqBC;;AAnBU,0CAAV,UAA2B,QAA3B,EAAwC;AAGvC,SAAK,QAAL,CAAc,QAAd;AACA,GAJS;;AAMA,kCAAV,UAAmB,IAAnB,EAAmC;AAAhB;AAAA;AAAgB;;AAElC,SAAK,SAAL,GAAiB,IAAjB;;AAEA,QAAI,KAAK,UAAT,EAAqB;AACpB,WAAK,UAAL,CAAgB,KAAK,EAArB,EAAyB,IAAI,CAAC,IAA9B,EAAoC,IAApC;AACA;;AAED,QAAI,KAAK,oBAAT,EAA+B;AAC9B,WAAK,oBAAL,CAA0B,IAA1B,EAAgC,IAAhC;AACA;AACD,GAXS;;AAaX;AAAC,CArBD,CAAgC,uBAAhC;;AAAa,gC;;;;;;;;;;;;;;;;;;ACMb;AAAA;AAAA;AAAA;AAWW,qBAAqB,KAArB;AAqEV;;AAnEO,0BAAP,aAAsB,CAAf;;AAEA,6BAAP;AAEC;AACA,SAAK,UAAL,GAAkB,IAAlB;AACA,SAAK,UAAL,GAAkB,IAAlB;AACA,SAAK,OAAL,GAAe,IAAf;AACA,SAAK,oBAAL,GAA4B,IAA5B;AACA,SAAK,YAAL,GAAoB,IAApB;AACA,GARM;;AAUA,oCAAP;AACC,WAAO,CAAP;AACA,GAFM;;AAIA,qCAAP;AACC,WAAQ,KAAK,SAAN,GAAmB,CAAnB,GAAuB,CAA9B;AACA,GAFM,CA7BR,CAiCC;;;AACO,6CAAP,UAA+B,aAA/B,EAAwD,KAAxD,EAAuE;AACtE,SAAK,oBAAL,GAA4B,aAA5B;AACA,SAAK,YAAL,GAAoB,KAApB;AACA,GAHM,CAlCR,CAuCC;AACA;AACA;AACA;AACA;;;AAEU,8BAAV,UAAmB,IAAnB,EAAmC;AAAhB;AAAA;AAAgB;;AAClC,SAAK,SAAL,GAAiB,IAAjB;;AACA,QAAI,KAAK,UAAT,EAAqB;AACpB,WAAK,UAAL,CAAgB,IAAhB,EAAsB,IAAtB;AACA;;AAED,QAAI,KAAK,oBAAT,EAA+B;AAC9B,WAAK,oBAAL,CAA0B,IAA1B,EAAgC,IAAhC;AACA;AACD,GATS;;AAWA,iCAAV,UAAsB,IAAtB,EAAsC;AAAhB;AAAA;AAAgB;;AACrC,QAAI,KAAK,aAAT,EAAwB;AACvB,WAAK,aAAL,CAAmB,IAAnB,EAAyB,IAAzB;AACA;;AACD,QAAI,KAAK,oBAAT,EAA+B;AAC9B,WAAK,oBAAL,CAA0B,IAA1B,EAAgC,IAAhC;AACA;AACD,GAPS;;AASA,8BAAV,UAAmB,IAAnB,EAAwC;AACvC,QAAI,KAAK,UAAT,EAAqB;AACpB,WAAK,UAAL,CAAgB,IAAhB,EAAsB,IAAtB;AACA;AACD,GAJS;;AAMA,2BAAV,UAAgB,KAAhB,EAA6B;AAC5B,QAAI,KAAK,OAAT,EAAkB;AACjB,WAAK,OAAL,CAAa,KAAb,EAAoB,IAApB;AACA;;AACD,QAAI,KAAK,YAAT,EAAuB;AACtB,WAAK,YAAL,CAAkB,KAAlB,EAAyB,IAAzB;AACA;AACD,GAPS;;AASX;AAAC,CAhFD;;AAAsB,wB;;;;;;;;;;;;;;;;;;ACJtB;AAAA;AAAA;AAAA;AAOS,kBAAyB,EAAzB;AAiGR;;AA/FO,8BAAP;AAAW;;SAAA,U,EAAA,qB,EAAA,I,EAAoB;AAApB;;;AACV,SAAK,MAAL,GAAc,KAAK,MAAL,CAAY,MAAZ,CAAmB,OAAnB,CAAd;AACA,GAFM;;AAIA,+BAAP;AAAA;;AACC,SAAK,IAAI,CAAC,GAAG,CAAb,EAAgB,CAAC,GAAG,KAAK,MAAL,CAAY,MAAhC,EAAwC,CAAC,EAAzC,EAA8C;AAC7C,WAAK,MAAL,CAAY,CAAZ,EAAe,uBAAf,CACC;AAAM,oBAAI,CAAJ;AAAuB,OAD9B,EAEC,UAAC,KAAD,EAAM;AAAK,oBAAI,CAAC,QAAL;AAAoB,OAFhC;;AAIA,WAAK,MAAL,CAAY,CAAZ,EAAe,IAAf;AACA;AACD,GARM,CAbR,CAuBC;AACA;AACA;AACA;AACA;AAEA;;;AACS,2CAAT,UAA2B,IAA3B,EAA2C;AAAhB;AAAA;AAAgB;;AAE1C,QAAI,WAAW,GAAW,KAAK,eAAL,EAA1B;;AACA,QAAI,YAAY,GAAY,KAAK,gBAAL,EAA5B;;AACA,QAAI,KAAK,GAAG,YAAY,GAAG,WAA3B;;AAEA,QAAI,KAAK,UAAT,EAAqB;AACpB,WAAK,UAAL,CAAiB;AAChB,UAAE,EAAE,KAAK,EADO;AAEhB,aAAK,EAAE,KAFS;AAGhB,aAAK,EAAE,WAHS;AAIhB,cAAM,EAAE;AAJQ,OAAjB;AAMA;;AAED,QAAI,WAAW,KAAK,YAApB,EAAkC;AACjC,WAAK,cAAL;AACA;AAED,GAnBQ,CA9BV,CAmDC;;;AACS,yCAAT;AAEC,QAAI,KAAK,UAAT,EAAqB;AACpB,WAAK,UAAL,CAAgB,KAAK,EAArB;AACA;;AAED,SAAK,QAAL;AAEA,GARQ,CApDV,CA8DC;;;AACS,mCAAT,UAAkB,KAAlB,EAA+B;AAC9B,QAAI,KAAK,OAAT,EAAkB;AACjB,WAAK,OAAL,CAAa,KAAb;AACA;AACD,GAJQ,CA/DV,CAqEC;;;AACQ,mCAAR;AAGC;;AACA,QAAI,CAAC,KAAK,MAAV,EAAkB;AACjB;AACA;;AAED,SAAK,IAAI,CAAC,GAAG,CAAb,EAAgB,CAAC,GAAG,KAAK,MAAL,CAAY,MAAhC,EAAwC,CAAC,EAAzC,EAA6C;AAC5C,WAAK,MAAL,CAAY,CAAZ,EAAe,OAAf;AACA;;AAED,SAAK,MAAL,GAAc,IAAd;AAEA,GAdO,CAtET,CAsFC;;;AACQ,0CAAR;AACC,QAAI,KAAK,GAAG,CAAZ;;AACA,SAAK,IAAI,CAAC,GAAG,CAAb,EAAgB,CAAC,GAAG,KAAK,MAAL,CAAY,MAAhC,EAAwC,CAAC,EAAzC,EAA8C;AAC7C,WAAK,IAAI,KAAK,MAAL,CAAY,CAAZ,EAAe,cAAf,EAAT;AACA;;AACD,WAAO,KAAP;AACA,GANO,CAvFT,CA+FC;;;AACQ,2CAAR;AACC,QAAI,KAAK,GAAG,CAAZ;;AACA,SAAK,IAAI,CAAC,GAAG,CAAb,EAAgB,CAAC,GAAG,KAAK,MAAL,CAAY,MAAhC,EAAwC,CAAC,EAAzC,EAA8C;AAC7C,WAAK,IAAI,KAAK,MAAL,CAAY,CAAZ,EAAe,eAAf,EAAT;AACA;;AACD,WAAO,KAAP;AACA,GANO;;AAQT;AAAC,CAxGD;;AAAa,kC;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ICLb;AACA;;AACA;;AAEA;AAAA;AAAA;AAAgC;;AAAhC;AAAA;;AAEQ,sBAA2B,CAAE;AAAC,SAAG,EAAE,aAAN;AAAqB,UAAI,EAAE;AAA3B,KAAF,CAA3B;AAGG,mBAAiB,CAAjB;AAEF,0BAAyB,KAAzB;;AA6ER,GApFD,CASC;;;AACO,8BAAP;AAAA;;AAEC,SAAK,OAAL,GAAgB,IAAI,IAAI,CAAC,OAAL,CAAa,MAAjB,EAAhB;AAEA,SAAK,SAAL,CAAe,OAAf,CAAuB,UAAC,QAAD,EAAS;AAC/B,WAAI,CAAC,OAAL,CAAa,GAAb,CAAiB,QAAQ,CAAC,GAA1B,EAA+B,QAAQ,CAAC,IAAxC;AACA,KAFD;;AAIA,SAAK,OAAL,CAAa,MAAb,CAAoB,GAApB,CAAwB,UAAC,MAAD,EAAS,SAAT,EAAkB;AAAM,kBAAI,CAAC,gBAAL,CAAsB,MAAtB;AAAwC,KAAxF;;AACA,SAAK,OAAL,CAAa,UAAb,CAAwB,GAAxB,CAA6B,UAAC,MAAD,EAAS,SAAT,EAAkB;AAAK,kBAAI,CAAC,WAAL,CAAiB,MAAjB;AAAmC,KAAvF;;AACA,SAAK,OAAL,CAAa,OAAb,CAAqB,GAArB,CAAyB,UAAC,MAAD,EAAS,IAAT,EAAa;AAAK,kBAAI,CAAJ;AAAe,KAA1D,EAVD,CAU+D;;;AAC9D,SAAK,OAAL,CAAa,IAAb;AAEA,GAbM,CAVR,CAyBC;AACA;;;AACO,wCAAP;AACC,QAAI,KAAK,GAAG,CAAZ;;AACA,SAAM,IAAI,CAAC,GAAG,CAAd,EAAiB,CAAC,GAAG,KAAK,SAAL,CAAe,MAApC,EAA4C,CAAC,EAA7C,EAAiD;AAChD,UAAI,GAAG,GAAW,KAAK,SAAL,CAAe,CAAf,EAAkB,aAAlB,GAAkC,CAAlC,GAAsC,CAAxD;AACA,WAAK,IAAI,GAAT;AACA;;AACD,WAAO,KAAP;AACA,GAPM;;AASA,yCAAP;AACC,WAAO,KAAK,MAAZ;AACA,GAFM,CApCR,CAwCC;AACA;AACA;AACA;AACA;AAEA;;;AACU,0CAAV,UAA2B,MAA3B,EAAwD,IAAxD,EAAiE;AAEhE,QAAI,WAAW,GAAG,KAAK,cAAL,EAAlB;AACA,SAAK,MAAL,GAAc,IAAI,CAAC,KAAL,CAAa,MAAM,CAAC,QAAP,GAAkB,GAAnB,GAA0B,WAAtC,CAAd;AAEA,QAAI,YAAY,GAAG,KAAK,eAAL,EAAnB;AACA,QAAI,KAAK,GAAG,YAAY,GAAG,WAA3B;AAEA,SAAK,QAAL,CAAc;AACb,QAAE,EAAE,KAAK,EADI;AAEb,WAAK,EAAE,KAFM;AAGb,WAAK,EAAE,WAHM;AAIb,YAAM,EAAE;AAJK,KAAd;AAOA,GAfS,CA/CX,CAgEC;;;AACQ,qCAAR,UAAoB,MAApB,EAA4B,SAA5B,EAAqC;AAEpC,QAAI,KAAK,aAAT,EAAwB;AACvB;AACA;;AAED,SAAK,aAAL,GAAqB,IAArB;AAEA,SAAK,QAAL,CAAc,KAAK,EAAnB;;AACA,QAAI,KAAK,gBAAT,EAA2B;AAC1B,WAAK,gBAAL,CAAsB,KAAK,EAA3B,EAA+B,SAA/B;AACA;AACD,GAZO,CAjET,CA+EC;;;AACQ,kCAAR;AACC,SAAK,KAAL,CAAW,oCAAkC,KAAK,EAAvC,GAAyC,GAApD;AACA,GAFO;;AAIT;AAAC,CApFD,CAAgC,eAAhC;;AAAa,gC;;;;;;;;;;;;;;;;;;ACIb;AAAA;AAAA;AAAA,+BAEC;;AAAD;AAAC,CAFD;;AAAa,4C;;;;;;;;;;;;;;;;;;ACLb;;AACA;;AAQA;AAAA;AAAA;AAAA;AAES,wBAAkC,EAAlC;AA2FR;;AAzFO,qCAAP;AAEC;AACA;AACA,SAAK,IAAI,CAAC,GAAG,CAAb,EAAgB,CAAC,GAAG,KAAK,YAAL,CAAkB,MAAtC,EAA8C,CAAC,EAA/C,EAAmD;AAClD,UAAK,KAAK,YAAL,CAAkB,CAAlB,EAAqB,MAA1B,EAAmC;AAClC,aAAK,YAAL,CAAkB,CAAlB,EAAqB,IAArB;AACA;AACD;;AAED,oBAAO,EAAP,CAAU,wBAAW,eAArB,EAAsC,KAAK,iBAAL,CAAuB,IAAvB,CAA4B,IAA5B,CAAtC;AAEA,GAZM;;AAcA,oCAAP;AAAW;;SAAA,U,EAAA,qB,EAAA,I,EAA6C;AAA7C;;;AACV,SAAK,IAAI,CAAC,GAAG,CAAb,EAAgB,CAAC,GAAG,iBAAiB,CAAC,MAAtC,EAA8C,CAAC,EAA/C,EAAmD;AAElD,UAAI,iBAAiB,CAAC,CAAD,CAAjB,CAAqB,MAAzB,EAAkC;AACjC,yBAAiB,CAAC,CAAD,CAAjB,CAAqB,QAArB,CAA8B,MAA9B,GAAuC,IAAvC;AACA;;AACD,UAAI,iBAAiB,CAAC,CAAD,CAAjB,CAAqB,QAAzB,EAAoC;AACnC,yBAAiB,CAAC,CAAD,CAAjB,CAAqB,QAArB,CAA8B,iBAA9B,GAAkD,iBAAiB,CAAC,CAAD,CAAjB,CAAqB,QAAvE;AACA;;AAED,WAAK,YAAL,CAAkB,IAAlB,CAAuB,iBAAiB,CAAC,CAAD,CAAjB,CAAqB,QAA5C;AACA;AAED,GAbM;;AAeA,oCAAP,UAAW,EAAX,EAAqB;AAEpB,SAAK,IAAI,CAAC,GAAG,CAAb,EAAgB,CAAC,GAAG,KAAK,YAAL,CAAkB,MAAtC,EAA8C,CAAC,EAA/C,EAAmD;AAClD,UAAI,KAAK,YAAL,CAAkB,CAAlB,EAAqB,EAArB,CAAwB,WAAxB,OAA0C,EAAE,CAAC,WAAH,EAA9C,EAAgE;AAC/D,eAAO,KAAK,YAAL,CAAkB,CAAlB,CAAP;AACA;AACD;;AAED,WAAO,IAAP;AACA,GATM;;AAWA,yCAAP;AAEC,SAAK,YAAL,CAAkB,OAAlB,CAA0B,UAAC,UAAD,EAAW;AACpC,UAAI,UAAU,CAAC,QAAf,EAAyB;AACxB,kBAAU,CAAC,YAAX;AACA;AACD,KAJD;AAKA,GAPM;;AASA,2CAAP;AACC,SAAK,YAAL,CAAkB,OAAlB,CAA0B,UAAC,UAAD,EAAW;AACpC,UAAI,UAAU,CAAC,UAAf,EAA2B;AAC1B,kBAAU,CAAC,UAAX;AACA;AACD,KAJD;AAKA,GANM;;AAQA,uCAAP,UAAc,OAAd,EAA6B;AAC5B,SAAK,YAAL,CAAkB,OAAlB,CAA0B,UAAC,UAAD,EAAW;AACpC,UAAI,UAAU,CAAC,MAAf,EAAuB;AACtB,kBAAU,CAAC,MAAX,CAAkB,OAAlB;AACA;AACD,KAJD;AAKA,GANM;;AAQA,uCAAP,UAAc,KAAd,EAAwB;AACtB,SAAK,YAAL,CAAkB,OAAlB,CAA0B,UAAC,UAAD,EAAW;AACrC,UAAI,UAAU,CAAC,MAAf,EAAuB;AACtB,kBAAU,CAAC,MAAX;AACA;AACD,KAJA;AAKD,GANM;;AAQA,qCAAP;AACC,SAAK,YAAL,CAAkB,OAAlB,CAA0B,UAAC,kBAAD,EAA+B;AACxD,UAAI,kBAAkB,CAAC,IAAvB,EAA6B;AAC5B,0BAAkB,CAAC,IAAnB;AACA;AACD,KAJD;AAKA,GANM;;AAQC,kDAAR;AACC,SAAK,YAAL,CAAkB,OAAlB,CAA0B,UAAC,UAAD,EAAW;AACpC,UAAI,UAAU,CAAC,cAAf,EAA+B;AAC9B,kBAAU,CAAC,cAAX;AACA;AACD,KAJD;AAKA,GANO;;AAQT;AAAC,CA7FD;;AAAa,8C;;;;;;;;;;;;;;;;;;ACZb;;AAEA;;AACA;;AACA;;AAEA,IAAK,SAAL;;AAAA,WAAK,SAAL,EAAc;AAAG;AAAS;AAAQ,CAAlC,EAAK,SAAS,KAAT,SAAS,MAAd;;AAQA;AAAA;AAAA;AAAA;AAES,oBAAqB,EAArB,CAFT,CAEwC;AAkPvC;;AA5OO,mCAAP,aAEC,CAFM;;AAIA,gCAAP,UAAW,EAAX,EAAqB;AACpB,WAAO,KAAK,cAAL,CAAoB,EAApB,CAAP;AACA,GAFM;;AAIA,qCAAP,UAAgB,GAAhB,EAA2B;AAC1B,WAAO,KAAK,gBAAL,CAAsB,GAAtB,CAAP;AACA,GAFM;;AAIA,4CAAP,UAAuB,IAAvB,EAAmC;AAClC,WAAO,KAAK,gBAAL,CAAsB,IAAtB,CAAP;AACA,GAFM;;AAIA,mCAAP,UAAc,EAAd,EAAwB;AACvB,SAAK,UAAL,CAAgB,EAAhB,EAAoB,SAAS,CAAC,MAA9B;AACA,GAFM;;AAIA,yCAAP,UAAoB,GAApB,EAA+B;AAC9B,SAAK,WAAL,CAAiB,GAAjB;;AACA,SAAK,MAAL;AACA,GAHM;;AAKA,oCAAP,UAAe,EAAf,EAAyB;AACxB,SAAK,UAAL,CAAgB,EAAhB,EAAoB,SAAS,CAAC,OAA9B;AACA,GAFM;;AAIA,qCAAP;AACC,SAAK,cAAL;AACA,GAFM;;AAIA,uCAAP;AACC,SAAK,SAAL;;AACA,SAAK,cAAL;AACA,GAHM;;AAKA,iCAAP;AACC,SAAK,QAAL,CAAc,OAAd,CAAsB,UAAC,cAAD,EAAuB;AAC5C,UAAI,cAAc,CAAC,IAAnB,EAAyB;AACxB,sBAAc,CAAC,IAAf;AACA;AACD,KAJD;AAKA,GANM;;AAQA,mCAAP,UAAc,OAAd,EAA6B;AAC5B,SAAK,QAAL,CAAc,OAAd,CAAsB,UAAC,cAAD,EAAuB;AAC5C,UAAI,cAAc,CAAC,MAAnB,EAA2B;AAC1B,sBAAc,CAAC,MAAf,CAAsB,OAAtB;AACA;AACD,KAJD;AAKA,GANM;;AAQA,mCAAP,UAAc,KAAd,EAAwB;AACvB,SAAK,QAAL,CAAc,OAAd,CAAsB,UAAC,cAAD,EAAuB;AAC5C,UAAI,cAAc,CAAC,MAAnB,EAA2B;AAC1B,sBAAc,CAAC,MAAf,CAAsB,KAAtB;AACA;AACD,KAJD;AAKA,GANM;;AAQA,kDAAP,UAA6B,OAA7B,EAAiD;AAChD,SAAK,sBAAL,CAA4B,OAA5B;AACA,GAFM,CAtER,CA0EC;AACA;;;AACQ,2CAAR,UAAuB,EAAvB,EAAiC;AAChC,SAAK,IAAI,CAAC,GAAG,CAAb,EAAgB,CAAC,GAAG,KAAK,QAAL,CAAc,MAAlC,EAA0C,CAAC,EAA3C,EAA+C;AAC9C,UAAI,KAAK,QAAL,CAAc,CAAd,EAAiB,EAAjB,KAAwB,EAA5B,EAAgC;AAC/B,eAAO,KAAK,QAAL,CAAc,CAAd,CAAP;AACA;AACD;;AACD,WAAO,IAAP;AACA,GAPO;;AASA,6CAAR,UAAyB,GAAzB,EAAoC;AACnC,WAAO,KAAK,QAAL,CAAc,MAAd,CAAsB,UAAC,UAAD,EAAW;AAAK,uBAAU,CAAC,GAAX;AAAsB,KAA5D,CAAP;AACA,GAFO;;AAIA,6CAAR,UAAyB,IAAzB,EAAqC;AACpC,WAAO,KAAK,QAAL,CAAc,MAAd,CAAsB,UAAC,UAAD,EAAW;AAAK,uBAAU,CAAC,UAAX;AAA8B,KAApE,CAAP;AACA,GAFO;;AAIA,2CAAR;AACC,0BAAU,GAAV,CAAc,QAAd,CAAuB,KAAK,gBAA5B;AACA,SAAK,gBAAL,GAAwB,sBAAU,GAAV,CAAc,GAAd,CAAkB,KAAK,kBAAL,CAAwB,IAAxB,CAA6B,IAA7B,CAAlB,CAAxB;AACA,GAHO,CA7FT,CAkGC;AACA;;;AACQ,+CAAR,UAA2B,MAA3B,EAAiD;AAAtB;AAAA;AAAsB,MAEhD;;;AACA,QAAI,CAAC,KAAK,eAAV,EAA2B;AAC1B,WAAK,eAAL,GAAuB,IAAI,+BAAJ,CAA4B,MAAc,CAAC,gBAA3C,CAAvB;AACA;;AAED,SAAK,sBAAL,CAA4B,QAA5B;;AAEA,oBAAO,QAAP,CAAgB,wBAAW,eAA3B;AAEA,GAXO;;AAaA,mDAAR,UAA+B,MAA/B,EAA0C;AAA1C;;AAEC,QAAI,OAAO,GAAwB,MAAM,CAAC,gBAAP,CAAwB,+BAAxB,CAAnC;AAEA,WAAO,CAAC,OAAR,CAAgB,UAAC,aAAD,EAAuB;AAEtC,UAAI;AACH,aAAI,CAAC,aAAL,CAAmB,aAAnB;AACA,OAFD,CAEE,OAAO,CAAP,EAAU;AACX,eAAO,CAAC,GAAR,CAAY,0CAAZ,EAAwD,aAAxD,EAAuE,CAAvE;AACA;AAED,KARD;AASA,GAbO,CAjHT,CAgIC;AACA;AACA;;;AACQ,0CAAR,UAAsB,OAAtB,EAAsC;AAErC;AACA,QAAI,UAAU,GAAQ,sBAAU,SAAV,CAAoB,mBAApB,CAAwC,OAAxC,CAAtB,CAHqC,CAKrC;;AACA,QAAI,QAAQ,GAAW,KAAK,YAAL,CAAkB,UAAU,CAAC,CAA7B,CAAvB;;AACA,YAAQ,CAAC,UAAT,GAAsB,OAAtB;AACA,YAAQ,CAAC,EAAT,GAAc,OAAO,CAAC,YAAR,CAAqB,IAArB,CAAd;;AAEA,QAAI,UAAU,CAAC,OAAD,CAAd,EAAyB;AACxB,cAAQ,CAAC,GAAT,GAAe,UAAU,CAAC,OAAD,CAAzB;AACA;;AAED,0BAAU,SAAV,CAAoB,kBAApB,CAAuC,QAAvC,EAAiD,UAAjD,EAA6D,UAAU,CAAC,CAAxE;AACA,YAAQ,CAAC,UAAT,GAAsB,UAAU,CAAC,CAAjC;AACA,YAAQ,CAAC,MAAT,GAhBqC,CAkBrC;;AACA,YAAQ,CAAC,OAAT,GAAmB,IAAnB;AACA,0BAAU,GAAV,CAAc,YAAd,CAA2B,OAA3B,EAAoC,WAApC,EAAiD,MAAjD,EApBqC,CAsBrC;;AACA,SAAK,QAAL,CAAc,IAAd,CAAmB,QAAnB;AAEA,GAzBO;;AA2BA,sCAAR;AACC,0BAAU,GAAV,CAAc,QAAd,CAAuB,KAAK,WAA5B;AACA,SAAK,WAAL,GAAmB,sBAAU,GAAV,CAAc,GAAd,CAAkB,KAAK,MAAL,CAAY,IAAZ,CAAiB,IAAjB,CAAlB,CAAnB;AACA,GAHO;;AAKA,mCAAR;AAEC,QAAI,CAAC,GAAG,CAAR;;AAEA,WAAO,CAAC,GAAG,KAAK,QAAL,CAAc,MAAzB,EAAiC;AAEhC;AACA,UAAI,CAAC,KAAK,QAAL,CAAc,CAAd,EAAiB,SAAlB,IAA+B,KAAK,UAAL,CAAgB,KAAK,QAAL,CAAc,CAAd,CAAhB,CAAnC,EAAsE;AACrE,aAAK,cAAL,CAAoB,KAAK,QAAL,CAAc,CAAd,CAApB;AACA;;AAED,UAAI,KAAK,QAAL,CAAc,CAAd,EAAiB,SAArB,EAAgC;AAC/B,wBAAO,QAAP,CAAgB,wBAAW,eAA3B,EAA4C,KAAK,QAAL,CAAc,CAAd,EAAiB,EAA7D;;AACA,aAAK,QAAL,CAAc,MAAd,CAAqB,CAArB,EAAwB,CAAxB;AACA,OAHD,MAGO;AACN,SAAC;AACD;AAED;AAED,GApBO;;AAsBA,yCAAR,UAAqB,UAArB,EAAuC;AACtC,QAAI,SAAS,GAAW,sBAAU,MAAV,CAAiB,gBAAjB,CAAkC,UAAlC,CAAxB;AACA,WAAO,CAAC,GAAR,CAAY,WAAZ,EAAyB,SAAzB;AAEA,WAAO,KAAK,eAAL,CAAqB,WAArB,CAAiC,SAAjC,CAAP;AACA,GALO;;AAOA,uCAAR,UAAmB,cAAnB,EAAyC;AAExC,WAAQ,cAAc,CAAC,OAAf,IAA0B,CAAC,sBAAU,GAAV,CAAc,QAAd,CAAuB,cAAc,CAAC,UAAtC,CAAnC;AACA,GAHO;;AAKA,uCAAR,UAAmB,EAAnB,EAA+B,IAA/B,EAA8C;AAE7C,QAAI,MAAM,GAAG,KAAK,cAAL,CAAoB,EAApB,CAAb;;AACA,QAAI,CAAC,MAAL,EAAa;AACZ;AACA,KAL4C,CAM7C;;;AACA,QAAI,IAAI,KAAK,SAAS,CAAC,OAAvB,EAAgC;AAC/B,WAAK,cAAL,CAAoB,MAApB;AACA,KAFD,MAEO;AACN,WAAK,aAAL,CAAmB,MAAnB;AACA,KAX4C,CAa7C;;;AACA,SAAK,SAAL;AACA,GAfO;;AAiBA,wCAAR,UAAoB,GAApB,EAA+B;AAA/B;;AACC,SAAK,gBAAL,CAAsB,GAAtB,EAA2B,OAA3B,CAAoC,UAAC,IAAD,EAAK;AAAK,kBAAI,CAAC,cAAL;AAAyB,KAAvE;AACA,GAFO;;AAIA,0CAAR,UAAsB,cAAtB,EAA4C;AAE3C,QAAI,CAAC,cAAc,CAAC,UAApB,EAAgC;AAC/B;AACA;;AAED,kBAAc,CAAC,OAAf,GAAyB,IAAzB;AACA,0BAAU,GAAV,CAAc,aAAd,CAA4B,cAAc,CAAC,UAA3C;AACA,0BAAU,GAAV,CAAc,gBAAd,CAA+B,cAAc,CAAC,UAA9C,EAA0D,GAA1D;AACA,0BAAU,GAAV,CAAc,gBAAd,CAA+B,cAAc,CAAC,UAA9C,EAA0D,UAA1D;AACA,kBAAc,CAAC,UAAf,GAA4B,IAA5B;;AAEA,QAAI,CAAC,cAAc,CAAC,SAApB,EAA+B;AAC9B,WAAK,cAAL,CAAoB,cAApB;AACA;AAED,GAhBO;;AAkBA,2CAAR,UAAuB,cAAvB,EAA6C;AAC5C,WAAO,CAAC,GAAR,CAAY,gBAAZ,EAA8B,cAA9B;AACA,kBAAc,CAAC,OAAf;AACA,kBAAc,CAAC,MAAf,GAAwB,KAAxB;AACA,kBAAc,CAAC,UAAf,GAA4B,IAA5B;AACA,kBAAc,CAAC,SAAf,GAA2B,IAA3B;AACA,GANO;;AAQT;AAAC,CApPD;;AAAa;;AAsPb,IAAI,cAAc,MAAd,IAAwB,CAAC,QAAQ,CAAC,SAAT,CAAmB,OAAhD,EAAyD;AACrD,UAAQ,CAAC,SAAT,CAAmB,OAAnB,GAA6B,UAAU,QAAV,EAAoB,OAApB,EAA2B;AACtD,WAAO,GAAG,OAAO,IAAI,MAArB;;AACA,SAAK,IAAI,CAAC,GAAG,CAAb,EAAgB,CAAC,GAAG,KAAK,MAAzB,EAAiC,CAAC,EAAlC,EAAsC;AACpC,cAAQ,CAAC,IAAT,CAAc,OAAd,EAAuB,KAAK,CAAL,CAAvB,EAAgC,CAAhC,EAAmC,IAAnC;AACD;AACF,GALD;AAMD,C;;;;;;;;;;;;;;;;;;AC3QH;;AASA;AAAA;AAAA;AAAA;AAEQ,4BAA4B,IAA5B;AAEC,mBAAyB,EAAzB;AAgDR;;AA7CA,wBAAW,sBAAX,EAAW,mBAAX,EAA4B;SAA5B,aAA6B,OAA7B,EAAuD;AACtD,WAAK,kBAAL,GAA0B,OAA1B;AACA,KAF2B;oBAAA;;AAAA,GAA5B;;AAIO,+BAAP,UAAW,MAAX,EAAgC;AAC/B,SAAK,OAAL,GAAe,MAAf;AACA,GAFM;;AAIA,gCAAP;AACC,QAAI,KAAK,OAAL,CAAa,MAAjB,EAAyB;AACxB,WAAK,aAAL;AACA;AACD,GAJM;;AAMC,yCAAR;AAAA;;AAEC,QAAI,MAAM,GAAG,IAAI,MAAJ,CAAW,IAAX,CAAb;AAEA,QAAI,YAAY,GAAG,EAAnB;;mCAES,C,EAAC;AAET,UAAI,GAAG,GAAG,OAAK,OAAL,CAAa,CAAb,EAAgB,IAA1B;;AACA,UAAI,UAAU,GAAI,OAAK,kBAAL,CAAwB,GAAxB,CAA4B,OAAK,OAAL,CAAa,CAAb,EAAgB,UAA5C,CAAlB;;AACA,UAAI,IAAI,GAAI,OAAK,OAAL,CAAa,CAAb,EAAgB,QAAjB,GAA6B,OAAK,OAAL,CAAa,CAAb,EAAgB,QAA7C,GAAwD,MAAnE;;AAEA,kBAAY,CAAC,GAAD,CAAZ,GAAoB,UAAC,MAAD,EAAgB,KAAhB,EAA4B;AAA3B;AAAA;AAAa;;AAAE;AAAA;AAAY;;AAC/C,kBAAU,CAAC,IAAD,CAAV,CAAiB,MAAjB,EAD+C,CAE/C;;AACA,YAAK,KAAI,CAAC,gBAAV,EAA6B;AAC3B,gBAAc,CAAC,KAAf;AACD;AACD,OAND;AAQA,K;;;;AAdD,SAAK,IAAI,CAAC,GAAG,CAAb,EAAgB,CAAC,GAAG,KAAK,OAAL,CAAa,MAAjC,EAAyC,CAAC,EAA1C,EAA4C;cAAnC,C;AAcR;;AAEA,UAAc,CAAC,QAAf,CAAwB,UAAU,KAAV,EAAe;AACrC,aAAO,CAAC,GAAR,CAAY,qBAAZ;AACF,KAFA;AAIA,UAAc,CACb,EADD,CACI,YADJ,EAEC,OAFD;AAGD,GA7BO;;AA+BT;AAAC,CApDD;;AAAa,oC;;;;;;;;;;;;CCTb;AACA;;;;;;AAaA;AAAA;AAAA;AAAA;AAES,mBAAwB,EAAxB,CAFT,CAEuC;;AAC9B,iBAAa,EAAb,CAHT,CAG+B;AAsE9B;;AAnEA,wBAAW,sBAAX,EAAW,MAAX,EAAe;AADf;SACA;AACC,aAAO,KAAK,KAAZ;AACA,KAFc;oBAAA;;AAAA,GAAf;;AAIO,+BAAP,UAAW,EAAX,EAAuB,KAAvB,EAAiC;AAChC,WAAO,IAAP;AACA,WAAO,KAAK,QAAL,CAAc,EAAd,EAAkB,QAAlB,CAA2B,KAA3B,CAAP;AACA,GAHM;;AAKA,+BAAP,UAAW,EAAX,EAAqB;AACpB,WAAO,IAAP;AACA,WAAO,KAAK,QAAL,CAAc,EAAd,EAAkB,QAAlB,EAAP;AACA,GAHM;;AAKA,oCAAP,aACC;AACA,GAFM;;AAIA,sCAAP,aACC;AACA,GAFM;;AAIA,gCAAP,UAAY,EAAZ,EAAwB,OAAxB,EAA0C,gBAA1C,EAAmE;AAClE,SAAK,QAAL,CAAc,EAAd,EAAkB,IAAlB,CAAuB,OAAvB,EAAgC,gBAAhC;AACA,GAFM,CA5BR,CAgCC;AACA;AACA;AACA;AACA;;;AAEQ,oCAAR,UAAiB,EAAjB,EAAmB;AAElB,SAAK,IAAI,CAAC,GAAG,CAAb,EAAgB,CAAC,GAAG,KAAK,OAAL,CAAa,MAAjC,EAAyC,CAAC,EAA1C,EAA8C;AAC7C,UAAI,KAAK,OAAL,CAAa,CAAb,EAAgB,MAAhB,CAAuB,EAAvB,KAA8B,EAAlC,EAAsC;AACrC,eAAO,KAAK,OAAL,CAAa,CAAb,CAAP;AACA;AACD;;AAED,WAAO,KAAK,YAAL,CAAkB,EAAlB,CAAP;AAEA,GAVO,CAtCT,CAkDC;AACA;;AACA;;;;;;;;;;;;;;;;AAgBQ,wCAAR,UAAqB,EAArB,EAA+B;AAC9B,SAAK,KAAL,CAAW,EAAX,IAAiB,KAAK,OAAL,CAAa,KAAK,OAAL,CAAa,MAAb,GAAsB,CAAnC,CAAjB;AACA,WAAO,KAAK,KAAL,CAAW,EAAX,CAAP;AACA,GAHO;;AAKT;AAAC,CAzED;;AAAa,oC;;;;;;;;;;;;;;;;;;ACdb;AAAA;AAAA;AAAA,iBAIC;;AAHc,aAAd,UAAoB,aAApB,EAA2C,WAA3C,EAAgE,UAAhE,EAA2F,UAA3F,EAAiH;AAAjD;AAAA;AAAyB;;AAAE;AAAA;AAAsB;;AAC/G,UAAc,CAAC,EAAf,CAAkB,MAAlB,EAA0B,OAA1B,EAAmC,aAAnC,EAAkD,WAAlD,EAA+D,UAA/D,EAA2E,UAA3E;AACD,GAFa;;AAGf;AAAC,CAJD;;AAAa,gB;;;;;;;;;;;;;;;;;;ACAb;;AACA;;AASA,IAAY,QAAZ;;AAAA,WAAY,QAAZ,EAAoB;AAAE;AAAG;AAAE,CAA3B,EAAY,QAAQ,GAAR,wCAAQ,EAAR,CAAZ;;AAEA;AAAA;AAAA;AAsCC,2BAAa,KAAb,EAAmC,IAAnC,EAA0D,UAA1D,EAAyF,IAAzF,EAA+G,OAA/G,EAAsI;AAAnG;AAAA;AAAqB;;AAAE;AAAA;AAAsB;;AAAS;AAAA;AAAoB;;AAAE;AAAA;AAAuB;;AAAnG;AAAsD;AApClF,qBAAoB,IAApB;AACA,4BAA2B,IAA3B;AAKA,gBAAiB,QAAQ,CAAC,CAA1B,CA8B+H,CA7BtI;;AACO,qBAAqB,IAArB;AAEC,mBAAmB,KAAnB;AACA,qBAAoB,CAApB;AACA,2BAA0B,CAA1B;AACA,wBAAkC,EAAlC;AAEA,4BAA2B,CAA3B;AAIA,sBAAqB,EAArB;AAEA,yBAAwB,IAAxB,CAe8H,CAf5F;;AAClC,4BAA2B,IAA3B,CAc8H,CAdzF;;AACrC,kCAAiC,IAAjC,CAa8H,CAbrF;;AACzC,2BAA0B,IAA1B;AACA,+BAA+B,KAA/B;AAEA,+BAA2B;AAAC,SAAG,EAAE,CAAN;AAAS,SAAG,EAAE;AAAd,KAA3B;AACA,wBAAoB;AAAC,SAAG,EAAE,CAAN;AAAS,SAAG,EAAE;AAAd,KAApB;AASP,SAAK,gBAAL,GAAwB,MAAM,KAA9B;AACA,SAAK,gBAAL,GAAwB,UAAxB;;AACA,SAAK,kBAAL,CAAwB,KAAxB;;AACA,SAAK,eAAL,CAAqB,OAArB;AACA;;AAEM,wCAAP,UAAiB,MAAjB,EAAgC;AAE/B,QAAI,CAAC,KAAK,OAAN,IAAiB,MAArB,EAA6B;AAC5B,YAAM,CAAC,qBAAP,CAA6B,KAAK,KAAL,CAAW,IAAX,CAAgB,IAAhB,CAA7B;AACA;;AAED,SAAK,OAAL,GAAe,MAAf;;AACA,SAAK,YAAL,CAAkB,SAAlB,CAA4B,KAAK,OAAjC;AAEA,GATM;AAWP;;;AACO,8CAAP,UAAuB,KAAvB,EAAoC;AACnC,SAAK,aAAL,GAAqB,KAArB;AACA,GAFM;AAIP;;;AACO,iDAAP,UAA0B,KAA1B,EAAuC;AACtC,SAAK,gBAAL,GAAwB,KAAxB;AACA,GAFM;AAIP;;;AACO,6CAAP,UAAsB,GAAtB,EAAuC,GAAvC,EAAsD;AAAhC;AAAA;AAAe;;AAAE;AAAA;AAAe;;AACrD,SAAK,mBAAL,GAA2B;AAC1B,SAAG,EAAE,GADqB;AAE1B,SAAG,EAAE;AAFqB,KAA3B;AAIA,GALM,CAnER,CA0EC;;;AACO,0CAAP,UAAmB,KAAnB,EAAgC;AAC/B,SAAK,gBAAL,GAAwB,CAAxB,CAD+B,CAE/B;;AACA,SAAK,SAAL,GAAiB,KAAK,eAAL,GAAuB,KAAxC;AACA,GAJM,CA3ER,CAiFC;;;AACO,wCAAP,UAAiB,KAAjB,EAA8B;AAC7B;AACA,SAAK,eAAL,GAAuB,KAAvB;AACA,GAHM,CAlFR,CAuFC;;;AACO,uCAAP,UAAgB,KAAhB,EAA6B;AAC5B,SAAK,KAAL,CAAW,KAAX,EAAkB,KAAlB;AACA,GAFM,CAxFR,CA4FC;;;AACO,gDAAP,UAAyB,SAAzB,EAA0C;AACzC,SAAK,mBAAL,GAA2B,SAA3B;AACA,SAAK,kBAAL,GAA2B,KAAK,mBAAL,GAA2B,CAAtD;AACA,GAHM,CA7FR,CAkGC;;;AACQ,iDAAR,UAA2B,KAA3B,EAAwC;AACvC,QAAI,KAAK,IAAT,EAAe;AACd,WAAK,sBAAL,CAA4B,KAA5B;AACA,KAFD,MAEO;AACN,WAAK,yBAAL,CAA+B,KAA/B;AACA;AAED,GAPO;;AASA,qDAAR,UAA+B,KAA/B,EAA4C;AAE3C,QAAI,KAAJ,EAAW,KAAX,EAAkB,KAAlB;AACA,SAAK,GAAG,GAAR,CAH2C,CAI3C;;AAEA,SAAK,IAAI,CAAC,GAAG,CAAb,EAAgB,CAAC,GAAG,KAApB,EAA2B,CAAC,EAA5B,EAAgC;AAE/B,WAAK,YAAL,CAAkB,IAAlB,CAAuB;AACtB,aAAK,EAAE,KADe;AAEtB,aAAK,EAAE,KAAK,GAAI,KAAK,gBAAL,GAAwB,CAFlB;AAGtB,aAAK,EAAE,KAAK,GAAI,KAAK,gBAAL,GAAwB;AAHlB,OAAvB;;AAMA,WAAK,IAAI,KAAK,gBAAd;AACA;;AAED,SAAK,YAAL,CAAkB,IAAlB,CAAuB;AACrB,WAAK,EAAE,GADc;AAErB,WAAK,EAAE,MAAO,KAAK,gBAAL,GAAwB,CAFjB;AAGrB,WAAK,EAAE,MAAO,KAAK,gBAAL,GAAwB;AAHjB,KAAvB;AAMA,GAvBO;;AAyBA,wDAAR,UAAkC,KAAlC,EAA+C;AAE9C,QAAI,KAAJ,EAAW,KAAX,EAAkB,KAAlB;;AAEA,SAAK,IAAI,CAAC,GAAG,CAAb,EAAgB,CAAC,GAAG,KAApB,EAA2B,CAAC,EAA5B,EAAgC;AAE/B,UAAI,CAAC,KAAK,CAAV,EAAa;AACZ,aAAK,GAAG,CAAR;AACA,aAAK,GAAG,CAAR;AACA,aAAK,GAAG,KAAK,gBAAb;AACA,OAJD,MAIO,IAAK,CAAC,KAAK,KAAK,GAAG,CAAnB,EAAsB;AAC5B,aAAK,GAAG,GAAR;AACA,aAAK,GAAG,MAAM,KAAK,gBAAnB;AACA,aAAK,GAAG,GAAR;AACA,OAJM,MAIA;AACN,aAAK,GAAK,CAAC,GAAG,KAAK,gBAAV,GAA+B,KAAK,gBAAL,GAAwB,CAAhE;AACA,aAAK,GAAG,KAAK,GAAI,KAAK,gBAAL,GAAwB,CAAzC;AACA,aAAK,GAAG,KAAK,GAAI,KAAK,gBAAL,GAAwB,CAAzC;AACA;;AAED,WAAK,YAAL,CAAkB,IAAlB,CAAuB;AACtB,aAAK,EAAE,KADe;AAEtB,aAAK,EAAE,KAFe;AAGtB,aAAK,EAAE;AAHe,OAAvB;AAMA;AAED,GA5BO;;AA8BA,8CAAR,UAAwB,OAAxB,EAA+C;AAAvB;AAAA;AAAuB;;AAC9C,SAAK,YAAL,GAAoB,IAAI,yBAAJ,CAAgB,OAAhB,CAApB,CAD8C,CAE9C;;AACA,SAAK,YAAL,CAAkB,QAAlB,GAA6B,IAA7B;AACA,SAAK,YAAL,CAAkB,aAAlB,GAAkC,EAAlC;AACA,SAAK,YAAL,CAAkB,gBAAlB,GAAqC,KAArC;AACA,SAAK,YAAL,CAAkB,OAAlB,GAA4B,KAAK,mBAAL,CAAyB,IAAzB,CAA8B,IAA9B,CAA5B;AACA,SAAK,YAAL,CAAkB,MAAlB,GAA2B,KAAK,kBAAL,CAAwB,IAAxB,CAA6B,IAA7B,CAA3B;AACA,SAAK,YAAL,CAAkB,SAAlB,GAA8B,KAAK,qBAAL,CAA2B,IAA3B,CAAgC,IAAhC,CAA9B;AAEA,GAVO;;AAYA,kDAAR;AAEC,QAAI,CAAC,KAAK,OAAV,EAAmB;AAClB;AACA;;AAED,SAAK,iBAAL,GAAyB,KAAzB;AACA,SAAK,eAAL,GAAuB,CAAvB;;AACA,SAAK,mBAAL;;AACA,SAAK,WAAL;AACA,GAVO;;AAYA,iDAAR,UAA2B,YAA3B,EAA8C;AAE7C,QAAI,CAAC,KAAK,OAAV,EAAmB;AAClB;AACA,KAJ4C,CAM7C;;;AACA,SAAK,UAAL,GAAkB,KAAK,SAAvB;;AACA,QAAI,aAAa,GAAW,CAAC,CAAD,GAAK,KAAK,aAAL,CAAmB,YAAnB,CAAjC,CAR6C,CAU7C;;;AACA,QAAI,KAAK,kBAAL,IAA2B,CAAC,KAAK,iBAArC,EAAwD;AAEvD,WAAK,eAAL,IAAwB,aAAxB,CAFuD,CAIvD;;AACA,UAAK,IAAI,CAAC,GAAL,CAAU,KAAK,eAAf,IAAmC,KAAK,mBAA7C,EAAkE;AACjE;AACA,OAPsD,CASvD;AACA;;;AACA,WAAK,iBAAL,GAAyB,IAAzB;AAEA;;AAED,SAAK,iBAAL,CAAuB,aAAvB;AAEA,GA5BO;;AA8BA,gDAAR,UAA0B,aAA1B,EAA+C;AAE9C,SAAK,eAAL,GAAuB,sBAAU,IAAV,CAAe,SAAf,CACtB,KAAK,eAAL,GAAuB,aADD,EAEtB,KAAK,YAAL,CAAkB,GAFI,EAGtB,KAAK,YAAL,CAAkB,GAHI,CAAvB;AAMA,GARO,CAzNT,CAmOC;;;AACQ,oCAAR;AAEC;AACA,QAAI,CAAC,KAAK,SAAV,EAAqB;AACpB,WAAK,SAAL,GAAiB,KAAK,SAAL,GAAkB,CAAC,KAAK,eAAL,GAAuB,KAAK,SAA7B,IAA2C,KAAK,UAAnF;AACA,KALF,CAOC;;;AACA,QAAI,CAAC,KAAK,SAAV,EAAqB;AAEpB,UAAI,mBAAmB,GAAW,KAAK,cAAL,CAAoB,KAAK,SAAzB,CAAlC;;AACA,UAAI,mBAAmB,KAAK,KAAK,gBAAjC,EAAmD;AAElD,aAAK,gBAAL,GAAwB,mBAAxB;;AAEA,YAAI,KAAK,SAAT,EAAoB;AACnB,eAAK,YAAL,CAAkB,SAAlB;;AACA,eAAK,KAAL,CAAW,KAAK,gBAAhB;AACA;AAED;AACD;;AAED,SAAK,MAAL,CAAY,KAAK,SAAjB;;AAEA,QAAI,KAAK,mBAAT,EAA8B;AAC7B,WAAK,mBAAL;AACA;;AAED,QAAI,KAAK,OAAT,EAAkB;AACjB,YAAM,CAAC,qBAAP,CAA6B,KAAK,KAAL,CAAW,IAAX,CAAgB,IAAhB,CAA7B;AACA;AAED,GAjCO,CApOT,CAuQC;;;AACQ,oDAAR,UAA8B,gBAA9B,EAAqD;AAArD;;AAEC,SAAK,mBAAL,GAA2B,KAA3B;;AACA,SAAK,eAAL;;AACA,SAAK,UAAL;;AAEA,QAAI,KAAK,UAAT,EAAqB;AACpB,WAAK,UAAL;AACA;;AAED,QAAI,CAAC,KAAK,IAAV,EAAgB;AACf,gBAAU,CAAC;AAAM,oBAAI,CAAC,YAAL,CAAkB,SAAlB;AAAiC,OAAxC,EAA0C,GAA1C,CAAV;AACA,gBAAU,CAAC;AAAM,oBAAI,CAAC,SAAL;AAAsB,OAA7B,EAA+B,GAA/B,CAAV;AACA;AACA;;AAED,QAAI,aAAa,GAAG,KAAK,aAAL,CAAmB,gBAAnB,CAApB;;AACA,QAAI,aAAa,GAAY,sBAAU,IAAV,CAAe,SAAf,CAAyB,KAAK,eAAL,GAAuB,aAAhD,EAA+D,CAA/D,EAAkE,CAAlE,CAA7B;;AAEA,QAAI,mBAAmB,GAAW,KAAK,cAAL,CAAoB,aAApB,CAAlC;;AACA,QAAI,mBAAmB,GAAG,KAAK,gBAA/B,EAAiD;AAChD,yBAAmB,GAAG,KAAK,gBAAL,GAAwB,CAA9C;AACA,KAFD,MAEO,IAAI,mBAAmB,GAAI,KAAK,gBAAhC,EAAkD;AACxD,yBAAmB,GAAG,KAAK,gBAAL,GAAwB,CAA9C;AACA;;AAED,SAAK,KAAL,CAAW,mBAAX;AAEA,GA5BO;AA8BR;;;AACQ,4CAAR,UAAsB,KAAtB,EAAkC;AACjC,QAAI,QAAQ,GAAI,KAAK,IAAL,KAAc,QAAQ,CAAC,CAAxB,GAA6B,KAAK,CAAC,CAAnC,GAAuC,KAAK,CAAC,CAA5D;AACA,WAAQ,QAAQ,IAAI,KAAK,aAAL,GAAqB,KAAK,gBAA9B,CAAhB;AACA,GAHO;AAKR;;;AACQ,oCAAR,UAAc,SAAd,EAAiC,cAAjC,EAAgE;AAAhE;;AAAiC;AAAA;AAA+B;;AAE/D,QAAI,CAAC,KAAK,OAAV,EAAmB;AAClB;AACA;;AAED,SAAK,SAAL,GAAiB,IAAjB;AACA,SAAK,UAAL,GAAkB,KAAK,gBAAvB;AACA,SAAK,gBAAL,GAAwB,SAAxB;AACA,SAAK,eAAL,GAAuB,KAAK,YAAL,CAAkB,KAAK,gBAAvB,EAAyC,KAAhE;;AAEA,QAAI,cAAJ,EAAoB;AACnB,WAAK,MAAL,CAAa,KAAK,gBAAlB;AACA;;AAED,cAAU,CAAC;AAAM,kBAAI,CAAC,YAAL,CAAkB,SAAlB;AAAiC,KAAxC,EAA0C,GAA1C,CAAV;AACA,cAAU,CAAC;AAAM,kBAAI,CAAC,SAAL;AAAsB,KAA7B,EAA+B,GAA/B,CAAV;AAEA,GAlBO,CA7ST,CAiUC;;;AACQ,6CAAR,UAAuB,KAAvB,EAAoC;AACnC,SAAK,IAAI,CAAC,GAAG,CAAb,EAAgB,CAAC,GAAG,KAAK,YAAL,CAAkB,MAAtC,EAA8C,CAAC,EAA/C,EAAmD;AAClD,UAAI,KAAK,IAAI,KAAK,YAAL,CAAkB,CAAlB,EAAqB,KAA9B,IAAwC,KAAK,IAAI,KAAK,YAAL,CAAkB,CAAlB,EAAqB,KAA1E,EAAiF;AAChF,eAAO,CAAP;AACA;AACD;AACD,GANO;AAQR;;;AACQ,kDAAR;AACC,QAAI,KAAK,GAAG,KAAK,mBAAL,CAAyB,GAAzB,GAA+B,KAAK,sBAAhD;AACA,QAAI,KAAK,GAAG,KAAK,mBAAL,CAAyB,GAAzB,GAA+B,KAAK,sBAAhD;AACA,SAAK,mBAAL,GAA4B,KAAK,SAAL,GAAiB,KAAjB,IAA0B,KAAK,SAAL,GAAiB,KAAvE;;AACA,SAAK,eAAL;AACA,GALO;AAOR;;;AACQ,8CAAR;AAEC,QAAI,KAAK,mBAAT,EAA8B;AAC7B,WAAK,YAAL,CAAkB,GAAlB,GAAwB,KAAK,mBAAL,CAAyB,GAAzB,GAA+B,KAAK,eAA5D;AACA,WAAK,YAAL,CAAkB,GAAlB,GAAwB,KAAK,mBAAL,CAAyB,GAAzB,GAA+B,KAAK,eAA5D;AACA;AACA;;AAED,SAAK,YAAL,CAAkB,GAAlB,GAAwB,KAAK,mBAAL,CAAyB,GAAjD;AACA,SAAK,YAAL,CAAkB,GAAlB,GAAwB,KAAK,mBAAL,CAAyB,GAAjD;AAEA,GAXO;AAaR;;;AACQ,yCAAR;AACG,SAAK,eAAL,GAAwB,sBAAU,IAAV,CAAe,SAAf,CAAyB,KAAK,eAA9B,EAA+C,KAAK,YAAL,CAAkB,GAAjE,EAAsE,KAAK,YAAL,CAAkB,GAAxF,CAAxB;AACF,GAFO;;AAIT;AAAC,CArWD;;AAAa,0C;;;;;;;;;;;;;;;;ICZb;;AACA,sG,CAEA;AACA;AACA;;;AAEA,IAAM,cAAc,GAAG,IAAvB;;AAOA;AAAA;AAAA;AAyBI,uBAAY,OAAZ,EAAmD;AAvB5C,4BAA6B,IAA7B;AACA,oBAAmB,IAAnB;AACA,gBAAe,MAAf;AACA,oBAAoB,KAApB;AACA,yBAAwB,EAAxB;AACA,4BAA4B,IAA5B;AACA,mBAAoB,IAApB;AACA,kBAAmB,IAAnB;AACA,qBAAsB,IAAtB;AAEC,mBAAmB,KAAnB;AACA,qBAAqB,KAArB;AAaN,SAAK,OAAL,GAAe,KAAf,CADiD,CAEjD;;AACA,SAAK,UAAL,GAAmB,OAAO,IAAI,MAA9B,CAHiD,CAIjD;;AACA,SAAK,QAAL,GAAgB;AAAE,OAAC,EAAE,CAAL;AAAQ,OAAC,EAAE;AAAX,KAAhB;AACA,SAAK,QAAL,GAAgB;AAAE,OAAC,EAAE,CAAL;AAAQ,OAAC,EAAE;AAAX,KAAhB;AACA,SAAK,KAAL,GAAa;AAAE,OAAC,EAAE,CAAL;AAAQ,OAAC,EAAE;AAAX,KAAb;AACA,SAAK,QAAL,GAAgB;AAAE,OAAC,EAAE,CAAL;AAAQ,OAAC,EAAE;AAAX,KAAhB;AACA,SAAK,QAAL,GAAgB,KAAhB;;AACA,SAAK,UAAL;;AACA,SAAK,KAAL;AACD;;AAGI,oCAAP,UAAiB,MAAjB,EAAgC;AAC9B,QAAI,CAAC,KAAK,OAAN,IAAiB,MAArB,EAA6B;AAC3B,WAAK,OAAL,GAAe,IAAf;AACA,2BAAqB,CAAC,KAAK,KAAL,CAAW,IAAX,CAAgB,IAAhB,CAAD,CAArB;AACD;;AACD,SAAK,OAAL,GAAe,MAAf;AACD,GANM;;AAQA,oCAAP;AACE,SAAK,QAAL,GAAgB,KAAK,OAAL,GAAe,KAA/B;AACA,SAAK,SAAL,GAAkB,IAAlB;AACD,GAHM;;AAKC,qCAAR;AAAA;;AAEE,SAAK,UAAL,CAAgB,gBAAhB,CAAiC,WAAjC,EAA8C,UAAC,CAAD,EAAE;AAE7C,UAAI,CAAC,KAAI,CAAC,OAAV,EAAmB;AAChB;AACH;;AAED,WAAI,CAAC,SAAL,GAAiB,KAAjB;AACA,WAAI,CAAC,QAAL,CAAc,CAAd,GAAkB,KAAI,CAAC,QAAL,CAAc,CAAd,GAAkB,KAAI,CAAC,KAAL,CAAW,CAAX,GAAe,CAAC,CAAC,KAArD;AACA,WAAI,CAAC,QAAL,CAAc,CAAd,GAAkB,KAAI,CAAC,QAAL,CAAc,CAAd,GAAkB,KAAI,CAAC,KAAL,CAAW,CAAX,GAAe,CAAC,CAAC,KAArD;AACA,WAAI,CAAC,QAAL,GAAgB,IAAhB;;AAEA,UAAI,KAAI,CAAC,OAAT,EAAkB;AACd,aAAI,CAAC,OAAL;AACH;AAEF,KAfD;AAiBA,SAAK,UAAL,CAAgB,gBAAhB,CAAiC,YAAjC,EAA+C,UAAC,CAAD,EAAc;AAC1D,UAAI,CAAC,KAAI,CAAC,OAAV,EAAmB;AAChB;AACH;;AAGD,WAAI,CAAC,SAAL,GAAiB,KAAjB;AACA,WAAI,CAAC,QAAL,CAAc,CAAd,GAAkB,KAAI,CAAC,QAAL,CAAc,CAAd,GAAkB,KAAI,CAAC,KAAL,CAAW,CAAX,GAAe,CAAC,CAAC,OAAF,CAAU,CAAV,EAAa,KAAhE;AACA,WAAI,CAAC,QAAL,CAAc,CAAd,GAAkB,KAAI,CAAC,QAAL,CAAc,CAAd,GAAkB,KAAI,CAAC,KAAL,CAAW,CAAX,GAAe,CAAC,CAAC,OAAF,CAAU,CAAV,EAAa,KAAhE;AACA,WAAI,CAAC,QAAL,GAAgB,IAAhB;;AAEA,UAAI,KAAI,CAAC,OAAT,EAAkB;AACd,aAAI,CAAC,OAAL;AACH;AACF,KAdD;AAgBC,SAAK,UAAL,CAAgB,gBAAhB,CAAiC,WAAjC,EAA8C,UAAC,CAAD,EAAE;AAE/C,UAAI,CAAC,KAAI,CAAC,OAAN,IAAiB,KAAI,CAAC,SAA1B,EAAqC;AACjC;AACH;;AAED,WAAI,CAAC,KAAL,CAAW,CAAX,GAAe,CAAC,CAAC,OAAF,CAAU,CAAV,EAAa,OAA5B;AACA,WAAI,CAAC,KAAL,CAAW,CAAX,GAAe,CAAC,CAAC,OAAF,CAAU,CAAV,EAAa,OAA5B;AAGD,KAVA,EAnCH,CA+CC;;AACA,oBAAO,EAAP,CAAU,SAAV,EAAqB,MAArB,EAA6B;AAE1B,UAAI,CAAC,KAAI,CAAC,OAAN,IAAkB,KAAI,CAAC,SAA3B,EAAsC;AAClC;AACH;;AACD,WAAI,CAAC,QAAL,GAAgB,KAAhB;;AACA,UAAI,cAAc,GAAU,KAAI,CAAC,cAAL,EAA5B;;AAEA,UAAI,KAAI,CAAC,SAAT,EAAoB;AAClB,aAAI,CAAC,SAAL,CAAe,cAAf;AACD;;AACD,UAAI,KAAI,CAAC,gBAAT,EAA2B;AACzB,aAAI,CAAC,OAAL,GAAe,KAAf;AACD;AAEF,KAfF;AAiBC,oBAAO,EAAP,CAAU,UAAV,EAAsB,MAAtB,EAA8B;AAE5B,UAAI,CAAC,KAAI,CAAC,OAAN,IAAkB,KAAI,CAAC,SAA3B,EAAsC;AAClC;AACH;;AACD,WAAI,CAAC,QAAL,GAAgB,KAAhB;AACA,UAAI,cAAc,GAAU;AAAC,SAAC,EAAE,CAAJ;AAAO,SAAC,EAAE;AAAV,OAA5B;;AAEA,UAAI,KAAI,CAAC,SAAT,EAAoB;AAClB,aAAI,CAAC,SAAL,CAAe,cAAf;AACD;;AACD,UAAI,KAAI,CAAC,gBAAT,EAA2B;AACzB,aAAI,CAAC,OAAL,GAAe,KAAf;AACD;AAEF,KAfD;AAiBA,oBAAO,EAAP,CAAU,WAAV,EAAuB,MAAvB,EAA+B,UAAC,KAAD,EAAW;AACxC,UAAI,CAAC,KAAI,CAAC,OAAN,IAAiB,KAAI,CAAC,SAA1B,EAAqC;AACjC;AACH;;AACD,WAAI,CAAC,KAAL,CAAW,CAAX,GAAe,KAAK,CAAC,OAArB;AACA,WAAI,CAAC,KAAL,CAAW,CAAX,GAAe,KAAK,CAAC,OAArB;AACD,KAND;AAQD,GA1FO;;AA4FE,gCAAR;AAEE,QAAI,KAAK,OAAT,EAAkB;AACd,2BAAqB,CAAC,KAAK,KAAL,CAAW,IAAX,CAAgB,IAAhB,CAAD,CAArB;AACH;;AAED,QAAI,CAAC,KAAK,OAAN,IAAkB,KAAK,SAA3B,EAAsC;AACpC;AACD;;AAEH,QAAI,KAAK,QAAT,EAAmB;AAEjB,WAAK,QAAL,CAAc,CAAd,GAAkB,KAAK,QAAL,CAAc,CAAhC;AACA,WAAK,QAAL,CAAc,CAAd,GAAkB,KAAK,QAAL,CAAc,CAAhC;AAEA,WAAK,QAAL,CAAc,CAAd,GAAkB,KAAK,KAAL,CAAW,CAA7B;AACA,WAAK,QAAL,CAAc,CAAd,GAAkB,KAAK,KAAL,CAAW,CAA7B;AAEA,WAAK,QAAL,CAAc,CAAd,GAAmB,KAAK,QAAL,CAAc,CAAd,GAAkB,KAAK,QAAL,CAAc,CAAnD;AACA,WAAK,QAAL,CAAc,CAAd,GAAmB,KAAK,QAAL,CAAc,CAAd,GAAkB,KAAK,QAAL,CAAc,CAAnD;AAED,KAXD,MAWO;AAEL,WAAK,QAAL,CAAc,CAAd,IAAmB,KAAK,QAAL,CAAc,CAAjC;AACA,WAAK,QAAL,CAAc,CAAd,IAAmB,KAAK,QAAL,CAAc,CAAjC;AAEA,WAAK,QAAL,CAAc,CAAd,IAAmB,KAAK,QAAxB;AACA,WAAK,QAAL,CAAc,CAAd,IAAmB,KAAK,QAAxB;AAED;;AAED,SAAK,SAAL,GAAiB,IAAjB;;AAEA,QAAI,KAAK,QAAL,CAAc,CAAd,KAAoB,CAApB,IAAyB,KAAK,QAAL,CAAc,CAAd,KAAoB,CAAjD,EAAoD;AACjD,WAAK,SAAL,GAAiB,KAAjB;AACF,KAFD,MAEO,IAAI,CAAC,KAAK,QAAN,IAAkB,CAAC,KAAK,gBAA5B,EAA8C;AAClD,WAAK,SAAL,GAAiB,KAAjB;AACF;;AAID,QAAI,KAAK,SAAT,EAAoB;AAClB,WAAK,MAAL,CAAY;AACV,SAAC,EAAE,KAAK,QAAL,CAAc,CADP;AAEV,SAAC,EAAE,KAAK,QAAL,CAAc;AAFP,OAAZ;AAID;AAEF,GAhDS,CAjJZ,CAmME;;;AACQ,yCAAR;AAEI,QAAI,CAAC,KAAK,QAAN,IAAkB,KAAK,aAAL,KAAuB,CAA7C,EAAgD;AAC9C,aAAO;AAAC,SAAC,EAAE,CAAJ;AAAO,SAAC,EAAE;AAAV,OAAP;AACD;;AAED,QAAI,YAAY,GAAU;AAAC,OAAC,EAAE,CAAJ;AAAO,OAAC,EAAE;AAAV,KAA1B;AACA,QAAI,YAAY,GAAU;AAAC,OAAC,EAAE,KAAK,QAAL,CAAc,CAAlB;AAAqB,OAAC,EAAE,KAAK,QAAL,CAAc;AAAtC,KAA1B;;AAEA,SAAK,IAAI,CAAC,GAAG,CAAb,EAAgB,CAAC,GAAG,KAAK,aAAzB,EAAwC,CAAC,EAAzC,EAA6C;AAC1C,kBAAY,CAAC,CAAb,IAAkB,YAAY,CAAC,CAA/B;AACA,kBAAY,CAAC,CAAb,IAAkB,YAAY,CAAC,CAA/B;AACA,kBAAY,CAAC,CAAb,IAAkB,KAAK,QAAvB;AACA,kBAAY,CAAC,CAAb,IAAkB,KAAK,QAAvB;AACF;;AAEA,WAAO,YAAP;AAEJ,GAlBO;;AA7KiB,qBAAe,MAAf;AAiM3B;AAAC,CAxND;;AAAa,kC;;;;;;;;;;;;;;;;;;ACdb,iG,CAEA;;;AACA;;AACA;;AACA;;AACA;;AACA;;AACA;;AACA;;AACA;;AACA;;AACA;;AACA;;AACA;;AACA;;AAEA,qE,CAEA;AACA;AACA;AACA;;;AAEA,sBAAU,UAAV,CAAqB,GAArB,EACC;AACA;AAAC,UAAQ,EAAE,IAAI,+BAAJ,CAAmB,MAAnB,CAAX;AAAuC,QAAM,EAAE;AAA/C,CAFD,EAGC;AAAC,UAAQ,EAAE,IAAI,6BAAJ,CAAkB,KAAlB,CAAX;AAAqC,QAAM,EAAE;AAA7C,CAHD,EAIC;AAAC,UAAQ,EAAE,IAAI,qCAAJ,CAAsB,SAAtB,CAAX;AAA6C,QAAM,EAAE,IAArD;AAA2D,UAAQ,EAAE;AAArE,CAJD,EAKC;AAAC,UAAQ,EAAE,IAAI,2BAAJ,CAAiB,IAAjB,CAAX;AAAmC,QAAM,EAAE,IAA3C;AAAiD,UAAQ,EAAE;AAA3D,CALD,EAMC;AAAC,UAAQ,EAAE,IAAI,qCAAJ,CAAsB,SAAtB,CAAX;AAA6C,QAAM,EAAE,IAArD;AAA2D,UAAQ,EAAE;AAArE,CAND,EAOC;AAAC,UAAQ,EAAE,IAAI,qCAAJ,CAAsB,SAAtB,CAAX;AAA6C,QAAM,EAAE;AAArD,CAPD,EAQC;AAAC,UAAQ,EAAE,IAAI,iCAAJ,CAAoB,OAApB,CAAX;AAAyC,QAAM,EAAE,IAAjD;AAAuD,UAAQ,EAAE;AAAjE,CARD,EASC;AAAC,UAAQ,EAAE,IAAI,yCAAJ,CAAwB,WAAxB,CAAX;AAAiD,QAAM,EAAE,IAAzD;AAA+D,UAAQ,EAAE;AAAzE,CATD,EAUC;AAAC,UAAQ,EAAE,IAAI,2CAAJ,CAAyB,YAAzB,CAAX;AAAmD,QAAM,EAAE;AAA3D,CAVD,EAWC;AACA;AAAC,UAAQ,EAAE,IAAI,+BAAJ,CAAmB,MAAnB,CAAX;AAAuC,UAAQ,EAAE;AAAjD,CAZD,EAaC;AAAC,UAAQ,EAAE,IAAI,+BAAJ,CAAmB,SAAnB,CAAX;AAA0C,UAAQ,EAAE;AAApD,CAbD,EAcC;AAAC,UAAQ,EAAE,IAAI,+BAAJ,CAAmB,QAAnB,CAAX;AAAyC,UAAQ,EAAE;AAAnD,CAdD,EAeC;AAAC,UAAQ,EAAE,IAAI,qCAAJ,CAAsB,SAAtB,CAAX;AAA6C,UAAQ,EAAE;AAAvD,CAfD,EAgBC;AAAC,UAAQ,EAAE,IAAI,+BAAJ,CAAmB,MAAnB,CAAX;AAAuC,UAAQ,EAAE;AAAjD,CAhBD;AAmBA,sBAAU,KAAV,CAAgB,GAAhB,CAAoB,CACnB;AAAC,MAAI,EAAE,GAAP;AAAY,YAAU,EAAE;AAAxB,CADmB,EAEnB;AAAC,MAAI,EAAE,SAAP;AAAkB,YAAU,EAAE,SAA9B;AAAyC,UAAQ,EAAE;AAAnD,CAFmB,EAGnB;AAAC,MAAI,EAAE,QAAP;AAAiB,YAAU,EAAE,QAA7B;AAAuC,UAAQ,EAAE;AAAjD,CAHmB,EAInB;AAAC,MAAI,EAAE,kBAAP;AAA2B,YAAU,EAAE,SAAvC;AAAkD,UAAQ,EAAE;AAA5D,CAJmB,EAKnB;AAAC,MAAI,EAAE,iBAAP;AAA0B,YAAU,EAAE,SAAtC;AAAiD,UAAQ,EAAE;AAA3D,CALmB,EAMnB;AAAC,MAAI,EAAE,OAAP;AAAgB,YAAU,EAAE,MAA5B;AAAoC,UAAQ,EAAE;AAA9C,CANmB,EAOnB;AAAC,MAAI,EAAE,QAAP;AAAiB,YAAU,EAAE,MAA7B;AAAqC,UAAQ,EAAE;AAA/C,CAPmB,EAQnB;AAAC,MAAI,EAAE,MAAP;AAAe,YAAU,EAAE,MAA3B;AAAmC,UAAQ,EAAE;AAA7C,CARmB,EASnB;AAAC,MAAI,EAAE,SAAP;AAAkB,YAAU,EAAE,MAA9B;AAAsC,UAAQ,EAAE;AAAhD,CATmB,CAApB;AAYA,sBAAU,IAAV,G;;;;;;;;;;;;;;;;;;ACvDA;;AACA;;AAEA;;AACA;;AAEA,IAAM,YAAY,GAAG,IAAI,qBAAJ,EAArB;AAGS;AAFT,YAAY,CAAC,IAAb,CAA0B,cAAM,MAAhC,EAAwC,EAAxC,CAA2C,6BAA3C;AACA,YAAY,CAAC,IAAb,CAAiC,cAAM,aAAvC,EAAsD,EAAtD,CAAyD,2CAAzD,E;;;;;;;;;;;;;;;;;;ACPA;;AACA;;AACA;;AACA;;AACA;;AACA;;AACA;;AACA;;AAmCM,MAAO,CAAC,gBAAR,GAA2B;AAChC;AACA,eAAa,EAAE,6BAFiB;AAGhC,QAAM,EAAE,eAHwB;AAIhC,WAAS,EAAE,qBAJqB;AAKhC,SAAO,EAAE,iBALuB;AAMhC,aAAW,EAAE,yBANmB;AAOhC,WAAS,EAAE,qBAPqB;AAQhC,eAAa,EAAE,6BARiB;AAShC,UAAQ,EAAE;AATsB,CAA3B,C;;;;;;;;;;;;;;;;;AC3CN,IAAM,KAAK,GAAG;AACV,QAAM,EAAE,MAAM,CAAC,GAAP,CAAW,QAAX,CADE;AAEV,eAAa,EAAG,MAAM,CAAC,GAAP,CAAW,eAAX;AAFN,CAAd;AAIS,sB","file":"bundle.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = \"./src/index.ts\");\n","module.exports = require('./lib/axios');","'use strict';\n\nvar utils = require('./../utils');\nvar settle = require('./../core/settle');\nvar buildURL = require('./../helpers/buildURL');\nvar parseHeaders = require('./../helpers/parseHeaders');\nvar isURLSameOrigin = require('./../helpers/isURLSameOrigin');\nvar createError = require('../core/createError');\n\nmodule.exports = function xhrAdapter(config) {\n  return new Promise(function dispatchXhrRequest(resolve, reject) {\n    var requestData = config.data;\n    var requestHeaders = config.headers;\n\n    if (utils.isFormData(requestData)) {\n      delete requestHeaders['Content-Type']; // Let the browser set it\n    }\n\n    var request = new XMLHttpRequest();\n\n    // HTTP basic authentication\n    if (config.auth) {\n      var username = config.auth.username || '';\n      var password = config.auth.password || '';\n      requestHeaders.Authorization = 'Basic ' + btoa(username + ':' + password);\n    }\n\n    request.open(config.method.toUpperCase(), buildURL(config.url, config.params, config.paramsSerializer), true);\n\n    // Set the request timeout in MS\n    request.timeout = config.timeout;\n\n    // Listen for ready state\n    request.onreadystatechange = function handleLoad() {\n      if (!request || request.readyState !== 4) {\n        return;\n      }\n\n      // The request errored out and we didn't get a response, this will be\n      // handled by onerror instead\n      // With one exception: request that using file: protocol, most browsers\n      // will return status as 0 even though it's a successful request\n      if (request.status === 0 && !(request.responseURL && request.responseURL.indexOf('file:') === 0)) {\n        return;\n      }\n\n      // Prepare the response\n      var responseHeaders = 'getAllResponseHeaders' in request ? parseHeaders(request.getAllResponseHeaders()) : null;\n      var responseData = !config.responseType || config.responseType === 'text' ? request.responseText : request.response;\n      var response = {\n        data: responseData,\n        status: request.status,\n        statusText: request.statusText,\n        headers: responseHeaders,\n        config: config,\n        request: request\n      };\n\n      settle(resolve, reject, response);\n\n      // Clean up request\n      request = null;\n    };\n\n    // Handle low level network errors\n    request.onerror = function handleError() {\n      // Real errors are hidden from us by the browser\n      // onerror should only fire if it's a network error\n      reject(createError('Network Error', config, null, request));\n\n      // Clean up request\n      request = null;\n    };\n\n    // Handle timeout\n    request.ontimeout = function handleTimeout() {\n      reject(createError('timeout of ' + config.timeout + 'ms exceeded', config, 'ECONNABORTED',\n        request));\n\n      // Clean up request\n      request = null;\n    };\n\n    // Add xsrf header\n    // This is only done if running in a standard browser environment.\n    // Specifically not if we're in a web worker, or react-native.\n    if (utils.isStandardBrowserEnv()) {\n      var cookies = require('./../helpers/cookies');\n\n      // Add xsrf header\n      var xsrfValue = (config.withCredentials || isURLSameOrigin(config.url)) && config.xsrfCookieName ?\n          cookies.read(config.xsrfCookieName) :\n          undefined;\n\n      if (xsrfValue) {\n        requestHeaders[config.xsrfHeaderName] = xsrfValue;\n      }\n    }\n\n    // Add headers to the request\n    if ('setRequestHeader' in request) {\n      utils.forEach(requestHeaders, function setRequestHeader(val, key) {\n        if (typeof requestData === 'undefined' && key.toLowerCase() === 'content-type') {\n          // Remove Content-Type if data is undefined\n          delete requestHeaders[key];\n        } else {\n          // Otherwise add header to the request\n          request.setRequestHeader(key, val);\n        }\n      });\n    }\n\n    // Add withCredentials to request if needed\n    if (config.withCredentials) {\n      request.withCredentials = true;\n    }\n\n    // Add responseType to request if needed\n    if (config.responseType) {\n      try {\n        request.responseType = config.responseType;\n      } catch (e) {\n        // Expected DOMException thrown by browsers not compatible XMLHttpRequest Level 2.\n        // But, this can be suppressed for 'json' type as it can be parsed by default 'transformResponse' function.\n        if (config.responseType !== 'json') {\n          throw e;\n        }\n      }\n    }\n\n    // Handle progress if needed\n    if (typeof config.onDownloadProgress === 'function') {\n      request.addEventListener('progress', config.onDownloadProgress);\n    }\n\n    // Not all browsers support upload events\n    if (typeof config.onUploadProgress === 'function' && request.upload) {\n      request.upload.addEventListener('progress', config.onUploadProgress);\n    }\n\n    if (config.cancelToken) {\n      // Handle cancellation\n      config.cancelToken.promise.then(function onCanceled(cancel) {\n        if (!request) {\n          return;\n        }\n\n        request.abort();\n        reject(cancel);\n        // Clean up request\n        request = null;\n      });\n    }\n\n    if (requestData === undefined) {\n      requestData = null;\n    }\n\n    // Send the request\n    request.send(requestData);\n  });\n};\n","'use strict';\n\nvar utils = require('./utils');\nvar bind = require('./helpers/bind');\nvar Axios = require('./core/Axios');\nvar defaults = require('./defaults');\n\n/**\n * Create an instance of Axios\n *\n * @param {Object} defaultConfig The default config for the instance\n * @return {Axios} A new instance of Axios\n */\nfunction createInstance(defaultConfig) {\n  var context = new Axios(defaultConfig);\n  var instance = bind(Axios.prototype.request, context);\n\n  // Copy axios.prototype to instance\n  utils.extend(instance, Axios.prototype, context);\n\n  // Copy context to instance\n  utils.extend(instance, context);\n\n  return instance;\n}\n\n// Create the default instance to be exported\nvar axios = createInstance(defaults);\n\n// Expose Axios class to allow class inheritance\naxios.Axios = Axios;\n\n// Factory for creating new instances\naxios.create = function create(instanceConfig) {\n  return createInstance(utils.merge(defaults, instanceConfig));\n};\n\n// Expose Cancel & CancelToken\naxios.Cancel = require('./cancel/Cancel');\naxios.CancelToken = require('./cancel/CancelToken');\naxios.isCancel = require('./cancel/isCancel');\n\n// Expose all/spread\naxios.all = function all(promises) {\n  return Promise.all(promises);\n};\naxios.spread = require('./helpers/spread');\n\nmodule.exports = axios;\n\n// Allow use of default import syntax in TypeScript\nmodule.exports.default = axios;\n","'use strict';\n\n/**\n * A `Cancel` is an object that is thrown when an operation is canceled.\n *\n * @class\n * @param {string=} message The message.\n */\nfunction Cancel(message) {\n  this.message = message;\n}\n\nCancel.prototype.toString = function toString() {\n  return 'Cancel' + (this.message ? ': ' + this.message : '');\n};\n\nCancel.prototype.__CANCEL__ = true;\n\nmodule.exports = Cancel;\n","'use strict';\n\nvar Cancel = require('./Cancel');\n\n/**\n * A `CancelToken` is an object that can be used to request cancellation of an operation.\n *\n * @class\n * @param {Function} executor The executor function.\n */\nfunction CancelToken(executor) {\n  if (typeof executor !== 'function') {\n    throw new TypeError('executor must be a function.');\n  }\n\n  var resolvePromise;\n  this.promise = new Promise(function promiseExecutor(resolve) {\n    resolvePromise = resolve;\n  });\n\n  var token = this;\n  executor(function cancel(message) {\n    if (token.reason) {\n      // Cancellation has already been requested\n      return;\n    }\n\n    token.reason = new Cancel(message);\n    resolvePromise(token.reason);\n  });\n}\n\n/**\n * Throws a `Cancel` if cancellation has been requested.\n */\nCancelToken.prototype.throwIfRequested = function throwIfRequested() {\n  if (this.reason) {\n    throw this.reason;\n  }\n};\n\n/**\n * Returns an object that contains a new `CancelToken` and a function that, when called,\n * cancels the `CancelToken`.\n */\nCancelToken.source = function source() {\n  var cancel;\n  var token = new CancelToken(function executor(c) {\n    cancel = c;\n  });\n  return {\n    token: token,\n    cancel: cancel\n  };\n};\n\nmodule.exports = CancelToken;\n","'use strict';\n\nmodule.exports = function isCancel(value) {\n  return !!(value && value.__CANCEL__);\n};\n","'use strict';\n\nvar defaults = require('./../defaults');\nvar utils = require('./../utils');\nvar InterceptorManager = require('./InterceptorManager');\nvar dispatchRequest = require('./dispatchRequest');\n\n/**\n * Create a new instance of Axios\n *\n * @param {Object} instanceConfig The default config for the instance\n */\nfunction Axios(instanceConfig) {\n  this.defaults = instanceConfig;\n  this.interceptors = {\n    request: new InterceptorManager(),\n    response: new InterceptorManager()\n  };\n}\n\n/**\n * Dispatch a request\n *\n * @param {Object} config The config specific for this request (merged with this.defaults)\n */\nAxios.prototype.request = function request(config) {\n  /*eslint no-param-reassign:0*/\n  // Allow for axios('example/url'[, config]) a la fetch API\n  if (typeof config === 'string') {\n    config = utils.merge({\n      url: arguments[0]\n    }, arguments[1]);\n  }\n\n  config = utils.merge(defaults, {method: 'get'}, this.defaults, config);\n  config.method = config.method.toLowerCase();\n\n  // Hook up interceptors middleware\n  var chain = [dispatchRequest, undefined];\n  var promise = Promise.resolve(config);\n\n  this.interceptors.request.forEach(function unshiftRequestInterceptors(interceptor) {\n    chain.unshift(interceptor.fulfilled, interceptor.rejected);\n  });\n\n  this.interceptors.response.forEach(function pushResponseInterceptors(interceptor) {\n    chain.push(interceptor.fulfilled, interceptor.rejected);\n  });\n\n  while (chain.length) {\n    promise = promise.then(chain.shift(), chain.shift());\n  }\n\n  return promise;\n};\n\n// Provide aliases for supported request methods\nutils.forEach(['delete', 'get', 'head', 'options'], function forEachMethodNoData(method) {\n  /*eslint func-names:0*/\n  Axios.prototype[method] = function(url, config) {\n    return this.request(utils.merge(config || {}, {\n      method: method,\n      url: url\n    }));\n  };\n});\n\nutils.forEach(['post', 'put', 'patch'], function forEachMethodWithData(method) {\n  /*eslint func-names:0*/\n  Axios.prototype[method] = function(url, data, config) {\n    return this.request(utils.merge(config || {}, {\n      method: method,\n      url: url,\n      data: data\n    }));\n  };\n});\n\nmodule.exports = Axios;\n","'use strict';\n\nvar utils = require('./../utils');\n\nfunction InterceptorManager() {\n  this.handlers = [];\n}\n\n/**\n * Add a new interceptor to the stack\n *\n * @param {Function} fulfilled The function to handle `then` for a `Promise`\n * @param {Function} rejected The function to handle `reject` for a `Promise`\n *\n * @return {Number} An ID used to remove interceptor later\n */\nInterceptorManager.prototype.use = function use(fulfilled, rejected) {\n  this.handlers.push({\n    fulfilled: fulfilled,\n    rejected: rejected\n  });\n  return this.handlers.length - 1;\n};\n\n/**\n * Remove an interceptor from the stack\n *\n * @param {Number} id The ID that was returned by `use`\n */\nInterceptorManager.prototype.eject = function eject(id) {\n  if (this.handlers[id]) {\n    this.handlers[id] = null;\n  }\n};\n\n/**\n * Iterate over all the registered interceptors\n *\n * This method is particularly useful for skipping over any\n * interceptors that may have become `null` calling `eject`.\n *\n * @param {Function} fn The function to call for each interceptor\n */\nInterceptorManager.prototype.forEach = function forEach(fn) {\n  utils.forEach(this.handlers, function forEachHandler(h) {\n    if (h !== null) {\n      fn(h);\n    }\n  });\n};\n\nmodule.exports = InterceptorManager;\n","'use strict';\n\nvar enhanceError = require('./enhanceError');\n\n/**\n * Create an Error with the specified message, config, error code, request and response.\n *\n * @param {string} message The error message.\n * @param {Object} config The config.\n * @param {string} [code] The error code (for example, 'ECONNABORTED').\n * @param {Object} [request] The request.\n * @param {Object} [response] The response.\n * @returns {Error} The created error.\n */\nmodule.exports = function createError(message, config, code, request, response) {\n  var error = new Error(message);\n  return enhanceError(error, config, code, request, response);\n};\n","'use strict';\n\nvar utils = require('./../utils');\nvar transformData = require('./transformData');\nvar isCancel = require('../cancel/isCancel');\nvar defaults = require('../defaults');\nvar isAbsoluteURL = require('./../helpers/isAbsoluteURL');\nvar combineURLs = require('./../helpers/combineURLs');\n\n/**\n * Throws a `Cancel` if cancellation has been requested.\n */\nfunction throwIfCancellationRequested(config) {\n  if (config.cancelToken) {\n    config.cancelToken.throwIfRequested();\n  }\n}\n\n/**\n * Dispatch a request to the server using the configured adapter.\n *\n * @param {object} config The config that is to be used for the request\n * @returns {Promise} The Promise to be fulfilled\n */\nmodule.exports = function dispatchRequest(config) {\n  throwIfCancellationRequested(config);\n\n  // Support baseURL config\n  if (config.baseURL && !isAbsoluteURL(config.url)) {\n    config.url = combineURLs(config.baseURL, config.url);\n  }\n\n  // Ensure headers exist\n  config.headers = config.headers || {};\n\n  // Transform request data\n  config.data = transformData(\n    config.data,\n    config.headers,\n    config.transformRequest\n  );\n\n  // Flatten headers\n  config.headers = utils.merge(\n    config.headers.common || {},\n    config.headers[config.method] || {},\n    config.headers || {}\n  );\n\n  utils.forEach(\n    ['delete', 'get', 'head', 'post', 'put', 'patch', 'common'],\n    function cleanHeaderConfig(method) {\n      delete config.headers[method];\n    }\n  );\n\n  var adapter = config.adapter || defaults.adapter;\n\n  return adapter(config).then(function onAdapterResolution(response) {\n    throwIfCancellationRequested(config);\n\n    // Transform response data\n    response.data = transformData(\n      response.data,\n      response.headers,\n      config.transformResponse\n    );\n\n    return response;\n  }, function onAdapterRejection(reason) {\n    if (!isCancel(reason)) {\n      throwIfCancellationRequested(config);\n\n      // Transform response data\n      if (reason && reason.response) {\n        reason.response.data = transformData(\n          reason.response.data,\n          reason.response.headers,\n          config.transformResponse\n        );\n      }\n    }\n\n    return Promise.reject(reason);\n  });\n};\n","'use strict';\n\n/**\n * Update an Error with the specified config, error code, and response.\n *\n * @param {Error} error The error to update.\n * @param {Object} config The config.\n * @param {string} [code] The error code (for example, 'ECONNABORTED').\n * @param {Object} [request] The request.\n * @param {Object} [response] The response.\n * @returns {Error} The error.\n */\nmodule.exports = function enhanceError(error, config, code, request, response) {\n  error.config = config;\n  if (code) {\n    error.code = code;\n  }\n  error.request = request;\n  error.response = response;\n  return error;\n};\n","'use strict';\n\nvar createError = require('./createError');\n\n/**\n * Resolve or reject a Promise based on response status.\n *\n * @param {Function} resolve A function that resolves the promise.\n * @param {Function} reject A function that rejects the promise.\n * @param {object} response The response.\n */\nmodule.exports = function settle(resolve, reject, response) {\n  var validateStatus = response.config.validateStatus;\n  // Note: status is not exposed by XDomainRequest\n  if (!response.status || !validateStatus || validateStatus(response.status)) {\n    resolve(response);\n  } else {\n    reject(createError(\n      'Request failed with status code ' + response.status,\n      response.config,\n      null,\n      response.request,\n      response\n    ));\n  }\n};\n","'use strict';\n\nvar utils = require('./../utils');\n\n/**\n * Transform the data for a request or a response\n *\n * @param {Object|String} data The data to be transformed\n * @param {Array} headers The headers for the request or response\n * @param {Array|Function} fns A single function or Array of functions\n * @returns {*} The resulting transformed data\n */\nmodule.exports = function transformData(data, headers, fns) {\n  /*eslint no-param-reassign:0*/\n  utils.forEach(fns, function transform(fn) {\n    data = fn(data, headers);\n  });\n\n  return data;\n};\n","'use strict';\n\nvar utils = require('./utils');\nvar normalizeHeaderName = require('./helpers/normalizeHeaderName');\n\nvar DEFAULT_CONTENT_TYPE = {\n  'Content-Type': 'application/x-www-form-urlencoded'\n};\n\nfunction setContentTypeIfUnset(headers, value) {\n  if (!utils.isUndefined(headers) && utils.isUndefined(headers['Content-Type'])) {\n    headers['Content-Type'] = value;\n  }\n}\n\nfunction getDefaultAdapter() {\n  var adapter;\n  if (typeof XMLHttpRequest !== 'undefined') {\n    // For browsers use XHR adapter\n    adapter = require('./adapters/xhr');\n  } else if (typeof process !== 'undefined') {\n    // For node use HTTP adapter\n    adapter = require('./adapters/http');\n  }\n  return adapter;\n}\n\nvar defaults = {\n  adapter: getDefaultAdapter(),\n\n  transformRequest: [function transformRequest(data, headers) {\n    normalizeHeaderName(headers, 'Content-Type');\n    if (utils.isFormData(data) ||\n      utils.isArrayBuffer(data) ||\n      utils.isBuffer(data) ||\n      utils.isStream(data) ||\n      utils.isFile(data) ||\n      utils.isBlob(data)\n    ) {\n      return data;\n    }\n    if (utils.isArrayBufferView(data)) {\n      return data.buffer;\n    }\n    if (utils.isURLSearchParams(data)) {\n      setContentTypeIfUnset(headers, 'application/x-www-form-urlencoded;charset=utf-8');\n      return data.toString();\n    }\n    if (utils.isObject(data)) {\n      setContentTypeIfUnset(headers, 'application/json;charset=utf-8');\n      return JSON.stringify(data);\n    }\n    return data;\n  }],\n\n  transformResponse: [function transformResponse(data) {\n    /*eslint no-param-reassign:0*/\n    if (typeof data === 'string') {\n      try {\n        data = JSON.parse(data);\n      } catch (e) { /* Ignore */ }\n    }\n    return data;\n  }],\n\n  /**\n   * A timeout in milliseconds to abort a request. If set to 0 (default) a\n   * timeout is not created.\n   */\n  timeout: 0,\n\n  xsrfCookieName: 'XSRF-TOKEN',\n  xsrfHeaderName: 'X-XSRF-TOKEN',\n\n  maxContentLength: -1,\n\n  validateStatus: function validateStatus(status) {\n    return status >= 200 && status < 300;\n  }\n};\n\ndefaults.headers = {\n  common: {\n    'Accept': 'application/json, text/plain, */*'\n  }\n};\n\nutils.forEach(['delete', 'get', 'head'], function forEachMethodNoData(method) {\n  defaults.headers[method] = {};\n});\n\nutils.forEach(['post', 'put', 'patch'], function forEachMethodWithData(method) {\n  defaults.headers[method] = utils.merge(DEFAULT_CONTENT_TYPE);\n});\n\nmodule.exports = defaults;\n","'use strict';\n\nmodule.exports = function bind(fn, thisArg) {\n  return function wrap() {\n    var args = new Array(arguments.length);\n    for (var i = 0; i < args.length; i++) {\n      args[i] = arguments[i];\n    }\n    return fn.apply(thisArg, args);\n  };\n};\n","'use strict';\n\nvar utils = require('./../utils');\n\nfunction encode(val) {\n  return encodeURIComponent(val).\n    replace(/%40/gi, '@').\n    replace(/%3A/gi, ':').\n    replace(/%24/g, '$').\n    replace(/%2C/gi, ',').\n    replace(/%20/g, '+').\n    replace(/%5B/gi, '[').\n    replace(/%5D/gi, ']');\n}\n\n/**\n * Build a URL by appending params to the end\n *\n * @param {string} url The base of the url (e.g., http://www.google.com)\n * @param {object} [params] The params to be appended\n * @returns {string} The formatted url\n */\nmodule.exports = function buildURL(url, params, paramsSerializer) {\n  /*eslint no-param-reassign:0*/\n  if (!params) {\n    return url;\n  }\n\n  var serializedParams;\n  if (paramsSerializer) {\n    serializedParams = paramsSerializer(params);\n  } else if (utils.isURLSearchParams(params)) {\n    serializedParams = params.toString();\n  } else {\n    var parts = [];\n\n    utils.forEach(params, function serialize(val, key) {\n      if (val === null || typeof val === 'undefined') {\n        return;\n      }\n\n      if (utils.isArray(val)) {\n        key = key + '[]';\n      } else {\n        val = [val];\n      }\n\n      utils.forEach(val, function parseValue(v) {\n        if (utils.isDate(v)) {\n          v = v.toISOString();\n        } else if (utils.isObject(v)) {\n          v = JSON.stringify(v);\n        }\n        parts.push(encode(key) + '=' + encode(v));\n      });\n    });\n\n    serializedParams = parts.join('&');\n  }\n\n  if (serializedParams) {\n    url += (url.indexOf('?') === -1 ? '?' : '&') + serializedParams;\n  }\n\n  return url;\n};\n","'use strict';\n\n/**\n * Creates a new URL by combining the specified URLs\n *\n * @param {string} baseURL The base URL\n * @param {string} relativeURL The relative URL\n * @returns {string} The combined URL\n */\nmodule.exports = function combineURLs(baseURL, relativeURL) {\n  return relativeURL\n    ? baseURL.replace(/\\/+$/, '') + '/' + relativeURL.replace(/^\\/+/, '')\n    : baseURL;\n};\n","'use strict';\n\nvar utils = require('./../utils');\n\nmodule.exports = (\n  utils.isStandardBrowserEnv() ?\n\n  // Standard browser envs support document.cookie\n  (function standardBrowserEnv() {\n    return {\n      write: function write(name, value, expires, path, domain, secure) {\n        var cookie = [];\n        cookie.push(name + '=' + encodeURIComponent(value));\n\n        if (utils.isNumber(expires)) {\n          cookie.push('expires=' + new Date(expires).toGMTString());\n        }\n\n        if (utils.isString(path)) {\n          cookie.push('path=' + path);\n        }\n\n        if (utils.isString(domain)) {\n          cookie.push('domain=' + domain);\n        }\n\n        if (secure === true) {\n          cookie.push('secure');\n        }\n\n        document.cookie = cookie.join('; ');\n      },\n\n      read: function read(name) {\n        var match = document.cookie.match(new RegExp('(^|;\\\\s*)(' + name + ')=([^;]*)'));\n        return (match ? decodeURIComponent(match[3]) : null);\n      },\n\n      remove: function remove(name) {\n        this.write(name, '', Date.now() - 86400000);\n      }\n    };\n  })() :\n\n  // Non standard browser env (web workers, react-native) lack needed support.\n  (function nonStandardBrowserEnv() {\n    return {\n      write: function write() {},\n      read: function read() { return null; },\n      remove: function remove() {}\n    };\n  })()\n);\n","'use strict';\n\n/**\n * Determines whether the specified URL is absolute\n *\n * @param {string} url The URL to test\n * @returns {boolean} True if the specified URL is absolute, otherwise false\n */\nmodule.exports = function isAbsoluteURL(url) {\n  // A URL is considered absolute if it begins with \"<scheme>://\" or \"//\" (protocol-relative URL).\n  // RFC 3986 defines scheme name as a sequence of characters beginning with a letter and followed\n  // by any combination of letters, digits, plus, period, or hyphen.\n  return /^([a-z][a-z\\d\\+\\-\\.]*:)?\\/\\//i.test(url);\n};\n","'use strict';\n\nvar utils = require('./../utils');\n\nmodule.exports = (\n  utils.isStandardBrowserEnv() ?\n\n  // Standard browser envs have full support of the APIs needed to test\n  // whether the request URL is of the same origin as current location.\n  (function standardBrowserEnv() {\n    var msie = /(msie|trident)/i.test(navigator.userAgent);\n    var urlParsingNode = document.createElement('a');\n    var originURL;\n\n    /**\n    * Parse a URL to discover it's components\n    *\n    * @param {String} url The URL to be parsed\n    * @returns {Object}\n    */\n    function resolveURL(url) {\n      var href = url;\n\n      if (msie) {\n        // IE needs attribute set twice to normalize properties\n        urlParsingNode.setAttribute('href', href);\n        href = urlParsingNode.href;\n      }\n\n      urlParsingNode.setAttribute('href', href);\n\n      // urlParsingNode provides the UrlUtils interface - http://url.spec.whatwg.org/#urlutils\n      return {\n        href: urlParsingNode.href,\n        protocol: urlParsingNode.protocol ? urlParsingNode.protocol.replace(/:$/, '') : '',\n        host: urlParsingNode.host,\n        search: urlParsingNode.search ? urlParsingNode.search.replace(/^\\?/, '') : '',\n        hash: urlParsingNode.hash ? urlParsingNode.hash.replace(/^#/, '') : '',\n        hostname: urlParsingNode.hostname,\n        port: urlParsingNode.port,\n        pathname: (urlParsingNode.pathname.charAt(0) === '/') ?\n                  urlParsingNode.pathname :\n                  '/' + urlParsingNode.pathname\n      };\n    }\n\n    originURL = resolveURL(window.location.href);\n\n    /**\n    * Determine if a URL shares the same origin as the current location\n    *\n    * @param {String} requestURL The URL to test\n    * @returns {boolean} True if URL shares the same origin, otherwise false\n    */\n    return function isURLSameOrigin(requestURL) {\n      var parsed = (utils.isString(requestURL)) ? resolveURL(requestURL) : requestURL;\n      return (parsed.protocol === originURL.protocol &&\n            parsed.host === originURL.host);\n    };\n  })() :\n\n  // Non standard browser envs (web workers, react-native) lack needed support.\n  (function nonStandardBrowserEnv() {\n    return function isURLSameOrigin() {\n      return true;\n    };\n  })()\n);\n","'use strict';\n\nvar utils = require('../utils');\n\nmodule.exports = function normalizeHeaderName(headers, normalizedName) {\n  utils.forEach(headers, function processHeader(value, name) {\n    if (name !== normalizedName && name.toUpperCase() === normalizedName.toUpperCase()) {\n      headers[normalizedName] = value;\n      delete headers[name];\n    }\n  });\n};\n","'use strict';\n\nvar utils = require('./../utils');\n\n// Headers whose duplicates are ignored by node\n// c.f. https://nodejs.org/api/http.html#http_message_headers\nvar ignoreDuplicateOf = [\n  'age', 'authorization', 'content-length', 'content-type', 'etag',\n  'expires', 'from', 'host', 'if-modified-since', 'if-unmodified-since',\n  'last-modified', 'location', 'max-forwards', 'proxy-authorization',\n  'referer', 'retry-after', 'user-agent'\n];\n\n/**\n * Parse headers into an object\n *\n * ```\n * Date: Wed, 27 Aug 2014 08:58:49 GMT\n * Content-Type: application/json\n * Connection: keep-alive\n * Transfer-Encoding: chunked\n * ```\n *\n * @param {String} headers Headers needing to be parsed\n * @returns {Object} Headers parsed into an object\n */\nmodule.exports = function parseHeaders(headers) {\n  var parsed = {};\n  var key;\n  var val;\n  var i;\n\n  if (!headers) { return parsed; }\n\n  utils.forEach(headers.split('\\n'), function parser(line) {\n    i = line.indexOf(':');\n    key = utils.trim(line.substr(0, i)).toLowerCase();\n    val = utils.trim(line.substr(i + 1));\n\n    if (key) {\n      if (parsed[key] && ignoreDuplicateOf.indexOf(key) >= 0) {\n        return;\n      }\n      if (key === 'set-cookie') {\n        parsed[key] = (parsed[key] ? parsed[key] : []).concat([val]);\n      } else {\n        parsed[key] = parsed[key] ? parsed[key] + ', ' + val : val;\n      }\n    }\n  });\n\n  return parsed;\n};\n","'use strict';\n\n/**\n * Syntactic sugar for invoking a function and expanding an array for arguments.\n *\n * Common use case would be to use `Function.prototype.apply`.\n *\n *  ```js\n *  function f(x, y, z) {}\n *  var args = [1, 2, 3];\n *  f.apply(null, args);\n *  ```\n *\n * With `spread` this example can be re-written.\n *\n *  ```js\n *  spread(function(x, y, z) {})([1, 2, 3]);\n *  ```\n *\n * @param {Function} callback\n * @returns {Function}\n */\nmodule.exports = function spread(callback) {\n  return function wrap(arr) {\n    return callback.apply(null, arr);\n  };\n};\n","'use strict';\n\nvar bind = require('./helpers/bind');\nvar isBuffer = require('is-buffer');\n\n/*global toString:true*/\n\n// utils is a library of generic helper functions non-specific to axios\n\nvar toString = Object.prototype.toString;\n\n/**\n * Determine if a value is an Array\n *\n * @param {Object} val The value to test\n * @returns {boolean} True if value is an Array, otherwise false\n */\nfunction isArray(val) {\n  return toString.call(val) === '[object Array]';\n}\n\n/**\n * Determine if a value is an ArrayBuffer\n *\n * @param {Object} val The value to test\n * @returns {boolean} True if value is an ArrayBuffer, otherwise false\n */\nfunction isArrayBuffer(val) {\n  return toString.call(val) === '[object ArrayBuffer]';\n}\n\n/**\n * Determine if a value is a FormData\n *\n * @param {Object} val The value to test\n * @returns {boolean} True if value is an FormData, otherwise false\n */\nfunction isFormData(val) {\n  return (typeof FormData !== 'undefined') && (val instanceof FormData);\n}\n\n/**\n * Determine if a value is a view on an ArrayBuffer\n *\n * @param {Object} val The value to test\n * @returns {boolean} True if value is a view on an ArrayBuffer, otherwise false\n */\nfunction isArrayBufferView(val) {\n  var result;\n  if ((typeof ArrayBuffer !== 'undefined') && (ArrayBuffer.isView)) {\n    result = ArrayBuffer.isView(val);\n  } else {\n    result = (val) && (val.buffer) && (val.buffer instanceof ArrayBuffer);\n  }\n  return result;\n}\n\n/**\n * Determine if a value is a String\n *\n * @param {Object} val The value to test\n * @returns {boolean} True if value is a String, otherwise false\n */\nfunction isString(val) {\n  return typeof val === 'string';\n}\n\n/**\n * Determine if a value is a Number\n *\n * @param {Object} val The value to test\n * @returns {boolean} True if value is a Number, otherwise false\n */\nfunction isNumber(val) {\n  return typeof val === 'number';\n}\n\n/**\n * Determine if a value is undefined\n *\n * @param {Object} val The value to test\n * @returns {boolean} True if the value is undefined, otherwise false\n */\nfunction isUndefined(val) {\n  return typeof val === 'undefined';\n}\n\n/**\n * Determine if a value is an Object\n *\n * @param {Object} val The value to test\n * @returns {boolean} True if value is an Object, otherwise false\n */\nfunction isObject(val) {\n  return val !== null && typeof val === 'object';\n}\n\n/**\n * Determine if a value is a Date\n *\n * @param {Object} val The value to test\n * @returns {boolean} True if value is a Date, otherwise false\n */\nfunction isDate(val) {\n  return toString.call(val) === '[object Date]';\n}\n\n/**\n * Determine if a value is a File\n *\n * @param {Object} val The value to test\n * @returns {boolean} True if value is a File, otherwise false\n */\nfunction isFile(val) {\n  return toString.call(val) === '[object File]';\n}\n\n/**\n * Determine if a value is a Blob\n *\n * @param {Object} val The value to test\n * @returns {boolean} True if value is a Blob, otherwise false\n */\nfunction isBlob(val) {\n  return toString.call(val) === '[object Blob]';\n}\n\n/**\n * Determine if a value is a Function\n *\n * @param {Object} val The value to test\n * @returns {boolean} True if value is a Function, otherwise false\n */\nfunction isFunction(val) {\n  return toString.call(val) === '[object Function]';\n}\n\n/**\n * Determine if a value is a Stream\n *\n * @param {Object} val The value to test\n * @returns {boolean} True if value is a Stream, otherwise false\n */\nfunction isStream(val) {\n  return isObject(val) && isFunction(val.pipe);\n}\n\n/**\n * Determine if a value is a URLSearchParams object\n *\n * @param {Object} val The value to test\n * @returns {boolean} True if value is a URLSearchParams object, otherwise false\n */\nfunction isURLSearchParams(val) {\n  return typeof URLSearchParams !== 'undefined' && val instanceof URLSearchParams;\n}\n\n/**\n * Trim excess whitespace off the beginning and end of a string\n *\n * @param {String} str The String to trim\n * @returns {String} The String freed of excess whitespace\n */\nfunction trim(str) {\n  return str.replace(/^\\s*/, '').replace(/\\s*$/, '');\n}\n\n/**\n * Determine if we're running in a standard browser environment\n *\n * This allows axios to run in a web worker, and react-native.\n * Both environments support XMLHttpRequest, but not fully standard globals.\n *\n * web workers:\n *  typeof window -> undefined\n *  typeof document -> undefined\n *\n * react-native:\n *  navigator.product -> 'ReactNative'\n */\nfunction isStandardBrowserEnv() {\n  if (typeof navigator !== 'undefined' && navigator.product === 'ReactNative') {\n    return false;\n  }\n  return (\n    typeof window !== 'undefined' &&\n    typeof document !== 'undefined'\n  );\n}\n\n/**\n * Iterate over an Array or an Object invoking a function for each item.\n *\n * If `obj` is an Array callback will be called passing\n * the value, index, and complete array for each item.\n *\n * If 'obj' is an Object callback will be called passing\n * the value, key, and complete object for each property.\n *\n * @param {Object|Array} obj The object to iterate\n * @param {Function} fn The callback to invoke for each item\n */\nfunction forEach(obj, fn) {\n  // Don't bother if no value provided\n  if (obj === null || typeof obj === 'undefined') {\n    return;\n  }\n\n  // Force an array if not already something iterable\n  if (typeof obj !== 'object') {\n    /*eslint no-param-reassign:0*/\n    obj = [obj];\n  }\n\n  if (isArray(obj)) {\n    // Iterate over array values\n    for (var i = 0, l = obj.length; i < l; i++) {\n      fn.call(null, obj[i], i, obj);\n    }\n  } else {\n    // Iterate over object keys\n    for (var key in obj) {\n      if (Object.prototype.hasOwnProperty.call(obj, key)) {\n        fn.call(null, obj[key], key, obj);\n      }\n    }\n  }\n}\n\n/**\n * Accepts varargs expecting each argument to be an object, then\n * immutably merges the properties of each object and returns result.\n *\n * When multiple objects contain the same key the later object in\n * the arguments list will take precedence.\n *\n * Example:\n *\n * ```js\n * var result = merge({foo: 123}, {foo: 456});\n * console.log(result.foo); // outputs 456\n * ```\n *\n * @param {Object} obj1 Object to merge\n * @returns {Object} Result of all merge properties\n */\nfunction merge(/* obj1, obj2, obj3, ... */) {\n  var result = {};\n  function assignValue(val, key) {\n    if (typeof result[key] === 'object' && typeof val === 'object') {\n      result[key] = merge(result[key], val);\n    } else {\n      result[key] = val;\n    }\n  }\n\n  for (var i = 0, l = arguments.length; i < l; i++) {\n    forEach(arguments[i], assignValue);\n  }\n  return result;\n}\n\n/**\n * Extends object a by mutably adding to it the properties of object b.\n *\n * @param {Object} a The object to be extended\n * @param {Object} b The object to copy properties from\n * @param {Object} thisArg The object to bind function to\n * @return {Object} The resulting value of object a\n */\nfunction extend(a, b, thisArg) {\n  forEach(b, function assignValue(val, key) {\n    if (thisArg && typeof val === 'function') {\n      a[key] = bind(val, thisArg);\n    } else {\n      a[key] = val;\n    }\n  });\n  return a;\n}\n\nmodule.exports = {\n  isArray: isArray,\n  isArrayBuffer: isArrayBuffer,\n  isBuffer: isBuffer,\n  isFormData: isFormData,\n  isArrayBufferView: isArrayBufferView,\n  isString: isString,\n  isNumber: isNumber,\n  isObject: isObject,\n  isUndefined: isUndefined,\n  isDate: isDate,\n  isFile: isFile,\n  isBlob: isBlob,\n  isFunction: isFunction,\n  isStream: isStream,\n  isURLSearchParams: isURLSearchParams,\n  isStandardBrowserEnv: isStandardBrowserEnv,\n  forEach: forEach,\n  merge: merge,\n  extend: extend,\n  trim: trim\n};\n","import SelectorSet from 'selector-set';\n\nvar bubbleEvents = {};\nvar captureEvents = {};\nvar propagationStopped = new WeakMap();\nvar immediatePropagationStopped = new WeakMap();\nvar currentTargets = new WeakMap();\nvar currentTargetDesc = Object.getOwnPropertyDescriptor(Event.prototype, 'currentTarget');\n\nfunction before(subject, verb, fn) {\n  var source = subject[verb];\n  subject[verb] = function () {\n    fn.apply(subject, arguments);\n    return source.apply(subject, arguments);\n  };\n  return subject;\n}\n\nfunction matches(selectors, target, reverse) {\n  var queue = [];\n  var node = target;\n\n  do {\n    if (node.nodeType !== 1) break;\n    var _matches = selectors.matches(node);\n    if (_matches.length) {\n      var matched = { node: node, observers: _matches };\n      if (reverse) {\n        queue.unshift(matched);\n      } else {\n        queue.push(matched);\n      }\n    }\n  } while (node = node.parentElement);\n\n  return queue;\n}\n\nfunction trackPropagation() {\n  propagationStopped.set(this, true);\n}\n\nfunction trackImmediate() {\n  propagationStopped.set(this, true);\n  immediatePropagationStopped.set(this, true);\n}\n\nfunction getCurrentTarget() {\n  return currentTargets.get(this) || null;\n}\n\nfunction defineCurrentTarget(event, getter) {\n  if (!currentTargetDesc) return;\n\n  Object.defineProperty(event, 'currentTarget', {\n    configurable: true,\n    enumerable: true,\n    get: getter || currentTargetDesc.get\n  });\n}\n\nfunction dispatch(event) {\n  var events = event.eventPhase === 1 ? captureEvents : bubbleEvents;\n\n  var selectors = events[event.type];\n  if (!selectors) return;\n\n  var queue = matches(selectors, event.target, event.eventPhase === 1);\n  if (!queue.length) return;\n\n  before(event, 'stopPropagation', trackPropagation);\n  before(event, 'stopImmediatePropagation', trackImmediate);\n  defineCurrentTarget(event, getCurrentTarget);\n\n  for (var i = 0, len1 = queue.length; i < len1; i++) {\n    if (propagationStopped.get(event)) break;\n    var matched = queue[i];\n    currentTargets.set(event, matched.node);\n\n    for (var j = 0, len2 = matched.observers.length; j < len2; j++) {\n      if (immediatePropagationStopped.get(event)) break;\n      matched.observers[j].data.call(matched.node, event);\n    }\n  }\n\n  currentTargets.delete(event);\n  defineCurrentTarget(event);\n}\n\nfunction on(name, selector, fn) {\n  var options = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : {};\n\n  var capture = options.capture ? true : false;\n  var events = capture ? captureEvents : bubbleEvents;\n\n  var selectors = events[name];\n  if (!selectors) {\n    selectors = new SelectorSet();\n    events[name] = selectors;\n    document.addEventListener(name, dispatch, capture);\n  }\n  selectors.add(selector, fn);\n}\n\nfunction off(name, selector, fn) {\n  var options = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : {};\n\n  var capture = options.capture ? true : false;\n  var events = capture ? captureEvents : bubbleEvents;\n\n  var selectors = events[name];\n  if (!selectors) return;\n  selectors.remove(selector, fn);\n\n  if (selectors.size) return;\n  delete events[name];\n  document.removeEventListener(name, dispatch, capture);\n}\n\nfunction fire(target, name, detail) {\n  return target.dispatchEvent(new CustomEvent(name, {\n    bubbles: true,\n    cancelable: true,\n    detail: detail\n  }));\n}\n\nexport { on, off, fire };\n","!(function(win) {\n\n/**\n * FastDom\n *\n * Eliminates layout thrashing\n * by batching DOM read/write\n * interactions.\n *\n * @author Wilson Page <wilsonpage@me.com>\n * @author Kornel Lesinski <kornel.lesinski@ft.com>\n */\n\n'use strict';\n\n/**\n * Mini logger\n *\n * @return {Function}\n */\nvar debug = 0 ? console.log.bind(console, '[fastdom]') : function() {};\n\n/**\n * Normalized rAF\n *\n * @type {Function}\n */\nvar raf = win.requestAnimationFrame\n  || win.webkitRequestAnimationFrame\n  || win.mozRequestAnimationFrame\n  || win.msRequestAnimationFrame\n  || function(cb) { return setTimeout(cb, 16); };\n\n/**\n * Initialize a `FastDom`.\n *\n * @constructor\n */\nfunction FastDom() {\n  var self = this;\n  self.reads = [];\n  self.writes = [];\n  self.raf = raf.bind(win); // test hook\n  debug('initialized', self);\n}\n\nFastDom.prototype = {\n  constructor: FastDom,\n\n  /**\n   * Adds a job to the read batch and\n   * schedules a new frame if need be.\n   *\n   * @param  {Function} fn\n   * @param  {Object} ctx the context to be bound to `fn` (optional).\n   * @public\n   */\n  measure: function(fn, ctx) {\n    debug('measure');\n    var task = !ctx ? fn : fn.bind(ctx);\n    this.reads.push(task);\n    scheduleFlush(this);\n    return task;\n  },\n\n  /**\n   * Adds a job to the\n   * write batch and schedules\n   * a new frame if need be.\n   *\n   * @param  {Function} fn\n   * @param  {Object} ctx the context to be bound to `fn` (optional).\n   * @public\n   */\n  mutate: function(fn, ctx) {\n    debug('mutate');\n    var task = !ctx ? fn : fn.bind(ctx);\n    this.writes.push(task);\n    scheduleFlush(this);\n    return task;\n  },\n\n  /**\n   * Clears a scheduled 'read' or 'write' task.\n   *\n   * @param {Object} task\n   * @return {Boolean} success\n   * @public\n   */\n  clear: function(task) {\n    debug('clear', task);\n    return remove(this.reads, task) || remove(this.writes, task);\n  },\n\n  /**\n   * Extend this FastDom with some\n   * custom functionality.\n   *\n   * Because fastdom must *always* be a\n   * singleton, we're actually extending\n   * the fastdom instance. This means tasks\n   * scheduled by an extension still enter\n   * fastdom's global task queue.\n   *\n   * The 'super' instance can be accessed\n   * from `this.fastdom`.\n   *\n   * @example\n   *\n   * var myFastdom = fastdom.extend({\n   *   initialize: function() {\n   *     // runs on creation\n   *   },\n   *\n   *   // override a method\n   *   measure: function(fn) {\n   *     // do extra stuff ...\n   *\n   *     // then call the original\n   *     return this.fastdom.measure(fn);\n   *   },\n   *\n   *   ...\n   * });\n   *\n   * @param  {Object} props  properties to mixin\n   * @return {FastDom}\n   */\n  extend: function(props) {\n    debug('extend', props);\n    if (typeof props != 'object') throw new Error('expected object');\n\n    var child = Object.create(this);\n    mixin(child, props);\n    child.fastdom = this;\n\n    // run optional creation hook\n    if (child.initialize) child.initialize();\n\n    return child;\n  },\n\n  // override this with a function\n  // to prevent Errors in console\n  // when tasks throw\n  catch: null\n};\n\n/**\n * Schedules a new read/write\n * batch if one isn't pending.\n *\n * @private\n */\nfunction scheduleFlush(fastdom) {\n  if (!fastdom.scheduled) {\n    fastdom.scheduled = true;\n    fastdom.raf(flush.bind(null, fastdom));\n    debug('flush scheduled');\n  }\n}\n\n/**\n * Runs queued `read` and `write` tasks.\n *\n * Errors are caught and thrown by default.\n * If a `.catch` function has been defined\n * it is called instead.\n *\n * @private\n */\nfunction flush(fastdom) {\n  debug('flush');\n\n  var writes = fastdom.writes;\n  var reads = fastdom.reads;\n  var error;\n\n  try {\n    debug('flushing reads', reads.length);\n    runTasks(reads);\n    debug('flushing writes', writes.length);\n    runTasks(writes);\n  } catch (e) { error = e; }\n\n  fastdom.scheduled = false;\n\n  // If the batch errored we may still have tasks queued\n  if (reads.length || writes.length) scheduleFlush(fastdom);\n\n  if (error) {\n    debug('task errored', error.message);\n    if (fastdom.catch) fastdom.catch(error);\n    else throw error;\n  }\n}\n\n/**\n * We run this inside a try catch\n * so that if any jobs error, we\n * are able to recover and continue\n * to flush the batch until it's empty.\n *\n * @private\n */\nfunction runTasks(tasks) {\n  debug('run tasks');\n  var task; while (task = tasks.shift()) task();\n}\n\n/**\n * Remove an item from an Array.\n *\n * @param  {Array} array\n * @param  {*} item\n * @return {Boolean}\n */\nfunction remove(array, item) {\n  var index = array.indexOf(item);\n  return !!~index && !!array.splice(index, 1);\n}\n\n/**\n * Mixin own properties of source\n * object into the target.\n *\n * @param  {Object} target\n * @param  {Object} source\n */\nfunction mixin(target, source) {\n  for (var key in source) {\n    if (source.hasOwnProperty(key)) target[key] = source[key];\n  }\n}\n\n// There should never be more than\n// one instance of `FastDom` in an app\nvar exports = win.fastdom = (win.fastdom || new FastDom()); // jshint ignore:line\n\n// Expose to CJS & AMD\nif ((typeof define) == 'function') define(function() { return exports; });\nelse if ((typeof module) == 'object') module.exports = exports;\n\n})( typeof window !== 'undefined' ? window : this);\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar ERROR_MSGS = require(\"../constants/error_msgs\");\nvar METADATA_KEY = require(\"../constants/metadata_keys\");\nfunction tagParameter(annotationTarget, propertyName, parameterIndex, metadata) {\n    var metadataKey = METADATA_KEY.TAGGED;\n    _tagParameterOrProperty(metadataKey, annotationTarget, propertyName, metadata, parameterIndex);\n}\nexports.tagParameter = tagParameter;\nfunction tagProperty(annotationTarget, propertyName, metadata) {\n    var metadataKey = METADATA_KEY.TAGGED_PROP;\n    _tagParameterOrProperty(metadataKey, annotationTarget.constructor, propertyName, metadata);\n}\nexports.tagProperty = tagProperty;\nfunction _tagParameterOrProperty(metadataKey, annotationTarget, propertyName, metadata, parameterIndex) {\n    var paramsOrPropertiesMetadata = {};\n    var isParameterDecorator = (typeof parameterIndex === \"number\");\n    var key = (parameterIndex !== undefined && isParameterDecorator) ? parameterIndex.toString() : propertyName;\n    if (isParameterDecorator && propertyName !== undefined) {\n        throw new Error(ERROR_MSGS.INVALID_DECORATOR_OPERATION);\n    }\n    if (Reflect.hasOwnMetadata(metadataKey, annotationTarget)) {\n        paramsOrPropertiesMetadata = Reflect.getMetadata(metadataKey, annotationTarget);\n    }\n    var paramOrPropertyMetadata = paramsOrPropertiesMetadata[key];\n    if (!Array.isArray(paramOrPropertyMetadata)) {\n        paramOrPropertyMetadata = [];\n    }\n    else {\n        for (var _i = 0, paramOrPropertyMetadata_1 = paramOrPropertyMetadata; _i < paramOrPropertyMetadata_1.length; _i++) {\n            var m = paramOrPropertyMetadata_1[_i];\n            if (m.key === metadata.key) {\n                throw new Error(ERROR_MSGS.DUPLICATED_METADATA + \" \" + m.key.toString());\n            }\n        }\n    }\n    paramOrPropertyMetadata.push(metadata);\n    paramsOrPropertiesMetadata[key] = paramOrPropertyMetadata;\n    Reflect.defineMetadata(metadataKey, paramsOrPropertiesMetadata, annotationTarget);\n}\nfunction _decorate(decorators, target) {\n    Reflect.decorate(decorators, target);\n}\nfunction _param(paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); };\n}\nfunction decorate(decorator, target, parameterIndex) {\n    if (typeof parameterIndex === \"number\") {\n        _decorate([_param(parameterIndex, decorator)], target);\n    }\n    else if (typeof parameterIndex === \"string\") {\n        Reflect.decorate([decorator], target, parameterIndex);\n    }\n    else {\n        _decorate([decorator], target);\n    }\n}\nexports.decorate = decorate;\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar error_msgs_1 = require(\"../constants/error_msgs\");\nvar METADATA_KEY = require(\"../constants/metadata_keys\");\nvar metadata_1 = require(\"../planning/metadata\");\nvar decorator_utils_1 = require(\"./decorator_utils\");\nvar LazyServiceIdentifer = (function () {\n    function LazyServiceIdentifer(cb) {\n        this._cb = cb;\n    }\n    LazyServiceIdentifer.prototype.unwrap = function () {\n        return this._cb();\n    };\n    return LazyServiceIdentifer;\n}());\nexports.LazyServiceIdentifer = LazyServiceIdentifer;\nfunction inject(serviceIdentifier) {\n    return function (target, targetKey, index) {\n        if (serviceIdentifier === undefined) {\n            throw new Error(error_msgs_1.UNDEFINED_INJECT_ANNOTATION(target.name));\n        }\n        var metadata = new metadata_1.Metadata(METADATA_KEY.INJECT_TAG, serviceIdentifier);\n        if (typeof index === \"number\") {\n            decorator_utils_1.tagParameter(target, targetKey, index, metadata);\n        }\n        else {\n            decorator_utils_1.tagProperty(target, targetKey, metadata);\n        }\n    };\n}\nexports.inject = inject;\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar ERRORS_MSGS = require(\"../constants/error_msgs\");\nvar METADATA_KEY = require(\"../constants/metadata_keys\");\nfunction injectable() {\n    return function (target) {\n        if (Reflect.hasOwnMetadata(METADATA_KEY.PARAM_TYPES, target)) {\n            throw new Error(ERRORS_MSGS.DUPLICATED_INJECTABLE_DECORATOR);\n        }\n        var types = Reflect.getMetadata(METADATA_KEY.DESIGN_PARAM_TYPES, target) || [];\n        Reflect.defineMetadata(METADATA_KEY.PARAM_TYPES, types, target);\n        return target;\n    };\n}\nexports.injectable = injectable;\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar METADATA_KEY = require(\"../constants/metadata_keys\");\nvar metadata_1 = require(\"../planning/metadata\");\nvar decorator_utils_1 = require(\"./decorator_utils\");\nfunction multiInject(serviceIdentifier) {\n    return function (target, targetKey, index) {\n        var metadata = new metadata_1.Metadata(METADATA_KEY.MULTI_INJECT_TAG, serviceIdentifier);\n        if (typeof index === \"number\") {\n            decorator_utils_1.tagParameter(target, targetKey, index, metadata);\n        }\n        else {\n            decorator_utils_1.tagProperty(target, targetKey, metadata);\n        }\n    };\n}\nexports.multiInject = multiInject;\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar METADATA_KEY = require(\"../constants/metadata_keys\");\nvar metadata_1 = require(\"../planning/metadata\");\nvar decorator_utils_1 = require(\"./decorator_utils\");\nfunction named(name) {\n    return function (target, targetKey, index) {\n        var metadata = new metadata_1.Metadata(METADATA_KEY.NAMED_TAG, name);\n        if (typeof index === \"number\") {\n            decorator_utils_1.tagParameter(target, targetKey, index, metadata);\n        }\n        else {\n            decorator_utils_1.tagProperty(target, targetKey, metadata);\n        }\n    };\n}\nexports.named = named;\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar METADATA_KEY = require(\"../constants/metadata_keys\");\nvar metadata_1 = require(\"../planning/metadata\");\nvar decorator_utils_1 = require(\"./decorator_utils\");\nfunction optional() {\n    return function (target, targetKey, index) {\n        var metadata = new metadata_1.Metadata(METADATA_KEY.OPTIONAL_TAG, true);\n        if (typeof index === \"number\") {\n            decorator_utils_1.tagParameter(target, targetKey, index, metadata);\n        }\n        else {\n            decorator_utils_1.tagProperty(target, targetKey, metadata);\n        }\n    };\n}\nexports.optional = optional;\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar ERRORS_MSGS = require(\"../constants/error_msgs\");\nvar METADATA_KEY = require(\"../constants/metadata_keys\");\nvar metadata_1 = require(\"../planning/metadata\");\nfunction postConstruct() {\n    return function (target, propertyKey, descriptor) {\n        var metadata = new metadata_1.Metadata(METADATA_KEY.POST_CONSTRUCT, propertyKey);\n        if (Reflect.hasOwnMetadata(METADATA_KEY.POST_CONSTRUCT, target.constructor)) {\n            throw new Error(ERRORS_MSGS.MULTIPLE_POST_CONSTRUCT_METHODS);\n        }\n        Reflect.defineMetadata(METADATA_KEY.POST_CONSTRUCT, metadata, target.constructor);\n    };\n}\nexports.postConstruct = postConstruct;\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar metadata_1 = require(\"../planning/metadata\");\nvar decorator_utils_1 = require(\"./decorator_utils\");\nfunction tagged(metadataKey, metadataValue) {\n    return function (target, targetKey, index) {\n        var metadata = new metadata_1.Metadata(metadataKey, metadataValue);\n        if (typeof index === \"number\") {\n            decorator_utils_1.tagParameter(target, targetKey, index, metadata);\n        }\n        else {\n            decorator_utils_1.tagProperty(target, targetKey, metadata);\n        }\n    };\n}\nexports.tagged = tagged;\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar METADATA_KEY = require(\"../constants/metadata_keys\");\nvar metadata_1 = require(\"../planning/metadata\");\nvar decorator_utils_1 = require(\"./decorator_utils\");\nfunction targetName(name) {\n    return function (target, targetKey, index) {\n        var metadata = new metadata_1.Metadata(METADATA_KEY.NAME_TAG, name);\n        decorator_utils_1.tagParameter(target, targetKey, index, metadata);\n    };\n}\nexports.targetName = targetName;\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar METADATA_KEY = require(\"../constants/metadata_keys\");\nvar metadata_1 = require(\"../planning/metadata\");\nvar decorator_utils_1 = require(\"./decorator_utils\");\nfunction unmanaged() {\n    return function (target, targetKey, index) {\n        var metadata = new metadata_1.Metadata(METADATA_KEY.UNMANAGED_TAG, true);\n        decorator_utils_1.tagParameter(target, targetKey, index, metadata);\n    };\n}\nexports.unmanaged = unmanaged;\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar literal_types_1 = require(\"../constants/literal_types\");\nvar id_1 = require(\"../utils/id\");\nvar Binding = (function () {\n    function Binding(serviceIdentifier, scope) {\n        this.id = id_1.id();\n        this.activated = false;\n        this.serviceIdentifier = serviceIdentifier;\n        this.scope = scope;\n        this.type = literal_types_1.BindingTypeEnum.Invalid;\n        this.constraint = function (request) { return true; };\n        this.implementationType = null;\n        this.cache = null;\n        this.factory = null;\n        this.provider = null;\n        this.onActivation = null;\n        this.dynamicValue = null;\n    }\n    Binding.prototype.clone = function () {\n        var clone = new Binding(this.serviceIdentifier, this.scope);\n        clone.activated = false;\n        clone.implementationType = this.implementationType;\n        clone.dynamicValue = this.dynamicValue;\n        clone.scope = this.scope;\n        clone.type = this.type;\n        clone.factory = this.factory;\n        clone.provider = this.provider;\n        clone.constraint = this.constraint;\n        clone.onActivation = this.onActivation;\n        clone.cache = this.cache;\n        return clone;\n    };\n    return Binding;\n}());\nexports.Binding = Binding;\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar BindingCount = {\n    MultipleBindingsAvailable: 2,\n    NoBindingsAvailable: 0,\n    OnlyOneBindingAvailable: 1\n};\nexports.BindingCount = BindingCount;\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.DUPLICATED_INJECTABLE_DECORATOR = \"Cannot apply @injectable decorator multiple times.\";\nexports.DUPLICATED_METADATA = \"Metadata key was used more than once in a parameter:\";\nexports.NULL_ARGUMENT = \"NULL argument\";\nexports.KEY_NOT_FOUND = \"Key Not Found\";\nexports.AMBIGUOUS_MATCH = \"Ambiguous match found for serviceIdentifier:\";\nexports.CANNOT_UNBIND = \"Could not unbind serviceIdentifier:\";\nexports.NOT_REGISTERED = \"No matching bindings found for serviceIdentifier:\";\nexports.MISSING_INJECTABLE_ANNOTATION = \"Missing required @injectable annotation in:\";\nexports.MISSING_INJECT_ANNOTATION = \"Missing required @inject or @multiInject annotation in:\";\nexports.UNDEFINED_INJECT_ANNOTATION = function (name) {\n    return \"@inject called with undefined this could mean that the class \" + name + \" has \" +\n        \"a circular dependency problem. You can use a LazyServiceIdentifer to  \" +\n        \"overcome this limitation.\";\n};\nexports.CIRCULAR_DEPENDENCY = \"Circular dependency found:\";\nexports.NOT_IMPLEMENTED = \"Sorry, this feature is not fully implemented yet.\";\nexports.INVALID_BINDING_TYPE = \"Invalid binding type:\";\nexports.NO_MORE_SNAPSHOTS_AVAILABLE = \"No snapshot available to restore.\";\nexports.INVALID_MIDDLEWARE_RETURN = \"Invalid return type in middleware. Middleware must return!\";\nexports.INVALID_FUNCTION_BINDING = \"Value provided to function binding must be a function!\";\nexports.INVALID_TO_SELF_VALUE = \"The toSelf function can only be applied when a constructor is \" +\n    \"used as service identifier\";\nexports.INVALID_DECORATOR_OPERATION = \"The @inject @multiInject @tagged and @named decorators \" +\n    \"must be applied to the parameters of a class constructor or a class property.\";\nexports.ARGUMENTS_LENGTH_MISMATCH = function () {\n    var values = [];\n    for (var _i = 0; _i < arguments.length; _i++) {\n        values[_i] = arguments[_i];\n    }\n    return \"The number of constructor arguments in the derived class \" +\n        (values[0] + \" must be >= than the number of constructor arguments of its base class.\");\n};\nexports.CONTAINER_OPTIONS_MUST_BE_AN_OBJECT = \"Invalid Container constructor argument. Container options \" +\n    \"must be an object.\";\nexports.CONTAINER_OPTIONS_INVALID_DEFAULT_SCOPE = \"Invalid Container option. Default scope must \" +\n    \"be a string ('singleton' or 'transient').\";\nexports.CONTAINER_OPTIONS_INVALID_AUTO_BIND_INJECTABLE = \"Invalid Container option. Auto bind injectable must \" +\n    \"be a boolean\";\nexports.CONTAINER_OPTIONS_INVALID_SKIP_BASE_CHECK = \"Invalid Container option. Skip base check must \" +\n    \"be a boolean\";\nexports.MULTIPLE_POST_CONSTRUCT_METHODS = \"Cannot apply @postConstruct decorator multiple times in the same class\";\nexports.POST_CONSTRUCT_ERROR = function () {\n    var values = [];\n    for (var _i = 0; _i < arguments.length; _i++) {\n        values[_i] = arguments[_i];\n    }\n    return \"@postConstruct error in class \" + values[0] + \": \" + values[1];\n};\nexports.CIRCULAR_DEPENDENCY_IN_FACTORY = function () {\n    var values = [];\n    for (var _i = 0; _i < arguments.length; _i++) {\n        values[_i] = arguments[_i];\n    }\n    return \"It looks like there is a circular dependency \" +\n        (\"in one of the '\" + values[0] + \"' bindings. Please investigate bindings with\") +\n        (\"service identifier '\" + values[1] + \"'.\");\n};\nexports.STACK_OVERFLOW = \"Maximum call stack size exceeded\";\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar BindingScopeEnum = {\n    Request: \"Request\",\n    Singleton: \"Singleton\",\n    Transient: \"Transient\"\n};\nexports.BindingScopeEnum = BindingScopeEnum;\nvar BindingTypeEnum = {\n    ConstantValue: \"ConstantValue\",\n    Constructor: \"Constructor\",\n    DynamicValue: \"DynamicValue\",\n    Factory: \"Factory\",\n    Function: \"Function\",\n    Instance: \"Instance\",\n    Invalid: \"Invalid\",\n    Provider: \"Provider\"\n};\nexports.BindingTypeEnum = BindingTypeEnum;\nvar TargetTypeEnum = {\n    ClassProperty: \"ClassProperty\",\n    ConstructorArgument: \"ConstructorArgument\",\n    Variable: \"Variable\"\n};\nexports.TargetTypeEnum = TargetTypeEnum;\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.NAMED_TAG = \"named\";\nexports.NAME_TAG = \"name\";\nexports.UNMANAGED_TAG = \"unmanaged\";\nexports.OPTIONAL_TAG = \"optional\";\nexports.INJECT_TAG = \"inject\";\nexports.MULTI_INJECT_TAG = \"multi_inject\";\nexports.TAGGED = \"inversify:tagged\";\nexports.TAGGED_PROP = \"inversify:tagged_props\";\nexports.PARAM_TYPES = \"inversify:paramtypes\";\nexports.DESIGN_PARAM_TYPES = \"design:paramtypes\";\nexports.POST_CONSTRUCT = \"post_construct\";\n","\"use strict\";\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : new P(function (resolve) { resolve(result.value); }).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nvar __generator = (this && this.__generator) || function (thisArg, body) {\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\n    function verb(n) { return function (v) { return step([n, v]); }; }\n    function step(op) {\n        if (f) throw new TypeError(\"Generator is already executing.\");\n        while (_) try {\n            if (f = 1, y && (t = y[op[0] & 2 ? \"return\" : op[0] ? \"throw\" : \"next\"]) && !(t = t.call(y, op[1])).done) return t;\n            if (y = 0, t) op = [0, t.value];\n            switch (op[0]) {\n                case 0: case 1: t = op; break;\n                case 4: _.label++; return { value: op[1], done: false };\n                case 5: _.label++; y = op[1]; op = [0]; continue;\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\n                default:\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\n                    if (t[2]) _.ops.pop();\n                    _.trys.pop(); continue;\n            }\n            op = body.call(thisArg, _);\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\n    }\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar binding_1 = require(\"../bindings/binding\");\nvar ERROR_MSGS = require(\"../constants/error_msgs\");\nvar literal_types_1 = require(\"../constants/literal_types\");\nvar METADATA_KEY = require(\"../constants/metadata_keys\");\nvar metadata_reader_1 = require(\"../planning/metadata_reader\");\nvar planner_1 = require(\"../planning/planner\");\nvar resolver_1 = require(\"../resolution/resolver\");\nvar binding_to_syntax_1 = require(\"../syntax/binding_to_syntax\");\nvar id_1 = require(\"../utils/id\");\nvar serialization_1 = require(\"../utils/serialization\");\nvar container_snapshot_1 = require(\"./container_snapshot\");\nvar lookup_1 = require(\"./lookup\");\nvar Container = (function () {\n    function Container(containerOptions) {\n        var options = containerOptions || {};\n        if (typeof options !== \"object\") {\n            throw new Error(\"\" + ERROR_MSGS.CONTAINER_OPTIONS_MUST_BE_AN_OBJECT);\n        }\n        if (options.defaultScope === undefined) {\n            options.defaultScope = literal_types_1.BindingScopeEnum.Transient;\n        }\n        else if (options.defaultScope !== literal_types_1.BindingScopeEnum.Singleton &&\n            options.defaultScope !== literal_types_1.BindingScopeEnum.Transient &&\n            options.defaultScope !== literal_types_1.BindingScopeEnum.Request) {\n            throw new Error(\"\" + ERROR_MSGS.CONTAINER_OPTIONS_INVALID_DEFAULT_SCOPE);\n        }\n        if (options.autoBindInjectable === undefined) {\n            options.autoBindInjectable = false;\n        }\n        else if (typeof options.autoBindInjectable !== \"boolean\") {\n            throw new Error(\"\" + ERROR_MSGS.CONTAINER_OPTIONS_INVALID_AUTO_BIND_INJECTABLE);\n        }\n        if (options.skipBaseClassChecks === undefined) {\n            options.skipBaseClassChecks = false;\n        }\n        else if (typeof options.skipBaseClassChecks !== \"boolean\") {\n            throw new Error(\"\" + ERROR_MSGS.CONTAINER_OPTIONS_INVALID_SKIP_BASE_CHECK);\n        }\n        this.options = {\n            autoBindInjectable: options.autoBindInjectable,\n            defaultScope: options.defaultScope,\n            skipBaseClassChecks: options.skipBaseClassChecks\n        };\n        this.id = id_1.id();\n        this._bindingDictionary = new lookup_1.Lookup();\n        this._snapshots = [];\n        this._middleware = null;\n        this.parent = null;\n        this._metadataReader = new metadata_reader_1.MetadataReader();\n    }\n    Container.merge = function (container1, container2) {\n        var container = new Container();\n        var bindingDictionary = planner_1.getBindingDictionary(container);\n        var bindingDictionary1 = planner_1.getBindingDictionary(container1);\n        var bindingDictionary2 = planner_1.getBindingDictionary(container2);\n        function copyDictionary(origin, destination) {\n            origin.traverse(function (key, value) {\n                value.forEach(function (binding) {\n                    destination.add(binding.serviceIdentifier, binding.clone());\n                });\n            });\n        }\n        copyDictionary(bindingDictionary1, bindingDictionary);\n        copyDictionary(bindingDictionary2, bindingDictionary);\n        return container;\n    };\n    Container.prototype.load = function () {\n        var modules = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            modules[_i] = arguments[_i];\n        }\n        var getHelpers = this._getContainerModuleHelpersFactory();\n        for (var _a = 0, modules_1 = modules; _a < modules_1.length; _a++) {\n            var currentModule = modules_1[_a];\n            var containerModuleHelpers = getHelpers(currentModule.id);\n            currentModule.registry(containerModuleHelpers.bindFunction, containerModuleHelpers.unbindFunction, containerModuleHelpers.isboundFunction, containerModuleHelpers.rebindFunction);\n        }\n    };\n    Container.prototype.loadAsync = function () {\n        var modules = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            modules[_i] = arguments[_i];\n        }\n        return __awaiter(this, void 0, void 0, function () {\n            var getHelpers, _a, modules_2, currentModule, containerModuleHelpers;\n            return __generator(this, function (_b) {\n                switch (_b.label) {\n                    case 0:\n                        getHelpers = this._getContainerModuleHelpersFactory();\n                        _a = 0, modules_2 = modules;\n                        _b.label = 1;\n                    case 1:\n                        if (!(_a < modules_2.length)) return [3, 4];\n                        currentModule = modules_2[_a];\n                        containerModuleHelpers = getHelpers(currentModule.id);\n                        return [4, currentModule.registry(containerModuleHelpers.bindFunction, containerModuleHelpers.unbindFunction, containerModuleHelpers.isboundFunction, containerModuleHelpers.rebindFunction)];\n                    case 2:\n                        _b.sent();\n                        _b.label = 3;\n                    case 3:\n                        _a++;\n                        return [3, 1];\n                    case 4: return [2];\n                }\n            });\n        });\n    };\n    Container.prototype.unload = function () {\n        var _this = this;\n        var modules = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            modules[_i] = arguments[_i];\n        }\n        var conditionFactory = function (expected) { return function (item) {\n            return item.moduleId === expected;\n        }; };\n        modules.forEach(function (module) {\n            var condition = conditionFactory(module.id);\n            _this._bindingDictionary.removeByCondition(condition);\n        });\n    };\n    Container.prototype.bind = function (serviceIdentifier) {\n        var scope = this.options.defaultScope || literal_types_1.BindingScopeEnum.Transient;\n        var binding = new binding_1.Binding(serviceIdentifier, scope);\n        this._bindingDictionary.add(serviceIdentifier, binding);\n        return new binding_to_syntax_1.BindingToSyntax(binding);\n    };\n    Container.prototype.rebind = function (serviceIdentifier) {\n        this.unbind(serviceIdentifier);\n        return this.bind(serviceIdentifier);\n    };\n    Container.prototype.unbind = function (serviceIdentifier) {\n        try {\n            this._bindingDictionary.remove(serviceIdentifier);\n        }\n        catch (e) {\n            throw new Error(ERROR_MSGS.CANNOT_UNBIND + \" \" + serialization_1.getServiceIdentifierAsString(serviceIdentifier));\n        }\n    };\n    Container.prototype.unbindAll = function () {\n        this._bindingDictionary = new lookup_1.Lookup();\n    };\n    Container.prototype.isBound = function (serviceIdentifier) {\n        var bound = this._bindingDictionary.hasKey(serviceIdentifier);\n        if (!bound && this.parent) {\n            bound = this.parent.isBound(serviceIdentifier);\n        }\n        return bound;\n    };\n    Container.prototype.isBoundNamed = function (serviceIdentifier, named) {\n        return this.isBoundTagged(serviceIdentifier, METADATA_KEY.NAMED_TAG, named);\n    };\n    Container.prototype.isBoundTagged = function (serviceIdentifier, key, value) {\n        var bound = false;\n        if (this._bindingDictionary.hasKey(serviceIdentifier)) {\n            var bindings = this._bindingDictionary.get(serviceIdentifier);\n            var request_1 = planner_1.createMockRequest(this, serviceIdentifier, key, value);\n            bound = bindings.some(function (b) { return b.constraint(request_1); });\n        }\n        if (!bound && this.parent) {\n            bound = this.parent.isBoundTagged(serviceIdentifier, key, value);\n        }\n        return bound;\n    };\n    Container.prototype.snapshot = function () {\n        this._snapshots.push(container_snapshot_1.ContainerSnapshot.of(this._bindingDictionary.clone(), this._middleware));\n    };\n    Container.prototype.restore = function () {\n        var snapshot = this._snapshots.pop();\n        if (snapshot === undefined) {\n            throw new Error(ERROR_MSGS.NO_MORE_SNAPSHOTS_AVAILABLE);\n        }\n        this._bindingDictionary = snapshot.bindings;\n        this._middleware = snapshot.middleware;\n    };\n    Container.prototype.createChild = function (containerOptions) {\n        var child = new Container(containerOptions || this.options);\n        child.parent = this;\n        return child;\n    };\n    Container.prototype.applyMiddleware = function () {\n        var middlewares = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            middlewares[_i] = arguments[_i];\n        }\n        var initial = (this._middleware) ? this._middleware : this._planAndResolve();\n        this._middleware = middlewares.reduce(function (prev, curr) { return curr(prev); }, initial);\n    };\n    Container.prototype.applyCustomMetadataReader = function (metadataReader) {\n        this._metadataReader = metadataReader;\n    };\n    Container.prototype.get = function (serviceIdentifier) {\n        return this._get(false, false, literal_types_1.TargetTypeEnum.Variable, serviceIdentifier);\n    };\n    Container.prototype.getTagged = function (serviceIdentifier, key, value) {\n        return this._get(false, false, literal_types_1.TargetTypeEnum.Variable, serviceIdentifier, key, value);\n    };\n    Container.prototype.getNamed = function (serviceIdentifier, named) {\n        return this.getTagged(serviceIdentifier, METADATA_KEY.NAMED_TAG, named);\n    };\n    Container.prototype.getAll = function (serviceIdentifier) {\n        return this._get(true, true, literal_types_1.TargetTypeEnum.Variable, serviceIdentifier);\n    };\n    Container.prototype.getAllTagged = function (serviceIdentifier, key, value) {\n        return this._get(false, true, literal_types_1.TargetTypeEnum.Variable, serviceIdentifier, key, value);\n    };\n    Container.prototype.getAllNamed = function (serviceIdentifier, named) {\n        return this.getAllTagged(serviceIdentifier, METADATA_KEY.NAMED_TAG, named);\n    };\n    Container.prototype.resolve = function (constructorFunction) {\n        var tempContainer = this.createChild();\n        tempContainer.bind(constructorFunction).toSelf();\n        return tempContainer.get(constructorFunction);\n    };\n    Container.prototype._getContainerModuleHelpersFactory = function () {\n        var _this = this;\n        var setModuleId = function (bindingToSyntax, moduleId) {\n            bindingToSyntax._binding.moduleId = moduleId;\n        };\n        var getBindFunction = function (moduleId) {\n            return function (serviceIdentifier) {\n                var _bind = _this.bind.bind(_this);\n                var bindingToSyntax = _bind(serviceIdentifier);\n                setModuleId(bindingToSyntax, moduleId);\n                return bindingToSyntax;\n            };\n        };\n        var getUnbindFunction = function (moduleId) {\n            return function (serviceIdentifier) {\n                var _unbind = _this.unbind.bind(_this);\n                _unbind(serviceIdentifier);\n            };\n        };\n        var getIsboundFunction = function (moduleId) {\n            return function (serviceIdentifier) {\n                var _isBound = _this.isBound.bind(_this);\n                return _isBound(serviceIdentifier);\n            };\n        };\n        var getRebindFunction = function (moduleId) {\n            return function (serviceIdentifier) {\n                var _rebind = _this.rebind.bind(_this);\n                var bindingToSyntax = _rebind(serviceIdentifier);\n                setModuleId(bindingToSyntax, moduleId);\n                return bindingToSyntax;\n            };\n        };\n        return function (mId) { return ({\n            bindFunction: getBindFunction(mId),\n            isboundFunction: getIsboundFunction(mId),\n            rebindFunction: getRebindFunction(mId),\n            unbindFunction: getUnbindFunction(mId)\n        }); };\n    };\n    Container.prototype._get = function (avoidConstraints, isMultiInject, targetType, serviceIdentifier, key, value) {\n        var result = null;\n        var defaultArgs = {\n            avoidConstraints: avoidConstraints,\n            contextInterceptor: function (context) { return context; },\n            isMultiInject: isMultiInject,\n            key: key,\n            serviceIdentifier: serviceIdentifier,\n            targetType: targetType,\n            value: value\n        };\n        if (this._middleware) {\n            result = this._middleware(defaultArgs);\n            if (result === undefined || result === null) {\n                throw new Error(ERROR_MSGS.INVALID_MIDDLEWARE_RETURN);\n            }\n        }\n        else {\n            result = this._planAndResolve()(defaultArgs);\n        }\n        return result;\n    };\n    Container.prototype._planAndResolve = function () {\n        var _this = this;\n        return function (args) {\n            var context = planner_1.plan(_this._metadataReader, _this, args.isMultiInject, args.targetType, args.serviceIdentifier, args.key, args.value, args.avoidConstraints);\n            context = args.contextInterceptor(context);\n            var result = resolver_1.resolve(context);\n            return result;\n        };\n    };\n    return Container;\n}());\nexports.Container = Container;\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar id_1 = require(\"../utils/id\");\nvar ContainerModule = (function () {\n    function ContainerModule(registry) {\n        this.id = id_1.id();\n        this.registry = registry;\n    }\n    return ContainerModule;\n}());\nexports.ContainerModule = ContainerModule;\nvar AsyncContainerModule = (function () {\n    function AsyncContainerModule(registry) {\n        this.id = id_1.id();\n        this.registry = registry;\n    }\n    return AsyncContainerModule;\n}());\nexports.AsyncContainerModule = AsyncContainerModule;\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar ContainerSnapshot = (function () {\n    function ContainerSnapshot() {\n    }\n    ContainerSnapshot.of = function (bindings, middleware) {\n        var snapshot = new ContainerSnapshot();\n        snapshot.bindings = bindings;\n        snapshot.middleware = middleware;\n        return snapshot;\n    };\n    return ContainerSnapshot;\n}());\nexports.ContainerSnapshot = ContainerSnapshot;\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar ERROR_MSGS = require(\"../constants/error_msgs\");\nvar Lookup = (function () {\n    function Lookup() {\n        this._map = new Map();\n    }\n    Lookup.prototype.getMap = function () {\n        return this._map;\n    };\n    Lookup.prototype.add = function (serviceIdentifier, value) {\n        if (serviceIdentifier === null || serviceIdentifier === undefined) {\n            throw new Error(ERROR_MSGS.NULL_ARGUMENT);\n        }\n        if (value === null || value === undefined) {\n            throw new Error(ERROR_MSGS.NULL_ARGUMENT);\n        }\n        var entry = this._map.get(serviceIdentifier);\n        if (entry !== undefined) {\n            entry.push(value);\n            this._map.set(serviceIdentifier, entry);\n        }\n        else {\n            this._map.set(serviceIdentifier, [value]);\n        }\n    };\n    Lookup.prototype.get = function (serviceIdentifier) {\n        if (serviceIdentifier === null || serviceIdentifier === undefined) {\n            throw new Error(ERROR_MSGS.NULL_ARGUMENT);\n        }\n        var entry = this._map.get(serviceIdentifier);\n        if (entry !== undefined) {\n            return entry;\n        }\n        else {\n            throw new Error(ERROR_MSGS.KEY_NOT_FOUND);\n        }\n    };\n    Lookup.prototype.remove = function (serviceIdentifier) {\n        if (serviceIdentifier === null || serviceIdentifier === undefined) {\n            throw new Error(ERROR_MSGS.NULL_ARGUMENT);\n        }\n        if (!this._map.delete(serviceIdentifier)) {\n            throw new Error(ERROR_MSGS.KEY_NOT_FOUND);\n        }\n    };\n    Lookup.prototype.removeByCondition = function (condition) {\n        var _this = this;\n        this._map.forEach(function (entries, key) {\n            var updatedEntries = entries.filter(function (entry) { return !condition(entry); });\n            if (updatedEntries.length > 0) {\n                _this._map.set(key, updatedEntries);\n            }\n            else {\n                _this._map.delete(key);\n            }\n        });\n    };\n    Lookup.prototype.hasKey = function (serviceIdentifier) {\n        if (serviceIdentifier === null || serviceIdentifier === undefined) {\n            throw new Error(ERROR_MSGS.NULL_ARGUMENT);\n        }\n        return this._map.has(serviceIdentifier);\n    };\n    Lookup.prototype.clone = function () {\n        var copy = new Lookup();\n        this._map.forEach(function (value, key) {\n            value.forEach(function (b) { return copy.add(key, b.clone()); });\n        });\n        return copy;\n    };\n    Lookup.prototype.traverse = function (func) {\n        this._map.forEach(function (value, key) {\n            func(key, value);\n        });\n    };\n    return Lookup;\n}());\nexports.Lookup = Lookup;\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar keys = require(\"./constants/metadata_keys\");\nexports.METADATA_KEY = keys;\nvar container_1 = require(\"./container/container\");\nexports.Container = container_1.Container;\nvar literal_types_1 = require(\"./constants/literal_types\");\nexports.BindingScopeEnum = literal_types_1.BindingScopeEnum;\nexports.BindingTypeEnum = literal_types_1.BindingTypeEnum;\nexports.TargetTypeEnum = literal_types_1.TargetTypeEnum;\nvar container_module_1 = require(\"./container/container_module\");\nexports.AsyncContainerModule = container_module_1.AsyncContainerModule;\nexports.ContainerModule = container_module_1.ContainerModule;\nvar injectable_1 = require(\"./annotation/injectable\");\nexports.injectable = injectable_1.injectable;\nvar tagged_1 = require(\"./annotation/tagged\");\nexports.tagged = tagged_1.tagged;\nvar named_1 = require(\"./annotation/named\");\nexports.named = named_1.named;\nvar inject_1 = require(\"./annotation/inject\");\nexports.inject = inject_1.inject;\nexports.LazyServiceIdentifer = inject_1.LazyServiceIdentifer;\nvar optional_1 = require(\"./annotation/optional\");\nexports.optional = optional_1.optional;\nvar unmanaged_1 = require(\"./annotation/unmanaged\");\nexports.unmanaged = unmanaged_1.unmanaged;\nvar multi_inject_1 = require(\"./annotation/multi_inject\");\nexports.multiInject = multi_inject_1.multiInject;\nvar target_name_1 = require(\"./annotation/target_name\");\nexports.targetName = target_name_1.targetName;\nvar post_construct_1 = require(\"./annotation/post_construct\");\nexports.postConstruct = post_construct_1.postConstruct;\nvar metadata_reader_1 = require(\"./planning/metadata_reader\");\nexports.MetadataReader = metadata_reader_1.MetadataReader;\nvar id_1 = require(\"./utils/id\");\nexports.id = id_1.id;\nvar decorator_utils_1 = require(\"./annotation/decorator_utils\");\nexports.decorate = decorator_utils_1.decorate;\nvar constraint_helpers_1 = require(\"./syntax/constraint_helpers\");\nexports.traverseAncerstors = constraint_helpers_1.traverseAncerstors;\nexports.taggedConstraint = constraint_helpers_1.taggedConstraint;\nexports.namedConstraint = constraint_helpers_1.namedConstraint;\nexports.typeConstraint = constraint_helpers_1.typeConstraint;\nvar serialization_1 = require(\"./utils/serialization\");\nexports.getServiceIdentifierAsString = serialization_1.getServiceIdentifierAsString;\nvar binding_utils_1 = require(\"./utils/binding_utils\");\nexports.multiBindToService = binding_utils_1.multiBindToService;\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar id_1 = require(\"../utils/id\");\nvar Context = (function () {\n    function Context(container) {\n        this.id = id_1.id();\n        this.container = container;\n    }\n    Context.prototype.addPlan = function (plan) {\n        this.plan = plan;\n    };\n    Context.prototype.setCurrentRequest = function (currentRequest) {\n        this.currentRequest = currentRequest;\n    };\n    return Context;\n}());\nexports.Context = Context;\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar METADATA_KEY = require(\"../constants/metadata_keys\");\nvar Metadata = (function () {\n    function Metadata(key, value) {\n        this.key = key;\n        this.value = value;\n    }\n    Metadata.prototype.toString = function () {\n        if (this.key === METADATA_KEY.NAMED_TAG) {\n            return \"named: \" + this.value.toString() + \" \";\n        }\n        else {\n            return \"tagged: { key:\" + this.key.toString() + \", value: \" + this.value + \" }\";\n        }\n    };\n    return Metadata;\n}());\nexports.Metadata = Metadata;\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar METADATA_KEY = require(\"../constants/metadata_keys\");\nvar MetadataReader = (function () {\n    function MetadataReader() {\n    }\n    MetadataReader.prototype.getConstructorMetadata = function (constructorFunc) {\n        var compilerGeneratedMetadata = Reflect.getMetadata(METADATA_KEY.PARAM_TYPES, constructorFunc);\n        var userGeneratedMetadata = Reflect.getMetadata(METADATA_KEY.TAGGED, constructorFunc);\n        return {\n            compilerGeneratedMetadata: compilerGeneratedMetadata,\n            userGeneratedMetadata: userGeneratedMetadata || {}\n        };\n    };\n    MetadataReader.prototype.getPropertiesMetadata = function (constructorFunc) {\n        var userGeneratedMetadata = Reflect.getMetadata(METADATA_KEY.TAGGED_PROP, constructorFunc) || [];\n        return userGeneratedMetadata;\n    };\n    return MetadataReader;\n}());\nexports.MetadataReader = MetadataReader;\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar Plan = (function () {\n    function Plan(parentContext, rootRequest) {\n        this.parentContext = parentContext;\n        this.rootRequest = rootRequest;\n    }\n    return Plan;\n}());\nexports.Plan = Plan;\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar binding_count_1 = require(\"../bindings/binding_count\");\nvar ERROR_MSGS = require(\"../constants/error_msgs\");\nvar literal_types_1 = require(\"../constants/literal_types\");\nvar METADATA_KEY = require(\"../constants/metadata_keys\");\nvar exceptions_1 = require(\"../utils/exceptions\");\nvar serialization_1 = require(\"../utils/serialization\");\nvar context_1 = require(\"./context\");\nvar metadata_1 = require(\"./metadata\");\nvar plan_1 = require(\"./plan\");\nvar reflection_utils_1 = require(\"./reflection_utils\");\nvar request_1 = require(\"./request\");\nvar target_1 = require(\"./target\");\nfunction getBindingDictionary(cntnr) {\n    return cntnr._bindingDictionary;\n}\nexports.getBindingDictionary = getBindingDictionary;\nfunction _createTarget(isMultiInject, targetType, serviceIdentifier, name, key, value) {\n    var metadataKey = isMultiInject ? METADATA_KEY.MULTI_INJECT_TAG : METADATA_KEY.INJECT_TAG;\n    var injectMetadata = new metadata_1.Metadata(metadataKey, serviceIdentifier);\n    var target = new target_1.Target(targetType, name, serviceIdentifier, injectMetadata);\n    if (key !== undefined) {\n        var tagMetadata = new metadata_1.Metadata(key, value);\n        target.metadata.push(tagMetadata);\n    }\n    return target;\n}\nfunction _getActiveBindings(metadataReader, avoidConstraints, context, parentRequest, target) {\n    var bindings = getBindings(context.container, target.serviceIdentifier);\n    var activeBindings = [];\n    if (bindings.length === binding_count_1.BindingCount.NoBindingsAvailable &&\n        context.container.options.autoBindInjectable &&\n        typeof target.serviceIdentifier === \"function\" &&\n        metadataReader.getConstructorMetadata(target.serviceIdentifier).compilerGeneratedMetadata) {\n        context.container.bind(target.serviceIdentifier).toSelf();\n        bindings = getBindings(context.container, target.serviceIdentifier);\n    }\n    if (!avoidConstraints) {\n        activeBindings = bindings.filter(function (binding) {\n            var request = new request_1.Request(binding.serviceIdentifier, context, parentRequest, binding, target);\n            return binding.constraint(request);\n        });\n    }\n    else {\n        activeBindings = bindings;\n    }\n    _validateActiveBindingCount(target.serviceIdentifier, activeBindings, target, context.container);\n    return activeBindings;\n}\nfunction _validateActiveBindingCount(serviceIdentifier, bindings, target, container) {\n    switch (bindings.length) {\n        case binding_count_1.BindingCount.NoBindingsAvailable:\n            if (target.isOptional()) {\n                return bindings;\n            }\n            else {\n                var serviceIdentifierString = serialization_1.getServiceIdentifierAsString(serviceIdentifier);\n                var msg = ERROR_MSGS.NOT_REGISTERED;\n                msg += serialization_1.listMetadataForTarget(serviceIdentifierString, target);\n                msg += serialization_1.listRegisteredBindingsForServiceIdentifier(container, serviceIdentifierString, getBindings);\n                throw new Error(msg);\n            }\n        case binding_count_1.BindingCount.OnlyOneBindingAvailable:\n            if (!target.isArray()) {\n                return bindings;\n            }\n        case binding_count_1.BindingCount.MultipleBindingsAvailable:\n        default:\n            if (!target.isArray()) {\n                var serviceIdentifierString = serialization_1.getServiceIdentifierAsString(serviceIdentifier);\n                var msg = ERROR_MSGS.AMBIGUOUS_MATCH + \" \" + serviceIdentifierString;\n                msg += serialization_1.listRegisteredBindingsForServiceIdentifier(container, serviceIdentifierString, getBindings);\n                throw new Error(msg);\n            }\n            else {\n                return bindings;\n            }\n    }\n}\nfunction _createSubRequests(metadataReader, avoidConstraints, serviceIdentifier, context, parentRequest, target) {\n    var activeBindings;\n    var childRequest;\n    if (parentRequest === null) {\n        activeBindings = _getActiveBindings(metadataReader, avoidConstraints, context, null, target);\n        childRequest = new request_1.Request(serviceIdentifier, context, null, activeBindings, target);\n        var thePlan = new plan_1.Plan(context, childRequest);\n        context.addPlan(thePlan);\n    }\n    else {\n        activeBindings = _getActiveBindings(metadataReader, avoidConstraints, context, parentRequest, target);\n        childRequest = parentRequest.addChildRequest(target.serviceIdentifier, activeBindings, target);\n    }\n    activeBindings.forEach(function (binding) {\n        var subChildRequest = null;\n        if (target.isArray()) {\n            subChildRequest = childRequest.addChildRequest(binding.serviceIdentifier, binding, target);\n        }\n        else {\n            if (binding.cache) {\n                return;\n            }\n            subChildRequest = childRequest;\n        }\n        if (binding.type === literal_types_1.BindingTypeEnum.Instance && binding.implementationType !== null) {\n            var dependencies = reflection_utils_1.getDependencies(metadataReader, binding.implementationType);\n            if (!context.container.options.skipBaseClassChecks) {\n                var baseClassDependencyCount = reflection_utils_1.getBaseClassDependencyCount(metadataReader, binding.implementationType);\n                if (dependencies.length < baseClassDependencyCount) {\n                    var error = ERROR_MSGS.ARGUMENTS_LENGTH_MISMATCH(reflection_utils_1.getFunctionName(binding.implementationType));\n                    throw new Error(error);\n                }\n            }\n            dependencies.forEach(function (dependency) {\n                _createSubRequests(metadataReader, false, dependency.serviceIdentifier, context, subChildRequest, dependency);\n            });\n        }\n    });\n}\nfunction getBindings(container, serviceIdentifier) {\n    var bindings = [];\n    var bindingDictionary = getBindingDictionary(container);\n    if (bindingDictionary.hasKey(serviceIdentifier)) {\n        bindings = bindingDictionary.get(serviceIdentifier);\n    }\n    else if (container.parent !== null) {\n        bindings = getBindings(container.parent, serviceIdentifier);\n    }\n    return bindings;\n}\nfunction plan(metadataReader, container, isMultiInject, targetType, serviceIdentifier, key, value, avoidConstraints) {\n    if (avoidConstraints === void 0) { avoidConstraints = false; }\n    var context = new context_1.Context(container);\n    var target = _createTarget(isMultiInject, targetType, serviceIdentifier, \"\", key, value);\n    try {\n        _createSubRequests(metadataReader, avoidConstraints, serviceIdentifier, context, null, target);\n        return context;\n    }\n    catch (error) {\n        if (exceptions_1.isStackOverflowExeption(error)) {\n            if (context.plan) {\n                serialization_1.circularDependencyToException(context.plan.rootRequest);\n            }\n        }\n        throw error;\n    }\n}\nexports.plan = plan;\nfunction createMockRequest(container, serviceIdentifier, key, value) {\n    var target = new target_1.Target(literal_types_1.TargetTypeEnum.Variable, \"\", serviceIdentifier, new metadata_1.Metadata(key, value));\n    var context = new context_1.Context(container);\n    var request = new request_1.Request(serviceIdentifier, context, null, [], target);\n    return request;\n}\nexports.createMockRequest = createMockRequest;\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar QueryableString = (function () {\n    function QueryableString(str) {\n        this.str = str;\n    }\n    QueryableString.prototype.startsWith = function (searchString) {\n        return this.str.indexOf(searchString) === 0;\n    };\n    QueryableString.prototype.endsWith = function (searchString) {\n        var reverseString = \"\";\n        var reverseSearchString = searchString.split(\"\").reverse().join(\"\");\n        reverseString = this.str.split(\"\").reverse().join(\"\");\n        return this.startsWith.call({ str: reverseString }, reverseSearchString);\n    };\n    QueryableString.prototype.contains = function (searchString) {\n        return (this.str.indexOf(searchString) !== -1);\n    };\n    QueryableString.prototype.equals = function (compareString) {\n        return this.str === compareString;\n    };\n    QueryableString.prototype.value = function () {\n        return this.str;\n    };\n    return QueryableString;\n}());\nexports.QueryableString = QueryableString;\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar inject_1 = require(\"../annotation/inject\");\nvar ERROR_MSGS = require(\"../constants/error_msgs\");\nvar literal_types_1 = require(\"../constants/literal_types\");\nvar METADATA_KEY = require(\"../constants/metadata_keys\");\nvar serialization_1 = require(\"../utils/serialization\");\nexports.getFunctionName = serialization_1.getFunctionName;\nvar target_1 = require(\"./target\");\nfunction getDependencies(metadataReader, func) {\n    var constructorName = serialization_1.getFunctionName(func);\n    var targets = getTargets(metadataReader, constructorName, func, false);\n    return targets;\n}\nexports.getDependencies = getDependencies;\nfunction getTargets(metadataReader, constructorName, func, isBaseClass) {\n    var metadata = metadataReader.getConstructorMetadata(func);\n    var serviceIdentifiers = metadata.compilerGeneratedMetadata;\n    if (serviceIdentifiers === undefined) {\n        var msg = ERROR_MSGS.MISSING_INJECTABLE_ANNOTATION + \" \" + constructorName + \".\";\n        throw new Error(msg);\n    }\n    var constructorArgsMetadata = metadata.userGeneratedMetadata;\n    var keys = Object.keys(constructorArgsMetadata);\n    var hasUserDeclaredUnknownInjections = (func.length === 0 && keys.length > 0);\n    var iterations = (hasUserDeclaredUnknownInjections) ? keys.length : func.length;\n    var constructorTargets = getConstructorArgsAsTargets(isBaseClass, constructorName, serviceIdentifiers, constructorArgsMetadata, iterations);\n    var propertyTargets = getClassPropsAsTargets(metadataReader, func);\n    var targets = constructorTargets.concat(propertyTargets);\n    return targets;\n}\nfunction getConstructorArgsAsTarget(index, isBaseClass, constructorName, serviceIdentifiers, constructorArgsMetadata) {\n    var targetMetadata = constructorArgsMetadata[index.toString()] || [];\n    var metadata = formatTargetMetadata(targetMetadata);\n    var isManaged = metadata.unmanaged !== true;\n    var serviceIdentifier = serviceIdentifiers[index];\n    var injectIdentifier = (metadata.inject || metadata.multiInject);\n    serviceIdentifier = (injectIdentifier) ? (injectIdentifier) : serviceIdentifier;\n    if (serviceIdentifier instanceof inject_1.LazyServiceIdentifer) {\n        serviceIdentifier = serviceIdentifier.unwrap();\n    }\n    if (isManaged) {\n        var isObject = serviceIdentifier === Object;\n        var isFunction = serviceIdentifier === Function;\n        var isUndefined = serviceIdentifier === undefined;\n        var isUnknownType = (isObject || isFunction || isUndefined);\n        if (!isBaseClass && isUnknownType) {\n            var msg = ERROR_MSGS.MISSING_INJECT_ANNOTATION + \" argument \" + index + \" in class \" + constructorName + \".\";\n            throw new Error(msg);\n        }\n        var target = new target_1.Target(literal_types_1.TargetTypeEnum.ConstructorArgument, metadata.targetName, serviceIdentifier);\n        target.metadata = targetMetadata;\n        return target;\n    }\n    return null;\n}\nfunction getConstructorArgsAsTargets(isBaseClass, constructorName, serviceIdentifiers, constructorArgsMetadata, iterations) {\n    var targets = [];\n    for (var i = 0; i < iterations; i++) {\n        var index = i;\n        var target = getConstructorArgsAsTarget(index, isBaseClass, constructorName, serviceIdentifiers, constructorArgsMetadata);\n        if (target !== null) {\n            targets.push(target);\n        }\n    }\n    return targets;\n}\nfunction getClassPropsAsTargets(metadataReader, constructorFunc) {\n    var classPropsMetadata = metadataReader.getPropertiesMetadata(constructorFunc);\n    var targets = [];\n    var keys = Object.keys(classPropsMetadata);\n    for (var _i = 0, keys_1 = keys; _i < keys_1.length; _i++) {\n        var key = keys_1[_i];\n        var targetMetadata = classPropsMetadata[key];\n        var metadata = formatTargetMetadata(classPropsMetadata[key]);\n        var targetName = metadata.targetName || key;\n        var serviceIdentifier = (metadata.inject || metadata.multiInject);\n        var target = new target_1.Target(literal_types_1.TargetTypeEnum.ClassProperty, targetName, serviceIdentifier);\n        target.metadata = targetMetadata;\n        targets.push(target);\n    }\n    var baseConstructor = Object.getPrototypeOf(constructorFunc.prototype).constructor;\n    if (baseConstructor !== Object) {\n        var baseTargets = getClassPropsAsTargets(metadataReader, baseConstructor);\n        targets = targets.concat(baseTargets);\n    }\n    return targets;\n}\nfunction getBaseClassDependencyCount(metadataReader, func) {\n    var baseConstructor = Object.getPrototypeOf(func.prototype).constructor;\n    if (baseConstructor !== Object) {\n        var baseConstructorName = serialization_1.getFunctionName(baseConstructor);\n        var targets = getTargets(metadataReader, baseConstructorName, baseConstructor, true);\n        var metadata = targets.map(function (t) {\n            return t.metadata.filter(function (m) {\n                return m.key === METADATA_KEY.UNMANAGED_TAG;\n            });\n        });\n        var unmanagedCount = [].concat.apply([], metadata).length;\n        var dependencyCount = targets.length - unmanagedCount;\n        if (dependencyCount > 0) {\n            return dependencyCount;\n        }\n        else {\n            return getBaseClassDependencyCount(metadataReader, baseConstructor);\n        }\n    }\n    else {\n        return 0;\n    }\n}\nexports.getBaseClassDependencyCount = getBaseClassDependencyCount;\nfunction formatTargetMetadata(targetMetadata) {\n    var targetMetadataMap = {};\n    targetMetadata.forEach(function (m) {\n        targetMetadataMap[m.key.toString()] = m.value;\n    });\n    return {\n        inject: targetMetadataMap[METADATA_KEY.INJECT_TAG],\n        multiInject: targetMetadataMap[METADATA_KEY.MULTI_INJECT_TAG],\n        targetName: targetMetadataMap[METADATA_KEY.NAME_TAG],\n        unmanaged: targetMetadataMap[METADATA_KEY.UNMANAGED_TAG]\n    };\n}\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar id_1 = require(\"../utils/id\");\nvar Request = (function () {\n    function Request(serviceIdentifier, parentContext, parentRequest, bindings, target) {\n        this.id = id_1.id();\n        this.serviceIdentifier = serviceIdentifier;\n        this.parentContext = parentContext;\n        this.parentRequest = parentRequest;\n        this.target = target;\n        this.childRequests = [];\n        this.bindings = (Array.isArray(bindings) ? bindings : [bindings]);\n        this.requestScope = parentRequest === null\n            ? new Map()\n            : null;\n    }\n    Request.prototype.addChildRequest = function (serviceIdentifier, bindings, target) {\n        var child = new Request(serviceIdentifier, this.parentContext, this, bindings, target);\n        this.childRequests.push(child);\n        return child;\n    };\n    return Request;\n}());\nexports.Request = Request;\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar METADATA_KEY = require(\"../constants/metadata_keys\");\nvar id_1 = require(\"../utils/id\");\nvar metadata_1 = require(\"./metadata\");\nvar queryable_string_1 = require(\"./queryable_string\");\nvar Target = (function () {\n    function Target(type, name, serviceIdentifier, namedOrTagged) {\n        this.id = id_1.id();\n        this.type = type;\n        this.serviceIdentifier = serviceIdentifier;\n        this.name = new queryable_string_1.QueryableString(name || \"\");\n        this.metadata = new Array();\n        var metadataItem = null;\n        if (typeof namedOrTagged === \"string\") {\n            metadataItem = new metadata_1.Metadata(METADATA_KEY.NAMED_TAG, namedOrTagged);\n        }\n        else if (namedOrTagged instanceof metadata_1.Metadata) {\n            metadataItem = namedOrTagged;\n        }\n        if (metadataItem !== null) {\n            this.metadata.push(metadataItem);\n        }\n    }\n    Target.prototype.hasTag = function (key) {\n        for (var _i = 0, _a = this.metadata; _i < _a.length; _i++) {\n            var m = _a[_i];\n            if (m.key === key) {\n                return true;\n            }\n        }\n        return false;\n    };\n    Target.prototype.isArray = function () {\n        return this.hasTag(METADATA_KEY.MULTI_INJECT_TAG);\n    };\n    Target.prototype.matchesArray = function (name) {\n        return this.matchesTag(METADATA_KEY.MULTI_INJECT_TAG)(name);\n    };\n    Target.prototype.isNamed = function () {\n        return this.hasTag(METADATA_KEY.NAMED_TAG);\n    };\n    Target.prototype.isTagged = function () {\n        return this.metadata.some(function (m) {\n            return (m.key !== METADATA_KEY.INJECT_TAG) &&\n                (m.key !== METADATA_KEY.MULTI_INJECT_TAG) &&\n                (m.key !== METADATA_KEY.NAME_TAG) &&\n                (m.key !== METADATA_KEY.UNMANAGED_TAG) &&\n                (m.key !== METADATA_KEY.NAMED_TAG);\n        });\n    };\n    Target.prototype.isOptional = function () {\n        return this.matchesTag(METADATA_KEY.OPTIONAL_TAG)(true);\n    };\n    Target.prototype.getNamedTag = function () {\n        if (this.isNamed()) {\n            return this.metadata.filter(function (m) { return m.key === METADATA_KEY.NAMED_TAG; })[0];\n        }\n        return null;\n    };\n    Target.prototype.getCustomTags = function () {\n        if (this.isTagged()) {\n            return this.metadata.filter(function (m) {\n                return (m.key !== METADATA_KEY.INJECT_TAG) &&\n                    (m.key !== METADATA_KEY.MULTI_INJECT_TAG) &&\n                    (m.key !== METADATA_KEY.NAME_TAG) &&\n                    (m.key !== METADATA_KEY.UNMANAGED_TAG) &&\n                    (m.key !== METADATA_KEY.NAMED_TAG);\n            });\n        }\n        return null;\n    };\n    Target.prototype.matchesNamedTag = function (name) {\n        return this.matchesTag(METADATA_KEY.NAMED_TAG)(name);\n    };\n    Target.prototype.matchesTag = function (key) {\n        var _this = this;\n        return function (value) {\n            for (var _i = 0, _a = _this.metadata; _i < _a.length; _i++) {\n                var m = _a[_i];\n                if (m.key === key && m.value === value) {\n                    return true;\n                }\n            }\n            return false;\n        };\n    };\n    return Target;\n}());\nexports.Target = Target;\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar error_msgs_1 = require(\"../constants/error_msgs\");\nvar literal_types_1 = require(\"../constants/literal_types\");\nvar METADATA_KEY = require(\"../constants/metadata_keys\");\nfunction _injectProperties(instance, childRequests, resolveRequest) {\n    var propertyInjectionsRequests = childRequests.filter(function (childRequest) {\n        return (childRequest.target !== null &&\n            childRequest.target.type === literal_types_1.TargetTypeEnum.ClassProperty);\n    });\n    var propertyInjections = propertyInjectionsRequests.map(resolveRequest);\n    propertyInjectionsRequests.forEach(function (r, index) {\n        var propertyName = \"\";\n        propertyName = r.target.name.value();\n        var injection = propertyInjections[index];\n        instance[propertyName] = injection;\n    });\n    return instance;\n}\nfunction _createInstance(Func, injections) {\n    return new (Func.bind.apply(Func, [void 0].concat(injections)))();\n}\nfunction _postConstruct(constr, result) {\n    if (Reflect.hasMetadata(METADATA_KEY.POST_CONSTRUCT, constr)) {\n        var data = Reflect.getMetadata(METADATA_KEY.POST_CONSTRUCT, constr);\n        try {\n            result[data.value]();\n        }\n        catch (e) {\n            throw new Error(error_msgs_1.POST_CONSTRUCT_ERROR(constr.name, e.message));\n        }\n    }\n}\nfunction resolveInstance(constr, childRequests, resolveRequest) {\n    var result = null;\n    if (childRequests.length > 0) {\n        var constructorInjectionsRequests = childRequests.filter(function (childRequest) {\n            return (childRequest.target !== null && childRequest.target.type === literal_types_1.TargetTypeEnum.ConstructorArgument);\n        });\n        var constructorInjections = constructorInjectionsRequests.map(resolveRequest);\n        result = _createInstance(constr, constructorInjections);\n        result = _injectProperties(result, childRequests, resolveRequest);\n    }\n    else {\n        result = new constr();\n    }\n    _postConstruct(constr, result);\n    return result;\n}\nexports.resolveInstance = resolveInstance;\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar ERROR_MSGS = require(\"../constants/error_msgs\");\nvar literal_types_1 = require(\"../constants/literal_types\");\nvar exceptions_1 = require(\"../utils/exceptions\");\nvar serialization_1 = require(\"../utils/serialization\");\nvar instantiation_1 = require(\"./instantiation\");\nvar invokeFactory = function (factoryType, serviceIdentifier, fn) {\n    try {\n        return fn();\n    }\n    catch (error) {\n        if (exceptions_1.isStackOverflowExeption(error)) {\n            throw new Error(ERROR_MSGS.CIRCULAR_DEPENDENCY_IN_FACTORY(factoryType, serviceIdentifier.toString()));\n        }\n        else {\n            throw error;\n        }\n    }\n};\nvar _resolveRequest = function (requestScope) {\n    return function (request) {\n        request.parentContext.setCurrentRequest(request);\n        var bindings = request.bindings;\n        var childRequests = request.childRequests;\n        var targetIsAnArray = request.target && request.target.isArray();\n        var targetParentIsNotAnArray = !request.parentRequest ||\n            !request.parentRequest.target ||\n            !request.target ||\n            !request.parentRequest.target.matchesArray(request.target.serviceIdentifier);\n        if (targetIsAnArray && targetParentIsNotAnArray) {\n            return childRequests.map(function (childRequest) {\n                var _f = _resolveRequest(requestScope);\n                return _f(childRequest);\n            });\n        }\n        else {\n            var result = null;\n            if (request.target.isOptional() && bindings.length === 0) {\n                return undefined;\n            }\n            var binding_1 = bindings[0];\n            var isSingleton = binding_1.scope === literal_types_1.BindingScopeEnum.Singleton;\n            var isRequestSingleton = binding_1.scope === literal_types_1.BindingScopeEnum.Request;\n            if (isSingleton && binding_1.activated) {\n                return binding_1.cache;\n            }\n            if (isRequestSingleton &&\n                requestScope !== null &&\n                requestScope.has(binding_1.id)) {\n                return requestScope.get(binding_1.id);\n            }\n            if (binding_1.type === literal_types_1.BindingTypeEnum.ConstantValue) {\n                result = binding_1.cache;\n            }\n            else if (binding_1.type === literal_types_1.BindingTypeEnum.Function) {\n                result = binding_1.cache;\n            }\n            else if (binding_1.type === literal_types_1.BindingTypeEnum.Constructor) {\n                result = binding_1.implementationType;\n            }\n            else if (binding_1.type === literal_types_1.BindingTypeEnum.DynamicValue && binding_1.dynamicValue !== null) {\n                result = invokeFactory(\"toDynamicValue\", binding_1.serviceIdentifier, function () { return binding_1.dynamicValue(request.parentContext); });\n            }\n            else if (binding_1.type === literal_types_1.BindingTypeEnum.Factory && binding_1.factory !== null) {\n                result = invokeFactory(\"toFactory\", binding_1.serviceIdentifier, function () { return binding_1.factory(request.parentContext); });\n            }\n            else if (binding_1.type === literal_types_1.BindingTypeEnum.Provider && binding_1.provider !== null) {\n                result = invokeFactory(\"toProvider\", binding_1.serviceIdentifier, function () { return binding_1.provider(request.parentContext); });\n            }\n            else if (binding_1.type === literal_types_1.BindingTypeEnum.Instance && binding_1.implementationType !== null) {\n                result = instantiation_1.resolveInstance(binding_1.implementationType, childRequests, _resolveRequest(requestScope));\n            }\n            else {\n                var serviceIdentifier = serialization_1.getServiceIdentifierAsString(request.serviceIdentifier);\n                throw new Error(ERROR_MSGS.INVALID_BINDING_TYPE + \" \" + serviceIdentifier);\n            }\n            if (typeof binding_1.onActivation === \"function\") {\n                result = binding_1.onActivation(request.parentContext, result);\n            }\n            if (isSingleton) {\n                binding_1.cache = result;\n                binding_1.activated = true;\n            }\n            if (isRequestSingleton &&\n                requestScope !== null &&\n                !requestScope.has(binding_1.id)) {\n                requestScope.set(binding_1.id, result);\n            }\n            return result;\n        }\n    };\n};\nfunction resolve(context) {\n    var _f = _resolveRequest(context.plan.rootRequest.requestScope);\n    return _f(context.plan.rootRequest);\n}\nexports.resolve = resolve;\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar literal_types_1 = require(\"../constants/literal_types\");\nvar binding_when_on_syntax_1 = require(\"./binding_when_on_syntax\");\nvar BindingInSyntax = (function () {\n    function BindingInSyntax(binding) {\n        this._binding = binding;\n    }\n    BindingInSyntax.prototype.inRequestScope = function () {\n        this._binding.scope = literal_types_1.BindingScopeEnum.Request;\n        return new binding_when_on_syntax_1.BindingWhenOnSyntax(this._binding);\n    };\n    BindingInSyntax.prototype.inSingletonScope = function () {\n        this._binding.scope = literal_types_1.BindingScopeEnum.Singleton;\n        return new binding_when_on_syntax_1.BindingWhenOnSyntax(this._binding);\n    };\n    BindingInSyntax.prototype.inTransientScope = function () {\n        this._binding.scope = literal_types_1.BindingScopeEnum.Transient;\n        return new binding_when_on_syntax_1.BindingWhenOnSyntax(this._binding);\n    };\n    return BindingInSyntax;\n}());\nexports.BindingInSyntax = BindingInSyntax;\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar binding_in_syntax_1 = require(\"./binding_in_syntax\");\nvar binding_on_syntax_1 = require(\"./binding_on_syntax\");\nvar binding_when_syntax_1 = require(\"./binding_when_syntax\");\nvar BindingInWhenOnSyntax = (function () {\n    function BindingInWhenOnSyntax(binding) {\n        this._binding = binding;\n        this._bindingWhenSyntax = new binding_when_syntax_1.BindingWhenSyntax(this._binding);\n        this._bindingOnSyntax = new binding_on_syntax_1.BindingOnSyntax(this._binding);\n        this._bindingInSyntax = new binding_in_syntax_1.BindingInSyntax(binding);\n    }\n    BindingInWhenOnSyntax.prototype.inRequestScope = function () {\n        return this._bindingInSyntax.inRequestScope();\n    };\n    BindingInWhenOnSyntax.prototype.inSingletonScope = function () {\n        return this._bindingInSyntax.inSingletonScope();\n    };\n    BindingInWhenOnSyntax.prototype.inTransientScope = function () {\n        return this._bindingInSyntax.inTransientScope();\n    };\n    BindingInWhenOnSyntax.prototype.when = function (constraint) {\n        return this._bindingWhenSyntax.when(constraint);\n    };\n    BindingInWhenOnSyntax.prototype.whenTargetNamed = function (name) {\n        return this._bindingWhenSyntax.whenTargetNamed(name);\n    };\n    BindingInWhenOnSyntax.prototype.whenTargetIsDefault = function () {\n        return this._bindingWhenSyntax.whenTargetIsDefault();\n    };\n    BindingInWhenOnSyntax.prototype.whenTargetTagged = function (tag, value) {\n        return this._bindingWhenSyntax.whenTargetTagged(tag, value);\n    };\n    BindingInWhenOnSyntax.prototype.whenInjectedInto = function (parent) {\n        return this._bindingWhenSyntax.whenInjectedInto(parent);\n    };\n    BindingInWhenOnSyntax.prototype.whenParentNamed = function (name) {\n        return this._bindingWhenSyntax.whenParentNamed(name);\n    };\n    BindingInWhenOnSyntax.prototype.whenParentTagged = function (tag, value) {\n        return this._bindingWhenSyntax.whenParentTagged(tag, value);\n    };\n    BindingInWhenOnSyntax.prototype.whenAnyAncestorIs = function (ancestor) {\n        return this._bindingWhenSyntax.whenAnyAncestorIs(ancestor);\n    };\n    BindingInWhenOnSyntax.prototype.whenNoAncestorIs = function (ancestor) {\n        return this._bindingWhenSyntax.whenNoAncestorIs(ancestor);\n    };\n    BindingInWhenOnSyntax.prototype.whenAnyAncestorNamed = function (name) {\n        return this._bindingWhenSyntax.whenAnyAncestorNamed(name);\n    };\n    BindingInWhenOnSyntax.prototype.whenAnyAncestorTagged = function (tag, value) {\n        return this._bindingWhenSyntax.whenAnyAncestorTagged(tag, value);\n    };\n    BindingInWhenOnSyntax.prototype.whenNoAncestorNamed = function (name) {\n        return this._bindingWhenSyntax.whenNoAncestorNamed(name);\n    };\n    BindingInWhenOnSyntax.prototype.whenNoAncestorTagged = function (tag, value) {\n        return this._bindingWhenSyntax.whenNoAncestorTagged(tag, value);\n    };\n    BindingInWhenOnSyntax.prototype.whenAnyAncestorMatches = function (constraint) {\n        return this._bindingWhenSyntax.whenAnyAncestorMatches(constraint);\n    };\n    BindingInWhenOnSyntax.prototype.whenNoAncestorMatches = function (constraint) {\n        return this._bindingWhenSyntax.whenNoAncestorMatches(constraint);\n    };\n    BindingInWhenOnSyntax.prototype.onActivation = function (handler) {\n        return this._bindingOnSyntax.onActivation(handler);\n    };\n    return BindingInWhenOnSyntax;\n}());\nexports.BindingInWhenOnSyntax = BindingInWhenOnSyntax;\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar binding_when_syntax_1 = require(\"./binding_when_syntax\");\nvar BindingOnSyntax = (function () {\n    function BindingOnSyntax(binding) {\n        this._binding = binding;\n    }\n    BindingOnSyntax.prototype.onActivation = function (handler) {\n        this._binding.onActivation = handler;\n        return new binding_when_syntax_1.BindingWhenSyntax(this._binding);\n    };\n    return BindingOnSyntax;\n}());\nexports.BindingOnSyntax = BindingOnSyntax;\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar ERROR_MSGS = require(\"../constants/error_msgs\");\nvar literal_types_1 = require(\"../constants/literal_types\");\nvar binding_in_when_on_syntax_1 = require(\"./binding_in_when_on_syntax\");\nvar binding_when_on_syntax_1 = require(\"./binding_when_on_syntax\");\nvar BindingToSyntax = (function () {\n    function BindingToSyntax(binding) {\n        this._binding = binding;\n    }\n    BindingToSyntax.prototype.to = function (constructor) {\n        this._binding.type = literal_types_1.BindingTypeEnum.Instance;\n        this._binding.implementationType = constructor;\n        return new binding_in_when_on_syntax_1.BindingInWhenOnSyntax(this._binding);\n    };\n    BindingToSyntax.prototype.toSelf = function () {\n        if (typeof this._binding.serviceIdentifier !== \"function\") {\n            throw new Error(\"\" + ERROR_MSGS.INVALID_TO_SELF_VALUE);\n        }\n        var self = this._binding.serviceIdentifier;\n        return this.to(self);\n    };\n    BindingToSyntax.prototype.toConstantValue = function (value) {\n        this._binding.type = literal_types_1.BindingTypeEnum.ConstantValue;\n        this._binding.cache = value;\n        this._binding.dynamicValue = null;\n        this._binding.implementationType = null;\n        return new binding_when_on_syntax_1.BindingWhenOnSyntax(this._binding);\n    };\n    BindingToSyntax.prototype.toDynamicValue = function (func) {\n        this._binding.type = literal_types_1.BindingTypeEnum.DynamicValue;\n        this._binding.cache = null;\n        this._binding.dynamicValue = func;\n        this._binding.implementationType = null;\n        return new binding_in_when_on_syntax_1.BindingInWhenOnSyntax(this._binding);\n    };\n    BindingToSyntax.prototype.toConstructor = function (constructor) {\n        this._binding.type = literal_types_1.BindingTypeEnum.Constructor;\n        this._binding.implementationType = constructor;\n        return new binding_when_on_syntax_1.BindingWhenOnSyntax(this._binding);\n    };\n    BindingToSyntax.prototype.toFactory = function (factory) {\n        this._binding.type = literal_types_1.BindingTypeEnum.Factory;\n        this._binding.factory = factory;\n        return new binding_when_on_syntax_1.BindingWhenOnSyntax(this._binding);\n    };\n    BindingToSyntax.prototype.toFunction = function (func) {\n        if (typeof func !== \"function\") {\n            throw new Error(ERROR_MSGS.INVALID_FUNCTION_BINDING);\n        }\n        var bindingWhenOnSyntax = this.toConstantValue(func);\n        this._binding.type = literal_types_1.BindingTypeEnum.Function;\n        return bindingWhenOnSyntax;\n    };\n    BindingToSyntax.prototype.toAutoFactory = function (serviceIdentifier) {\n        this._binding.type = literal_types_1.BindingTypeEnum.Factory;\n        this._binding.factory = function (context) {\n            var autofactory = function () { return context.container.get(serviceIdentifier); };\n            return autofactory;\n        };\n        return new binding_when_on_syntax_1.BindingWhenOnSyntax(this._binding);\n    };\n    BindingToSyntax.prototype.toProvider = function (provider) {\n        this._binding.type = literal_types_1.BindingTypeEnum.Provider;\n        this._binding.provider = provider;\n        return new binding_when_on_syntax_1.BindingWhenOnSyntax(this._binding);\n    };\n    BindingToSyntax.prototype.toService = function (service) {\n        this.toDynamicValue(function (context) { return context.container.get(service); });\n    };\n    return BindingToSyntax;\n}());\nexports.BindingToSyntax = BindingToSyntax;\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar binding_on_syntax_1 = require(\"./binding_on_syntax\");\nvar binding_when_syntax_1 = require(\"./binding_when_syntax\");\nvar BindingWhenOnSyntax = (function () {\n    function BindingWhenOnSyntax(binding) {\n        this._binding = binding;\n        this._bindingWhenSyntax = new binding_when_syntax_1.BindingWhenSyntax(this._binding);\n        this._bindingOnSyntax = new binding_on_syntax_1.BindingOnSyntax(this._binding);\n    }\n    BindingWhenOnSyntax.prototype.when = function (constraint) {\n        return this._bindingWhenSyntax.when(constraint);\n    };\n    BindingWhenOnSyntax.prototype.whenTargetNamed = function (name) {\n        return this._bindingWhenSyntax.whenTargetNamed(name);\n    };\n    BindingWhenOnSyntax.prototype.whenTargetIsDefault = function () {\n        return this._bindingWhenSyntax.whenTargetIsDefault();\n    };\n    BindingWhenOnSyntax.prototype.whenTargetTagged = function (tag, value) {\n        return this._bindingWhenSyntax.whenTargetTagged(tag, value);\n    };\n    BindingWhenOnSyntax.prototype.whenInjectedInto = function (parent) {\n        return this._bindingWhenSyntax.whenInjectedInto(parent);\n    };\n    BindingWhenOnSyntax.prototype.whenParentNamed = function (name) {\n        return this._bindingWhenSyntax.whenParentNamed(name);\n    };\n    BindingWhenOnSyntax.prototype.whenParentTagged = function (tag, value) {\n        return this._bindingWhenSyntax.whenParentTagged(tag, value);\n    };\n    BindingWhenOnSyntax.prototype.whenAnyAncestorIs = function (ancestor) {\n        return this._bindingWhenSyntax.whenAnyAncestorIs(ancestor);\n    };\n    BindingWhenOnSyntax.prototype.whenNoAncestorIs = function (ancestor) {\n        return this._bindingWhenSyntax.whenNoAncestorIs(ancestor);\n    };\n    BindingWhenOnSyntax.prototype.whenAnyAncestorNamed = function (name) {\n        return this._bindingWhenSyntax.whenAnyAncestorNamed(name);\n    };\n    BindingWhenOnSyntax.prototype.whenAnyAncestorTagged = function (tag, value) {\n        return this._bindingWhenSyntax.whenAnyAncestorTagged(tag, value);\n    };\n    BindingWhenOnSyntax.prototype.whenNoAncestorNamed = function (name) {\n        return this._bindingWhenSyntax.whenNoAncestorNamed(name);\n    };\n    BindingWhenOnSyntax.prototype.whenNoAncestorTagged = function (tag, value) {\n        return this._bindingWhenSyntax.whenNoAncestorTagged(tag, value);\n    };\n    BindingWhenOnSyntax.prototype.whenAnyAncestorMatches = function (constraint) {\n        return this._bindingWhenSyntax.whenAnyAncestorMatches(constraint);\n    };\n    BindingWhenOnSyntax.prototype.whenNoAncestorMatches = function (constraint) {\n        return this._bindingWhenSyntax.whenNoAncestorMatches(constraint);\n    };\n    BindingWhenOnSyntax.prototype.onActivation = function (handler) {\n        return this._bindingOnSyntax.onActivation(handler);\n    };\n    return BindingWhenOnSyntax;\n}());\nexports.BindingWhenOnSyntax = BindingWhenOnSyntax;\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar binding_on_syntax_1 = require(\"./binding_on_syntax\");\nvar constraint_helpers_1 = require(\"./constraint_helpers\");\nvar BindingWhenSyntax = (function () {\n    function BindingWhenSyntax(binding) {\n        this._binding = binding;\n    }\n    BindingWhenSyntax.prototype.when = function (constraint) {\n        this._binding.constraint = constraint;\n        return new binding_on_syntax_1.BindingOnSyntax(this._binding);\n    };\n    BindingWhenSyntax.prototype.whenTargetNamed = function (name) {\n        this._binding.constraint = constraint_helpers_1.namedConstraint(name);\n        return new binding_on_syntax_1.BindingOnSyntax(this._binding);\n    };\n    BindingWhenSyntax.prototype.whenTargetIsDefault = function () {\n        this._binding.constraint = function (request) {\n            var targetIsDefault = (request.target !== null) &&\n                (!request.target.isNamed()) &&\n                (!request.target.isTagged());\n            return targetIsDefault;\n        };\n        return new binding_on_syntax_1.BindingOnSyntax(this._binding);\n    };\n    BindingWhenSyntax.prototype.whenTargetTagged = function (tag, value) {\n        this._binding.constraint = constraint_helpers_1.taggedConstraint(tag)(value);\n        return new binding_on_syntax_1.BindingOnSyntax(this._binding);\n    };\n    BindingWhenSyntax.prototype.whenInjectedInto = function (parent) {\n        this._binding.constraint = function (request) {\n            return constraint_helpers_1.typeConstraint(parent)(request.parentRequest);\n        };\n        return new binding_on_syntax_1.BindingOnSyntax(this._binding);\n    };\n    BindingWhenSyntax.prototype.whenParentNamed = function (name) {\n        this._binding.constraint = function (request) {\n            return constraint_helpers_1.namedConstraint(name)(request.parentRequest);\n        };\n        return new binding_on_syntax_1.BindingOnSyntax(this._binding);\n    };\n    BindingWhenSyntax.prototype.whenParentTagged = function (tag, value) {\n        this._binding.constraint = function (request) {\n            return constraint_helpers_1.taggedConstraint(tag)(value)(request.parentRequest);\n        };\n        return new binding_on_syntax_1.BindingOnSyntax(this._binding);\n    };\n    BindingWhenSyntax.prototype.whenAnyAncestorIs = function (ancestor) {\n        this._binding.constraint = function (request) {\n            return constraint_helpers_1.traverseAncerstors(request, constraint_helpers_1.typeConstraint(ancestor));\n        };\n        return new binding_on_syntax_1.BindingOnSyntax(this._binding);\n    };\n    BindingWhenSyntax.prototype.whenNoAncestorIs = function (ancestor) {\n        this._binding.constraint = function (request) {\n            return !constraint_helpers_1.traverseAncerstors(request, constraint_helpers_1.typeConstraint(ancestor));\n        };\n        return new binding_on_syntax_1.BindingOnSyntax(this._binding);\n    };\n    BindingWhenSyntax.prototype.whenAnyAncestorNamed = function (name) {\n        this._binding.constraint = function (request) {\n            return constraint_helpers_1.traverseAncerstors(request, constraint_helpers_1.namedConstraint(name));\n        };\n        return new binding_on_syntax_1.BindingOnSyntax(this._binding);\n    };\n    BindingWhenSyntax.prototype.whenNoAncestorNamed = function (name) {\n        this._binding.constraint = function (request) {\n            return !constraint_helpers_1.traverseAncerstors(request, constraint_helpers_1.namedConstraint(name));\n        };\n        return new binding_on_syntax_1.BindingOnSyntax(this._binding);\n    };\n    BindingWhenSyntax.prototype.whenAnyAncestorTagged = function (tag, value) {\n        this._binding.constraint = function (request) {\n            return constraint_helpers_1.traverseAncerstors(request, constraint_helpers_1.taggedConstraint(tag)(value));\n        };\n        return new binding_on_syntax_1.BindingOnSyntax(this._binding);\n    };\n    BindingWhenSyntax.prototype.whenNoAncestorTagged = function (tag, value) {\n        this._binding.constraint = function (request) {\n            return !constraint_helpers_1.traverseAncerstors(request, constraint_helpers_1.taggedConstraint(tag)(value));\n        };\n        return new binding_on_syntax_1.BindingOnSyntax(this._binding);\n    };\n    BindingWhenSyntax.prototype.whenAnyAncestorMatches = function (constraint) {\n        this._binding.constraint = function (request) {\n            return constraint_helpers_1.traverseAncerstors(request, constraint);\n        };\n        return new binding_on_syntax_1.BindingOnSyntax(this._binding);\n    };\n    BindingWhenSyntax.prototype.whenNoAncestorMatches = function (constraint) {\n        this._binding.constraint = function (request) {\n            return !constraint_helpers_1.traverseAncerstors(request, constraint);\n        };\n        return new binding_on_syntax_1.BindingOnSyntax(this._binding);\n    };\n    return BindingWhenSyntax;\n}());\nexports.BindingWhenSyntax = BindingWhenSyntax;\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar METADATA_KEY = require(\"../constants/metadata_keys\");\nvar metadata_1 = require(\"../planning/metadata\");\nvar traverseAncerstors = function (request, constraint) {\n    var parent = request.parentRequest;\n    if (parent !== null) {\n        return constraint(parent) ? true : traverseAncerstors(parent, constraint);\n    }\n    else {\n        return false;\n    }\n};\nexports.traverseAncerstors = traverseAncerstors;\nvar taggedConstraint = function (key) { return function (value) {\n    var constraint = function (request) {\n        return request !== null && request.target !== null && request.target.matchesTag(key)(value);\n    };\n    constraint.metaData = new metadata_1.Metadata(key, value);\n    return constraint;\n}; };\nexports.taggedConstraint = taggedConstraint;\nvar namedConstraint = taggedConstraint(METADATA_KEY.NAMED_TAG);\nexports.namedConstraint = namedConstraint;\nvar typeConstraint = function (type) { return function (request) {\n    var binding = null;\n    if (request !== null) {\n        binding = request.bindings[0];\n        if (typeof type === \"string\") {\n            var serviceIdentifier = binding.serviceIdentifier;\n            return serviceIdentifier === type;\n        }\n        else {\n            var constructor = request.bindings[0].implementationType;\n            return type === constructor;\n        }\n    }\n    return false;\n}; };\nexports.typeConstraint = typeConstraint;\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.multiBindToService = function (container) {\n    return function (service) {\n        return function () {\n            var types = [];\n            for (var _i = 0; _i < arguments.length; _i++) {\n                types[_i] = arguments[_i];\n            }\n            return types.forEach(function (t) { return container.bind(t).toService(service); });\n        };\n    };\n};\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar ERROR_MSGS = require(\"../constants/error_msgs\");\nfunction isStackOverflowExeption(error) {\n    return (error instanceof RangeError ||\n        error.message === ERROR_MSGS.STACK_OVERFLOW);\n}\nexports.isStackOverflowExeption = isStackOverflowExeption;\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar idCounter = 0;\nfunction id() {\n    return idCounter++;\n}\nexports.id = id;\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar ERROR_MSGS = require(\"../constants/error_msgs\");\nfunction getServiceIdentifierAsString(serviceIdentifier) {\n    if (typeof serviceIdentifier === \"function\") {\n        var _serviceIdentifier = serviceIdentifier;\n        return _serviceIdentifier.name;\n    }\n    else if (typeof serviceIdentifier === \"symbol\") {\n        return serviceIdentifier.toString();\n    }\n    else {\n        var _serviceIdentifier = serviceIdentifier;\n        return _serviceIdentifier;\n    }\n}\nexports.getServiceIdentifierAsString = getServiceIdentifierAsString;\nfunction listRegisteredBindingsForServiceIdentifier(container, serviceIdentifier, getBindings) {\n    var registeredBindingsList = \"\";\n    var registeredBindings = getBindings(container, serviceIdentifier);\n    if (registeredBindings.length !== 0) {\n        registeredBindingsList = \"\\nRegistered bindings:\";\n        registeredBindings.forEach(function (binding) {\n            var name = \"Object\";\n            if (binding.implementationType !== null) {\n                name = getFunctionName(binding.implementationType);\n            }\n            registeredBindingsList = registeredBindingsList + \"\\n \" + name;\n            if (binding.constraint.metaData) {\n                registeredBindingsList = registeredBindingsList + \" - \" + binding.constraint.metaData;\n            }\n        });\n    }\n    return registeredBindingsList;\n}\nexports.listRegisteredBindingsForServiceIdentifier = listRegisteredBindingsForServiceIdentifier;\nfunction alreadyDependencyChain(request, serviceIdentifier) {\n    if (request.parentRequest === null) {\n        return false;\n    }\n    else if (request.parentRequest.serviceIdentifier === serviceIdentifier) {\n        return true;\n    }\n    else {\n        return alreadyDependencyChain(request.parentRequest, serviceIdentifier);\n    }\n}\nfunction dependencyChainToString(request) {\n    function _createStringArr(req, result) {\n        if (result === void 0) { result = []; }\n        var serviceIdentifier = getServiceIdentifierAsString(req.serviceIdentifier);\n        result.push(serviceIdentifier);\n        if (req.parentRequest !== null) {\n            return _createStringArr(req.parentRequest, result);\n        }\n        return result;\n    }\n    var stringArr = _createStringArr(request);\n    return stringArr.reverse().join(\" --> \");\n}\nfunction circularDependencyToException(request) {\n    request.childRequests.forEach(function (childRequest) {\n        if (alreadyDependencyChain(childRequest, childRequest.serviceIdentifier)) {\n            var services = dependencyChainToString(childRequest);\n            throw new Error(ERROR_MSGS.CIRCULAR_DEPENDENCY + \" \" + services);\n        }\n        else {\n            circularDependencyToException(childRequest);\n        }\n    });\n}\nexports.circularDependencyToException = circularDependencyToException;\nfunction listMetadataForTarget(serviceIdentifierString, target) {\n    if (target.isTagged() || target.isNamed()) {\n        var m_1 = \"\";\n        var namedTag = target.getNamedTag();\n        var otherTags = target.getCustomTags();\n        if (namedTag !== null) {\n            m_1 += namedTag.toString() + \"\\n\";\n        }\n        if (otherTags !== null) {\n            otherTags.forEach(function (tag) {\n                m_1 += tag.toString() + \"\\n\";\n            });\n        }\n        return \" \" + serviceIdentifierString + \"\\n \" + serviceIdentifierString + \" - \" + m_1;\n    }\n    else {\n        return \" \" + serviceIdentifierString;\n    }\n}\nexports.listMetadataForTarget = listMetadataForTarget;\nfunction getFunctionName(v) {\n    if (v.name) {\n        return v.name;\n    }\n    else {\n        var name_1 = v.toString();\n        var match = name_1.match(/^function\\s*([^\\s(]+)/);\n        return match ? match[1] : \"Anonymous function: \" + name_1;\n    }\n}\nexports.getFunctionName = getFunctionName;\n","/*!\n * Determine if an object is a Buffer\n *\n * @author   Feross Aboukhadijeh <https://feross.org>\n * @license  MIT\n */\n\n// The _isBuffer check is for Safari 5-7 support, because it's missing\n// Object.prototype.constructor. Remove this eventually\nmodule.exports = function (obj) {\n  return obj != null && (isBuffer(obj) || isSlowBuffer(obj) || !!obj._isBuffer)\n}\n\nfunction isBuffer (obj) {\n  return !!obj.constructor && typeof obj.constructor.isBuffer === 'function' && obj.constructor.isBuffer(obj)\n}\n\n// For Node v0.10 support. Remove this eventually.\nfunction isSlowBuffer (obj) {\n  return typeof obj.readFloatLE === 'function' && typeof obj.slice === 'function' && isBuffer(obj.slice(0, 0))\n}\n","!function(e,t){\"object\"==typeof exports&&\"undefined\"!=typeof module?module.exports=t():\"function\"==typeof define&&define.amd?define(t):e.Navigo=t()}(this,function(){\"use strict\";var e=\"function\"==typeof Symbol&&\"symbol\"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&\"function\"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?\"symbol\":typeof e};function t(){return!(\"undefined\"==typeof window||!window.history||!window.history.pushState)}function n(e,n,o){this.root=null,this._routes=[],this._useHash=n,this._hash=void 0===o?\"#\":o,this._paused=!1,this._destroyed=!1,this._lastRouteResolved=null,this._notFoundHandler=null,this._defaultHandler=null,this._usePushState=!n&&t(),this._onLocationChange=this._onLocationChange.bind(this),this._genericHooks=null,this._historyAPIUpdateMethod=\"pushState\",e?this.root=n?e.replace(/\\/$/,\"/\"+this._hash):e.replace(/\\/$/,\"\"):n&&(this.root=this._cLoc().split(this._hash)[0].replace(/\\/$/,\"/\"+this._hash)),this._listen(),this.updatePageLinks()}function o(e){return e instanceof RegExp?e:e.replace(/\\/+$/,\"\").replace(/^\\/+/,\"^/\")}function i(e){return e.replace(/\\/$/,\"\").split(\"/\").length}function s(e,t){return i(t)-i(e)}function r(e,t){return function(e){return(arguments.length>1&&void 0!==arguments[1]?arguments[1]:[]).map(function(t){var i=function(e){var t=[];return{regexp:e instanceof RegExp?e:new RegExp(e.replace(n.PARAMETER_REGEXP,function(e,o,i){return t.push(i),n.REPLACE_VARIABLE_REGEXP}).replace(n.WILDCARD_REGEXP,n.REPLACE_WILDCARD)+n.FOLLOWED_BY_SLASH_REGEXP,n.MATCH_REGEXP_FLAGS),paramNames:t}}(o(t.route)),s=i.regexp,r=i.paramNames,a=e.replace(/^\\/+/,\"/\").match(s),h=function(e,t){return 0===t.length?null:e?e.slice(1,e.length).reduce(function(e,n,o){return null===e&&(e={}),e[t[o]]=decodeURIComponent(n),e},null):null}(a,r);return!!a&&{match:a,route:t,params:h}}).filter(function(e){return e})}(e,t)[0]||!1}function a(e,t){var n=t.map(function(t){return\"\"===t.route||\"*\"===t.route?e:e.split(new RegExp(t.route+\"($|/)\"))[0]}),i=o(e);return n.length>1?n.reduce(function(e,t){return e.length>t.length&&(e=t),e},n[0]):1===n.length?n[0]:i}function h(e,n,o){var i,s=function(e){return e.split(/\\?(.*)?$/)[0]};return void 0===o&&(o=\"#\"),t()&&!n?s(e).split(o)[0]:(i=e.split(o)).length>1?s(i[1]):s(i[0])}function u(t,n,o){if(n&&\"object\"===(void 0===n?\"undefined\":e(n))){if(n.before)return void n.before(function(){(!(arguments.length>0&&void 0!==arguments[0])||arguments[0])&&(t(),n.after&&n.after(o))},o);if(n.after)return t(),void(n.after&&n.after(o))}t()}return n.prototype={helpers:{match:r,root:a,clean:o,getOnlyURL:h},navigate:function(e,t){var n;return e=e||\"\",this._usePushState?(n=(n=(t?\"\":this._getRoot()+\"/\")+e.replace(/^\\/+/,\"/\")).replace(/([^:])(\\/{2,})/g,\"$1/\"),history[this._historyAPIUpdateMethod]({},\"\",n),this.resolve()):\"undefined\"!=typeof window&&(e=e.replace(new RegExp(\"^\"+this._hash),\"\"),window.location.href=window.location.href.replace(/#$/,\"\").replace(new RegExp(this._hash+\".*$\"),\"\")+this._hash+e),this},on:function(){for(var t=this,n=arguments.length,o=Array(n),i=0;i<n;i++)o[i]=arguments[i];if(\"function\"==typeof o[0])this._defaultHandler={handler:o[0],hooks:o[1]};else if(o.length>=2)if(\"/\"===o[0]){var r=o[1];\"object\"===e(o[1])&&(r=o[1].uses),this._defaultHandler={handler:r,hooks:o[2]}}else this._add(o[0],o[1],o[2]);else\"object\"===e(o[0])&&Object.keys(o[0]).sort(s).forEach(function(e){t.on(e,o[0][e])});return this},off:function(e){return null!==this._defaultHandler&&e===this._defaultHandler.handler?this._defaultHandler=null:null!==this._notFoundHandler&&e===this._notFoundHandler.handler&&(this._notFoundHandler=null),this._routes=this._routes.reduce(function(t,n){return n.handler!==e&&t.push(n),t},[]),this},notFound:function(e,t){return this._notFoundHandler={handler:e,hooks:t},this},resolve:function(e){var n,o,i=this,s=(e||this._cLoc()).replace(this._getRoot(),\"\");this._useHash&&(s=s.replace(new RegExp(\"^/\"+this._hash),\"/\"));var a=function(e){return e.split(/\\?(.*)?$/).slice(1).join(\"\")}(e||this._cLoc()),l=h(s,this._useHash,this._hash);return!this._paused&&(this._lastRouteResolved&&l===this._lastRouteResolved.url&&a===this._lastRouteResolved.query?(this._lastRouteResolved.hooks&&this._lastRouteResolved.hooks.already&&this._lastRouteResolved.hooks.already(this._lastRouteResolved.params),!1):(o=r(l,this._routes))?(this._callLeave(),this._lastRouteResolved={url:l,query:a,hooks:o.route.hooks,params:o.params,name:o.route.name},n=o.route.handler,u(function(){u(function(){o.route.route instanceof RegExp?n.apply(void 0,o.match.slice(1,o.match.length)):n(o.params,a)},o.route.hooks,o.params,i._genericHooks)},this._genericHooks,o.params),o):this._defaultHandler&&(\"\"===l||\"/\"===l||l===this._hash||function(e,n,o){if(t()&&!n)return!1;if(!e.match(o))return!1;var i=e.split(o);return i.length<2||\"\"===i[1]}(l,this._useHash,this._hash))?(u(function(){u(function(){i._callLeave(),i._lastRouteResolved={url:l,query:a,hooks:i._defaultHandler.hooks},i._defaultHandler.handler(a)},i._defaultHandler.hooks)},this._genericHooks),!0):(this._notFoundHandler&&u(function(){u(function(){i._callLeave(),i._lastRouteResolved={url:l,query:a,hooks:i._notFoundHandler.hooks},i._notFoundHandler.handler(a)},i._notFoundHandler.hooks)},this._genericHooks),!1))},destroy:function(){this._routes=[],this._destroyed=!0,this._lastRouteResolved=null,this._genericHooks=null,clearTimeout(this._listeningInterval),\"undefined\"!=typeof window&&(window.removeEventListener(\"popstate\",this._onLocationChange),window.removeEventListener(\"hashchange\",this._onLocationChange))},updatePageLinks:function(){var e=this;\"undefined\"!=typeof document&&this._findLinks().forEach(function(t){t.hasListenerAttached||(t.addEventListener(\"click\",function(n){if((n.ctrlKey||n.metaKey)&&\"a\"==n.target.tagName.toLowerCase())return!1;var o=e.getLinkPath(t);e._destroyed||(n.preventDefault(),e.navigate(o.replace(/\\/+$/,\"\").replace(/^\\/+/,\"/\")))}),t.hasListenerAttached=!0)})},generate:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=this._routes.reduce(function(n,o){var i;if(o.name===e)for(i in n=o.route,t)n=n.toString().replace(\":\"+i,t[i]);return n},\"\");return this._useHash?this._hash+n:n},link:function(e){return this._getRoot()+e},pause:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this._paused=e,this._historyAPIUpdateMethod=e?\"replaceState\":\"pushState\"},resume:function(){this.pause(!1)},historyAPIUpdateMethod:function(e){return void 0===e?this._historyAPIUpdateMethod:(this._historyAPIUpdateMethod=e,e)},disableIfAPINotAvailable:function(){t()||this.destroy()},lastRouteResolved:function(){return this._lastRouteResolved},getLinkPath:function(e){return e.getAttribute(\"href\")},hooks:function(e){this._genericHooks=e},_add:function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return\"string\"==typeof t&&(t=encodeURI(t)),this._routes.push(\"object\"===(void 0===n?\"undefined\":e(n))?{route:t,handler:n.uses,name:n.as,hooks:o||n.hooks}:{route:t,handler:n,hooks:o}),this._add},_getRoot:function(){return null!==this.root?this.root:(this.root=a(this._cLoc().split(\"?\")[0],this._routes),this.root)},_listen:function(){var e=this;if(this._usePushState)window.addEventListener(\"popstate\",this._onLocationChange);else if(\"undefined\"!=typeof window&&\"onhashchange\"in window)window.addEventListener(\"hashchange\",this._onLocationChange);else{var t=this._cLoc(),n=void 0,o=void 0;(o=function(){n=e._cLoc(),t!==n&&(t=n,e.resolve()),e._listeningInterval=setTimeout(o,200)})()}},_cLoc:function(){return\"undefined\"!=typeof window?void 0!==window.__NAVIGO_WINDOW_LOCATION_MOCK__?window.__NAVIGO_WINDOW_LOCATION_MOCK__:o(window.location.href):\"\"},_findLinks:function(){return[].slice.call(document.querySelectorAll(\"[data-navigo]\"))},_onLocationChange:function(){this.resolve()},_callLeave:function(){var e=this._lastRouteResolved;e&&e.hooks&&e.hooks.leave&&e.hooks.leave(e.params)}},n.PARAMETER_REGEXP=/([:*])(\\w+)/g,n.WILDCARD_REGEXP=/\\*/g,n.REPLACE_VARIABLE_REGEXP=\"([^/]+)\",n.REPLACE_WILDCARD=\"(?:.*)\",n.FOLLOWED_BY_SLASH_REGEXP=\"(?:/$|$)\",n.MATCH_REGEXP_FLAGS=\"\",n});\n//# sourceMappingURL=navigo.min.js.map\n","// shim for using process in browser\nvar process = module.exports = {};\n\n// cached from whatever global is present so that test runners that stub it\n// don't break things.  But we need to wrap it in a try catch in case it is\n// wrapped in strict mode code which doesn't define any globals.  It's inside a\n// function because try/catches deoptimize in certain engines.\n\nvar cachedSetTimeout;\nvar cachedClearTimeout;\n\nfunction defaultSetTimout() {\n    throw new Error('setTimeout has not been defined');\n}\nfunction defaultClearTimeout () {\n    throw new Error('clearTimeout has not been defined');\n}\n(function () {\n    try {\n        if (typeof setTimeout === 'function') {\n            cachedSetTimeout = setTimeout;\n        } else {\n            cachedSetTimeout = defaultSetTimout;\n        }\n    } catch (e) {\n        cachedSetTimeout = defaultSetTimout;\n    }\n    try {\n        if (typeof clearTimeout === 'function') {\n            cachedClearTimeout = clearTimeout;\n        } else {\n            cachedClearTimeout = defaultClearTimeout;\n        }\n    } catch (e) {\n        cachedClearTimeout = defaultClearTimeout;\n    }\n} ())\nfunction runTimeout(fun) {\n    if (cachedSetTimeout === setTimeout) {\n        //normal enviroments in sane situations\n        return setTimeout(fun, 0);\n    }\n    // if setTimeout wasn't available but was latter defined\n    if ((cachedSetTimeout === defaultSetTimout || !cachedSetTimeout) && setTimeout) {\n        cachedSetTimeout = setTimeout;\n        return setTimeout(fun, 0);\n    }\n    try {\n        // when when somebody has screwed with setTimeout but no I.E. maddness\n        return cachedSetTimeout(fun, 0);\n    } catch(e){\n        try {\n            // When we are in I.E. but the script has been evaled so I.E. doesn't trust the global object when called normally\n            return cachedSetTimeout.call(null, fun, 0);\n        } catch(e){\n            // same as above but when it's a version of I.E. that must have the global object for 'this', hopfully our context correct otherwise it will throw a global error\n            return cachedSetTimeout.call(this, fun, 0);\n        }\n    }\n\n\n}\nfunction runClearTimeout(marker) {\n    if (cachedClearTimeout === clearTimeout) {\n        //normal enviroments in sane situations\n        return clearTimeout(marker);\n    }\n    // if clearTimeout wasn't available but was latter defined\n    if ((cachedClearTimeout === defaultClearTimeout || !cachedClearTimeout) && clearTimeout) {\n        cachedClearTimeout = clearTimeout;\n        return clearTimeout(marker);\n    }\n    try {\n        // when when somebody has screwed with setTimeout but no I.E. maddness\n        return cachedClearTimeout(marker);\n    } catch (e){\n        try {\n            // When we are in I.E. but the script has been evaled so I.E. doesn't  trust the global object when called normally\n            return cachedClearTimeout.call(null, marker);\n        } catch (e){\n            // same as above but when it's a version of I.E. that must have the global object for 'this', hopfully our context correct otherwise it will throw a global error.\n            // Some versions of I.E. have different rules for clearTimeout vs setTimeout\n            return cachedClearTimeout.call(this, marker);\n        }\n    }\n\n\n\n}\nvar queue = [];\nvar draining = false;\nvar currentQueue;\nvar queueIndex = -1;\n\nfunction cleanUpNextTick() {\n    if (!draining || !currentQueue) {\n        return;\n    }\n    draining = false;\n    if (currentQueue.length) {\n        queue = currentQueue.concat(queue);\n    } else {\n        queueIndex = -1;\n    }\n    if (queue.length) {\n        drainQueue();\n    }\n}\n\nfunction drainQueue() {\n    if (draining) {\n        return;\n    }\n    var timeout = runTimeout(cleanUpNextTick);\n    draining = true;\n\n    var len = queue.length;\n    while(len) {\n        currentQueue = queue;\n        queue = [];\n        while (++queueIndex < len) {\n            if (currentQueue) {\n                currentQueue[queueIndex].run();\n            }\n        }\n        queueIndex = -1;\n        len = queue.length;\n    }\n    currentQueue = null;\n    draining = false;\n    runClearTimeout(timeout);\n}\n\nprocess.nextTick = function (fun) {\n    var args = new Array(arguments.length - 1);\n    if (arguments.length > 1) {\n        for (var i = 1; i < arguments.length; i++) {\n            args[i - 1] = arguments[i];\n        }\n    }\n    queue.push(new Item(fun, args));\n    if (queue.length === 1 && !draining) {\n        runTimeout(drainQueue);\n    }\n};\n\n// v8 likes predictible objects\nfunction Item(fun, array) {\n    this.fun = fun;\n    this.array = array;\n}\nItem.prototype.run = function () {\n    this.fun.apply(null, this.array);\n};\nprocess.title = 'browser';\nprocess.browser = true;\nprocess.env = {};\nprocess.argv = [];\nprocess.version = ''; // empty string to avoid regexp issues\nprocess.versions = {};\n\nfunction noop() {}\n\nprocess.on = noop;\nprocess.addListener = noop;\nprocess.once = noop;\nprocess.off = noop;\nprocess.removeListener = noop;\nprocess.removeAllListeners = noop;\nprocess.emit = noop;\nprocess.prependListener = noop;\nprocess.prependOnceListener = noop;\n\nprocess.listeners = function (name) { return [] }\n\nprocess.binding = function (name) {\n    throw new Error('process.binding is not supported');\n};\n\nprocess.cwd = function () { return '/' };\nprocess.chdir = function (dir) {\n    throw new Error('process.chdir is not supported');\n};\nprocess.umask = function() { return 0; };\n","/*! *****************************************************************************\nCopyright (C) Microsoft. All rights reserved.\nLicensed under the Apache License, Version 2.0 (the \"License\"); you may not use\nthis file except in compliance with the License. You may obtain a copy of the\nLicense at http://www.apache.org/licenses/LICENSE-2.0\n\nTHIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\nKIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED\nWARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,\nMERCHANTABLITY OR NON-INFRINGEMENT.\n\nSee the Apache Version 2.0 License for specific language governing permissions\nand limitations under the License.\n***************************************************************************** */\nvar Reflect;\n(function (Reflect) {\n    // Metadata Proposal\n    // https://rbuckton.github.io/reflect-metadata/\n    (function (factory) {\n        var root = typeof global === \"object\" ? global :\n            typeof self === \"object\" ? self :\n                typeof this === \"object\" ? this :\n                    Function(\"return this;\")();\n        var exporter = makeExporter(Reflect);\n        if (typeof root.Reflect === \"undefined\") {\n            root.Reflect = Reflect;\n        }\n        else {\n            exporter = makeExporter(root.Reflect, exporter);\n        }\n        factory(exporter);\n        function makeExporter(target, previous) {\n            return function (key, value) {\n                if (typeof target[key] !== \"function\") {\n                    Object.defineProperty(target, key, { configurable: true, writable: true, value: value });\n                }\n                if (previous)\n                    previous(key, value);\n            };\n        }\n    })(function (exporter) {\n        var hasOwn = Object.prototype.hasOwnProperty;\n        // feature test for Symbol support\n        var supportsSymbol = typeof Symbol === \"function\";\n        var toPrimitiveSymbol = supportsSymbol && typeof Symbol.toPrimitive !== \"undefined\" ? Symbol.toPrimitive : \"@@toPrimitive\";\n        var iteratorSymbol = supportsSymbol && typeof Symbol.iterator !== \"undefined\" ? Symbol.iterator : \"@@iterator\";\n        var supportsCreate = typeof Object.create === \"function\"; // feature test for Object.create support\n        var supportsProto = { __proto__: [] } instanceof Array; // feature test for __proto__ support\n        var downLevel = !supportsCreate && !supportsProto;\n        var HashMap = {\n            // create an object in dictionary mode (a.k.a. \"slow\" mode in v8)\n            create: supportsCreate\n                ? function () { return MakeDictionary(Object.create(null)); }\n                : supportsProto\n                    ? function () { return MakeDictionary({ __proto__: null }); }\n                    : function () { return MakeDictionary({}); },\n            has: downLevel\n                ? function (map, key) { return hasOwn.call(map, key); }\n                : function (map, key) { return key in map; },\n            get: downLevel\n                ? function (map, key) { return hasOwn.call(map, key) ? map[key] : undefined; }\n                : function (map, key) { return map[key]; },\n        };\n        // Load global or shim versions of Map, Set, and WeakMap\n        var functionPrototype = Object.getPrototypeOf(Function);\n        var usePolyfill = typeof process === \"object\" && process.env && process.env[\"REFLECT_METADATA_USE_MAP_POLYFILL\"] === \"true\";\n        var _Map = !usePolyfill && typeof Map === \"function\" && typeof Map.prototype.entries === \"function\" ? Map : CreateMapPolyfill();\n        var _Set = !usePolyfill && typeof Set === \"function\" && typeof Set.prototype.entries === \"function\" ? Set : CreateSetPolyfill();\n        var _WeakMap = !usePolyfill && typeof WeakMap === \"function\" ? WeakMap : CreateWeakMapPolyfill();\n        // [[Metadata]] internal slot\n        // https://rbuckton.github.io/reflect-metadata/#ordinary-object-internal-methods-and-internal-slots\n        var Metadata = new _WeakMap();\n        /**\n         * Applies a set of decorators to a property of a target object.\n         * @param decorators An array of decorators.\n         * @param target The target object.\n         * @param propertyKey (Optional) The property key to decorate.\n         * @param attributes (Optional) The property descriptor for the target key.\n         * @remarks Decorators are applied in reverse order.\n         * @example\n         *\n         *     class Example {\n         *         // property declarations are not part of ES6, though they are valid in TypeScript:\n         *         // static staticProperty;\n         *         // property;\n         *\n         *         constructor(p) { }\n         *         static staticMethod(p) { }\n         *         method(p) { }\n         *     }\n         *\n         *     // constructor\n         *     Example = Reflect.decorate(decoratorsArray, Example);\n         *\n         *     // property (on constructor)\n         *     Reflect.decorate(decoratorsArray, Example, \"staticProperty\");\n         *\n         *     // property (on prototype)\n         *     Reflect.decorate(decoratorsArray, Example.prototype, \"property\");\n         *\n         *     // method (on constructor)\n         *     Object.defineProperty(Example, \"staticMethod\",\n         *         Reflect.decorate(decoratorsArray, Example, \"staticMethod\",\n         *             Object.getOwnPropertyDescriptor(Example, \"staticMethod\")));\n         *\n         *     // method (on prototype)\n         *     Object.defineProperty(Example.prototype, \"method\",\n         *         Reflect.decorate(decoratorsArray, Example.prototype, \"method\",\n         *             Object.getOwnPropertyDescriptor(Example.prototype, \"method\")));\n         *\n         */\n        function decorate(decorators, target, propertyKey, attributes) {\n            if (!IsUndefined(propertyKey)) {\n                if (!IsArray(decorators))\n                    throw new TypeError();\n                if (!IsObject(target))\n                    throw new TypeError();\n                if (!IsObject(attributes) && !IsUndefined(attributes) && !IsNull(attributes))\n                    throw new TypeError();\n                if (IsNull(attributes))\n                    attributes = undefined;\n                propertyKey = ToPropertyKey(propertyKey);\n                return DecorateProperty(decorators, target, propertyKey, attributes);\n            }\n            else {\n                if (!IsArray(decorators))\n                    throw new TypeError();\n                if (!IsConstructor(target))\n                    throw new TypeError();\n                return DecorateConstructor(decorators, target);\n            }\n        }\n        exporter(\"decorate\", decorate);\n        // 4.1.2 Reflect.metadata(metadataKey, metadataValue)\n        // https://rbuckton.github.io/reflect-metadata/#reflect.metadata\n        /**\n         * A default metadata decorator factory that can be used on a class, class member, or parameter.\n         * @param metadataKey The key for the metadata entry.\n         * @param metadataValue The value for the metadata entry.\n         * @returns A decorator function.\n         * @remarks\n         * If `metadataKey` is already defined for the target and target key, the\n         * metadataValue for that key will be overwritten.\n         * @example\n         *\n         *     // constructor\n         *     @Reflect.metadata(key, value)\n         *     class Example {\n         *     }\n         *\n         *     // property (on constructor, TypeScript only)\n         *     class Example {\n         *         @Reflect.metadata(key, value)\n         *         static staticProperty;\n         *     }\n         *\n         *     // property (on prototype, TypeScript only)\n         *     class Example {\n         *         @Reflect.metadata(key, value)\n         *         property;\n         *     }\n         *\n         *     // method (on constructor)\n         *     class Example {\n         *         @Reflect.metadata(key, value)\n         *         static staticMethod() { }\n         *     }\n         *\n         *     // method (on prototype)\n         *     class Example {\n         *         @Reflect.metadata(key, value)\n         *         method() { }\n         *     }\n         *\n         */\n        function metadata(metadataKey, metadataValue) {\n            function decorator(target, propertyKey) {\n                if (!IsObject(target))\n                    throw new TypeError();\n                if (!IsUndefined(propertyKey) && !IsPropertyKey(propertyKey))\n                    throw new TypeError();\n                OrdinaryDefineOwnMetadata(metadataKey, metadataValue, target, propertyKey);\n            }\n            return decorator;\n        }\n        exporter(\"metadata\", metadata);\n        /**\n         * Define a unique metadata entry on the target.\n         * @param metadataKey A key used to store and retrieve metadata.\n         * @param metadataValue A value that contains attached metadata.\n         * @param target The target object on which to define metadata.\n         * @param propertyKey (Optional) The property key for the target.\n         * @example\n         *\n         *     class Example {\n         *         // property declarations are not part of ES6, though they are valid in TypeScript:\n         *         // static staticProperty;\n         *         // property;\n         *\n         *         constructor(p) { }\n         *         static staticMethod(p) { }\n         *         method(p) { }\n         *     }\n         *\n         *     // constructor\n         *     Reflect.defineMetadata(\"custom:annotation\", options, Example);\n         *\n         *     // property (on constructor)\n         *     Reflect.defineMetadata(\"custom:annotation\", options, Example, \"staticProperty\");\n         *\n         *     // property (on prototype)\n         *     Reflect.defineMetadata(\"custom:annotation\", options, Example.prototype, \"property\");\n         *\n         *     // method (on constructor)\n         *     Reflect.defineMetadata(\"custom:annotation\", options, Example, \"staticMethod\");\n         *\n         *     // method (on prototype)\n         *     Reflect.defineMetadata(\"custom:annotation\", options, Example.prototype, \"method\");\n         *\n         *     // decorator factory as metadata-producing annotation.\n         *     function MyAnnotation(options): Decorator {\n         *         return (target, key?) => Reflect.defineMetadata(\"custom:annotation\", options, target, key);\n         *     }\n         *\n         */\n        function defineMetadata(metadataKey, metadataValue, target, propertyKey) {\n            if (!IsObject(target))\n                throw new TypeError();\n            if (!IsUndefined(propertyKey))\n                propertyKey = ToPropertyKey(propertyKey);\n            return OrdinaryDefineOwnMetadata(metadataKey, metadataValue, target, propertyKey);\n        }\n        exporter(\"defineMetadata\", defineMetadata);\n        /**\n         * Gets a value indicating whether the target object or its prototype chain has the provided metadata key defined.\n         * @param metadataKey A key used to store and retrieve metadata.\n         * @param target The target object on which the metadata is defined.\n         * @param propertyKey (Optional) The property key for the target.\n         * @returns `true` if the metadata key was defined on the target object or its prototype chain; otherwise, `false`.\n         * @example\n         *\n         *     class Example {\n         *         // property declarations are not part of ES6, though they are valid in TypeScript:\n         *         // static staticProperty;\n         *         // property;\n         *\n         *         constructor(p) { }\n         *         static staticMethod(p) { }\n         *         method(p) { }\n         *     }\n         *\n         *     // constructor\n         *     result = Reflect.hasMetadata(\"custom:annotation\", Example);\n         *\n         *     // property (on constructor)\n         *     result = Reflect.hasMetadata(\"custom:annotation\", Example, \"staticProperty\");\n         *\n         *     // property (on prototype)\n         *     result = Reflect.hasMetadata(\"custom:annotation\", Example.prototype, \"property\");\n         *\n         *     // method (on constructor)\n         *     result = Reflect.hasMetadata(\"custom:annotation\", Example, \"staticMethod\");\n         *\n         *     // method (on prototype)\n         *     result = Reflect.hasMetadata(\"custom:annotation\", Example.prototype, \"method\");\n         *\n         */\n        function hasMetadata(metadataKey, target, propertyKey) {\n            if (!IsObject(target))\n                throw new TypeError();\n            if (!IsUndefined(propertyKey))\n                propertyKey = ToPropertyKey(propertyKey);\n            return OrdinaryHasMetadata(metadataKey, target, propertyKey);\n        }\n        exporter(\"hasMetadata\", hasMetadata);\n        /**\n         * Gets a value indicating whether the target object has the provided metadata key defined.\n         * @param metadataKey A key used to store and retrieve metadata.\n         * @param target The target object on which the metadata is defined.\n         * @param propertyKey (Optional) The property key for the target.\n         * @returns `true` if the metadata key was defined on the target object; otherwise, `false`.\n         * @example\n         *\n         *     class Example {\n         *         // property declarations are not part of ES6, though they are valid in TypeScript:\n         *         // static staticProperty;\n         *         // property;\n         *\n         *         constructor(p) { }\n         *         static staticMethod(p) { }\n         *         method(p) { }\n         *     }\n         *\n         *     // constructor\n         *     result = Reflect.hasOwnMetadata(\"custom:annotation\", Example);\n         *\n         *     // property (on constructor)\n         *     result = Reflect.hasOwnMetadata(\"custom:annotation\", Example, \"staticProperty\");\n         *\n         *     // property (on prototype)\n         *     result = Reflect.hasOwnMetadata(\"custom:annotation\", Example.prototype, \"property\");\n         *\n         *     // method (on constructor)\n         *     result = Reflect.hasOwnMetadata(\"custom:annotation\", Example, \"staticMethod\");\n         *\n         *     // method (on prototype)\n         *     result = Reflect.hasOwnMetadata(\"custom:annotation\", Example.prototype, \"method\");\n         *\n         */\n        function hasOwnMetadata(metadataKey, target, propertyKey) {\n            if (!IsObject(target))\n                throw new TypeError();\n            if (!IsUndefined(propertyKey))\n                propertyKey = ToPropertyKey(propertyKey);\n            return OrdinaryHasOwnMetadata(metadataKey, target, propertyKey);\n        }\n        exporter(\"hasOwnMetadata\", hasOwnMetadata);\n        /**\n         * Gets the metadata value for the provided metadata key on the target object or its prototype chain.\n         * @param metadataKey A key used to store and retrieve metadata.\n         * @param target The target object on which the metadata is defined.\n         * @param propertyKey (Optional) The property key for the target.\n         * @returns The metadata value for the metadata key if found; otherwise, `undefined`.\n         * @example\n         *\n         *     class Example {\n         *         // property declarations are not part of ES6, though they are valid in TypeScript:\n         *         // static staticProperty;\n         *         // property;\n         *\n         *         constructor(p) { }\n         *         static staticMethod(p) { }\n         *         method(p) { }\n         *     }\n         *\n         *     // constructor\n         *     result = Reflect.getMetadata(\"custom:annotation\", Example);\n         *\n         *     // property (on constructor)\n         *     result = Reflect.getMetadata(\"custom:annotation\", Example, \"staticProperty\");\n         *\n         *     // property (on prototype)\n         *     result = Reflect.getMetadata(\"custom:annotation\", Example.prototype, \"property\");\n         *\n         *     // method (on constructor)\n         *     result = Reflect.getMetadata(\"custom:annotation\", Example, \"staticMethod\");\n         *\n         *     // method (on prototype)\n         *     result = Reflect.getMetadata(\"custom:annotation\", Example.prototype, \"method\");\n         *\n         */\n        function getMetadata(metadataKey, target, propertyKey) {\n            if (!IsObject(target))\n                throw new TypeError();\n            if (!IsUndefined(propertyKey))\n                propertyKey = ToPropertyKey(propertyKey);\n            return OrdinaryGetMetadata(metadataKey, target, propertyKey);\n        }\n        exporter(\"getMetadata\", getMetadata);\n        /**\n         * Gets the metadata value for the provided metadata key on the target object.\n         * @param metadataKey A key used to store and retrieve metadata.\n         * @param target The target object on which the metadata is defined.\n         * @param propertyKey (Optional) The property key for the target.\n         * @returns The metadata value for the metadata key if found; otherwise, `undefined`.\n         * @example\n         *\n         *     class Example {\n         *         // property declarations are not part of ES6, though they are valid in TypeScript:\n         *         // static staticProperty;\n         *         // property;\n         *\n         *         constructor(p) { }\n         *         static staticMethod(p) { }\n         *         method(p) { }\n         *     }\n         *\n         *     // constructor\n         *     result = Reflect.getOwnMetadata(\"custom:annotation\", Example);\n         *\n         *     // property (on constructor)\n         *     result = Reflect.getOwnMetadata(\"custom:annotation\", Example, \"staticProperty\");\n         *\n         *     // property (on prototype)\n         *     result = Reflect.getOwnMetadata(\"custom:annotation\", Example.prototype, \"property\");\n         *\n         *     // method (on constructor)\n         *     result = Reflect.getOwnMetadata(\"custom:annotation\", Example, \"staticMethod\");\n         *\n         *     // method (on prototype)\n         *     result = Reflect.getOwnMetadata(\"custom:annotation\", Example.prototype, \"method\");\n         *\n         */\n        function getOwnMetadata(metadataKey, target, propertyKey) {\n            if (!IsObject(target))\n                throw new TypeError();\n            if (!IsUndefined(propertyKey))\n                propertyKey = ToPropertyKey(propertyKey);\n            return OrdinaryGetOwnMetadata(metadataKey, target, propertyKey);\n        }\n        exporter(\"getOwnMetadata\", getOwnMetadata);\n        /**\n         * Gets the metadata keys defined on the target object or its prototype chain.\n         * @param target The target object on which the metadata is defined.\n         * @param propertyKey (Optional) The property key for the target.\n         * @returns An array of unique metadata keys.\n         * @example\n         *\n         *     class Example {\n         *         // property declarations are not part of ES6, though they are valid in TypeScript:\n         *         // static staticProperty;\n         *         // property;\n         *\n         *         constructor(p) { }\n         *         static staticMethod(p) { }\n         *         method(p) { }\n         *     }\n         *\n         *     // constructor\n         *     result = Reflect.getMetadataKeys(Example);\n         *\n         *     // property (on constructor)\n         *     result = Reflect.getMetadataKeys(Example, \"staticProperty\");\n         *\n         *     // property (on prototype)\n         *     result = Reflect.getMetadataKeys(Example.prototype, \"property\");\n         *\n         *     // method (on constructor)\n         *     result = Reflect.getMetadataKeys(Example, \"staticMethod\");\n         *\n         *     // method (on prototype)\n         *     result = Reflect.getMetadataKeys(Example.prototype, \"method\");\n         *\n         */\n        function getMetadataKeys(target, propertyKey) {\n            if (!IsObject(target))\n                throw new TypeError();\n            if (!IsUndefined(propertyKey))\n                propertyKey = ToPropertyKey(propertyKey);\n            return OrdinaryMetadataKeys(target, propertyKey);\n        }\n        exporter(\"getMetadataKeys\", getMetadataKeys);\n        /**\n         * Gets the unique metadata keys defined on the target object.\n         * @param target The target object on which the metadata is defined.\n         * @param propertyKey (Optional) The property key for the target.\n         * @returns An array of unique metadata keys.\n         * @example\n         *\n         *     class Example {\n         *         // property declarations are not part of ES6, though they are valid in TypeScript:\n         *         // static staticProperty;\n         *         // property;\n         *\n         *         constructor(p) { }\n         *         static staticMethod(p) { }\n         *         method(p) { }\n         *     }\n         *\n         *     // constructor\n         *     result = Reflect.getOwnMetadataKeys(Example);\n         *\n         *     // property (on constructor)\n         *     result = Reflect.getOwnMetadataKeys(Example, \"staticProperty\");\n         *\n         *     // property (on prototype)\n         *     result = Reflect.getOwnMetadataKeys(Example.prototype, \"property\");\n         *\n         *     // method (on constructor)\n         *     result = Reflect.getOwnMetadataKeys(Example, \"staticMethod\");\n         *\n         *     // method (on prototype)\n         *     result = Reflect.getOwnMetadataKeys(Example.prototype, \"method\");\n         *\n         */\n        function getOwnMetadataKeys(target, propertyKey) {\n            if (!IsObject(target))\n                throw new TypeError();\n            if (!IsUndefined(propertyKey))\n                propertyKey = ToPropertyKey(propertyKey);\n            return OrdinaryOwnMetadataKeys(target, propertyKey);\n        }\n        exporter(\"getOwnMetadataKeys\", getOwnMetadataKeys);\n        /**\n         * Deletes the metadata entry from the target object with the provided key.\n         * @param metadataKey A key used to store and retrieve metadata.\n         * @param target The target object on which the metadata is defined.\n         * @param propertyKey (Optional) The property key for the target.\n         * @returns `true` if the metadata entry was found and deleted; otherwise, false.\n         * @example\n         *\n         *     class Example {\n         *         // property declarations are not part of ES6, though they are valid in TypeScript:\n         *         // static staticProperty;\n         *         // property;\n         *\n         *         constructor(p) { }\n         *         static staticMethod(p) { }\n         *         method(p) { }\n         *     }\n         *\n         *     // constructor\n         *     result = Reflect.deleteMetadata(\"custom:annotation\", Example);\n         *\n         *     // property (on constructor)\n         *     result = Reflect.deleteMetadata(\"custom:annotation\", Example, \"staticProperty\");\n         *\n         *     // property (on prototype)\n         *     result = Reflect.deleteMetadata(\"custom:annotation\", Example.prototype, \"property\");\n         *\n         *     // method (on constructor)\n         *     result = Reflect.deleteMetadata(\"custom:annotation\", Example, \"staticMethod\");\n         *\n         *     // method (on prototype)\n         *     result = Reflect.deleteMetadata(\"custom:annotation\", Example.prototype, \"method\");\n         *\n         */\n        function deleteMetadata(metadataKey, target, propertyKey) {\n            if (!IsObject(target))\n                throw new TypeError();\n            if (!IsUndefined(propertyKey))\n                propertyKey = ToPropertyKey(propertyKey);\n            var metadataMap = GetOrCreateMetadataMap(target, propertyKey, /*Create*/ false);\n            if (IsUndefined(metadataMap))\n                return false;\n            if (!metadataMap.delete(metadataKey))\n                return false;\n            if (metadataMap.size > 0)\n                return true;\n            var targetMetadata = Metadata.get(target);\n            targetMetadata.delete(propertyKey);\n            if (targetMetadata.size > 0)\n                return true;\n            Metadata.delete(target);\n            return true;\n        }\n        exporter(\"deleteMetadata\", deleteMetadata);\n        function DecorateConstructor(decorators, target) {\n            for (var i = decorators.length - 1; i >= 0; --i) {\n                var decorator = decorators[i];\n                var decorated = decorator(target);\n                if (!IsUndefined(decorated) && !IsNull(decorated)) {\n                    if (!IsConstructor(decorated))\n                        throw new TypeError();\n                    target = decorated;\n                }\n            }\n            return target;\n        }\n        function DecorateProperty(decorators, target, propertyKey, descriptor) {\n            for (var i = decorators.length - 1; i >= 0; --i) {\n                var decorator = decorators[i];\n                var decorated = decorator(target, propertyKey, descriptor);\n                if (!IsUndefined(decorated) && !IsNull(decorated)) {\n                    if (!IsObject(decorated))\n                        throw new TypeError();\n                    descriptor = decorated;\n                }\n            }\n            return descriptor;\n        }\n        function GetOrCreateMetadataMap(O, P, Create) {\n            var targetMetadata = Metadata.get(O);\n            if (IsUndefined(targetMetadata)) {\n                if (!Create)\n                    return undefined;\n                targetMetadata = new _Map();\n                Metadata.set(O, targetMetadata);\n            }\n            var metadataMap = targetMetadata.get(P);\n            if (IsUndefined(metadataMap)) {\n                if (!Create)\n                    return undefined;\n                metadataMap = new _Map();\n                targetMetadata.set(P, metadataMap);\n            }\n            return metadataMap;\n        }\n        // 3.1.1.1 OrdinaryHasMetadata(MetadataKey, O, P)\n        // https://rbuckton.github.io/reflect-metadata/#ordinaryhasmetadata\n        function OrdinaryHasMetadata(MetadataKey, O, P) {\n            var hasOwn = OrdinaryHasOwnMetadata(MetadataKey, O, P);\n            if (hasOwn)\n                return true;\n            var parent = OrdinaryGetPrototypeOf(O);\n            if (!IsNull(parent))\n                return OrdinaryHasMetadata(MetadataKey, parent, P);\n            return false;\n        }\n        // 3.1.2.1 OrdinaryHasOwnMetadata(MetadataKey, O, P)\n        // https://rbuckton.github.io/reflect-metadata/#ordinaryhasownmetadata\n        function OrdinaryHasOwnMetadata(MetadataKey, O, P) {\n            var metadataMap = GetOrCreateMetadataMap(O, P, /*Create*/ false);\n            if (IsUndefined(metadataMap))\n                return false;\n            return ToBoolean(metadataMap.has(MetadataKey));\n        }\n        // 3.1.3.1 OrdinaryGetMetadata(MetadataKey, O, P)\n        // https://rbuckton.github.io/reflect-metadata/#ordinarygetmetadata\n        function OrdinaryGetMetadata(MetadataKey, O, P) {\n            var hasOwn = OrdinaryHasOwnMetadata(MetadataKey, O, P);\n            if (hasOwn)\n                return OrdinaryGetOwnMetadata(MetadataKey, O, P);\n            var parent = OrdinaryGetPrototypeOf(O);\n            if (!IsNull(parent))\n                return OrdinaryGetMetadata(MetadataKey, parent, P);\n            return undefined;\n        }\n        // 3.1.4.1 OrdinaryGetOwnMetadata(MetadataKey, O, P)\n        // https://rbuckton.github.io/reflect-metadata/#ordinarygetownmetadata\n        function OrdinaryGetOwnMetadata(MetadataKey, O, P) {\n            var metadataMap = GetOrCreateMetadataMap(O, P, /*Create*/ false);\n            if (IsUndefined(metadataMap))\n                return undefined;\n            return metadataMap.get(MetadataKey);\n        }\n        // 3.1.5.1 OrdinaryDefineOwnMetadata(MetadataKey, MetadataValue, O, P)\n        // https://rbuckton.github.io/reflect-metadata/#ordinarydefineownmetadata\n        function OrdinaryDefineOwnMetadata(MetadataKey, MetadataValue, O, P) {\n            var metadataMap = GetOrCreateMetadataMap(O, P, /*Create*/ true);\n            metadataMap.set(MetadataKey, MetadataValue);\n        }\n        // 3.1.6.1 OrdinaryMetadataKeys(O, P)\n        // https://rbuckton.github.io/reflect-metadata/#ordinarymetadatakeys\n        function OrdinaryMetadataKeys(O, P) {\n            var ownKeys = OrdinaryOwnMetadataKeys(O, P);\n            var parent = OrdinaryGetPrototypeOf(O);\n            if (parent === null)\n                return ownKeys;\n            var parentKeys = OrdinaryMetadataKeys(parent, P);\n            if (parentKeys.length <= 0)\n                return ownKeys;\n            if (ownKeys.length <= 0)\n                return parentKeys;\n            var set = new _Set();\n            var keys = [];\n            for (var _i = 0, ownKeys_1 = ownKeys; _i < ownKeys_1.length; _i++) {\n                var key = ownKeys_1[_i];\n                var hasKey = set.has(key);\n                if (!hasKey) {\n                    set.add(key);\n                    keys.push(key);\n                }\n            }\n            for (var _a = 0, parentKeys_1 = parentKeys; _a < parentKeys_1.length; _a++) {\n                var key = parentKeys_1[_a];\n                var hasKey = set.has(key);\n                if (!hasKey) {\n                    set.add(key);\n                    keys.push(key);\n                }\n            }\n            return keys;\n        }\n        // 3.1.7.1 OrdinaryOwnMetadataKeys(O, P)\n        // https://rbuckton.github.io/reflect-metadata/#ordinaryownmetadatakeys\n        function OrdinaryOwnMetadataKeys(O, P) {\n            var keys = [];\n            var metadataMap = GetOrCreateMetadataMap(O, P, /*Create*/ false);\n            if (IsUndefined(metadataMap))\n                return keys;\n            var keysObj = metadataMap.keys();\n            var iterator = GetIterator(keysObj);\n            var k = 0;\n            while (true) {\n                var next = IteratorStep(iterator);\n                if (!next) {\n                    keys.length = k;\n                    return keys;\n                }\n                var nextValue = IteratorValue(next);\n                try {\n                    keys[k] = nextValue;\n                }\n                catch (e) {\n                    try {\n                        IteratorClose(iterator);\n                    }\n                    finally {\n                        throw e;\n                    }\n                }\n                k++;\n            }\n        }\n        // 6 ECMAScript Data Typ0es and Values\n        // https://tc39.github.io/ecma262/#sec-ecmascript-data-types-and-values\n        function Type(x) {\n            if (x === null)\n                return 1 /* Null */;\n            switch (typeof x) {\n                case \"undefined\": return 0 /* Undefined */;\n                case \"boolean\": return 2 /* Boolean */;\n                case \"string\": return 3 /* String */;\n                case \"symbol\": return 4 /* Symbol */;\n                case \"number\": return 5 /* Number */;\n                case \"object\": return x === null ? 1 /* Null */ : 6 /* Object */;\n                default: return 6 /* Object */;\n            }\n        }\n        // 6.1.1 The Undefined Type\n        // https://tc39.github.io/ecma262/#sec-ecmascript-language-types-undefined-type\n        function IsUndefined(x) {\n            return x === undefined;\n        }\n        // 6.1.2 The Null Type\n        // https://tc39.github.io/ecma262/#sec-ecmascript-language-types-null-type\n        function IsNull(x) {\n            return x === null;\n        }\n        // 6.1.5 The Symbol Type\n        // https://tc39.github.io/ecma262/#sec-ecmascript-language-types-symbol-type\n        function IsSymbol(x) {\n            return typeof x === \"symbol\";\n        }\n        // 6.1.7 The Object Type\n        // https://tc39.github.io/ecma262/#sec-object-type\n        function IsObject(x) {\n            return typeof x === \"object\" ? x !== null : typeof x === \"function\";\n        }\n        // 7.1 Type Conversion\n        // https://tc39.github.io/ecma262/#sec-type-conversion\n        // 7.1.1 ToPrimitive(input [, PreferredType])\n        // https://tc39.github.io/ecma262/#sec-toprimitive\n        function ToPrimitive(input, PreferredType) {\n            switch (Type(input)) {\n                case 0 /* Undefined */: return input;\n                case 1 /* Null */: return input;\n                case 2 /* Boolean */: return input;\n                case 3 /* String */: return input;\n                case 4 /* Symbol */: return input;\n                case 5 /* Number */: return input;\n            }\n            var hint = PreferredType === 3 /* String */ ? \"string\" : PreferredType === 5 /* Number */ ? \"number\" : \"default\";\n            var exoticToPrim = GetMethod(input, toPrimitiveSymbol);\n            if (exoticToPrim !== undefined) {\n                var result = exoticToPrim.call(input, hint);\n                if (IsObject(result))\n                    throw new TypeError();\n                return result;\n            }\n            return OrdinaryToPrimitive(input, hint === \"default\" ? \"number\" : hint);\n        }\n        // 7.1.1.1 OrdinaryToPrimitive(O, hint)\n        // https://tc39.github.io/ecma262/#sec-ordinarytoprimitive\n        function OrdinaryToPrimitive(O, hint) {\n            if (hint === \"string\") {\n                var toString_1 = O.toString;\n                if (IsCallable(toString_1)) {\n                    var result = toString_1.call(O);\n                    if (!IsObject(result))\n                        return result;\n                }\n                var valueOf = O.valueOf;\n                if (IsCallable(valueOf)) {\n                    var result = valueOf.call(O);\n                    if (!IsObject(result))\n                        return result;\n                }\n            }\n            else {\n                var valueOf = O.valueOf;\n                if (IsCallable(valueOf)) {\n                    var result = valueOf.call(O);\n                    if (!IsObject(result))\n                        return result;\n                }\n                var toString_2 = O.toString;\n                if (IsCallable(toString_2)) {\n                    var result = toString_2.call(O);\n                    if (!IsObject(result))\n                        return result;\n                }\n            }\n            throw new TypeError();\n        }\n        // 7.1.2 ToBoolean(argument)\n        // https://tc39.github.io/ecma262/2016/#sec-toboolean\n        function ToBoolean(argument) {\n            return !!argument;\n        }\n        // 7.1.12 ToString(argument)\n        // https://tc39.github.io/ecma262/#sec-tostring\n        function ToString(argument) {\n            return \"\" + argument;\n        }\n        // 7.1.14 ToPropertyKey(argument)\n        // https://tc39.github.io/ecma262/#sec-topropertykey\n        function ToPropertyKey(argument) {\n            var key = ToPrimitive(argument, 3 /* String */);\n            if (IsSymbol(key))\n                return key;\n            return ToString(key);\n        }\n        // 7.2 Testing and Comparison Operations\n        // https://tc39.github.io/ecma262/#sec-testing-and-comparison-operations\n        // 7.2.2 IsArray(argument)\n        // https://tc39.github.io/ecma262/#sec-isarray\n        function IsArray(argument) {\n            return Array.isArray\n                ? Array.isArray(argument)\n                : argument instanceof Object\n                    ? argument instanceof Array\n                    : Object.prototype.toString.call(argument) === \"[object Array]\";\n        }\n        // 7.2.3 IsCallable(argument)\n        // https://tc39.github.io/ecma262/#sec-iscallable\n        function IsCallable(argument) {\n            // NOTE: This is an approximation as we cannot check for [[Call]] internal method.\n            return typeof argument === \"function\";\n        }\n        // 7.2.4 IsConstructor(argument)\n        // https://tc39.github.io/ecma262/#sec-isconstructor\n        function IsConstructor(argument) {\n            // NOTE: This is an approximation as we cannot check for [[Construct]] internal method.\n            return typeof argument === \"function\";\n        }\n        // 7.2.7 IsPropertyKey(argument)\n        // https://tc39.github.io/ecma262/#sec-ispropertykey\n        function IsPropertyKey(argument) {\n            switch (Type(argument)) {\n                case 3 /* String */: return true;\n                case 4 /* Symbol */: return true;\n                default: return false;\n            }\n        }\n        // 7.3 Operations on Objects\n        // https://tc39.github.io/ecma262/#sec-operations-on-objects\n        // 7.3.9 GetMethod(V, P)\n        // https://tc39.github.io/ecma262/#sec-getmethod\n        function GetMethod(V, P) {\n            var func = V[P];\n            if (func === undefined || func === null)\n                return undefined;\n            if (!IsCallable(func))\n                throw new TypeError();\n            return func;\n        }\n        // 7.4 Operations on Iterator Objects\n        // https://tc39.github.io/ecma262/#sec-operations-on-iterator-objects\n        function GetIterator(obj) {\n            var method = GetMethod(obj, iteratorSymbol);\n            if (!IsCallable(method))\n                throw new TypeError(); // from Call\n            var iterator = method.call(obj);\n            if (!IsObject(iterator))\n                throw new TypeError();\n            return iterator;\n        }\n        // 7.4.4 IteratorValue(iterResult)\n        // https://tc39.github.io/ecma262/2016/#sec-iteratorvalue\n        function IteratorValue(iterResult) {\n            return iterResult.value;\n        }\n        // 7.4.5 IteratorStep(iterator)\n        // https://tc39.github.io/ecma262/#sec-iteratorstep\n        function IteratorStep(iterator) {\n            var result = iterator.next();\n            return result.done ? false : result;\n        }\n        // 7.4.6 IteratorClose(iterator, completion)\n        // https://tc39.github.io/ecma262/#sec-iteratorclose\n        function IteratorClose(iterator) {\n            var f = iterator[\"return\"];\n            if (f)\n                f.call(iterator);\n        }\n        // 9.1 Ordinary Object Internal Methods and Internal Slots\n        // https://tc39.github.io/ecma262/#sec-ordinary-object-internal-methods-and-internal-slots\n        // 9.1.1.1 OrdinaryGetPrototypeOf(O)\n        // https://tc39.github.io/ecma262/#sec-ordinarygetprototypeof\n        function OrdinaryGetPrototypeOf(O) {\n            var proto = Object.getPrototypeOf(O);\n            if (typeof O !== \"function\" || O === functionPrototype)\n                return proto;\n            // TypeScript doesn't set __proto__ in ES5, as it's non-standard.\n            // Try to determine the superclass constructor. Compatible implementations\n            // must either set __proto__ on a subclass constructor to the superclass constructor,\n            // or ensure each class has a valid `constructor` property on its prototype that\n            // points back to the constructor.\n            // If this is not the same as Function.[[Prototype]], then this is definately inherited.\n            // This is the case when in ES6 or when using __proto__ in a compatible browser.\n            if (proto !== functionPrototype)\n                return proto;\n            // If the super prototype is Object.prototype, null, or undefined, then we cannot determine the heritage.\n            var prototype = O.prototype;\n            var prototypeProto = prototype && Object.getPrototypeOf(prototype);\n            if (prototypeProto == null || prototypeProto === Object.prototype)\n                return proto;\n            // If the constructor was not a function, then we cannot determine the heritage.\n            var constructor = prototypeProto.constructor;\n            if (typeof constructor !== \"function\")\n                return proto;\n            // If we have some kind of self-reference, then we cannot determine the heritage.\n            if (constructor === O)\n                return proto;\n            // we have a pretty good guess at the heritage.\n            return constructor;\n        }\n        // naive Map shim\n        function CreateMapPolyfill() {\n            var cacheSentinel = {};\n            var arraySentinel = [];\n            var MapIterator = /** @class */ (function () {\n                function MapIterator(keys, values, selector) {\n                    this._index = 0;\n                    this._keys = keys;\n                    this._values = values;\n                    this._selector = selector;\n                }\n                MapIterator.prototype[\"@@iterator\"] = function () { return this; };\n                MapIterator.prototype[iteratorSymbol] = function () { return this; };\n                MapIterator.prototype.next = function () {\n                    var index = this._index;\n                    if (index >= 0 && index < this._keys.length) {\n                        var result = this._selector(this._keys[index], this._values[index]);\n                        if (index + 1 >= this._keys.length) {\n                            this._index = -1;\n                            this._keys = arraySentinel;\n                            this._values = arraySentinel;\n                        }\n                        else {\n                            this._index++;\n                        }\n                        return { value: result, done: false };\n                    }\n                    return { value: undefined, done: true };\n                };\n                MapIterator.prototype.throw = function (error) {\n                    if (this._index >= 0) {\n                        this._index = -1;\n                        this._keys = arraySentinel;\n                        this._values = arraySentinel;\n                    }\n                    throw error;\n                };\n                MapIterator.prototype.return = function (value) {\n                    if (this._index >= 0) {\n                        this._index = -1;\n                        this._keys = arraySentinel;\n                        this._values = arraySentinel;\n                    }\n                    return { value: value, done: true };\n                };\n                return MapIterator;\n            }());\n            return /** @class */ (function () {\n                function Map() {\n                    this._keys = [];\n                    this._values = [];\n                    this._cacheKey = cacheSentinel;\n                    this._cacheIndex = -2;\n                }\n                Object.defineProperty(Map.prototype, \"size\", {\n                    get: function () { return this._keys.length; },\n                    enumerable: true,\n                    configurable: true\n                });\n                Map.prototype.has = function (key) { return this._find(key, /*insert*/ false) >= 0; };\n                Map.prototype.get = function (key) {\n                    var index = this._find(key, /*insert*/ false);\n                    return index >= 0 ? this._values[index] : undefined;\n                };\n                Map.prototype.set = function (key, value) {\n                    var index = this._find(key, /*insert*/ true);\n                    this._values[index] = value;\n                    return this;\n                };\n                Map.prototype.delete = function (key) {\n                    var index = this._find(key, /*insert*/ false);\n                    if (index >= 0) {\n                        var size = this._keys.length;\n                        for (var i = index + 1; i < size; i++) {\n                            this._keys[i - 1] = this._keys[i];\n                            this._values[i - 1] = this._values[i];\n                        }\n                        this._keys.length--;\n                        this._values.length--;\n                        if (key === this._cacheKey) {\n                            this._cacheKey = cacheSentinel;\n                            this._cacheIndex = -2;\n                        }\n                        return true;\n                    }\n                    return false;\n                };\n                Map.prototype.clear = function () {\n                    this._keys.length = 0;\n                    this._values.length = 0;\n                    this._cacheKey = cacheSentinel;\n                    this._cacheIndex = -2;\n                };\n                Map.prototype.keys = function () { return new MapIterator(this._keys, this._values, getKey); };\n                Map.prototype.values = function () { return new MapIterator(this._keys, this._values, getValue); };\n                Map.prototype.entries = function () { return new MapIterator(this._keys, this._values, getEntry); };\n                Map.prototype[\"@@iterator\"] = function () { return this.entries(); };\n                Map.prototype[iteratorSymbol] = function () { return this.entries(); };\n                Map.prototype._find = function (key, insert) {\n                    if (this._cacheKey !== key) {\n                        this._cacheIndex = this._keys.indexOf(this._cacheKey = key);\n                    }\n                    if (this._cacheIndex < 0 && insert) {\n                        this._cacheIndex = this._keys.length;\n                        this._keys.push(key);\n                        this._values.push(undefined);\n                    }\n                    return this._cacheIndex;\n                };\n                return Map;\n            }());\n            function getKey(key, _) {\n                return key;\n            }\n            function getValue(_, value) {\n                return value;\n            }\n            function getEntry(key, value) {\n                return [key, value];\n            }\n        }\n        // naive Set shim\n        function CreateSetPolyfill() {\n            return /** @class */ (function () {\n                function Set() {\n                    this._map = new _Map();\n                }\n                Object.defineProperty(Set.prototype, \"size\", {\n                    get: function () { return this._map.size; },\n                    enumerable: true,\n                    configurable: true\n                });\n                Set.prototype.has = function (value) { return this._map.has(value); };\n                Set.prototype.add = function (value) { return this._map.set(value, value), this; };\n                Set.prototype.delete = function (value) { return this._map.delete(value); };\n                Set.prototype.clear = function () { this._map.clear(); };\n                Set.prototype.keys = function () { return this._map.keys(); };\n                Set.prototype.values = function () { return this._map.values(); };\n                Set.prototype.entries = function () { return this._map.entries(); };\n                Set.prototype[\"@@iterator\"] = function () { return this.keys(); };\n                Set.prototype[iteratorSymbol] = function () { return this.keys(); };\n                return Set;\n            }());\n        }\n        // naive WeakMap shim\n        function CreateWeakMapPolyfill() {\n            var UUID_SIZE = 16;\n            var keys = HashMap.create();\n            var rootKey = CreateUniqueKey();\n            return /** @class */ (function () {\n                function WeakMap() {\n                    this._key = CreateUniqueKey();\n                }\n                WeakMap.prototype.has = function (target) {\n                    var table = GetOrCreateWeakMapTable(target, /*create*/ false);\n                    return table !== undefined ? HashMap.has(table, this._key) : false;\n                };\n                WeakMap.prototype.get = function (target) {\n                    var table = GetOrCreateWeakMapTable(target, /*create*/ false);\n                    return table !== undefined ? HashMap.get(table, this._key) : undefined;\n                };\n                WeakMap.prototype.set = function (target, value) {\n                    var table = GetOrCreateWeakMapTable(target, /*create*/ true);\n                    table[this._key] = value;\n                    return this;\n                };\n                WeakMap.prototype.delete = function (target) {\n                    var table = GetOrCreateWeakMapTable(target, /*create*/ false);\n                    return table !== undefined ? delete table[this._key] : false;\n                };\n                WeakMap.prototype.clear = function () {\n                    // NOTE: not a real clear, just makes the previous data unreachable\n                    this._key = CreateUniqueKey();\n                };\n                return WeakMap;\n            }());\n            function CreateUniqueKey() {\n                var key;\n                do\n                    key = \"@@WeakMap@@\" + CreateUUID();\n                while (HashMap.has(keys, key));\n                keys[key] = true;\n                return key;\n            }\n            function GetOrCreateWeakMapTable(target, create) {\n                if (!hasOwn.call(target, rootKey)) {\n                    if (!create)\n                        return undefined;\n                    Object.defineProperty(target, rootKey, { value: HashMap.create() });\n                }\n                return target[rootKey];\n            }\n            function FillRandomBytes(buffer, size) {\n                for (var i = 0; i < size; ++i)\n                    buffer[i] = Math.random() * 0xff | 0;\n                return buffer;\n            }\n            function GenRandomBytes(size) {\n                if (typeof Uint8Array === \"function\") {\n                    if (typeof crypto !== \"undefined\")\n                        return crypto.getRandomValues(new Uint8Array(size));\n                    if (typeof msCrypto !== \"undefined\")\n                        return msCrypto.getRandomValues(new Uint8Array(size));\n                    return FillRandomBytes(new Uint8Array(size), size);\n                }\n                return FillRandomBytes(new Array(size), size);\n            }\n            function CreateUUID() {\n                var data = GenRandomBytes(UUID_SIZE);\n                // mark as random - RFC 4122  4.4\n                data[6] = data[6] & 0x4f | 0x40;\n                data[8] = data[8] & 0xbf | 0x80;\n                var result = \"\";\n                for (var offset = 0; offset < UUID_SIZE; ++offset) {\n                    var byte = data[offset];\n                    if (offset === 4 || offset === 6 || offset === 8)\n                        result += \"-\";\n                    if (byte < 16)\n                        result += \"0\";\n                    result += byte.toString(16).toLowerCase();\n                }\n                return result;\n            }\n        }\n        // uses a heuristic used by v8 and chakra to force an object into dictionary mode.\n        function MakeDictionary(obj) {\n            obj.__ = undefined;\n            delete obj.__;\n            return obj;\n        }\n    });\n})(Reflect || (Reflect = {}));\n","// Public: Create a new SelectorSet.\nexport default function SelectorSet() {\n  // Construct new SelectorSet if called as a function.\n  if (!(this instanceof SelectorSet)) {\n    return new SelectorSet();\n  }\n\n  // Public: Number of selectors added to the set\n  this.size = 0;\n\n  // Internal: Incrementing ID counter\n  this.uid = 0;\n\n  // Internal: Array of String selectors in the set\n  this.selectors = [];\n\n  // Internal: All Object index String names mapping to Index objects.\n  this.indexes = Object.create(this.indexes);\n\n  // Internal: Used Object index String names mapping to Index objects.\n  this.activeIndexes = [];\n}\n\n// Detect prefixed Element#matches function.\nvar docElem = window.document.documentElement;\nvar matches = (docElem.matches ||\n                docElem.webkitMatchesSelector ||\n                docElem.mozMatchesSelector ||\n                docElem.oMatchesSelector ||\n                docElem.msMatchesSelector);\n\n// Public: Check if element matches selector.\n//\n// Maybe overridden with custom Element.matches function.\n//\n// el       - An Element\n// selector - String CSS selector\n//\n// Returns true or false.\nSelectorSet.prototype.matchesSelector = function(el, selector) {\n  return matches.call(el, selector);\n};\n\n// Public: Find all elements in the context that match the selector.\n//\n// Maybe overridden with custom querySelectorAll function.\n//\n// selectors - String CSS selectors.\n// context   - Element context\n//\n// Returns non-live list of Elements.\nSelectorSet.prototype.querySelectorAll = function(selectors, context) {\n  return context.querySelectorAll(selectors);\n};\n\n\n// Public: Array of indexes.\n//\n// name     - Unique String name\n// selector - Function that takes a String selector and returns a String key\n//            or undefined if it can't be used by the index.\n// element  - Function that takes an Element and returns an Array of String\n//            keys that point to indexed values.\n//\nSelectorSet.prototype.indexes = [];\n\n// Index by element id\nvar idRe = /^#((?:[\\w\\u00c0-\\uFFFF\\-]|\\\\.)+)/g;\nSelectorSet.prototype.indexes.push({\n  name: 'ID',\n  selector: function matchIdSelector(sel) {\n    var m;\n    if (m = sel.match(idRe)) {\n      return m[0].slice(1);\n    }\n  },\n  element: function getElementId(el) {\n    if (el.id) {\n      return [el.id];\n    }\n  }\n});\n\n// Index by all of its class names\nvar classRe = /^\\.((?:[\\w\\u00c0-\\uFFFF\\-]|\\\\.)+)/g;\nSelectorSet.prototype.indexes.push({\n  name: 'CLASS',\n  selector: function matchClassSelector(sel) {\n    var m;\n    if (m = sel.match(classRe)) {\n      return m[0].slice(1);\n    }\n  },\n  element: function getElementClassNames(el) {\n    var className = el.className;\n    if (className) {\n      if (typeof className === 'string') {\n        return className.split(/\\s/);\n      } else if (typeof className === 'object' && 'baseVal' in className) {\n        // className is a SVGAnimatedString\n        // global SVGAnimatedString is not an exposed global in Opera 12\n        return className.baseVal.split(/\\s/);\n      }\n    }\n  }\n});\n\n// Index by tag/node name: `DIV`, `FORM`, `A`\nvar tagRe = /^((?:[\\w\\u00c0-\\uFFFF\\-]|\\\\.)+)/g;\nSelectorSet.prototype.indexes.push({\n  name: 'TAG',\n  selector: function matchTagSelector(sel) {\n    var m;\n    if (m = sel.match(tagRe)) {\n      return m[0].toUpperCase();\n    }\n  },\n  element: function getElementTagName(el) {\n    return [el.nodeName.toUpperCase()];\n  }\n});\n\n// Default index just contains a single array of elements.\nSelectorSet.prototype.indexes['default'] = {\n  name: 'UNIVERSAL',\n  selector: function() {\n    return true;\n  },\n  element: function() {\n    return [true];\n  }\n};\n\n\n// Use ES Maps when supported\nvar Map;\nif (typeof window.Map === 'function') {\n  Map = window.Map;\n} else {\n  Map = (function() {\n    function Map() {\n      this.map = {};\n    }\n    Map.prototype.get = function(key) {\n      return this.map[key + ' '];\n    };\n    Map.prototype.set = function(key, value) {\n      this.map[key + ' '] = value;\n    };\n    return Map;\n  })();\n}\n\n\n// Regexps adopted from Sizzle\n//   https://github.com/jquery/sizzle/blob/1.7/sizzle.js\n//\nvar chunker = /((?:\\((?:\\([^()]+\\)|[^()]+)+\\)|\\[(?:\\[[^\\[\\]]*\\]|['\"][^'\"]*['\"]|[^\\[\\]'\"]+)+\\]|\\\\.|[^ >+~,(\\[\\\\]+)+|[>+~])(\\s*,\\s*)?((?:.|\\r|\\n)*)/g;\n\n// Internal: Get indexes for selector.\n//\n// selector - String CSS selector\n//\n// Returns Array of {index, key}.\nfunction parseSelectorIndexes(allIndexes, selector) {\n  allIndexes = allIndexes.slice(0).concat(allIndexes['default']);\n\n  var allIndexesLen = allIndexes.length,\n      i, j, m, dup, rest = selector,\n      key, index, indexes = [];\n\n  do {\n    chunker.exec('');\n    if (m = chunker.exec(rest)) {\n      rest = m[3];\n      if (m[2] || !rest) {\n        for (i = 0; i < allIndexesLen; i++) {\n          index = allIndexes[i];\n          if (key = index.selector(m[1])) {\n            j = indexes.length;\n            dup = false;\n            while (j--) {\n              if (indexes[j].index === index && indexes[j].key === key) {\n                dup = true;\n                break;\n              }\n            }\n            if (!dup) {\n              indexes.push({index: index, key: key});\n            }\n            break;\n          }\n        }\n      }\n    }\n  } while (m);\n\n  return indexes;\n}\n\n// Internal: Find first item in Array that is a prototype of `proto`.\n//\n// ary   - Array of objects\n// proto - Prototype of expected item in `ary`\n//\n// Returns object from `ary` if found. Otherwise returns undefined.\nfunction findByPrototype(ary, proto) {\n  var i, len, item;\n  for (i = 0, len = ary.length; i < len; i++) {\n    item = ary[i];\n    if (proto.isPrototypeOf(item)) {\n      return item;\n    }\n  }\n}\n\n// Public: Log when added selector falls under the default index.\n//\n// This API should not be considered stable. May change between\n// minor versions.\n//\n// obj - {selector, data} Object\n//\n//   SelectorSet.prototype.logDefaultIndexUsed = function(obj) {\n//     console.warn(obj.selector, \"could not be indexed\");\n//   };\n//\n// Returns nothing.\nSelectorSet.prototype.logDefaultIndexUsed = function() {};\n\n// Public: Add selector to set.\n//\n// selector - String CSS selector\n// data     - Optional data Object (default: undefined)\n//\n// Returns nothing.\nSelectorSet.prototype.add = function(selector, data) {\n  var obj, i, indexProto, key, index, objs,\n      selectorIndexes, selectorIndex,\n      indexes = this.activeIndexes,\n      selectors = this.selectors;\n\n  if (typeof selector !== 'string') {\n    return;\n  }\n\n  obj = {\n    id: this.uid++,\n    selector: selector,\n    data: data\n  };\n\n  selectorIndexes = parseSelectorIndexes(this.indexes, selector);\n  for (i = 0; i < selectorIndexes.length; i++) {\n    selectorIndex = selectorIndexes[i];\n    key = selectorIndex.key;\n    indexProto = selectorIndex.index;\n\n    index = findByPrototype(indexes, indexProto);\n    if (!index) {\n      index = Object.create(indexProto);\n      index.map = new Map();\n      indexes.push(index);\n    }\n\n    if (indexProto === this.indexes['default']) {\n      this.logDefaultIndexUsed(obj);\n    }\n    objs = index.map.get(key);\n    if (!objs) {\n      objs = [];\n      index.map.set(key, objs);\n    }\n    objs.push(obj);\n  }\n\n  this.size++;\n  selectors.push(selector);\n};\n\n// Public: Remove selector from set.\n//\n// selector - String CSS selector\n// data     - Optional data Object (default: undefined)\n//\n// Returns nothing.\nSelectorSet.prototype.remove = function(selector, data) {\n  if (typeof selector !== 'string') {\n    return;\n  }\n\n  var selectorIndexes, selectorIndex, i, j, k, selIndex, objs, obj;\n  var indexes = this.activeIndexes;\n  var removedIds = {};\n  var removeAll = arguments.length === 1;\n\n  selectorIndexes = parseSelectorIndexes(this.indexes, selector);\n  for (i = 0; i < selectorIndexes.length; i++) {\n    selectorIndex = selectorIndexes[i];\n\n    j = indexes.length;\n    while (j--) {\n      selIndex = indexes[j];\n      if (selectorIndex.index.isPrototypeOf(selIndex)) {\n        objs = selIndex.map.get(selectorIndex.key);\n        if (objs) {\n          k = objs.length;\n          while (k--) {\n            obj = objs[k];\n            if (obj.selector === selector && (removeAll || obj.data === data)) {\n              objs.splice(k, 1);\n              removedIds[obj.id] = true;\n            }\n          }\n        }\n        break;\n      }\n    }\n  }\n\n  this.size -= Object.keys(removedIds).length;\n};\n\n// Sort by id property handler.\n//\n// a - Selector obj.\n// b - Selector obj.\n//\n// Returns Number.\nfunction sortById(a, b) {\n  return a.id - b.id;\n}\n\n// Public: Find all matching decendants of the context element.\n//\n// context - An Element\n//\n// Returns Array of {selector, data, elements} matches.\nSelectorSet.prototype.queryAll = function(context) {\n  if (!this.selectors.length) {\n    return [];\n  }\n\n  var matches = {}, results = [];\n  var els = this.querySelectorAll(this.selectors.join(', '), context);\n\n  var i, j, len, len2, el, m, match, obj;\n  for (i = 0, len = els.length; i < len; i++) {\n    el = els[i];\n    m = this.matches(el);\n    for (j = 0, len2 = m.length; j < len2; j++) {\n      obj = m[j];\n      if (!matches[obj.id]) {\n        match = {\n          id: obj.id,\n          selector: obj.selector,\n          data: obj.data,\n          elements: []\n        };\n        matches[obj.id] = match;\n        results.push(match);\n      } else {\n        match = matches[obj.id];\n      }\n      match.elements.push(el);\n    }\n  }\n\n  return results.sort(sortById);\n};\n\n// Public: Match element against all selectors in set.\n//\n// el - An Element\n//\n// Returns Array of {selector, data} matches.\nSelectorSet.prototype.matches = function(el) {\n  if (!el) {\n    return [];\n  }\n\n  var i, j, k, len, len2, len3, index, keys, objs, obj, id;\n  var indexes = this.activeIndexes, matchedIds = {}, matches = [];\n\n  for (i = 0, len = indexes.length; i < len; i++) {\n    index = indexes[i];\n    keys = index.element(el);\n    if (keys) {\n      for (j = 0, len2 = keys.length; j < len2; j++) {\n        if (objs = index.map.get(keys[j])) {\n          for (k = 0, len3 = objs.length; k < len3; k++) {\n            obj = objs[k];\n            id = obj.id;\n            if (!matchedIds[id] && this.matchesSelector(el, obj.selector)) {\n              matchedIds[id] = true;\n              matches.push(obj);\n            }\n          }\n        }\n      }\n    }\n  }\n\n  return matches.sort(sortById);\n};\n","var g;\n\n// This works in non-strict mode\ng = (function() {\n\treturn this;\n})();\n\ntry {\n\t// This works if eval is allowed (see CSP)\n\tg = g || Function(\"return this\")() || (1, eval)(\"this\");\n} catch (e) {\n\t// This works if the window reference is available\n\tif (typeof window === \"object\") g = window;\n}\n\n// g can still be undefined, but nothing to do about it...\n// We return undefined, instead of nothing here, so it's\n// easier to handle this case. if(!global) { ...}\n\nmodule.exports = g;\n","import {RegionBehaviour} from './RegionBehaviour';\r\nimport {Behaviourable, BehaviourConfig } from '../../managers/ScrollBehaviourManager';\r\nimport {Events} from 'debugbase/events/Events';\r\nimport {UIThemeChangeEvent} from 'app/event/UIThemeChangeEvent';\r\nimport {SidebarChangeEvent} from 'app/event/SidebarChangeEvent';\r\nimport {UIThemeColourType} from 'app/data/Enums';\r\n\r\n\r\n\r\nenum ActionType {\r\n\tUI_THEME = 'ui-theme',\r\n\tSIDEBAR = 'sidebar',\r\n}\r\n\r\n/** @class Scroll behaviour class, trigers when a element goes into a 'region' */\r\nexport class IntersectBehaviour extends RegionBehaviour {\r\n\r\n\tprivate _intersected: boolean = false; \r\n\tprivate _target: HTMLElement;\r\n\tprivate _targetRect: DOMRect;\r\n\tprivate _calculateScrollCounter: number = 1;\r\n\r\n\tconstructor (protected _config: BehaviourConfig, protected _container: HTMLElement) {\r\n\r\n\t\tsuper(_config, _container);\r\n\t\tthis._target = document.querySelector(this._config.selector);\r\n\r\n\t\t//TEST VALID. IF not then destroy this\r\n\t\tif (this._testValidElements() ) {\r\n\t\t\tthis.resize();\r\n\t\t} else {\r\n\t\t\tthis.destroy();\r\n\t\t}\r\n\t\r\n\t}\r\n\r\n\tpublic destroy(): void {\r\n\t\tsuper.destroy();\r\n\t}\r\n\r\n\tpublic resize(): void {\r\n\t\tthis._targetRect = this._target.getBoundingClientRect() as DOMRect;\r\n\t\tsuper.resize();\r\n\t}\r\n\r\n\t/** Update the scroll position (Note this doesn't nessary mean the 'viewport' is scrolled (but it could)) \r\n\t* @param {number} scroll\r\n\t*/\r\n\tpublic update(scroll: number): void {\r\n\r\n\t\tif (!this._config) {\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tsuper.update(scroll);\r\n\r\n\t\t//getBoundingClientRect is expensive, so limit with a counter\r\n\t\tthis._updateRegionRect();\r\n\r\n\t\tif (!this._intersected && this._isIntersected()) {\r\n\t\t\tthis._onIntersect();\r\n\t\t} else if (this._intersected && !this._isIntersected()) {\r\n\t\t\tthis._onExitIntersect();\r\n\t\t}\r\n\t}\r\n\r\n\t//PRIVATE \r\n\t//----------------------------------------------------------------------------------------------------\r\n\tprivate _onIntersect(): void {\r\n\t\t\r\n\t\t//When intersected then fire that event:\r\n\t\tif (this._config.action === ActionType.UI_THEME) {\r\n\t\t\tEvents.dispatch(new UIThemeChangeEvent({\r\n\t\t\t\ttheme: this._config.data as UIThemeColourType\r\n\t\t\t}) );\r\n\t\t} else if (this._config.action === ActionType.SIDEBAR) {\r\n\t\t\tlet dataParts: Array<string> = this._config.data.split(',');\r\n\t\t\tEvents.dispatch(new SidebarChangeEvent({\r\n\t\t\t\ttheme: dataParts[0] as UIThemeColourType,\r\n\t\t\t\tindex: parseInt(dataParts[1], 10),\r\n\t\t\t}) );\r\n\t\t}\r\n\r\n\t\tthis._intersected = true;\r\n\r\n\t}\r\n\r\n\tprivate _onExitIntersect(): void {\r\n\t\tthis._intersected = false;\r\n\t}\r\n\r\n\t/** Update the region client rect on on a counter so its not 60FPS!! */\r\n\tprivate _updateRegionRect(): void {\r\n\t\tthis._calculateScrollCounter++;\r\n\t\tif (this._calculateScrollCounter >= 1) {\r\n\t\t\tthis._regionRect = this._region.getBoundingClientRect() as DOMRect;\r\n\t\t\tthis._calculateScrollCounter = 0;\r\n\t\t}\r\n\t}\r\n\r\n\t/** Check if the target and the region are intersected \r\n\t* https://stackoverflow.com/questions/12066870/how-to-check-if-an-element-is-overlapping-other-elements\r\n\t*/ \r\n\tprivate _isIntersected(): boolean {\r\n\t\treturn !(this._regionRect.right < this._targetRect.left || \r\n                this._regionRect.left > this._targetRect.right || \r\n                this._regionRect.bottom < this._targetRect.top || \r\n                this._regionRect.top > this._targetRect.bottom);\r\n\r\n\t}\r\n\r\n\t/** Test if the elements are valid */\r\n\tprivate _testValidElements(): boolean {\r\n\r\n\t\tif (!this._target) {\r\n\t\t\ttry {\r\n\t\t\t\tthrow new Error(`Behaviour intersect target is not valid  : ${JSON.stringify(this._config)}` );\r\n\t\t\t} catch (e) {\r\n\t\t\t\tconsole.log(e);\r\n\t\t\t}\r\n\t\t\treturn false;\r\n\t\t}\r\n\r\n\t\treturn true;\r\n\r\n\t}\r\n\r\n}\r\n","import {Behaviourable, BehaviourConfig} from '../../managers/ScrollBehaviourManager';\r\nimport {Events} from 'debugbase/events/Events';\r\nimport {ScrollerType} from 'app/data/Enums';\r\nimport {RegionViewportEvent} from 'app/event/RegionViewportEvent';\r\n\r\n/** @class Scroll behaviour class, triggers when a region is viewable */\r\nexport class RegionBehaviour implements Behaviourable {\r\n\r\n\tpublic destoyed: boolean = false;\r\n\t//Protected  ------------------------------------------\r\n\tprotected _region: HTMLElement;\r\n\tprotected _regionRect: DOMRect;\r\n\tprotected _regionHeight: number;\r\n\tprotected _regionOffsetTop: number;\r\n\tprotected _viewable: boolean = true;\r\n\tprotected _innerHeight: number = 0;\r\n\tprotected _scrollY: number = 0;\r\n\t//Private -----------------------------------------------\r\n\tprivate _viewableTolerence: number = 0; \t//+/- When a region is consiedered visible: \r\n\r\n\tconstructor (protected _config: BehaviourConfig, protected _container: HTMLElement) {\r\n\t\t\r\n\t\tthis._region = _container.querySelector(`#${this._config.id}`);\r\n\t\t\r\n\t\tif (!this._testValidRegion() ) {\r\n\t\t\tthis.destroy();\r\n\t\t}\r\n\r\n\t}\r\n\r\n\tpublic destroy(): void {\r\n\t\tthis._config = null;\r\n\t\tthis._container = null;\r\n\t\tthis._regionRect = null;\r\n\t\tthis.destoyed = false;\r\n\t\tthis._region.removeEventListener('resize', this.resize.bind(this));\r\n\t}\r\n\r\n\tpublic resize(): void {\r\n\r\n\t\tif (!this._config) {\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tthis._innerHeight = window.innerHeight;\r\n\t\tthis._regionRect = this._region.getBoundingClientRect() as DOMRect;\r\n\t\tthis._regionHeight =  this._region.clientHeight;\r\n\t\tthis._regionOffsetTop  =  this._region.offsetTop;\r\n\t}\r\n\r\n\tpublic update(scroll: number): void {\r\n\t\tthis._scrollY = scroll;\r\n\t\tthis._testInViewport();\r\n\t}\r\n\r\n\t//private\r\n\t//-----------------------------------------------------------------------------------------\r\n\t\r\n\t/** Test if the region is in in viewport (allowing for any tolerences). Can be used for lazy loading, video play/stoping, resting state, hiding, etc */\r\n\tprivate _testInViewport(): void {\r\n\r\n\t\tif (this._viewable !== this._checkRegionInViewPort() ) {\r\n\t\t\t\r\n\t\t\tthis._viewable = !this._viewable;\r\n\r\n\t\t\t//If is setup to hide when outside view viewport then css hide / show \r\n\t\t\tif (this._config.hideOutsideViewport && this._config.scrollerType === ScrollerType.CUSTOM) {\r\n\t\t\t\tthis._region.style.visibility = (this._viewable) ? 'visible' : 'hidden';\r\n\t\t\t}\r\n\r\n\t\t\t//As the region viewable state has changed then, Trigger event that can be acted on\r\n\t\t\tEvents.dispatch(new RegionViewportEvent( {\r\n\t\t\t\tviewable: this._viewable,\r\n\t\t\t\tregion: this._region,\r\n\t\t\t\tconfig: this._config\r\n\t\t\t}));\r\n\t\t}\r\n\r\n\t}\r\n\r\n\t/** Measure if region is in Viewport \r\n\t* @return {boolean}\r\n\t*/\r\n\tprivate _checkRegionInViewPort(): boolean {\r\n\r\n\t\tif (this._scrollY + this._innerHeight > (this._regionOffsetTop - this._viewableTolerence)  && \r\n\t\t\tthis._scrollY < ((this._regionOffsetTop + this._regionHeight) + this._viewableTolerence) ) {\r\n\t\t\t\treturn true;\r\n\t\t}\r\n\r\n\t\t//if (this._innerHeight > (this._region.offsetTop - this._viewableTolerence)  && \r\n\t\t//\tthis._scrollY < ((this._region.offsetTop + this._regionRect.height) + this._viewableTolerence) ) {\r\n\t\t//\treturn true;\r\n\t\t//}\r\n\r\n\t\treturn false;\r\n\r\n\t}\r\n\r\n\t/** Test if the region is actualy valid. Throw an error if not \r\n\t* @return {boolean}\r\n\t*/\r\n\tprivate _testValidRegion(): boolean {\r\n\r\n\t\tif (!this._region) {\r\n\t\t\ttry {\r\n\t\t\t\tthrow new Error(`Behaviour region not valid target  : ${JSON.stringify(this._config)}` );\r\n\t\t\t} catch (e) {\r\n\t\t\t\tconsole.log(e);\r\n\t\t\t}\r\n\t\t\treturn false;\r\n\t\t}\r\n\r\n\t\treturn true;\r\n\r\n\t}\r\n\r\n}\r\n\r\n","import { ScrollerType} from 'app/data/Enums';\r\nimport { IntersectBehaviour } from '../behaviours/scroll/IntersectBehaviour';\r\nimport { RegionBehaviour } from '../behaviours/scroll/RegionBehaviour';\r\n\r\nexport enum BehaviourType {\r\n\tINTERSECT = 'intersect',  \t\r\n\tREGION = 'region' \r\n}\r\n\r\nexport interface Behaviourable {\r\n\tresize: Function;\r\n\tdestroy: Function;\r\n\tupdate: Function;\r\n}\r\n\r\nexport  interface  BehaviourConfig {\r\n\tscrollerType: ScrollerType;\r\n\ttype: BehaviourType;\r\n\tid: string;\r\n\thideOutsideViewport?: boolean;\r\n\tselector?: string;\r\n\taction?: string;\r\n\tdata?: string;\r\n}\r\n\r\n/** @class Mananger to manage scroll behaviours */\r\nexport class ScrollBehaviourManager {\r\n\r\n\tprivate _behaviours: Array<Behaviourable> = [];\r\n\tprivate _scroll: number = 0;\r\n\tprivate _container: HTMLElement;\r\n\tprivate _scrollerType: ScrollerType;\r\n\r\n\tpublic setType(type: ScrollerType): void {\r\n\t\tthis._scrollerType = type;\r\n\t}\r\n\r\n\t/**\r\n\t* Update the scroll\r\n\t* @param {number} scroll - Y position of the scroll \r\n\t*/\r\n\tpublic updateScroll(scroll: number): void {\r\n\t\tthis._scroll = scroll;\r\n\t\tthis._updateBehaviours(this._scroll);\r\n\t}\r\n\r\n\t/** \r\n\t* Set target container \r\n\t* @param {HTMLElement} container - The container with the elements to apply behaviours to\r\n\t*/\r\n\tpublic setContainer(element: HTMLElement): void {\r\n\t\t\r\n\t\tthis._destroyBehaviours();\r\n\t\tthis._removeListeners();\r\n\t\tthis._container = element;\r\n\r\n\t\tif (this._container) {\r\n\t\t\tthis._createBehaviours();\r\n\t\t\tthis._container.addEventListener('resize', this.resize.bind(this));\r\n\t\t}\r\n\t\r\n\t}\r\n\r\n\t/** Resize event */  \r\n\tpublic resize(): void {\r\n\t\tthis._resizeBehaviours();\r\n\t}\r\n\r\n\t//Private\r\n\t//------------------------------------------------------------------------------\r\n\t\r\n\t/** Destroy all 'scroll' behaviours from the old container */\r\n\tprivate _destroyBehaviours(): void {\r\n\t\tthis._behaviours.forEach( (behaviour) => {\r\n\t\t\tbehaviour.destroy();\r\n\t\t});\r\n\t\tthis._behaviours = [];\r\n\t}\r\n\r\n\t/** Remove listeners */\r\n\tprivate _removeListeners(): void {\r\n\t\tif (this._container) {\r\n\t\t\tthis._container.removeEventListener('resize', this.resize.bind(this));\r\n\t\t}\r\n\t}\r\n\r\n\t/** Create all 'scroll' behaviours found in the container */\r\n\tprivate _createBehaviours(): void {\r\n\t\tthis._container.querySelectorAll('.behaviour').forEach( (element: HTMLElement) => {\r\n\t\t\tlet id: string = element.getAttribute('id');\r\n\t\t\tlet behaviours: Array<BehaviourConfig> = JSON.parse(element.getAttribute('data-behaviour')).behaviours;\r\n\t\t\tif ( this._checkValidId(id, behaviours) ) {\r\n\t\t\t\tthis._createElementBehaviours(behaviours, id);\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n\r\n\t/** Create all the behaviours in one element \r\n\t* @param {Array<BehaviourConfig>} configList - Array of config value\r\n    */\r\n\tprivate _createElementBehaviours(configList: Array<BehaviourConfig>, id: string): void {\r\n\t\t\r\n\t\tconfigList.forEach( (config: BehaviourConfig ) =>  {\r\n\t\t\t\r\n\t\t\t//Set the id from the 'id' atrr on the tag: \r\n\t\t\tconfig.id = id;\r\n\t\t\tconfig.hideOutsideViewport = true;\r\n\t\t\tconfig.scrollerType = this._scrollerType;\r\n\r\n\t\t\tif (config.type === BehaviourType.INTERSECT) {\r\n\t\t\t\tthis._behaviours.push( new IntersectBehaviour(config, this._container) );\r\n\t\t\t} else if (config.type === BehaviourType.REGION) {\r\n\t\t\t\tthis._behaviours.push( new RegionBehaviour(config, this._container) );\r\n\t\t\t}\r\n\r\n\t\t});\r\n\r\n\t}\r\n\r\n\t/** Resize all 'scroll' behaviours from the old container */\r\n\tprivate _resizeBehaviours(): void {\r\n\t\t\r\n\t\tthis._behaviours.forEach( (behaviour) => {\r\n\t\t\tbehaviour.resize();\r\n\t\t});\r\n\r\n\t\tconsole.log('FIX OBSERVER !!!!!!');\r\n\t\t(window as any).observer.observe();\r\n\t\t\r\n\t}\r\n\r\n\t/** Update all the bahviours on scroll\r\n\t* @param {number} scroll \r\n\t*/\r\n\tprivate _updateBehaviours(scroll: number): void {\r\n\t\tthis._behaviours.forEach( (behaviour) => {\r\n\t\t\tbehaviour.update(scroll);\r\n\t\t});\r\n\t}\r\n\r\n\t/** Check if the ID is set \r\n\t* @param {string} id \r\n\t* @param {Array<BehaviourConfig>} config \r\n\t* @throws {Error}\r\n\t* @returns {boolean}\r\n\t*/\r\n\tprivate _checkValidId(id: string, config: Array<BehaviourConfig> ): boolean {\r\n\t\t\r\n\t\tif (!id || id === '') {\r\n\t\t\ttry {\r\n\t\t\t\tthrow new Error(`Behaviour ID has not been set on region/element : ${JSON.stringify(config)}` );\r\n\t\t\t} catch (e) {\r\n\t\t\t\tconsole.log(e);\r\n\t\t\t}\r\n\t\t\treturn false;\r\n\t\t}\r\n\r\n\r\n\t\treturn true;\r\n\r\n\t}\r\n\r\n}\r\n","//1.0 Main controller than creates all sub controllers: \r\nimport {Controller} from 'debugbase/abstract/Controller';\r\nimport {Events} from 'debugbase/events/Events';\r\nimport {GA} from 'debugbase/tracking/GA';\r\nimport {AppEvents} from 'app/data/AppEvents';\r\n\r\nimport {ViewReadyEvent} from 'app/event/ViewReadyEvent';\r\nimport {PixiResourceLoadEvent} from 'app/event/PixiResourceLoadEvent';\r\nimport {AjaxHTMLLoadedEvent} from 'app/event/AjaxHTMLLoadedEvent';\r\nimport {HomeDepartmentReachedEvent} from 'app/event/HomeDepartmentReachedEvent';\r\nimport {JSONLoadEvent} from 'app/event/JSONLoadEvent';\r\n\r\nimport {\r\n\tSectionType, \r\n\tDepartmentType, \r\n\tPixiResourceType, \r\n\tMenuStateType,\r\n\tInfoSectionType\r\n} from 'app/data/Enums';\r\n\r\nimport {PixiController} from 'app/controller/PixiController';\r\nimport {PreloadController} from 'app/controller/PreloadController';\r\nimport {UIController} from 'app/controller/UIController';\r\nimport {NavMenuController} from 'app/controller/NavMenuController';\r\nimport {ScrollbarController} from 'app/controller/ScrollbarController';\r\nimport {HomeController} from 'app/controller/HomeController';\r\nimport {WorkController} from 'app/controller/WorkController';\r\nimport {ProjectController} from 'app/controller/ProjectController';\r\nimport {MouseController} from 'app/controller/MouseController';\r\nimport {BackgroundController} from 'app/controller/BackgroundController';\r\nimport {InfoController} from 'app/controller/InfoController';\r\nimport {HistoryController} from 'app/controller/HistoryController';\r\nimport {HistoryStateModel} from 'app/model/HistoryStateModel';\r\n\r\nimport {HTMLLoader} from 'debugbase/loader/HTMLLoader';\r\n\r\n//import * as PIXI from 'pixi.js';\r\n\r\nexport class AppController extends Controller {\r\n\r\n\tprivate _pixi:  PixiController;\r\n\tprivate _preload:  PreloadController;\r\n\tprivate _mouse: MouseController;\r\n\tprivate _history: HistoryController;\r\n\tprivate _background: BackgroundController;\r\n\tprivate _scrollbar: ScrollbarController;\r\n\tprivate _ui:  UIController;\r\n\tprivate _navMenu: NavMenuController;\r\n\tprivate _home:  HomeController;\r\n\tprivate _screens:  WorkController;\r\n\tprivate _spaces:  WorkController;\r\n\tprivate _project:  ProjectController;\r\n\tprivate _info: InfoController;\r\n\r\n\t//Active view and state: \r\n\tprivate _activeViewController: Controller;\r\n\tprivate _activeState: HistoryStateModel;\r\n\r\n\t//Pixi app for Fullscreen / rich elements: \r\n\t//TODO - Move to own PIXI controller. Its weird that such a big concern is setup here....\r\n\tprivate _$pixi: PIXI.Application;\r\n\tprivate _$backgroundContainer:  PIXI.Container;\r\n\tprivate _$workContainer:  PIXI.Container;\r\n\tprivate _$homeContainer:  PIXI.Container;\r\n\r\n\tpublic init(): void {\r\n\t\tthis._setControllerRefs();\r\n\t\tthis._injectControllerRefs();\r\n\t\tthis._addListeners();\r\n\t\tthis._setPixiDepencies();\r\n\t}\r\n\r\n\tpublic DOMReady(): void {\r\n\t\t\r\n\t}\r\n\r\n\tpublic modulesMounted(): void {\r\n\t\t//setTimeout( () =>  this._preload.hide(), 1000);\r\n\t}\r\n\r\n\tpublic get pixi() : PIXI.Application {\r\n\t\treturn \tthis._pixi.getPixi();\r\n\t}\r\n\r\n\t//Private methods: \r\n\t//------------------------------------------------------------------------------------\r\n\t//-------------------------------------------------------------------------------------\r\n\t//-------------------------------------------------------------------------------------\r\n\t//-------------------------------------------------------------------------------------\r\n\r\n\t/** Controllers are created automatically through Debugbase.controllers directive so just need to granb them */\r\n\tprivate _setControllerRefs(): void {\r\n\t\t\r\n\t\tthis._pixi = this.get('Pixi');\r\n\t\tthis._preload = this.get('Preload');\r\n\t\tthis._mouse = this.get('Mouse');\r\n\t\tthis._history = this.get('History');\r\n\t\tthis._scrollbar = this.get('Scrollbar');\r\n\t\tthis._background = this.get('Background');\r\n\t\tthis._ui = this.get('UI');\r\n\t\tthis._navMenu = this.get('NavMenu');\r\n\t\tthis._home = this.get('Home');\r\n\t\tthis._spaces = this.get('Spaces');\r\n\t\tthis._screens = this.get('Screens');\r\n\t\tthis._project = this.get('Project');\r\n\t\tthis._info = this.get('Info');\r\n\r\n\t\tthis._spaces.setDepartment(DepartmentType.SPACES);\r\n\t\tthis._screens.setDepartment(DepartmentType.SCREENS);\r\n\r\n\t}\r\n\r\n\t/** Pass required controller refs to each other */\r\n\tprivate _injectControllerRefs(): void {\r\n\t\tthis._preload.setControllers(this._ui);\r\n\t\tthis._navMenu.setControllers(this._info);\r\n\t\tthis._ui.setControllers(this._scrollbar);\r\n\t\tthis._spaces.setControllers(this._mouse, this._background, this._pixi);\r\n\t\tthis._screens.setControllers(this._mouse, this._background, this._pixi);\r\n\t\tthis._home.setControllers(this._mouse, this._background, this._pixi);\r\n\t\tthis._info.setControllers(this._scrollbar);\r\n\t\tthis._project.setControllers(this._mouse, this._scrollbar, this._pixi, this._screens, this._spaces);\r\n\t\tthis._background.setControllers(this._mouse);\r\n\t}\r\n\r\n\t/** Pass PIXI dependecies on Work, Home and background controllers: */\r\n\tprivate _setPixiDepencies(): void {\r\n\t\tthis._screens.setPixi(this._pixi.getPixi(), this._pixi.getBackground(), this._pixi.getWork(DepartmentType.SCREENS) );\r\n\t\tthis._spaces.setPixi(this._pixi.getPixi(), this._pixi.getBackground(), this._pixi.getWork(DepartmentType.SPACES));\r\n\t\tthis._home.setPixi(this._pixi.getPixi(), this._pixi.getHome() );\r\n\t\tthis._background.setPixi(this._pixi.getPixi(), this._pixi.getBackground() ) ;\r\n\t}\r\n\r\n\t/** Add all the major app wide style event listeners: */\r\n\tprivate _addListeners(): void {\r\n\t\t\r\n\t\t//Loading:\r\n\t\tEvents.on(PixiResourceLoadEvent,  this._onPixiResourceLoaded.bind(this) );\r\n\t\tEvents.on(AjaxHTMLLoadedEvent,  this._onAjaxHTMLLoaded.bind(this) );\r\n\t\tEvents.on(JSONLoadEvent,  this._onJSONLoaded.bind(this) );\r\n\t\tEvents.on(ViewReadyEvent, this._onViewReady.bind(this));\r\n\r\n\t\t//Navigation / View changes: \r\n\t\tEvents.on(AppEvents.SET_INTIAL_STATE, this._onSetIntialState.bind(this) );\r\n\t\tEvents.on(AppEvents.CHANGE_SECTION, this._onChangeSection.bind(this) );\r\n\t\tEvents.on(AppEvents.POP_HISTORY_STATE, this._onPopHistoryState.bind(this) );\r\n\t\tEvents.on(AppEvents.DEEP_LINK_LOADER_COMPLETE, this._onDeepLinkLoaderComplete.bind(this) );\r\n\t\tEvents.on(HomeDepartmentReachedEvent, this._onHomeDepartmentReached.bind(this) );\r\n\t\t\r\n\t\t//UI / NavMenu type events: \r\n\t\tEvents.on(AppEvents.DEBUG_LOGO_PRESS,  this._onDebugLogoPress.bind(this) );\r\n\t\tEvents.on(AppEvents.ACTIVE_DEPARTMENT_NAV_MENU_PRESS,  this._onActiveDepartmentNavMenuPress.bind(this) );\r\n\t\tEvents.on(AppEvents.MENU_STATE_CHANGE,  this._onMenuStateChange.bind(this) );\r\n\t\tEvents.on(AppEvents.RESET_NAV_MENU,  this._onResetNavMenu.bind(this) );\r\n\r\n\t}\r\n\r\n\t//Pixi resource has loaded so pass that resource on the controllers that require it: \r\n\tprivate _onPixiResourceLoaded(resourceEvent: PixiResourceLoadEvent): void {\r\n\r\n\t\tconsole.log('resourceEvent', resourceEvent);\r\n\r\n\t\t//If background type then tell the background controller free to load the background items  \r\n\t\tif ( resourceEvent.type === PixiResourceType.BACKGROUNDS) {\r\n\t\t\tthis._background.pixiBackgroundsLoaded(resourceEvent.resource.spritesheet);\r\n\t\t} else if (resourceEvent.type === PixiResourceType.HOME_PARTCILES ) {\r\n\t\t\tthis._home.pixiParticlesLoaded(resourceEvent.resource.spritesheet);\r\n\t\t} else if (resourceEvent.type === PixiResourceType.WORK_PARTICLES) {\r\n\t\t\t//Work particles are shared so pass to both screens / spaces\r\n\t\t\tthis._screens.pixiParticlesLoaded(resourceEvent.resource.spritesheet);\r\n\t\t\tthis._spaces.pixiParticlesLoaded(resourceEvent.resource.spritesheet);\r\n\t\t} else if (resourceEvent.type === PixiResourceType.WORK_BACKGROUNDS_SCREEN ) {\r\n\t\t\tthis._screens.pixiBackgroundsLoaded(resourceEvent.resource.spritesheet, DepartmentType.SCREENS);\r\n\t\t} else if (resourceEvent.type === PixiResourceType.WORK_BACKGROUNDS_SPACES ) {\r\n\t\t\tthis._spaces.pixiBackgroundsLoaded(resourceEvent.resource.spritesheet, DepartmentType.SPACES);\r\n\t\t} else if (resourceEvent.type === PixiResourceType.MOTH ) {\r\n\t\t\tthis._home.pixiMothLoaded(resourceEvent.resource.spritesheet);\r\n\t\t}\r\n\r\n\t}\r\n\r\n\t/** Extrnal HTML has been set so pass to the correct controller that can then use the resource as required */\r\n\tprivate _onAjaxHTMLLoaded(event: AjaxHTMLLoadedEvent): void {\r\n\r\n\t\tlet id: string = event.loader.id;\r\n\t\tlet html: string = event.loader.html;\r\n\r\n\t\tif (id  === '/') {\r\n\t\t\tthis._home.setHTML(html);\r\n\t\t} else if (id  === '/about/' || id  === '/studio/' || id  === '/jobs/' || id  === '/contact/') {\r\n\t\t\tlet subSection: string = id.substring(1,  id.length - 1);\r\n\t\t\tthis._info.setHTML(html, (subSection as InfoSectionType));\r\n\t\t} else if (id  === '/screens/') {\r\n\t\t\tthis._screens.setHTML(html);\t\r\n\t\t} else if (id  === '/spaces/') {\r\n\t\t\tthis._spaces.setHTML(html);\t\r\n\t\t} else {\r\n\t\t\t//No other 'static' type pages left, so must be a project\r\n\t\t\tthis._project.setHTML(id, html);\t\r\n\t\t}\r\n\r\n\t}\r\n\r\n\t/** JSON item is loaded so pass to the required view controller */\r\n\tprivate _onJSONLoaded(event: JSONLoadEvent): void {\r\n\t\tif (event.id === 'json-screens') {\r\n\t\t\tthis._screens.setJSON(event.json);\r\n\t\t} else if (event.id === 'json-spaces') {\r\n\t\t\tthis._spaces.setJSON(event.json);\r\n\t\t}  else if (event.id === 'json-home') {\r\n\t\t\tthis._home.setJSON(event.json);\r\n\t\t}\r\n\t}\r\n\r\n\t/**Intial preload is complete. So can show the site */\r\n\t//private _onIntialPreloadComlete(): void {\r\n\t\t//this._activeViewController.show();\r\n\t//}\r\n\r\n\t/** \r\n\t* View is ready so can then show if the site/preloading is wairing on it\r\n\t* @param {ViewReadyEvent} event \r\n\t*/\r\n\tprivate _onViewReady(event: ViewReadyEvent): void {\r\n\t\t\r\n\t\t//Pass the event direct to the preload manager.\r\n\t\t//This checks if that view is being currently being waited on \r\n\t\tlet isPreloadingViewReady: boolean = this._preload.viewReady(event);\r\n\r\n\t\t//If the active controller is loaded and been waiting on then can show the active controller\r\n\t\tif (isPreloadingViewReady) {\r\n\t\t\tthis._preload.hide();\r\n\t\t\tthis._activeViewController.reset(null, true);\r\n\t\t\tthis._activeViewController.show(null, true);\r\n\t\t}\r\n\r\n\t}\r\n\r\n\t//** Set intial section / state / active view. Happens straight away, configured by the active 'view' as routed */\r\n\tprivate _onSetIntialState(stateObject: HistoryStateModel): void {\r\n\r\n\t\t//Tell the preloader what the intial state is (So it can decide what order to load assets)\r\n\t\tthis._preload.setIntialState(stateObject);\r\n\t\tthis._navMenu.setState(stateObject, false);\r\n\t\tthis._ui.setState(stateObject);\r\n\r\n\t\t//Get the active view controller by id ref (home, info, screens, spaces, project)\r\n\t\tthis._switchControllerToActive(stateObject);\r\n\t\t\r\n\t\t//Set the intial state. Will be reached when the users presses back through all history states\r\n\t\tthis._history.setIntialState(stateObject);\r\n\r\n\t}\r\n\r\n\t/** On change section. This comes form  */\r\n\tprivate _onChangeSection(stateObject: HistoryStateModel, pushHistoryState: boolean = true): void {\r\n\t\t\r\n\t\t//Check if the new view is ready to view. \r\n\t\tlet readyToView: boolean =  (this._getControllerFromState(stateObject) as any).isReadyToView(stateObject);\r\n\t\t\r\n\t\t//Add the history state if not bypassed (because coming from HistoryState pop() ) :\r\n\t\tif ( pushHistoryState) {\r\n\t\t\tthis._history.push(stateObject, stateObject.title, stateObject.href);\r\n\t\t}\r\n\t\t\r\n\t\t//Set the UI / breadcrumbs / menu state: \r\n\t\tthis._ui.setState(stateObject);\r\n\t\tthis._navMenu.setState(stateObject);\r\n\r\n\t\t//If the menu is showing then hide (If configured on stateObject as don't want mess with navMenu > info processes):\r\n\t\tif (stateObject.hideMenu && this._navMenu.isShowing()) {\r\n\t\t\tthis._navMenu.reset();\r\n\t\t\tthis._onMenuStateChange({state: MenuStateType.CLOSED});\r\n\t\t}\r\n\t\t\r\n\t\t//Check if transitions are bypassed (Because the view has controlled its own state change internally):\r\n\t\t//------------------------------------------------------------------------\r\n\t\tif (stateObject.bypassTransitions) {\r\n\t\t\tthis._switchControllerToActive(stateObject);\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\t//Check if an internal view switch (For example in info moving bewteen tabs, caused by menu action):\r\n\t\t//------------------------------------------------------------------------\r\n\t\tif (this._activeState.section === stateObject.section && this._activeState.section === SectionType.INFO) {\r\n\t\t\tthis._activeState = stateObject;\r\n\t\t\t(this._activeViewController as any).subsectionStateChange(stateObject);\r\n\t\t\tthis._navMenu.reset();\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\t//Check if a deeplink style: \r\n\t\t//-------------------------------------------------------------------------\r\n\t\tif (stateObject.isDeepLink || !readyToView) {\r\n\t\t\tthis._onDeepLink(stateObject);\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\t//Organic / mixed transition style switch. I.E going from home > work. Or nav menu to about, or work slider > to project\r\n\t\t///-------------------------------------------------------------------------\r\n\t\t\r\n\t\t//Hide the current/old view. Pass the state object of next state, so the view can workout how to hide itself based on where its going next\r\n\t\tthis._activeViewController.hide(stateObject);\r\n\t\t\r\n\t\t//Set to new view. Then pass the old state in with show, so the new view can work out how to show itsself based on where its comeing from:  \r\n\t\tlet oldState: HistoryStateModel = this._activeState;\r\n\t\tthis._switchControllerToActive(stateObject);\r\n\t\tthis._activeViewController.reset(oldState);\r\n\t\tthis._activeViewController.show(oldState);\r\n\t\t\r\n\t}\r\n\r\n\t/** On change section via back / forward buttons */\r\n\tprivate _onPopHistoryState(stateObject: HistoryStateModel): void {\r\n\r\n\t\t//If the section type is the same then can just trigger. This only applies to 'info' at this point\r\n\t\tif (this._activeState.section === stateObject.section) {\r\n\t\t\tthis._activeState = stateObject;\r\n\t\t\t(this._activeViewController as any).subsectionStateChange(stateObject);\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\t//Flag that its a deeplink change: \r\n\t\tstateObject.isDeepLink = true;\r\n\t\tstateObject.fromMenu = false;\r\n\t\tstateObject.bypassTransitions = false;\r\n\r\n\t\t//Treat as a deep link: \r\n\t\tthis._onChangeSection(stateObject, false);\r\n\r\n\t}\r\n\r\n\t/** Deep link to new section (Through history state, or far reaching nav action like spaces, screens or home link) */\r\n\tprivate _onDeepLink(stateObject: HistoryStateModel): void {\r\n\r\n\t\tconsole.log(\"AppController > _onDeepLink\", stateObject);\r\n\r\n\t\t//Freeze active controller, will decativate and hide the view:\r\n\t\t(this._activeViewController as any).freeze();\r\n\r\n\t\t//2. Set the the new controller to the one defined by the state, then pass that state back so view can be setup as required:\r\n\t\tthis._switchControllerToActive(stateObject);\r\n\t\r\n\t\t//Show a quick preloader to mask:\r\n\t\tthis._mouse.setDragCursorActive(false);\r\n\t\tthis._preload.showDeepLinkLoader( this._activeViewController  );\r\n\t\tthis._ui.hide();\r\n\t\r\n\t}\r\n\r\n\t/** Switch controller/state to active  */\r\n\tprivate _switchControllerToActive(stateObject: HistoryStateModel): void {\r\n\r\n\t\t//Get controller view ref, but when work pick between screens / spaces\r\n\t\tthis._activeState = stateObject;\r\n\t\tthis._activeViewController = this._getControllerFromState(stateObject);\r\n\t\t(this._activeViewController as any).setState(this._activeState);\r\n\r\n\t}\r\n\r\n\t/** Get controller from history state */ \r\n\tprivate _getControllerFromState(state: HistoryStateModel): Controller {\r\n\r\n\t\tlet controller: Controller;\r\n\t\tlet viewControllerRef: string = state.section;\r\n\t\tif (state.section === SectionType.WORK) {\r\n\t\t\tviewControllerRef = state.subsection;\r\n\t\t} \r\n\t\treturn this.get(viewControllerRef);\r\n\r\n\t}\r\n\r\n\t//** History state loader complete. Essentiall snazzy animation is complete so ready to show section again */\r\n\tprivate _onDeepLinkLoaderComplete(): void {\r\n\t\t//Reset the view to an intial state as defined by the set state then show\r\n\t\t//(This will mean the view is under the preloaded and will show as it hides)\r\n\t\tthis._navMenu.reset();\r\n\t\tthis._activeViewController.reset(null, true);\r\n\t\tthis._activeViewController.show(null, true);\r\n\t}\r\n\r\n\t/** A department has been reached / displayed on the home view. So que that item up for display (Inject HTM) */\r\n\tprivate _onHomeDepartmentReached(event: HomeDepartmentReachedEvent): void {\r\n\t\tvar view: Controller = (event.department === DepartmentType.SCREENS) ? this._screens : this._spaces;\r\n\t\t(view as any).que();\r\n\r\n\t\tGA.event('Progress', 'Work section qued', event.department);\r\n\r\n\t}\r\n\t\r\n\t//** Logo press jump to home > middle */\r\n\tprivate _onDebugLogoPress(): void {\r\n\r\n\t\tGA.event('UX', 'Logo press');\r\n\r\n\t\t//If the home section is active then animate to 0.5:\r\n\t\tif ( this._activeState.section === SectionType.HOME ) {\r\n\t\t\tthis._home.unpause();\r\n\t\t\tthis._home.animateProgressToValue(1);\r\n\t\t\tthis._mouse.setDragCursorActive(true);\r\n\t\t\tthis._navMenu.reset();\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\t//Home is not showing so, so do hard deep link transition to the section:\r\n\t\tlet stateObject: HistoryStateModel = {\r\n\t\t\tsection: SectionType.HOME,\r\n\t\t\ttitle: 'Home',\r\n\t\t\thref: '/',\r\n\t\t\tisDeepLink: true,\r\n\t\t\thideMenu: true,\r\n\t\t};\r\n\t\tthis._onChangeSection(stateObject);\r\n\r\n\t}\r\n\r\n\t/** On active deparment menu press. Basically just scroll back to start of the timeline. */\r\n\tprivate _onActiveDepartmentNavMenuPress(department: DepartmentType) {\r\n\r\n\t\tconsole.log('ACTIVE DEPARTMENT PRESS');\r\n\t\tthis._navMenu.reset();\r\n\t\tlet viewController = (department === DepartmentType.SCREENS) ? this._screens : this._spaces;\r\n\t\tviewController.animateProgressToValue(0);\r\n\t\t\r\n\t}\r\n\r\n\t/** When menu is opened / closed then need to pause/start whatever 'view' controller is active */\r\n\tprivate _onMenuStateChange(e: any): void {\r\n\t\t\r\n\t\tlet state: MenuStateType = e.state;\r\n\t\tif (state === MenuStateType.OPEN) {\r\n\t\t\r\n\t\t\tthis._activeViewController.pause();\r\n\t\t\tthis._mouse.pause();\r\n\r\n\t\t\t//Menu is opened. So its likely that sectiom will be opened next. So inject that HTML\r\n\t\t\t//Add slight delay so transition can happen without jank\r\n\t\t\tsetTimeout(() => this._info.que(), 1000);\r\n\r\n\t\t} else if (state === MenuStateType.CLOSED) {\r\n\t\t\tthis._activeViewController.unpause();\r\n\t\t\tthis._mouse.unpause();\r\n\t\t}\r\n\r\n\t\tthis._ui.setNavState(state);\r\n\r\n\t\t//Tracking \r\n\t\tGA.event('UX','Nav Menu', state);\r\n\t\t\r\n\t}\r\n\r\n\t/** Reset the menu state on returning back to the  */\r\n\tprivate _onResetNavMenu(): void {\r\n\t\tthis._navMenu.reset();\r\n\t}\r\n\r\n}\r\n","import {Controller} from 'debugbase/abstract/Controller';\r\nimport { MouseController } from 'app/controller/MouseController';\r\n//import {TimelineMax, TweenMax, Power0, Power3, Back } from 'gsap';\r\nimport {Events} from 'debugbase/events/Events';\r\nimport {SectionType, DepartmentType, BackgroundSetType} from 'app/data/Enums';\r\nimport {HistoryStateModel} from 'app/model/HistoryStateModel';\r\n\r\nimport {Debugbase} from 'debugbase/Debugbase';\r\nimport {Size} from 'debugbase/helper/MathHelper';\r\n\r\n//import * as PIXI from 'pixi.js';\r\n\r\nexport class BackgroundController extends Controller {\r\n\t\r\n\tprivate _mouseController: MouseController;\r\n\r\n\tprivate _$pixi: PIXI.Application;\t\t\t\t\t\t\t\t\t\t\t\t//PIXI app \r\n\tprivate _$pixiBGContainer: PIXI.Container;\t\t\t\t\t\t\t\t\t\t//Main container that holds all background tiles\r\n\tprivate _spritesheet: PIXI.Spritesheet;\t\t\t\t\t\t\t\t\r\n\r\n\tprivate _$backgrounds: Array <FullScreenPixiSprite> = [];\t\t\t\t\t\t//Self sizing. Essentially a best fit to ensure full screen\r\n\tprivate _activeBackgroundSet: BackgroundSetType = BackgroundSetType.HOME;\t\t//What background is currently active \r\n\r\n\tprivate _totalXScroll: number;\t\t\t//Max that can be scrolled when panning left and right (to allow full movement)\r\n\tprivate _totalYScroll: number;\t\t\t//Max the backgrounds can be animated up and down \r\n\t\r\n\t//Timelines to help create the colour tweens on the backgrounds: \r\n\tprivate _homeTimeline: gsap.TimelineMax;\r\n\tprivate _screensTimeline: gsap.TimelineMax;\r\n\tprivate _spacesTimeline: gsap.TimelineMax;\t\r\n\tprivate _activeTimeline: gsap.TimelineMax;\r\n\r\n\tprivate _ratio: number;\r\n\tprivate _y: number = 0;\r\n\tprivate _tweening: boolean = false;\r\n\r\n\t//Parallax tracking\r\n\tprivate _mouseOffsets: any = {x: 0, y: 0};\r\n\tprivate _mouseOffsetTargets: any = {x: 0, y: 0};\r\n\tprivate _mouseRatios: any = {x: 0, y: 0};\r\n\tprivate _parallaxPowerMouse: number = 0.02;\r\n\tprivate _innerWidth: number;\r\n\tprivate _innerHeight: number;\r\n\r\n\tprivate _parallaxEasePower: number = 8;\r\n\tprivate _parallaxTargetValue: number = 8;\r\n\tprivate _parallaxStartValue: number = 60;\r\n\tprivate _parallaxTickDecrease: number = 1;\r\n\r\n\t//Set Pixi dependcies \r\n\tconstructor(id: string) {\r\n\t\tsuper(id);\r\n\t\tthis.resize();\r\n\t}\r\n\r\n\tpublic setPixi($pixi: PIXI.Application, $bgContainer: PIXI.Container): void {\r\n\t\tthis._$pixi = $pixi;\r\n\t\tthis._$pixiBGContainer = $bgContainer;\r\n\t}\r\n\r\n\t/**Set set Containers */\r\n\tpublic setControllers(mouse: MouseController): void {\r\n\t\tthis._mouseController = mouse;\r\n\t}\r\n\r\n\t//Resize event, update all the background sizes to be full screen:\r\n\tpublic resize(): void {\r\n\r\n\t\tthis._innerWidth = window.innerWidth;\r\n\t\tthis._innerHeight = window.innerHeight;\r\n\r\n\t\tif (this._$backgrounds.length === 0) {\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tthis._$backgrounds.forEach((backgroundSprite: FullScreenPixiSprite) => {\r\n\t\t\tbackgroundSprite.resize(this._innerWidth , this._innerHeight );\r\n\t\t});\r\n\r\n\t\tthis._repositionBackgrounds(this._innerWidth , this._innerHeight );\r\n\r\n\t\tif (!this._tweening) {\r\n\t\t\tthis._y = (this._y !== 0) ?  -1 * window.innerHeight : 0;\r\n\t\t\tthis._$pixiBGContainer.y = this._y;\r\n\t\t}\r\n\r\n\t}\r\n\r\n\t//Pixi has loaded the backgrounds: \r\n\t//TODO - maybe don't just blanket load all backgrounds (Depding on sprite / home design / etc)\r\n\tpublic pixiBackgroundsLoaded(spriteSheet:  PIXI.Spritesheet): void {\r\n\t\tthis._spritesheet = spriteSheet;\r\n\t\tthis.backgroundSetLoaded(BackgroundSetType.HOME);\r\n\t\tthis.backgroundSetLoaded(BackgroundSetType.SCREENS);\r\n\t\tthis.backgroundSetLoaded(BackgroundSetType.SPACES);\r\n\t}\r\n\r\n\t//Background set is fully loaded so can now go ahead and generate the sprites and animation timelines: \r\n\tpublic backgroundSetLoaded(set: BackgroundSetType): void {\r\n\t\t\r\n\t\tif (set === BackgroundSetType.HOME) {\r\n\t\t\tthis._createHomeStructure(); \r\n\t\t} else if (set === BackgroundSetType.SCREENS) {\r\n\t\t\tthis._createWorkStructure(DepartmentType.SCREENS); \r\n\t\t}  else if (set === BackgroundSetType.SPACES) {\r\n\t\t\tthis._createWorkStructure(DepartmentType.SPACES); \r\n\t\t} \r\n\r\n\t\tthis._createBackgroundTimeline(set);\r\n\r\n\t\t//Trigger resize to fix sizing: \r\n\t\tthis.resize();\r\n\r\n\t\t//Set the max amount that the background will be allowed to scroll: \r\n\t\tthis._setTotalSrollValues();\r\n\t\tthis.setXProgress(0.5);\r\n\r\n\t}\r\n\r\n\t//Set X progress \r\n\tpublic setXProgress(ratio: number): void {\r\n\r\n\t\tif (!this._tweening) {\r\n\t\t\tthis._$pixiBGContainer.x =  (-1 * (this._totalXScroll * ratio)) + this._mouseOffsets.x;\r\n\t\t\tthis._$pixiBGContainer.y =  this._y + this._mouseOffsets.y;\r\n\t\t\tthis._ratio = ratio;\r\n\t\t}\r\n\t\t\r\n\t\tif ( this._activeTimeline) {\r\n\t\t\tthis._activeTimeline.progress(this.math.constrain(ratio, 0, 1));\r\n\t\t}\r\n\r\n\t}\r\n\r\n\tpublic tick(): void {\r\n\t\t//If not tweening on tranition then do parallax logic: \r\n\t\tif (!this._tweening) {\r\n\t\t\tthis._updateParallaxOffset(this._mouseController.getMouseCords());\r\n\t\t}\r\n\t}\r\n\r\n\t/** \r\n\t* Animate to the Work section \r\n\t* @param {DepartmentType} - Screens or spaces type.\r\n\t*/\r\n\tpublic animateToWork(department: DepartmentType): void {\r\n\r\n\t\tlet x: number = (department === DepartmentType.SCREENS) ? 0 :  -1 * (this._totalXScroll * this._ratio);\r\n\t\tx = 0;\r\n\t\tthis._tweening = true;\r\n\t\tthis._resetParallax();\r\n\t\tthis._y = -1 * window.innerHeight; \r\n\t\tgsap.TweenMax.to(this._$pixiBGContainer, 2, {\r\n\t\t\ty: this._y, \r\n\t\t\tx: x,\r\n\t\t\tease: gsap.Power3.easeInOut,\r\n\t\t\tonComplete: () => this._startParallax(),\r\n\t\t});\r\n\r\n\t\tthis._activeTimeline = (department === DepartmentType.SCREENS) ? this._screensTimeline : this._spacesTimeline;\r\n\t}\r\n\r\n\t/** \r\n\t* Animate to the Work section\r\n\t* @param {DepartmentType} - Screens or spaces type.\r\n\t*/\r\n\tpublic animateToHome(department: DepartmentType): void {\r\n\r\n\t\tlet x: number = (department === DepartmentType.SCREENS) ? 0 :  -1 * (this._totalXScroll * this._ratio);\r\n\t\tthis._y = 0;\r\n\t\tthis._tweening = true;\r\n\t\tthis._resetParallax();\r\n\t\tgsap.TweenMax.to(this._$pixiBGContainer, 2, {\r\n\t\t\ty: this._y, \r\n\t\t\tx: x,\r\n\t\t\tease: gsap.Power3.easeInOut,\r\n\t\t\tonComplete: () => this._startParallax()\r\n\t\t});\r\n\r\n\t\tthis._activeTimeline = this._homeTimeline;\r\n\r\n\t}\r\n\r\n\t/** Set tweening to stop updates */\r\n\tpublic setTweening(tweening: boolean): void {\r\n\t\tthis._tweening = tweening;\r\n\t}\r\n\r\n\t/** Start the parallax tween in (to stop harsh quick starts after transitions) */\r\n\tpublic startParallaxEaseIn(): void {\r\n\t\tthis._startParallax();\r\n\t}\r\n\r\n\t/** Reset to state */\r\n\tpublic reset(state: HistoryStateModel = null): void  {\r\n\r\n\t\tthis._tweening = false;\r\n\t\tthis._resetParallax();\r\n\r\n\t\tif (state.section === SectionType.HOME) {\r\n\t\t\tthis._ratio = 0.5;\r\n\t\t\tthis._y = 0; \r\n\t\t\tthis._activeTimeline = this._homeTimeline;\r\n\t\t}\r\n\r\n\t\tif (state.section === SectionType.WORK) {\r\n\t\t\tthis._ratio = (state.subsection === DepartmentType.SCREENS) ? 0 : 1;\r\n\t\t\tthis._y = -1 * window.innerHeight;\r\n\t\t\tthis._activeTimeline = (state.subsection === DepartmentType.SCREENS) ? this._screensTimeline : this._spacesTimeline;\r\n\t\t}\r\n\r\n\t\t//Set the position of PIXI container\r\n\t\tlet x: number = -1 * (this._totalXScroll * this._ratio);\r\n\t\tgsap.TweenMax.set(this._$pixiBGContainer, {y: this._y, x: x});\r\n\r\n\t\t//Set the timeline to correct position( Which handle colour tweening):\r\n\t\tif ( this._activeTimeline  ) {\r\n\t\t\tthis._activeTimeline.progress(this._ratio);\r\n\t\t}\r\n\r\n\r\n\t}\r\n\r\n\t//Private \r\n\t//--------------------------------------------------------------------------------------------\r\n\t//--------------------------------------------------------------------------------------------\r\n\t//--------------------------------------------------------------------------------------------\r\n\t//--------------------------------------------------------------------------------------------\r\n\r\n\t//Create the top level for screens <> home <> spaces\r\n\tprivate _createHomeStructure(): void {\r\n\t\t\r\n\t\t//Add left 'screens' tile \r\n\t\tlet screens = new FullScreenPixiSprite(this._$pixiBGContainer, this._spritesheet.textures['screens-bg.jpg']);\r\n\t\tscreens.setType = BackgroundSetType.HOME;\r\n\t\tscreens.id = 'home-screens';\r\n\t\tthis._$backgrounds.push(screens);\r\n\r\n\t\t//Add right screens side (Flip so can be tiled)\r\n\t\tlet spaces = new FullScreenPixiSprite(this._$pixiBGContainer, this._spritesheet.textures['screens-bg.jpg'], true);\r\n\t\tspaces.setType = BackgroundSetType.HOME;\r\n\t\tspaces.id = 'home-spaces';\r\n\t\t//spaces.getSprite().alpha = 0;\r\n\t\tthis._$backgrounds.push(spaces);\r\n\r\n\t}\r\n\r\n\t//Create the work structure for the work carosuel: \r\n\tprivate _createWorkStructure(department: DepartmentType): void {\r\n\t\t\r\n\t\tif (department ===  DepartmentType.SCREENS) {\r\n\t\t\t\r\n\t\t\t//Add left 'screens' tile \r\n\t\t\tlet left = new FullScreenPixiSprite(this._$pixiBGContainer, this._spritesheet.textures['screens-bg.jpg'], false, true);\r\n\t\t\tleft.setType = BackgroundSetType.SCREENS;\r\n\t\t\tleft.id = 'screens-left';\r\n\t\t\t//eft.getSprite().alpha = 0;\r\n\t\t\tthis._$backgrounds.push(left);\r\n\r\n\t\t\t//Add right screens side (Flip so can be tiled)\r\n\t\t\tlet right = new FullScreenPixiSprite(this._$pixiBGContainer,  this._spritesheet.textures['screens-bg.jpg'], true, true);\r\n\t\t\tright.setType = BackgroundSetType.SCREENS;\r\n\t\t\tright.id = 'screens-right';\r\n\t\t\t//right.getSprite().alpha = 0;\r\n\t\t\tthis._$backgrounds.push(right);\r\n\r\n\t\t} else if (department ===  DepartmentType.SPACES) {\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\t//Reposition backgrounds \r\n\tprivate _repositionBackgrounds(innerWidth: number, innerHeight: number): void {\r\n\r\n\t\t//HOME ---------------------------------------------------------------------------------------\r\n\t\tlet homeScreensBG: FullScreenPixiSprite = this._getBackgroundById('home-screens');\r\n\r\n\t\tif (homeScreensBG) {\r\n\t\t\t//Postion home screen at center of innerWidth / height \r\n\t\t\thomeScreensBG.setPosition(innerWidth / 2, innerHeight / 2);\r\n\r\n\t\t\t//Postion home so it's tiled with \r\n\t\t\tlet homeSpacesBG: FullScreenPixiSprite = this._getBackgroundById('home-spaces');\r\n\t\t\thomeSpacesBG.setPosition((innerWidth / 2) + homeScreensBG.getSize().width, innerHeight / 2);\r\n\t\t}\r\n\r\n\t\t//SCREENS  ------------------------------------------------------------------------------------\r\n\t\tlet screensLeftBG: FullScreenPixiSprite = this._getBackgroundById('screens-left');\r\n\r\n\t\tif (screensLeftBG) {\r\n\t\t\t\r\n\t\t\t//Postion screens left under the home BG\r\n\t\t\t//This is so it can animated down to on transition to work section:  \r\n\t\t\tlet screenX: number = innerWidth / 2;\r\n\t\t\tlet screenY: number = (innerHeight / 2) + homeScreensBG.getSize().height;\r\n\t\t\tscreensLeftBG.setPosition(screenX,  screenY);\r\n\r\n\t\t\t//Postion 2nd image so it's tiled: \r\n\t\t\tlet screensRighttBG: FullScreenPixiSprite = this._getBackgroundById('screens-right');\r\n\t\t\tscreensRighttBG.setPosition(screenX + homeScreensBG.getSize().width, screenY);\r\n\r\n\t\t\t//Tiles below to fi\r\n\r\n\t\t}\r\n\r\n\t\t//SPACES  ----------------------------------------------------------------------------------------\r\n\r\n\t}\r\n\r\n\t//Set the amount that can be scrolled to\r\n\tprivate _setTotalSrollValues(): void {\r\n\r\n\t\tif (this._activeBackgroundSet === BackgroundSetType.HOME) {\r\n\r\n\t\t\t//Home max scroll is the position of the right tile + the \r\n\t\t\tlet homeSpacesBG: FullScreenPixiSprite  = this._getBackgroundById('home-spaces');\r\n\t\t\tthis._totalXScroll = homeSpacesBG.getSprite().x - (homeSpacesBG.getSize().width / 2);\r\n\r\n\t\t} else if (this._activeBackgroundSet === BackgroundSetType.SCREENS) {\r\n\r\n\t\t\t//Home max scroll is the position of the right tile + the \r\n\t\t\tlet rightBG: FullScreenPixiSprite  = this._getBackgroundById('screens-right');\r\n\t\t\tthis._totalXScroll = rightBG.getSprite().x + (rightBG.getSize().width / 2);\r\n\r\n\t\t} else if (this._activeBackgroundSet === BackgroundSetType.SPACES) {\r\n\r\n\t\t} \r\n\r\n\t}\t\r\n\r\n\t//Create work bacground timeline (To colour the sprite, only really viable with TweenMax)\r\n\t//TODO: actual colours/times needs to be dyanmic based on tile settings \r\n\tprivate _createBackgroundTimeline(set: BackgroundSetType): void {\r\n\r\n\t\tif (set ===  BackgroundSetType.HOME) {\r\n\r\n\t\t\tthis._homeTimeline = new gsap.TimelineMax();\r\n\t\t\tthis._homeTimeline.pause();\r\n\t\t\t//let backgrounds: Array <PIXI.Sprite> = this._getBackgroundSpitesByType(BackgroundSetType.HOME);\r\n\t\t\tlet backgrounds = this._$pixiBGContainer;\r\n\r\n\t\t\t//this._homeTimeline\r\n\t\t\t\t//.set(backgrounds, {pixi: {colorMatrixFilter: null, ease: gsap.Power0.easeNone}}, 0)\t\t\t\t\t\t\t\t//Reset for base image \r\n\t\t\t\t//.to(backgrounds, 0.2, {pixi: {colorize: 0x333333 , colorizeAmount: 0.7, ease: gsap.Power0.easeNone}}, 0.3)\t\t//Dark grey for landing\r\n\t\t\t\t//.set(backgrounds, {pixi: {colorize: 0x333333 , colorizeAmount: 0.7, ease: gsap.Power0.easeNone}}, 0.5)\t\t//Dark grey for landing\r\n\t\t\t\t//.to(backgrounds, 0.3, {pixi: {colorize: 0x0ca0ad , colorizeAmount: 1, ease: gsap.Power0.easeNone}}, 0.7)\t\t//Green\r\n\t\t\t\t//.set(backgrounds, {pixi: { alpha: 1} }, 1);\r\n\r\n\t\t\tthis._activeTimeline = this._homeTimeline;\r\n\r\n\t\t} else  if (set ===  BackgroundSetType.SCREENS) {\r\n\t\t\t\r\n\t\t\tthis._screensTimeline = new gsap.TimelineMax();\r\n\t\t\tthis._screensTimeline.pause();\r\n\r\n\t\t\t//let backgrounds: Array <PIXI.Sprite> = this._getBackgroundSpitesByType(BackgroundSetType.SCREENS);\r\n\t\t\tlet backgrounds = this._$pixiBGContainer;\r\n\r\n\t\t\tthis._screensTimeline\r\n\t\t\t\t.from(backgrounds, 0.2, {pixi: {colorMatrixFilter: null}, ease: gsap.Power0.easeNone}, 0)\t\t\t\t\t//Reset to base \r\n\t\t\t\t.to(backgrounds, 0.2, {pixi: {colorize: 0x00c0ff , colorizeAmount: 0.5, ease: gsap.Power0.easeNone}}, 0.4)\t//Toytown blue\r\n\t\t\t\t.to(backgrounds, 0.2, {pixi: {colorize: 0xff0000 , colorizeAmount: 0.5, ease: gsap.Power0.easeNone}}, 0.6)\t//Market masters red\r\n\t\t\t\t.to(backgrounds, 0.2, {pixi: {colorize: null , colorizeAmount: 0.5, ease: gsap.Power0.easeNone}}, 0.8)\t\t//Reset to base \r\n\t\t\t\t.set(backgrounds, {pixi: { alpha: 1} }, 1);\r\n\r\n\t\t} else if (set ===  BackgroundSetType.SPACES) {\r\n\t\t\t\r\n\t\t\tthis._spacesTimeline = new gsap.TimelineMax();\r\n\t\t\tthis._spacesTimeline.pause();\r\n\t\t\t//let backgrounds: Array <PIXI.Sprite> = this._getBackgroundSpitesByType(BackgroundSetType.SPACES);\r\n\t\t\tlet backgrounds = this._$pixiBGContainer;\r\n\r\n\t\t\tthis._spacesTimeline\r\n\t\t\t\t.set(backgrounds, {pixi: {colorize: 0x0ca0ad, colorizeAmount: 0.6}}, 0)\t\t\t\t\t\r\n\t\t\t\t.to(backgrounds, 1, {pixi: {colorize: 0x077ebc , colorizeAmount: 0.6}, ease: gsap.Power0.easeNone}, 0)\t\t//Reset to base \r\n\t\t\t\t.set(backgrounds, {pixi: { alpha: 1} }, 1);\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\t//Get all sprites on a background set so they can be tweened with TweenMax\r\n\tprivate _getBackgroundSpitesByType(setType: BackgroundSetType): Array<PIXI.Sprite> {\r\n\r\n\t\tlet backgrounds: Array <PIXI.Sprite> = [];\r\n\t\tfor (var i = 0; i < this._$backgrounds.length; i++) {\r\n\t\t\tif (this._$backgrounds[i].setType === setType) {\r\n\t\t\t\tbackgrounds.push(this._$backgrounds[i].getSprite());\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\treturn backgrounds;\r\n\r\n\t}\t\r\n\r\n\tprivate _getBackgroundById(id: string): FullScreenPixiSprite {\r\n\r\n\t\tfor (var i = 0; i < this._$backgrounds.length; i++) {\r\n\t\t\tif (this._$backgrounds[i].id === id) {\r\n\t\t\t\treturn this._$backgrounds[i];\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\treturn null;\r\n\r\n\t}\t\r\n\r\n\t/**Update the parallax due to mouse OR mobile device acceleromater */\r\n\tprivate _updateParallaxOffset(mouseCords: any): void {\r\n\r\n\t\t//Movement is slowed after animations to stop harsh jumps to mouse position\r\n\t\tthis._setParallaxRate();\r\n\r\n\t\t//X:\r\n\t\tthis._mouseRatios.x = (mouseCords.x / this._innerHeight) - 0.5 ;\r\n\t\tthis._mouseOffsetTargets.x = -1 * (this._mouseRatios.x * (this._innerHeight * this._parallaxPowerMouse));\r\n\t\tthis._mouseOffsets.x = this._mouseOffsets.x + ((this._mouseOffsetTargets.x  -  this._mouseOffsets.x ) / this._parallaxEasePower  );\r\n\r\n\t\t//Y: \r\n\t\tthis._mouseRatios.y = (mouseCords.y / this._innerWidth) - 0.5 ;\r\n\t\tthis._mouseOffsetTargets.y = -1 * (this._mouseRatios.y * (this._innerHeight * this._parallaxPowerMouse ));\r\n\t\tthis._mouseOffsets.y = this._mouseOffsets.y + ((this._mouseOffsetTargets.y  - this._mouseOffsets.y ) / this._parallaxEasePower  );\r\n\r\n\t} \r\n\r\n\t/** Start parallax working */\r\n\tprivate _startParallax(): void {\r\n\t\tthis._tweening = false;\r\n\t\tthis._parallaxEasePower = this._parallaxStartValue;\r\n\t}\r\n\r\n\t/** Set the rate of movement. Stop harsh start at begining */\r\n\tprivate _setParallaxRate(): void {\r\n\t\tif (this._parallaxEasePower > this. _parallaxTargetValue) {\r\n\t\t\tthis._parallaxEasePower -= this._parallaxTickDecrease;\r\n\t\t}\r\n\t}\r\n\r\n\t/** Reset parallax */\r\n\tprivate _resetParallax(): void {\r\n\t\tthis._mouseRatios.x = this._mouseRatios.y = 0; \r\n\t\tthis._mouseOffsetTargets.x = this._mouseOffsetTargets.y = 0; \r\n\t\tthis._mouseOffsets.x = this._mouseOffsets.y = 0; \r\n\t}\r\n\t\t\t\r\n}\r\n\r\nexport class FullScreenPixiSprite {\r\n\r\n\tpublic setType: BackgroundSetType; \r\n\tpublic id: string; \r\n\r\n\tprivate _$pixiBGContainer: PIXI.Container;\r\n\tprivate _$sprite: PIXI.Sprite;\r\n\tprivate _scale: number;\r\n\tprivate _flipX: number = 1;\r\n\tprivate _flipY: number = 1;\r\n\r\n\tconstructor($bgContainer: PIXI.Container, texture: PIXI.Texture, flipX: boolean = false,  flipY: boolean = false, ) {\r\n\t\tthis._$pixiBGContainer = $bgContainer;\r\n\t\tthis._flipX = (flipX) ? -1 : 1;\r\n\t\tthis._flipY = (flipY) ? -1 : 1;\r\n\t\tthis._createSprite(texture);\r\n\t}\r\n\r\n\tpublic getSprite(): PIXI.Sprite {\r\n\t\treturn this._$sprite;\r\n\t}\r\n\r\n\t//Set the poistion of the sprite inside the big container: \r\n\tpublic setPosition(x: number, y: number): void {\r\n\t\tthis._$sprite.position.set(x, y);\r\n\t}\r\n\r\n\t//Return back a width/height object in px so surrounding backgrounds can be positoned relative: \r\n\tpublic getSize(): Size {\r\n\t\treturn {\r\n\t\t\twidth: this._$sprite.texture.width * this._scale,\r\n\t\t\theight: this._$sprite.texture.height * this._scale\r\n\t\t};\r\n\t}\r\n\r\n\t//Resize the sprite so it scales to be 100% \r\n\t//Note does't mask as needs to tile (Does it - depends on final design ???)\r\n\tpublic resize(innerWidth: number, innerHeight: number): void {\r\n\t\t\r\n\t\t//Work out best scale to use to display the background full screen: \r\n\t\tthis._scale = Debugbase.math.getBestFitScale(\r\n\t\t\t{width: this._$sprite.texture.width,  height: this._$sprite.texture.height},\r\n\t\t\t{width: innerWidth, height: innerHeight}\r\n\t\t);\r\n\r\n\t\t//Set the scale of the sprite: \r\n\t\tthis._$sprite.scale.set(this._scale * this._flipX, this._scale * this._flipY);\r\n\r\n\t}\r\n\r\n\t//Private \r\n\t//--------------------------------------------------------------------------------------------\r\n\t//--------------------------------------------------------------------------------------------\r\n\t//--------------------------------------------------------------------------------------------\r\n\t//--------------------------------------------------------------------------------------------\r\n\r\n\t//Create and add the sprite to the stage \r\n\tprivate _createSprite(texture: PIXI.Texture): void {\r\n\t\tthis._$sprite = new PIXI.Sprite(texture);\r\n\t\tthis._$sprite.interactive = false;\r\n\t\tthis._$sprite.anchor.x  = 0.5;\r\n\t\tthis._$sprite.anchor.y  = 0.5;\r\n\t\tthis._$pixiBGContainer.addChild(this._$sprite);\r\n\t}\r\n\t\r\n}\r\n","import {Controller} from 'debugbase/abstract/Controller';\r\nimport {Events} from 'debugbase/events/Events';\r\nimport {AppEvents} from 'app/data/AppEvents';\r\nimport {SectionType} from 'app/data/Enums';\r\nimport {HistoryStateModel} from 'app/model/HistoryStateModel';\r\n/** @class Controller to manage history state elements  */\r\nexport class HistoryController extends Controller {\r\n\r\n\tprivate _currentState: HistoryStateModel;\t\t//The current state of the website \r\n\tprivate _initalState: HistoryStateModel;\t\t//The intial state webite for the page that loads directly \r\n\r\n\t/** As a global controller init will be called on load. So set the intial state. Used when back takes to intial page  website */\r\n\tpublic init(): void {\r\n\t\t//Add listener for popstate: \r\n\t\twindow.onpopstate = this._onPop.bind(this);\r\n\t}\r\n\r\n\t/**\r\n\t * Set intial state loadup. Comes from View controller init > event as  logic for working out where loaded is bit tricky to make fully modular \r\n\t * @param {HistoryStateModel} stateObject - State object to rebuild the view from \r\n\t */\r\n\t public setIntialState(stateObject: HistoryStateModel): void {\r\n\t\tthis._initalState = stateObject;\r\n\t}\r\n\r\n\t/** \r\n\t * Add a history state in (Because of section change event)\r\n\t * @param {HistoryStateModel} stateObject - State object to rebuild the view from \r\n\t * @param {string} title - Title of the page. \r\n\t * @param {string} string - new page url to switch to.\r\n\t*/\r\n\tpublic push(stateObject: HistoryStateModel, title: string, url: string): void {\r\n\t\t\r\n\t\twindow.history.pushState(stateObject, this._getFullTitle(title), url);\r\n\t\tdocument.title = this._getFullTitle(title);\r\n\r\n\t\tif ( (window as any).ga ) {\r\n\t\t\t(window as any).ga('set', 'page', url);\r\n\t\t\t(window as any).ga('send', 'pageview');\r\n\t\t}\r\n\r\n\t}\r\n\r\n\t//PRIVATE \r\n\t//----------------------------------------------------------------------------------------------------------\r\n\t//----------------------------------------------------------------------------------------------------------\r\n\t//----------------------------------------------------------------------------------------------------------\r\n\t//----------------------------------------------------------------------------------------------------------\r\n\r\n\t/** User inicated back or forward navigation */ \r\n\tprivate _onPop(): void {\r\n\t\tthis._currentState = (window.history.state !== null) ? window.history.state : this._initalState;\r\n\t\tEvents.dispatch(AppEvents.POP_HISTORY_STATE, this._currentState);\r\n\t}\r\n\r\n\t/** Get full combined title */ \r\n\tprivate _getFullTitle(post: string): string {\r\n\t\treturn `${post} | Debug Digital`;\r\n\t}\r\n\r\n}\r\n","import {GA} from 'debugbase/tracking/GA';\r\nimport { Controller } from 'debugbase/abstract/Controller';\r\nimport { SectionType, DepartmentType, ViewType, DirectionalKeyType } from 'app/data/Enums';\r\nimport { DragBreakpoints, axisType} from 'debugbase/util/DragBreakpoints';\r\nimport { Events } from 'debugbase/events/Events';\r\nimport { DOMHelper } from 'debugbase/helper/DOMHelper';\r\nimport { CoreEvents } from 'debugbase/events/CoreEvents';\r\nimport { AppEvents } from 'app/data/AppEvents';\r\n\r\nimport { HomeTimelineMain } from './home/HomeTimelineMain';\r\nimport { HomeMoth } from './home/HomeMoth';\r\n\r\nimport {MouseController} from 'app/controller/MouseController';\r\nimport {BackgroundController} from 'app/controller/BackgroundController';\r\nimport {PixiController} from 'app/controller/PixiController';\r\n\r\nimport {Paging} from 'app/module/global/Paging';\r\n\r\nimport {HistoryStateModel} from 'app/model/HistoryStateModel';\r\nimport {HomeJSONModel} from 'app/model/HomeJSONModel';\r\n\r\nimport {ViewReadyEvent} from 'app/event/ViewReadyEvent';\r\nimport {HomeDepartmentReachedEvent} from 'app/event/HomeDepartmentReachedEvent';\r\nimport {DebugMouseWheelEvent} from 'app/event/DebugMouseWheelEvent';\r\nimport {DebugKeypressEvent} from 'app/event/DebugKeypressEvent';\r\n\r\nimport {Point} from 'app/contracts/Geometry';\r\n\r\nimport {TextScramble}  from 'app/module/home/homeUtil/TextScramble';\r\n//import { TimelineMax, TweenMax, Power0, Power3, Back } from 'gsap';\r\n\r\n//import * as PIXI from 'pixi.js';\r\n\r\nexport class HomeController extends Controller {\r\n\r\n\tprivate _state: HistoryStateModel;\r\n\tprivate _oldState: HistoryStateModel;\r\n\tprivate _active: boolean = false; \t\t\t\t//Is interative / active\r\n\tprivate _readyToSetup: boolean = false;\t\t\t//Is ready to view. So can be setup for viewing oif required\r\n\tprivate _isSetup: boolean = false;\t\t\t\t//Is setup up ready to view\r\n\tprivate _yScrollActive: boolean = false;\r\n\tprivate _resetAndShowQued: boolean = false;\r\n\r\n\tprivate _mainTimeline: HomeTimelineMain;\r\n\tprivate _moth: HomeMoth; \r\n\r\n\tprivate _mainBreakpoints: DragBreakpoints;\r\n\tprivate _breakpointIndex: number = 1;\r\n\tprivate _progressX: number = 0.5;\r\n\r\n\tprivate _mouseController: MouseController;\r\n\tprivate _backgroundController: BackgroundController;\r\n\tprivate _pixiController: PixiController;\r\n\r\n\tprivate _paging: Paging;\r\n\r\n\tprivate _textScrable: TextScramble;\r\n\tprivate _buttonScrable: TextScramble;\r\n\r\n\t\r\n\r\n\tprivate _$logoTitle: HTMLElement;\r\n\tprivate _$logoSubTitle: HTMLElement;\r\n\r\n\t//Pixi references for Fullscreen / rich elements: \r\n\tprivate _$pixi: PIXI.Application;\r\n\tprivate _$homeContainer: PIXI.Container;\r\n\tprivate _pixiSpritesheet: PIXI.Spritesheet;\r\n\tprivate _mothSpritesheet: PIXI.Spritesheet;\r\n\r\n\t//AJAX Loaded HTML/JSON\r\n\tprivate _html: string;\r\n\tprivate _json: HomeJSONModel;\r\n\tprivate _loadFlags: any = {pixi: false, moth: false, dom: false, json: false};\r\n\tprivate _queFlags: any = {screens: false, spaces: false};\r\n\tprivate _velocity: number = 0; \r\n\tprivate _frameProgress: number = 0;\r\n\r\n\tprivate _innerWidth: number;\r\n\tprivate _innerHeight: number;\r\n\tprivate _virtualWidth: number;\r\n\tprivate _timeouts: any = {};\r\n\tprivate _tweens: any = {};\r\n\tprivate _intervals: any = {};\r\n\r\n\t//Init is called when routed on /\r\n\tpublic init(): void {\r\n\t\t\r\n\t\tthis._active = true;\r\n\r\n\t\t//Set the opening state to the homepage: \r\n\t\tlet openingState: HistoryStateModel = {\r\n\t\t\tsection: SectionType.HOME,\r\n\t\t\ttitle: '',\r\n\t\t\thref: '/',\r\n\t\t};\r\n\t\tEvents.dispatch(AppEvents.SET_INTIAL_STATE, openingState);\r\n\r\n\t\tthis._textScrable = new TextScramble(document.querySelector('.home__action__text'), 10);\r\n\t\tthis.get('Preload').textScrable = this._textScrable;\r\n\r\n\t\tlet button = document.querySelector('.home__explore__area .home__action__button__wrapper');\r\n\t\tbutton.addEventListener('mouseover', (e) => {\r\n\r\n\t\t\tlet rect = (e.target as HTMLElement).parentElement.parentElement.getBoundingClientRect();\r\n\t\t\tlet center: Point = {x: rect.left + 50, y: rect.top + 80};\r\n\t\t\tthis._mainTimeline.setButtonHover(center);\r\n\t\t\tthis._mouseController.setHiddenState(true);\r\n\t\t});\r\n\r\n\t\tbutton.addEventListener('mouseout', () => {\r\n\r\n\t\t\tthis._mainTimeline.setButtonOut(DepartmentType.SCREENS);\r\n\t\t\tthis._mouseController.setHiddenState(false);\r\n\t\t});\r\n\r\n\t\tbutton = document.querySelector('.home__explore__area .home__action__button__wrapper.-spaces');\r\n\t\tbutton.addEventListener('mouseover', (e) => {\r\n\t\t\tlet rect = (e.target as HTMLElement).parentElement.parentElement.getBoundingClientRect();\r\n\t\t\tlet center: Point = {x: rect.left + 50, y: rect.top + 80};\r\n\t\t\tthis._mainTimeline.setButtonHover(center);\r\n\t\t\tthis._mouseController.setHiddenState(true);\r\n\t\t});\r\n\r\n\t\tbutton.addEventListener('mouseout', () => {\r\n\t\t\tthis._mainTimeline.setButtonOut(DepartmentType.SPACES);\r\n\t\t\tthis._mouseController.setHiddenState(false);\r\n\t\t});\r\n\r\n\t\t\r\n\r\n\t}\r\n\r\n\t//Getters ---------------------------------------------------------------------\r\n\r\n\t/** Get is section / controller is active */\r\n\tpublic isActive(): boolean {\r\n\t\treturn this._active;\r\n\t}\r\n\r\n\t/** Get if ready to setup for view */ \r\n\tpublic isReadyToSetup(): boolean {\r\n\t\treturn this._readyToSetup;\r\n\t}\r\n\r\n\t/** Check is ready to view. Really needs to check is 'ready to setup' */ \r\n\tpublic isReadyToView(stateObject: HistoryStateModel): boolean {\r\n\t\treturn this.isReadyToSetup();\r\n\t}\r\n\r\n\tpublic readyForDeeplink(): boolean {\r\n\t\t//If this function is being called then process is checking if it can show \r\n\t\t//So if its ready to setup but not actually been created then can setup here\r\n\t\tif (this._readyToSetup && !this._isSetup) {\r\n\t\t\tthis._setup();\r\n\t\t}\r\n\r\n\t\treturn (this._readyToSetup && this._isSetup);\r\n\t}\r\n\r\n\t//Setters-----------------------------------------------------------------------\r\n\r\n\t//Set controller depencies (set from app controller): \r\n\tpublic setControllers(mouse: MouseController, background: BackgroundController, pixi: PixiController): void {\r\n\t\t//Set references to required controllers: \r\n\t\tthis._mouseController = mouse;\r\n\t\tthis._backgroundController = background;\r\n\t\tthis._pixiController = pixi;\r\n\t}\r\n\r\n\t//Pixi dependecy (set in AppController): \r\n\tpublic setPixi($pixi: PIXI.Application, $homeContainer: PIXI.Container): void {\r\n\t\tthis._$pixi = $pixi;\r\n\t\tthis._$homeContainer = $homeContainer;\r\n\t}\r\n\r\n\t/** History state has been changed by / back forward */\r\n\tpublic setState(state: HistoryStateModel): void {\r\n\t\tthis._state = state;\r\n\t}\r\n\r\n\t/** \r\n\t/* HTML has loaded from external, so set as requried:\r\n\t* @param {string} html -  raw ajax loaded HTML \r\n\t*/\r\n\tpublic setHTML(html: string): void {\r\n\t\tthis._html = html;\r\n\t\tthis._loadFlags.dom = true;\r\n\t\tthis._testReadyToSetup();\r\n\t}\r\n\r\n\t/** \r\n\t/* JSON config has loaded so set:\r\n\t* @param {HomeJSONModel} json -  JSON data for home view \r\n\t*/\r\n\tpublic setJSON(json: HomeJSONModel): void {\r\n\t\tthis._json = json;\r\n\t\tthis._setVirtualWidth();\r\n\t\tthis._loadFlags.json = true;\r\n\t\tthis._testReadyToSetup();\r\n\t}\r\n\r\n\t//Public-------------------------------------------------------------------------\r\n\r\n\t/** Reset is always called before showing to put in correct state. Seperate from 'show' as a deplay might be needed between the 2 */\r\n\tpublic reset(oldState: HistoryStateModel = null, isDeeplink: boolean = false): void {\r\n\r\n\t\tthis._oldState = oldState;\r\n\r\n\t\t//If not setup then do \r\n\t\tif (!this._isSetup) {\r\n\t\t\tthis._setup();\r\n\t\t\tthis._resetAndShowQued = true;\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\t//0.) Generic across all types of show: \r\n\t\tthis._resetIntervalsAndAnimations();\r\n\r\n\t\tthis._mouseController.setColour('light');\r\n\r\n\t\tthis._$homeContainer.visible = true;\r\n\r\n\t\tif (this.container) {\r\n\t\t\tthis.DOM.addClass(this.container, '-active');\r\n\t\t\tgsap.TweenMax.set([this.container, document.querySelector('canvas')], {autoAlpha: 1, scale: 1});\r\n\t\t}\r\n\r\n\t\t//Is a deeplink for get ready to show coming direct from Preoader \r\n\t\tif (isDeeplink) {\r\n\t\t\tthis._resetForDeeplink();\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\t//If transition is coming back from screens / spaces section\r\n\t\tif (oldState.section === SectionType.WORK) {\r\n\t\t\tthis._resetFromWork(oldState.subsection as DepartmentType);\r\n\t\t}\r\n\r\n\t}\r\n\r\n\t/** Preloading is complete can be shown / activate dragging: */\r\n\tpublic show(oldState: HistoryStateModel = null, isDeeplink: boolean = false): void {\r\n\r\n\t\tif (!this.container) {\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tthis._pixiController.unpause();\r\n\r\n\t\tif (isDeeplink) {\r\n\t\t\tthis._showForDeeplink();\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tif (oldState.section === SectionType.WORK) {\r\n\t\t\tthis._showFromWork(oldState.subsection as DepartmentType);\r\n\t\t}\r\n\r\n\t}\r\n\r\n\t/** \r\n\t* Hide after section is moved away from. The new state is passed so can work out how to transition out \r\n\t* @param {HistoryStateModel} newState\r\n\t*/\r\n\tpublic hide(newState: HistoryStateModel = null): void {\r\n\t\tif (newState.section === SectionType.INFO) {\r\n\t\t\tthis._hideForInfo();\r\n\t\t} else if (newState.section === SectionType.WORK) {\r\n\t\t\tthis._hideForWork(newState.subsection as DepartmentType);\r\n\t\t} \r\n\t\tthis._active  = false;\r\n\t}\r\n\r\n\t/** Freeze for when transitions are being used */\r\n\tpublic freeze(): void {\r\n\t\tthis._active = false;\r\n\t\tthis._setInteractionEnabled(false);\r\n\t\tthis._resetIntervalsAndAnimations();\r\n\t\tthis._timeouts.freeze = setTimeout( () => this._cleanupAfterFreeze(), 500);\r\n\t}\r\n\r\n\t/** Pause (For when nav menu is showing) */\r\n\tpublic pause(): void {\r\n\t\tthis._setInteractionEnabled(false);\r\n\t\tgsap.TweenMax.to([this.container, document.querySelector('canvas')], 0.45, {scale: 1.2, ease: gsap.Power3.easeOut});\r\n\t}\r\n\r\n\t/** Unpause (For when nav menu is hidden) */\r\n\tpublic unpause(): void {\r\n\t\tthis._setInteractionEnabled(true);\r\n\t\tgsap.TweenMax.to([this.container, document.querySelector('canvas')], 0.45, {scale: 1, ease: gsap.Power3.easeOut});\r\n\t}\r\n\r\n\t/**  Modules are mounted to the DOM and ready to access */ \r\n\tpublic modulesMounted(): void {\r\n\t\tif (this._active) {\r\n\t\t\tthis._setupPaging();\r\n\t\t}\r\n\t}\r\n\r\n\tpublic pixiParticlesLoaded(spritesheet: PIXI.Spritesheet): void {\r\n\t\t\r\n\t\tthis._pixiSpritesheet = spritesheet;\r\n\t\tthis._loadFlags.pixi = true;\r\n\t\tthis._testReadyToSetup();\r\n\r\n\t\tif (this._readyToSetup && this._active) {\r\n\t\t\tthis._setup();\r\n\t\t}\r\n\r\n\t}\t\t\r\n\r\n\t\t/** The logo morpth sprite has loaded so create that animation setup */ \r\n\tpublic pixiMothLoaded(spritesheet: PIXI.Spritesheet): void {\r\n\t\tthis._mothSpritesheet = spritesheet;\r\n\t\tthis._loadFlags.moth = true;\r\n\t\tthis._testReadyToSetup();\r\n\r\n\t\tif (this._readyToSetup && this._active) {\r\n\t\t\tthis._setup();\r\n\t\t}\r\n\t}\r\n\r\n\t/** DOM has loaded / ready so flag and setup as required */\r\n\tpublic DOMReady(): void {\r\n\t\t//If active then on home view, so the html will already be on the page\r\n\t\t//Otherwise create container elements to load section to\r\n\t\tif (this._active) {\r\n\t\t\tthis._loadFlags.dom = true;\r\n\t\t\tthis._testReadyToSetup();\r\n\t\t\tthis._setup();\r\n\t\t} \r\n\t}\r\n\r\n\tpublic resize(): void {\r\n\r\n\t\tif (this._json) {\r\n\t\t\tthis._setVirtualWidth();\r\n\t\t}\r\n\r\n\t\tif (this._isSetup) {\r\n\t\t\tthis._mainTimeline.setVirtualWidth(this._virtualWidth);\r\n\t\t\tthis._mainBreakpoints.setVirtualWidth(this._virtualWidth);\r\n\t\t\tthis._$homeContainer.pivot.y = this._innerHeight / 2;\r\n\t\t\tthis._$homeContainer.y = this._innerHeight / 2;\r\n\t\t\t//this._moth.resize(this._virtualWidth, window.innerHeight);\r\n\t\t}\r\n\r\n\t}\r\n\r\n\tpublic tick(): void {\r\n\r\n\t\tif (!this._active || !this._isSetup) {\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tthis._checkWorkQueFlags();\r\n\t\tthis._processVelocity();\r\n\r\n\t\tthis._$homeContainer.scale.set(1.0 + (0.3 * Math.abs(this._velocity)), 1.0 + (0.3 * Math.abs(this._velocity)) );\r\n\r\n\t\tif (this._mainTimeline) {\r\n\t\t\t//this._moth.position\r\n\t\t \tthis._mainTimeline.tick(this._mouseController.getMouseCords(), this._mouseController.mouseIsDown(), this._velocity, false, false);\r\n\t\t}\r\n\r\n\t\t//if ( this._moth ) {\r\n\t\t\t//this._moth.tick(this._mouseController.getMouseCords(), this._mainTimeline.containerX, this._progressX);\r\n\t\t//}\r\n\r\n\t}\r\n\r\n\t//The logo morpth sprite has loaded so create that animation setup\r\n\t//public pixiLogoMorpthLoaded(spritesheet: PIXI.Spritesheet): void {\r\n\t//\tthis._mainTimeline.createLogoTimelinePixi(this._$homeContainer, spritesheet);\r\n\t//}\r\n\r\n\t/** \r\n\t* Animate x to progress to a point in time  \r\n\t* @param {number} index -  break point Index to animate to (0 Screens | 1 Home | 2 Spaces)\r\n\t*/\r\n\tpublic animateProgressToValue(index: number): void {\r\n\t\tthis._breakpointIndex = index;\r\n\t\tthis._mainBreakpoints.setIndex(index);\r\n\t}\r\n\r\n\t//** Stop the paging guide effect animation */\r\n\tpublic stopPagingGuide(): void {\r\n\t\tthis._paging.removeGuideEffect(1);\r\n\t}\r\n\r\n\tpublic setPagingIndex(index: number) {\r\n\t\tthis._breakpointIndex = index;\r\n\t\tthis._paging.setActiveIndex(index);\r\n\t}\r\n\r\n\r\n\t//private \r\n\t//----------------------------------------------------------------------\r\n\t//----------------------------------------------------------------------\r\n\t//----------------------------------------------------------------------\r\n\t//----------------------------------------------------------------------\r\n\r\n\t/** Work out the virtual container width of view. Used in timeline and drag logic */\r\n\tprivate _setVirtualWidth(): void {\r\n\r\n\t\tthis._innerWidth = window.innerWidth;\r\n\t\tthis._innerHeight = window.innerHeight;\r\n\r\n\t\tthis._virtualWidth = this._innerWidth * this._json.containerViewportsDesktop;\r\n\r\n\t\tif (this._innerWidth < 1000) {\r\n\t\t\tthis._virtualWidth = this._innerWidth * this._json.containerViewportsTablet;\r\n\t\t}\r\n\r\n\t\tif (this._innerWidth < 600) {\r\n\t\t\tthis._virtualWidth = this._innerWidth * this._json.containerViewportsMobile;\r\n\t\t}\r\n\r\n\t}\r\n\r\n\t/** Test that the view is ready to show */\r\n\tprivate _testReadyToSetup(): void {\r\n\t\t\r\n\t\tlet fireEvent = !this._readyToSetup;\r\n\t\tthis._readyToSetup =  (this._loadFlags.dom && this._loadFlags.pixi && this._loadFlags.moth && this._loadFlags.json);\r\n\t\t\t\r\n\t\t//If ready for first time flag this: \r\n\t\tif (fireEvent && this._readyToSetup) {\r\n\t\t\t//Trigger the VIEW_SETUP event, which can be picked up by any loading processes: \r\n\t\t\tEvents.dispatch(new ViewReadyEvent({\r\n\t\t\t\tview: ViewType.HOME\r\n\t\t\t}), {delay: 1});\r\n\t\t}\r\n\r\n\t}\r\n\r\n\t/** Check DOM / Pixi requirements are ready, if so can setup */\r\n\tprivate _setup(): void {\r\n\t\t\r\n\t\tif (!this._readyToSetup || this._isSetup) {\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\t//If page is not ready then get the \r\n\t\tif (!this.container) { \r\n\t\t\tthis.DOM.append(document.querySelector('body'), this._html, () => {\r\n\t\t\t\tthis.container = document.querySelector('.home');\r\n\t\t\t\tthis._setup();\r\n\t\t\t});\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tthis._setVirtualWidth();\r\n\t\tthis._setupPaging();\r\n\t\tthis._addEvents();\r\n\t\tthis._createTimelines();\r\n\t\tthis._createMoth();\r\n\t\tthis._createBreakpoints();\r\n\t\tthis._isSetup = true;\r\n\t\tthis.resize();\r\n\r\n\t\t//If reset and show qued then\r\n\t\tif (this._resetAndShowQued) {\r\n\t\t\tthis.reset(this._oldState, false);\r\n\t\t\tthis.show(this._oldState, false);\r\n\t\t\tthis._resetAndShowQued = false;\r\n\t\t}\r\n\r\n\t}\r\n\r\n\t/** Setup paging */\r\n\tprivate _setupPaging(): void {\r\n\r\n\t\t//If active then paging module is already auto crated on the page:\r\n\t\tif (this._active) {\r\n\t\t\tthis._paging = this.module.get('home-paging') as Paging;\r\n\t\t\tthis._paging.setCallbacks(this._pagingClick.bind(this));\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\t//Otherwise manually create:\r\n\t\tthis._paging = new Paging();\r\n\t\tthis._paging.setContainer( this.container.querySelector('.ui__paging__home') );\r\n\t\tthis._paging.id  = 'home-paging';\r\n\t\tthis._paging.create();\r\n\t\tthis._paging.config.activeIndex = 1;\r\n\t\tthis._paging.setCallbacks(this._pagingClick.bind(this));\r\n\r\n\t}\r\n\r\n\t/** Set interactoon to on/off */\r\n\tprivate _setInteractionEnabled(enabled: boolean): void {\r\n\t\tthis._active = enabled;\r\n\t\tthis._mainBreakpoints.setActive(enabled);\r\n\t\tthis._mainTimeline.setActive(enabled);\r\n\t}\r\n\r\n\tprivate _addEvents(): void {\r\n\t\t//Add the main explore clicks \r\n\t\tEvents.on('click', '.home__explorelink', this._onExploreButtonClick.bind(this) );\r\n\t\t//Events.on(DebugMouseWheelEvent,  this._onMouseWheel.bind(this));\r\n\t\tEvents.on(DebugKeypressEvent,  this._onKeyPress.bind(this));\r\n\t}\r\n\r\n\tprivate _pagingClick(index: number): void {\r\n\t\tthis._breakpointIndex = index;\r\n\t\tthis._mainBreakpoints.setIndex(index);\r\n\t\tthis._paging.setActiveIndex(index);\r\n\t}\r\n\r\n\tprivate _createBreakpoints(): void {\t\t\r\n\t\t\r\n\t\t//Create the 0% / 50% / 100% for SCREENS <> HOME <> SPACES layout \r\n\t\tthis._mainBreakpoints = new DragBreakpoints(3, false, 1, false);\r\n\t\t\r\n\t\tthis._mainBreakpoints.setVirtualWidth(this._virtualWidth);\r\n\t\tthis._mainBreakpoints.setDragToMoveRatio(this._json.dragToMoveRatio);\r\n\t\tthis._mainBreakpoints.easePower = this._json.dragEasePower;\r\n\t\tthis._mainBreakpoints.releaseEasePower = this._json.releaseEasePower;\r\n\t\tthis._mainBreakpoints.forceSnap = false;\r\n\t\tthis._mainBreakpoints.setProgress(0.5);\r\n\r\n\t\tthis._mainBreakpoints.onTick = (progressRatio: number) => {\r\n\t\t\tthis._frameProgress  = progressRatio - this._progressX;\r\n\t\t\tthis._progressX = progressRatio;\r\n\t\t\tthis._backgroundController.setXProgress(progressRatio);\r\n\t\t\tthis._mainTimeline.setProgress(progressRatio);\r\n\t\t\tthis._effectVelocity(this._frameProgress);\r\n\t\t};\r\n\r\n\t\tthis._mainBreakpoints.onStartDrag = () => {\r\n\t\t\tthis._mouseController.setDragDown(true);\r\n\t\t\t//this._moth.acivate();\r\n\t\t\t//this._moth.startDrag();\r\n\t\t};\r\n\r\n\t\tthis._mainBreakpoints.onStopDrag = () => {\r\n\t\t\tthis._mouseController.setDragDown(false);\r\n\t\t\t//this._moth.stopDrag();\r\n\t\t};\r\n\r\n\t}\r\n\r\n\t//Create the different animations for x and y movement on home: \r\n\tprivate _createTimelines(): void {\r\n\t\t\r\n\t\tthis._mainTimeline = new HomeTimelineMain(this._mouseController, this._json);\r\n\t\tthis._mainTimeline.setVirtualWidth(this._virtualWidth);\r\n\r\n\t\t//Pass the main: \r\n\t\tthis._mainTimeline.setUIRefs(\r\n\t\t\tthis.container.querySelector('.home__intro'), \r\n\t\t\tthis.container.querySelector('.home__screens'),\r\n\t\t\tthis.container.querySelector('.home__spaces'),\r\n\t\t\tthis.container.querySelector('.ui__paging__home')\r\n\t\t);\r\n\r\n\t\tthis._mainTimeline.create();\r\n\r\n\t\tthis._mainTimeline.setProgress(0.5);\r\n\t\tthis._mainTimeline.createParticlesPixi(this._$homeContainer, this._pixiSpritesheet);\r\n\t\tthis._mainTimeline.setVirtualWidth(this._virtualWidth);\r\n\t\tthis._mainTimeline.onCompleteExit = () =>  this.DOM.removeClass(this.container, '-active'); \r\n\r\n\t}\r\n\r\n\t/** Create the animated moth */\r\n\tprivate _createMoth(): void {\r\n\t\t//this._moth = new HomeMoth(this._mothSpritesheet, this._$homeContainer, this._virtualWidth, window.innerHeight, this._mainTimeline.containerX);\r\n\t}\r\n\r\n\t//Tolerence has been passed so flag that timeline has been selected: \r\n\tprivate _departmentSnapped(department: DepartmentType): void {\r\n\r\n\t}\r\n\r\n\tprivate _effectVelocity(frameMoveRatio: number): void {\r\n\t\tthis._velocity += (frameMoveRatio * this._json.velocityFactor);\r\n\t}\r\n\r\n\t/** Tick function to effect velcoity and rotation: */\r\n\tprivate _processVelocity(): void {\r\n\t\tthis._velocity *= this._json.velocityFriction;\r\n\t}\r\n\r\n\t/** Work section is qued when the users gets to a certian point on X. This is to allow seamless transitions between home > work */\r\n\tprivate _checkWorkQueFlags(): void {\r\n\r\n\t\tif (!this._queFlags.screens && this._progressX < 0.25) {\r\n\t\t\tthis._queFlags.screens = true; \r\n\t\t\tEvents.dispatch(new HomeDepartmentReachedEvent( {department: DepartmentType.SCREENS} ));\r\n\t\t}\r\n\r\n\t\tif (!this._queFlags.spaces && this._progressX > 0.75) {\r\n\t\t\tthis._queFlags.spaces = true; \r\n\t\t\tEvents.dispatch(new HomeDepartmentReachedEvent( {department: DepartmentType.SPACES} ));\r\n\t\t}\r\n\r\n\t}\r\n\r\n\t/** On explore press */\r\n\tprivate _onExploreButtonClick(e: MouseEvent): boolean {\r\n\t\t\r\n\t\te.preventDefault();\r\n\t\tthis._setInteractionEnabled(false);\r\n\t\tlet $link: Element = (e.target as HTMLElement);\r\n\t\tlet department: DepartmentType = $link.getAttribute('data-department') as DepartmentType;\r\n\r\n\t\tif(!department) {\r\n\t\t\tdepartment = (this._mainTimeline.progress <= 0.5) ? DepartmentType.SCREENS : DepartmentType.SPACES; \r\n\t\t}\r\n\r\n\t\tthis.DOM.addClass( $link, '-lineclicked');\r\n\r\n\t\tGA.event('UX', 'Home > Explore button', department);\r\n\r\n\t\t//Trigger event to switch to 'work' controller for department: \r\n\t\tlet newState: HistoryStateModel = {\r\n\t\t\tsection: SectionType.WORK,\r\n\t\t\tsubsection: department,\r\n\t\t\ttitle: (department === DepartmentType.SCREENS) ? 'Screens' : 'Spaces',\r\n\t\t\thref: `/${department}/`,\r\n\t\t};\r\n\t\tEvents.dispatch(AppEvents.CHANGE_SECTION, newState);\r\n\r\n\t\treturn false;\r\n\r\n\t}\r\n\r\n\t//Scrollwheel / mouse press \r\n\t//------------------------------------------------------------------------------------\r\n\tprivate _onMouseWheel(event: DebugMouseWheelEvent): void {\r\n\t\tif (!this._active) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tthis._mainBreakpoints.setTarget( this.math.constrain(this._progressX + (event.delta * 0.33), 0, 1) );\r\n\t\t//this._moth.clearTrail();\r\n\t\t//this._moth.acivate();\r\n\t}\r\n\r\n\tprivate _onKeyPress(event: DebugKeypressEvent): void {\r\n\t\tif (!this._active) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tlet direction = (event.keyType === DirectionalKeyType.LEFT || event.keyType === DirectionalKeyType.PAGE_UP) ? -1 : 1;\r\n\t\tthis._breakpointIndex += direction;\r\n\t\tthis.animateProgressToValue( this.math.constrain(this._breakpointIndex, 0, 2) );\r\n\t\t//this._moth.clearTrail();\r\n\t\t//this._moth.acivate();\r\n\t}\r\n\r\n\t/** After a deeplink / history pop() freeze then reset key things after hidden */\r\n\tprivate _cleanupAfterFreeze(): void {\r\n\t\tthis._$homeContainer.visible = false;\r\n\t\tthis._resetAndShowQued = false;\r\n\t\tthis.DOM.removeClass(this.container, '-active');\r\n\t\tgsap.TweenMax.set([this.container, document.querySelector('canvas')], {autoAlpha: 0, scale: 1});\r\n\t}\r\n\r\n\t//Reset methods\r\n\t//----------------------------------------------------------------------------------------------------------\r\n\t\r\n\t/** Reset for when coming from the full-screen preloader */\r\n\tprivate _resetForDeeplink(): void {\r\n\r\n\t\t//1.) Reset X positon of the timeline to the middle: \r\n\t\tthis._resetXProgress(0.5);\r\n\r\n\t\t//2.) Reset main timeline: \r\n\t\tthis._mainTimeline.resetForDeeplink();\r\n\r\n\t\t//3.) Make sure that PIXI background is correct intial state:\r\n\t\tthis._backgroundController.reset(this._state); \r\n\r\n\t}\t\t\r\n\r\n\t/** Reset when coming back from work section (To animate the work items down from top) */\r\n\tprivate _resetFromWork(department: DepartmentType): void {\r\n\t\t\r\n\t\t//1.) Set the progress / side to the corret department   \r\n\t\tlet progress: number = (department === DepartmentType.SCREENS) ? 0 : 1;\r\n\t\tthis._resetXProgress(progress);\r\n\r\n\t\t//2.) Reset the main timeline: \r\n\t\tthis._mainTimeline.resetFromWork(department);\r\n\r\n\t}\r\n\r\n\t/** Remove all intervals and animations that may have been applied */\r\n\tprivate _resetIntervalsAndAnimations(): void {\r\n\r\n\t\t//1.) Remove any animations/intervals from this main view class:\r\n\t\tclearTimeout(this._timeouts.freeze);\r\n\t\tif ( this._tweens.container ) {\r\n\t\t\tthis._tweens.container.kill();\r\n\t\t}\r\n\r\n\t\t//2.) Remove any animations/intervals from the main timeline:\r\n\t\tif (this._mainTimeline) {\r\n\t\t\tthis._mainTimeline.resetIntervalsAndAnimations();\r\n\t\t}\r\n\r\n\t\tthis._resetAndShowQued = false;\r\n\t\r\n\t}\r\n\r\n\t/** Reset the x progress of the timline */\r\n\tprivate _resetXProgress(progress: number): void {\r\n\t\t\r\n\t\tthis._mainTimeline.setProgress(progress, true);\r\n\t\t//TODO: convert set progress to a 0-1 to ration\r\n\t\tthis._mainBreakpoints.setProgress(progress);\r\n\t\tthis._progressX = progress;\r\n\t\tthis._velocity = 0;\r\n\t\tthis._frameProgress = 0;\r\n\r\n\t\tif (progress === 0) {\r\n\t\t\tthis._breakpointIndex = 0;\r\n\t\t} else if (progress === 1) {\r\n\t\t\tthis._breakpointIndex = 1;\r\n\t\t} else {\r\n\t\t\tthis._breakpointIndex = 2;\r\n\t\t}\r\n\r\n\t\t//Do an 'instant' update on the timeline. This should move everything the current psoition\r\n\t\tlet defaultMouseCords: any = {x: (window.innerWidth / 2), y: (window.innerHeight / 2) };\r\n\t\tthis._mainTimeline.tick(defaultMouseCords, false, 0, true, true);\r\n\r\n\t}\r\n\r\n\t//Show methods \r\n\t//-------------------------------------------------------------------------------------------------------\r\n\t\r\n\t/** Show from when coming from the full-screen preloader */\r\n\tprivate _showForDeeplink(): void {\r\n\r\n\t\t//Allow interaction: \r\n\t\t//this._setInteractionEnabled(true);\r\n\t\t\r\n\t\tthis._setupOpeningAction();\r\n\t\t this._mouseController.homeIntroStart();\r\n\r\n\t\t//Build in the elements from \r\n\t\tthis._mainTimeline.showForDeeplink();\r\n\t\t\r\n\t\tthis.resize();\r\n\r\n\t}\r\n\r\n\tprivate _timeoutInt: number = 0;\r\n\tprivate _setupOpeningAction(): void {\r\n\t\t//this.DOM.setText(document.querySelector('.home__action__text'), \"Click to explore\");\r\n\r\n\t\tthis._textScrable.setText('Interact');\r\n\t\t \r\n\t\tgsap.TweenMax.fromTo('.home__action', 0.45, {autoAlpha: 0, scale: 0, y: -75, x:-75, },  {autoAlpha: 1, scale: 1, x:0, y:0, delay: 0});\r\n\t\tEvents.on('click', '.home__action__button__center', () => this._openingActionComplete() );\r\n\t\tEvents.on('mouseover', '.home__action__button__center', () => {\r\n\t\t\tthis._mainTimeline.homeIntroHover();\r\n\t\t\tthis._mouseController.homeIntroHover();\r\n\t\t\tclearTimeout(this._timeoutInt);\r\n\t\t\tthis._timeoutInt = setTimeout(() => this._textScrable.setText('Enter'), 10);\r\n\t\t\t\r\n\t\t} );\r\n\r\n\t\tEvents.on('mouseout', '.home__action__button__center', () => {\r\n\t\t\tthis._mainTimeline.homeIntroMouseOut();\r\n\t\t\tthis._mouseController.homeIntroMouseOut();\r\n\t\t\tclearTimeout(this._timeoutInt);\r\n\t\t\tthis._timeoutInt = setTimeout(() => this._textScrable.setText('Interact'), 10);\r\n\t\t} );\t\r\n\r\n\t\t//Events.on('mousedown', '.home__action', () => (window as any).touchActive = true );\r\n\t\t//Events.on('mouseup', '.home__action', () => (window as any).touchActive = false );\r\n\r\n\t}\r\n\r\n\tprivate _openingActionComplete():  void {\r\n\t\t(window as any).touchActive = false;\r\n\t\tthis._mainTimeline.introComplete();\r\n\t\tthis._setInteractionEnabled(true);\r\n\t\tthis._mouseController.introComplete();\r\n\t\t(window as any ).introActive = false;\r\n\t\t(window as any ).introComplete = true;\r\n\r\n\t\tlet cords: Point = this._mouseController.getMouseCords();\r\n\t\tlet offsetx: number = cords.x - (window.innerWidth / 2);\r\n\t\tlet offsety: number = cords.y - (window.innerHeight / 2);\r\n\r\n\t\tgsap.TweenMax.to('.home__action', 0.4, {autoAlpha: 0, scale: 0, y: -75 + offsety, x: -75 + offsetx});\r\n\t\tgsap.TweenMax.to('.home__action__text', 0.3, {autoAlpha: 0, ease: gsap.Power0.easeNone});\r\n\t\tgsap.TweenMax.to('.ui__logo, .ui__hamburger', 0.4, {autoAlpha: 1, ease: gsap.Power0.easeNone, delay: 2 });\r\n\r\n\t}\r\n\r\n\t/** Animate in the work items from the top coming back from work (screens or spaces) view  */\r\n\tprivate _showFromWork(department: DepartmentType): void {\r\n\t\t\r\n\t\t//1.) Animate the elements from top: \r\n\t\tthis._mainTimeline.animateFromWork(department, 1.0);\r\n\t\t//this._moth.animateOn(1.0);\r\n\r\n\t\t//2.) Restart interaction on this controller after transition is complete:\r\n\t\tthis._timeouts.interaction = setTimeout( () => {\r\n\t\t\tthis._setInteractionEnabled(true);\r\n\t\t\tthis._mainTimeline.resetAnimationFreeze();\r\n\t\t\tthis._mouseController.setDragCursorActive(true);\r\n\t\t}, 2000);\r\n\r\n\t}\r\n\r\n\t//Hide methods\r\n\t//---------------------------------------------------------------------------------------------------------\r\n\r\n\t//** Hide to move to info section. Means hiding pixi and Home HTML elements */\r\n\tprivate _hideForInfo(): void {\r\n\t\tthis._tweens.container = gsap.TweenMax.to(\r\n\t\t\t[this.container, document.querySelector('canvas')], \r\n\t\t\t0.5, \r\n\t\t\t{autoAlpha: 0, delay: 0.5, onComplete: () => {\r\n\t\t\t\tthis._$homeContainer.visible = false;\r\n\t\t\t}}\r\n\t\t);\r\n\t}\r\n\r\n\t//** Hide after moving to work. Not too much to do here apart from deactive and hide elements */ \r\n\tprivate _hideForWork(department: DepartmentType): void {\r\n\t\t//gsap.TweenMax.set(this.container, {autoAlpha: 0});\r\n\t\tthis._mainTimeline.animateToWork(department);\r\n\t\t//this._moth.animateOff();\r\n\t\tthis._backgroundController.animateToWork(department);\r\n\t\tthis._timeouts.toWork = setTimeout( () => {\r\n\t\t\tthis.DOM.removeClass(this.container, '-active');\r\n\t\t\tthis._$homeContainer.visible = false;\r\n\t\t}, 1100);\r\n\r\n\t}\r\n\r\n}\r\n","import {GA} from 'debugbase/tracking/GA';\r\nimport {Controller} from 'debugbase/abstract/Controller';\r\nimport {SectionType, InfoSectionType, ViewType} from 'app/data/Enums';\r\nimport {Paging} from 'app/module/global/Paging';\r\n\r\nimport {ScrollbarController } from '../controller/ScrollbarController';\r\n\r\nimport {HistoryStateModel} from 'app/model/HistoryStateModel';\r\n\r\nimport { Events } from 'debugbase/events/Events';\r\nimport {AppEvents } from 'app/data/AppEvents';\r\nimport {ViewReadyEvent} from 'app/event/ViewReadyEvent';\r\n\r\n/** Controller to manage */\r\nexport class InfoController extends Controller {\r\n\r\n\t//AJAX Loaded HTML\r\n\tprivate _active: boolean = false;\r\n\r\n\tprivate _html: any = {};\r\n\tprivate _mainHTMLInjected: boolean  = false;\r\n\tprivate _allHTMLLoaded: boolean = false;\r\n\tprivate _sectionHTMLInjected: boolean = false;\r\n\tprivate _injectionQued: boolean = false;\r\n\tprivate _internalHTMLInjectTimerFlag: boolean = false;\r\n\tprivate _pagingScrolledFlagSet: boolean = false;\r\n\r\n\tprivate _$subsections: any = {};\r\n\t\r\n\tprivate _infoSectionType: InfoSectionType;\r\n\tprivate _state: HistoryStateModel;\r\n\r\n\tprivate _paging: Paging;\r\n\tprivate _scrollbar: ScrollbarController;\r\n\r\n\tprivate _freezeInt: number;\r\n\r\n\tprivate _timeouts: any = {};\r\n\tprivate _tweens: any = {};\r\n\tprivate _intervals: any = {};\r\n\t\r\n\tprivate readonly INFOSECTIONS = ['about', 'studio', 'jobs', 'contact'];\r\n\tprivate readonly INFOSECTIONS_TITLES = {about: 'About', studio: 'Studio', jobs: 'Jobs', contact: 'Contact'};\r\n\t\r\n\t//Init is only called if the section is deep linked to: \r\n\tpublic init(): void {\r\n\r\n\t\t//Info section is active loaded page so flag this \r\n\t\tthis._active = true;\r\n\r\n\t\t//Set HTML to blank value to flag this section is loaded \r\n\t\tthis._html[this._infoSectionType] = '';\r\n\t\tthis._mainHTMLInjected = true;\r\n\r\n\t\t//Set the opening state to the homepage: \r\n\t\tlet openingState: HistoryStateModel = {\r\n\t\t\tsection: SectionType.INFO,\r\n\t\t\tsubsection: this._infoSectionType,\r\n\t\t\ttitle: this.INFOSECTIONS_TITLES[this._infoSectionType],\r\n\t\t\thref: `/${this._infoSectionType}/`,\r\n\t\t};\r\n\t\tEvents.dispatch(AppEvents.SET_INTIAL_STATE, openingState);\r\n\r\n\t\t//Trigger timer. This is stop internal HTML being set to quickly on incorrect section. If its too quick the Google can process the dyanmic content\r\n\t\tthis._internalHTMLInjectTimerFlag = true; \r\n\t\tsetTimeout( () => {\r\n\t\t\tthis._internalHTMLInjectTimerFlag = false;\r\n\t\t\tif (this._allHTMLLoaded && !this._sectionHTMLInjected) {\r\n\t\t\t\tthis._injectSectionsHTML();\r\n\t\t\t}\r\n\t\t}, 5000);\r\n\r\n\t} \r\n\r\n\t//Routes \r\n\t//----------------------------------------------------------------------------------\r\n\t//----------------------------------------------------------------------------------\r\n\t//----------------------------------------------------------------------------------\r\n\t//----------------------------------------------------------------------------------\r\n\r\n\t/** About Deeplink */  \r\n\tpublic about(): void {\r\n\t\tthis._infoSectionType = InfoSectionType.ABOUT;\r\n\t\tthis.init();\r\n\t}\r\n\t/** Studio Deeplink */  \r\n\tpublic studio(): void {\r\n\t\tthis._infoSectionType = InfoSectionType.STUDIO;\r\n\t\tthis.init();\t\r\n\t}\r\n\t/** Jobs Deeplink */  \r\n\tpublic jobs(): void {\r\n\t\tthis._infoSectionType = InfoSectionType.JOBS;\r\n\t\tthis.init();\r\n\t}\r\n\t/** Contact Deeplink */  \r\n\tpublic contact(): void {\r\n\t\tthis._infoSectionType = InfoSectionType.CONTACT;\r\n\t\tthis.init();\t\r\n\t}\r\n\r\n\t//Public \r\n\t//----------------------------------------------------------------------------------\r\n\t//----------------------------------------------------------------------------------\r\n\t//----------------------------------------------------------------------------------\r\n\t//----------------------------------------------------------------------------------\r\n\r\n\t//Getters \r\n\t//-------------------------------------------------\r\n\tpublic isReadyToView(state: HistoryStateModel = null): boolean {\r\n\t\r\n\t\t//Check if the subsection has been loaded and is ready to view: \r\n\t\tif (!this._sectionHTMLInjected) {\r\n\t\t\tthis._injectSectionsHTML();\r\n\t\t\treturn false;\r\n\t\t}\r\n\t\treturn true;\r\n\t}\r\n\r\n\t//TODO, legacy hack so remove.\r\n\tpublic readyForDeeplink(): boolean {\r\n\t\treturn this.isReadyToView();\r\n\t}\r\n\r\n\t//Setters \r\n\t//-------------------------------------------------------\r\n\t/** Set contoller depencides */  \r\n\tpublic setControllers(scrollbar: ScrollbarController): void {\r\n\t\tthis._scrollbar = scrollbar;\r\n\t} \r\n\r\n\t/** DOReady auto event */\r\n\tpublic DOMReady(): void {\r\n\t\t//Set the active section to DOM records: \r\n\t\tif (this._active) {\r\n\t\t\tthis._$subsections[this._infoSectionType] = this.container.querySelector(`.info__subsection.-${this._infoSectionType}`);\r\n\t\t\tthis.resize();\r\n\t\t}\r\n\t}\r\n\r\n\t/** Reset ready to show */\r\n\tpublic reset(): void {\r\n\t\t(this.container as HTMLElement).style.visibility = 'visible';\r\n\t\t(this.container as HTMLElement).style.display = 'block';\r\n\t\tgsap.TweenMax.set([this.container], {scale: 1});\r\n\t\tthis._resetIntervalsAndAnimations();\r\n\t}\r\n\r\n\t/** Resize, fix container height */ \r\n\tpublic resize(): void {\r\n\r\n\t\treturn;\r\n\t\tif (!this._infoSectionType || !this._$subsections[this._infoSectionType]) {\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tconsole.log('this._$subsections[this._infoSectionType].clientHeight' , this._$subsections[this._infoSectionType].clientHeight);\r\n\t\t(this.container as HTMLElement).style.height = `${this._$subsections[this._infoSectionType].clientHeight}px`;\r\n\t}\r\n\r\n\t/** Tick function */\r\n\tpublic tick(): void {\r\n\t\tthis._checkPageScrolledState();\r\n\t}\r\n\r\n\t/** Pause when menu is shown */\r\n\tpublic pause(): void {\r\n\t\tgsap.TweenMax.to([this.container], 0.45, {scale: 1.2, ease: gsap.Power3.easeOut});\r\n\t}\r\n\r\n\t/** Pause when menu is hidden */\r\n\tpublic unpause(): void {\r\n\t\tgsap.TweenMax.to([this.container], 0.45, {scale: 1, ease: gsap.Power3.easeOut});\r\n\t}\r\n\r\n\t/** Freeze. View is active when a deep link is jumped to and this is old (current view) */\r\n\tpublic freeze(): void {\r\n\t\tthis._active = false;\r\n\t\tthis._paging.setActive(false);\r\n\t\tthis._resetIntervalsAndAnimations();\r\n\t\tthis._timeouts.freeze = setTimeout(() => this._cleanupAfterFreeze(), 500);\r\n\t}\r\n\r\n\t/** Que section up (when nav menu is opened) **/ \r\n\tpublic que(): void {\r\n\t\tif (!this._mainHTMLInjected ) {\r\n\t\t\tthis._createDOMStructure();\r\n\t\t} else if (!this._mainHTMLInjected && this._allHTMLLoaded) {\r\n\t\t\tthis._injectSectionsHTML();\r\n\t\t} else if (!this._mainHTMLInjected) {\r\n\t\t\tthis._injectionQued = true;\r\n\t\t}\r\n\t}\r\n\r\n\t/** Show after preload, or when section changes */\r\n\tpublic show(oldState: HistoryStateModel = null): void {\r\n\t\t\r\n\t\t//setState will always be set before show is calle, so we have to state the view should be in\r\n\t\t//So check if the action came from nav menu. This means switching depth, sliding scross and then seting the menu to be closed\r\n\t\t//This will be the most common use case!!\r\n\r\n\t\tthis._active = true;\r\n\t\t\r\n\t\tif (this._paging ) {\r\n\t\t\tthis._paging.setActive(true);\r\n\t\t}\r\n\t\t\r\n\t\tif (this._state.fromMenu) {\r\n\r\n\t\t\tlet sectionIndex: number = this._getIndexBySection(this._infoSectionType);\r\n\t\t\tthis._paging.setActiveIndex(sectionIndex);\r\n\r\n\t\t\tlet sectionTarget: HTMLElement = this._$subsections[this._state.subsection];\r\n\t\t\tthis.resize();\r\n\r\n\t\t\tthis._showActiveSubsection(sectionTarget);\r\n\t\t\tthis.DOM.addClass(this.container, '-abovemenu');\r\n\t\t\t\r\n\t\t\tthis._tweens.container = gsap.TweenMax.fromTo(this.container, 0.5, {x: '100%', autoAlpha: 1, display: 'block'}, {x: '0%'});\r\n\t\t\tthis._timeouts.activateScrollbar = setTimeout(() => {\r\n\t\t\t\tthis._scrollbar.setFocus(sectionTarget, 0, sectionTarget.querySelector('.info__subsection__content'));\r\n\t\t\t\tthis._scrollbar.setActive(true);\r\n\t\t\t}, 550);\r\n\t\t\tthis._timeouts.resetNav = setTimeout(() => Events.dispatch(AppEvents.RESET_NAV_MENU), 1000);\r\n\t\t\tthis._timeouts.resetZindex = setTimeout(() => this.DOM.removeClass(this.container, '-abovemenu'), 1500);\r\n\t\t\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\t//Deep link: \r\n\t\tthis._changeScrollFocus();\r\n\t\tthis._scrollbar.setActive(true);\r\n\t\tthis.resize();\r\n\r\n\t}\r\n\r\n\t/** Hide after section is moved away from */\r\n\tpublic hide(newState: HistoryStateModel = null): void {\r\n\r\n\t}\r\n\r\n\t/** \r\n\t* History state has been changed by a user action \r\n\t* @param {HistoryStateModel} state - The current state of the app\r\n\t*/\r\n\tpublic setState(state: HistoryStateModel): void {\r\n\t\tthis._state = state;\r\n\t\tthis._infoSectionType = (this._state.subsection as InfoSectionType);\r\n\t\tlet sectionIndex: number = this._getIndexBySection(this._infoSectionType);\r\n\t}\r\n\r\n\t/** \r\n\t* History state has been moved to go move inside the info section tions so just internal features to change state \r\n\t* @param {HistoryStateModel} state - The current state of the app\r\n\t*/\r\n\tpublic subsectionStateChange(state: HistoryStateModel): void {\r\n\t\tthis._state = state;\r\n\t\tlet sectionIndex: number = this._getIndexBySection( (state.subsection as InfoSectionType) );\r\n\t\t//Simulate a tab click. If coming from the nav menu delay this allow menu to transition out\r\n\t\tlet delay: number = (state.fromMenu) ? 300 : 0; \r\n\t\tthis._timeouts.subsectionChange = setTimeout(() => this._onPagingClick(sectionIndex, true), delay);\r\n\t\tgsap.TweenMax.to([this.container], 0.3, {scale: 1, ease: gsap.Power3.easeOut});\r\n\t}\r\n\r\n\t/** HTML has loaded from external, so set to local store:\r\n\t* @param {string} html - the raw HTML as a string\r\n\t* @param {string} infoSection - the info section that the HTML is for\r\n\t*/\r\n\tpublic setHTML(html: string, section: InfoSectionType): void {\r\n\t\t\r\n\t\tthis._html[section] = html;\r\n\t\tthis._allHTMLLoaded = this._checkAllSectionHTMLLoaded();\r\n\r\n\t\t//Flag that the view is ready to view: \r\n\t\tif (this._allHTMLLoaded) {\r\n\t\t\tEvents.dispatch(new ViewReadyEvent({view: ViewType.INFO}), {delay: 1} );\r\n\t\t} \r\n\r\n\t\t//If active then Inject the sections around the HTML loaded for the page. Also checked if injection has been requested but not possible (when menu is opned)\r\n\t\tif (this._allHTMLLoaded  &&  (this._active || this._injectionQued)) {\r\n\t\t\t\r\n\t\t\tif (!this._internalHTMLInjectTimerFlag) {\r\n\t\t\t\tthis._injectSectionsHTML();\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t}\r\n\r\n\t/** Get info section title\r\n\t* @param {InfoSectionType} infoSection - the info section\r\n\t* @return {string} - Infosection title\r\n\t*/ \r\n\tpublic getSubsectionTitle(section: InfoSectionType): string {\r\n\t\treturn this.INFOSECTIONS_TITLES[section];\r\n\t}\r\n\r\n\t//Private \r\n\t//----------------------------------------------------------------------------------\r\n\t//----------------------------------------------------------------------------------\r\n\t//----------------------------------------------------------------------------------\r\n\t//----------------------------------------------------------------------------------\r\n\t\r\n\t/** Check all HTML is loaded. */ \r\n\tprivate _checkAllSectionHTMLLoaded(): boolean {\r\n\t\tlet loaded: boolean = true;\r\n\t\tthis.INFOSECTIONS.forEach( (section: string) => {\r\n\t\t\tif (this._html[section] === null || this._html[section] === undefined) {\r\n\t\t\t\tloaded = false;\r\n\t\t\t}\r\n\t\t});\r\n\t\treturn loaded;\r\n\t}\r\n\r\n\t/**\r\n\t* Page is not deeplinked to generate the info section + paging + any generic elements required\r\n\t* Only used when info section is not deep linked directly to (and HTML is served in that way)\r\n\t*/\r\n\tprivate _createDOMStructure(): void {\r\n\t\tlet html: string = `<section class=\"info\">\r\n\t\t\t\t<div class='info__background'></div>\r\n\t\t\t\t${this._createPagingStructure()}\r\n\t\t\t</section>`;\r\n\r\n\t\tthis.DOM.append(document.querySelector('body'), html, () => {\r\n\t\t\tthis.container = document.querySelector('.info');\r\n\t\t\tthis._injectSectionsHTML();\r\n\t\t});\r\n\t\tthis._mainHTMLInjected = true;\r\n\t}\r\n\r\n\t/** Create the paging element structure for tab navigation: */\r\n\tprivate _createPagingStructure(): string {\r\n\r\n\t\tlet activeClass: string = (this._active) ? '-active' : '';\r\n\t\tlet html: string = `<ul id='info-paging' paging-active-index=\"1\" class=\"ui__paging ui__paging__info -info -show -scrollshow -items-${this.INFOSECTIONS.length} ${activeClass}\">`;\r\n\t\tthis.INFOSECTIONS.forEach( (section: string, index: number) =>  {\r\n\t\t\thtml += this._createPagingItemHTML(section, index);\r\n\t\t});\r\n\t\thtml += '</ul>';\r\n\t\treturn html;\r\n\t}\r\n\r\n\t/** Create single paging item */ \r\n\tprivate _createPagingItemHTML(section: string, index: number): string {\r\n\t\tlet label: string = this.INFOSECTIONS_TITLES[section];\r\n\t\treturn\t`<li class='ui__paging__item -index${index} -${section}'>\r\n\t\t\t<a href='/${section}/' class='ui__paging__link ui_hidecursor' data-index='${index}'>${label}</a>\r\n\t\t\t<i class='ui__paging__track'></i>\r\n\t\t\t<i class='ui__paging__bar'></i>\r\n\t\t </li>`;\r\n\t} \r\n\r\n\t/**  All subsections (about/studio/jobs/contact) have their html loaded, so inject into the section - called when navMenu is opened (as info section is a likely destination) */ \r\n\tprivate _injectSectionsHTML(): void {\r\n\r\n\t\t//If already injected then short circuit\r\n\t\tif (this._sectionHTMLInjected) {\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\t//If all sections are not loaded que injection\r\n\t\tif (!this._allHTMLLoaded) {\r\n\t\t\tthis._injectionQued = true;\r\n\t\t\treturn;\r\n\t\t}\r\n\t\t\r\n\t\tthis._injectionQued = false;\r\n\r\n\t\t//Build all the remaining subsections as one string and append into the .info section: \r\n\t\tvar htmlString: string = '';\r\n\t\tObject.keys(this._html).forEach( (key: string) => {\r\n\t\t\t//If active section then it will just be a blank string (as HTML is on main page load an not needed)\r\n\t\t\tif (this._html[key] !== '') {\r\n\t\t\t\thtmlString += this._html[key];\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t\tthis.DOM.append(this.container, htmlString, () => {\r\n\t\t\tthis._sectionHTMLInjected = true;\r\n\t\t\tthis._coreHTMLReady();\r\n\t\t\tif (this._paging) {\r\n\t\t\t\tthis._paging.setClass('-htmlloaded');\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t}\r\n\r\n\t//** Show active subsection, hide all others 8/\r\n\tprivate _showActiveSubsection($target: HTMLElement): void {\r\n\t\t\r\n\t\tObject.keys(this._$subsections).forEach( ($key) => {\r\n\t\t\tif (this._$subsections[$key] !== $target) {\r\n\t\t\t\tthis._$subsections[$key].style.display = 'none';\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t\t$target.style.display = 'block';\r\n\t\t//$target.style.transform = 'translate(0%, 0%)';\r\n\t\tgsap.TweenMax.set($target, {x: '0%'});\r\n\r\n\t}\r\n\r\n\t/** Core HTML ready, so add paging events and set container refs */ \r\n\tprivate _coreHTMLReady(): void {\r\n\t\t//set references to the container: \r\n\t\tthis.container = document.querySelector('.info');\r\n\t\tthis.INFOSECTIONS.forEach( (section) =>  {\r\n\t\t\tif (!this._$subsections[section]) {\r\n\t\t\t\tthis._$subsections[section] = this.container.querySelector(`.info__subsection.-${section}`);\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t\tthis._createPagingModule();\r\n\t}\r\n\r\n\t/** Create the paging controls: */\r\n\tprivate _createPagingModule(): void {\r\n\t\t\r\n\t\tthis._paging = new Paging();\r\n\t\tthis._paging.setContainer( this.container.querySelector('.ui__paging__info') );\r\n\t\tthis._paging.id  = 'info-paging';\r\n\t\tthis._paging.create();\r\n\t\tthis._paging.config.freezeInteractionOnClick = 0.6;\r\n\t\tthis._paging.config.track = false;\r\n\t\tthis._paging.setCallbacks(this._onPagingClick.bind(this));\r\n\r\n\t\tif (this._active) {\r\n\t\t\tlet sectionIndex: number = this._getIndexBySection(this._infoSectionType);\r\n\t\t\tthis._paging.setActiveIndex(sectionIndex);\r\n\t\t\tthis._paging.setActive(true);\r\n\t\t\tif (this._sectionHTMLInjected) {\r\n\t\t\t\tthis._paging.setClass('-htmlloaded');\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t}\r\n\r\n\t/** On paging click then change info section */ \r\n\tprivate _onPagingClick(index: number, byPassEvent: boolean = false): void {\r\n\r\n\t\tlet section = this._getSectionByIndex(index);\r\n\r\n\t\tGA.event('UX', 'Info section tab press', section);\r\n\r\n\t\t//If already in section then exit:\r\n\t\tif (this._infoSectionType === section) {\r\n\t\t\treturn; \r\n\t\t}\r\n\r\n\t\t//Switch subsection choosen item: \r\n\t\tlet oldSection: InfoSectionType = this._infoSectionType;\r\n\t\tlet oldSectionIndex: number = this._getIndexBySection(this._infoSectionType);\r\n\t\tthis._infoSectionType = section;\r\n\t\tthis._paging.setActiveIndex(index);\r\n\r\n\t\t//Animate across to new subsection\r\n\t\tlet direction = (oldSectionIndex > index) ? 1 : -1;\r\n\t\tthis._animateToSubsection(direction, oldSection); \r\n\t\tthis._changeScrollFocus();\r\n\r\n\t\t//Animate backgroud for minor parallax \r\n\t\tgsap.TweenMax.to('.info__background', 1.2, {x: `${-1 * (index * 10)}%`, ease: gsap.Power3.easeOut});\r\n\r\n\t\t//If no section change event is needed then short circuit: \r\n\t\tif (byPassEvent) {\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\t//Trigger event (Mainly so history state stuff can be managed)\r\n\t\tlet newState: HistoryStateModel = {\r\n\t\t\tsection: SectionType.INFO,\r\n\t\t\tsubsection: this._infoSectionType,\r\n\t\t\ttitle: this.INFOSECTIONS_TITLES[this._infoSectionType],\r\n\t\t\thref: `/${this._infoSectionType}/`,\r\n\t\t\tbypassTransitions: true,\r\n\t\t};\r\n\t\tEvents.dispatch(AppEvents.CHANGE_SECTION, newState);\r\n\r\n\t}\r\n\r\n\t/** Get the subsection by index */ \r\n\tprivate _getSectionByIndex(index: number): InfoSectionType {\r\n\t\treturn (this.INFOSECTIONS[index] as InfoSectionType);\r\n\t}\r\n\r\n\t//** Get the index by section */ \r\n\tprivate _getIndexBySection(section: InfoSectionType): number {\r\n\t\tfor (let i = 0; i < this.INFOSECTIONS.length; i++) {\r\n\t\t\tif (this.INFOSECTIONS[i] === section) {\r\n\t\t\t\treturn i;\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn -1; \r\n\t}\r\n\r\n\t//** Animate across to subsection */\r\n\tprivate _animateToSubsection(direction: number, oldSectionType: InfoSectionType ): void { \r\n\t\tlet offXPos: string = `${100 * direction}%`;\r\n\t\tlet onStartXPos: string = `${100 * (-1 * direction)}%`;\r\n\t\t\r\n\t\tthis._tweens.sectionOld = gsap.TweenMax.to(this._$subsections[oldSectionType], 0.7, {x: offXPos, ease: gsap.Power3.easeOut, onComplete: () => {\r\n\t\t\tthis.DOM.removeClass(this._$subsections[oldSectionType], '-active');\r\n\t\t\tthis._$subsections[oldSectionType].style.display = 'none';\r\n\t\t}});\r\n\t\t\r\n\t\tthis._$subsections[this._infoSectionType].style.display = 'block';\r\n\r\n\t\tthis.DOM.addClass(this._$subsections[this._infoSectionType], '-transitionin');\r\n\t\tthis._tweens.sectionNew = gsap.TweenMax.fromTo(\r\n\t\t\tthis._$subsections[this._infoSectionType], \r\n\t\t\t0.7, \r\n\t\t\t{x: onStartXPos, autoAlpha: 1}, \r\n\t\t\t{x: '0%', ease: gsap.Power3.easeOut, onComplete: () => {\r\n\t\t\t\tthis.DOM.removeClass(this._$subsections[this._infoSectionType], '-transitionin');\r\n\t\t\t\tthis.DOM.addClass(this._$subsections[this._infoSectionType], '-active');\r\n\t\t\t\tthis.resize();\r\n\t\t\t}}\r\n\t\t);\r\n\r\n\t}\r\n\r\n\t/** \r\n\t/*\tChange the scrollbar focus \r\n\t/*\tAnimate the scrollbar between states so its a bit smoother \r\n\t*/\r\n\tprivate _changeScrollFocus(): void {\r\n\t\tgsap.TweenMax.set(this._$subsections[this._infoSectionType], {y: 0});\r\n\t\t//Containers are absolute so have no height, sp get the content inside: \r\n\t\tlet $scrollbarHeightTarget: HTMLElement = this._$subsections[this._infoSectionType].querySelector('.info__subsection__content');\r\n\t\tthis._scrollbar.setFocus(this._$subsections[this._infoSectionType], 0.5, $scrollbarHeightTarget);\r\n\t}\r\n\r\n\t/** Cleanup after freeze */\r\n\tprivate _cleanupAfterFreeze(): void {\r\n\t\tthis._scrollbar.setActive(false);\r\n\t\tthis._scrollbar.setFocus(null);\r\n\t\tgsap.TweenMax.set([this.container], {scale: 1});\r\n\t\t(this.container as HTMLElement).style.visibility = 'hidden';\r\n\t\t(this.container as HTMLElement).style.display = 'none';\r\n\t\tthis.DOM.removeClass(this.container, '-active');\r\n\t}\r\n\r\n\t/** Reset anything that is happening */\r\n\tprivate _resetIntervalsAndAnimations(): void {\r\n\t\tObject.keys(this._tweens).forEach( (key: string) => {\r\n\t\t\tthis._tweens[key].kill();\r\n\t\t});\r\n\t\tObject.keys(this._timeouts).forEach( (key: string) => {\r\n\t\t\tclearTimeout(this._timeouts[key]);\r\n\t\t});\r\n\t\tObject.keys(this._intervals).forEach( (key: string) => {\r\n\t\t\tclearInterval(this._intervals[key]);\r\n\t\t});\r\n\t}\r\n\r\n\t/** Check the scroll amount to see if the scroll state should be flagged on paging (This is to add a black BG so it's visiible over content) */\r\n\tprivate _checkPageScrolledState(): void {\r\n\r\n\t\tif (!this._paging) {\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tif (this._pagingScrolledFlagSet && this._scrollbar.getScroll() < 200) {\r\n\t\t\tthis._pagingScrolledFlagSet = false;\r\n\t\t\tthis._paging.removeClass('-scrolled');\r\n\t\t} else  if (!this._pagingScrolledFlagSet && this._scrollbar.getScroll() >= 200) {\r\n\t\t\tthis._paging.setClass('-scrolled');\r\n\t\t\tthis._pagingScrolledFlagSet = true;\r\n\t\t}\r\n\t}\r\n\r\n}\r\n","import {Controller} from 'debugbase/abstract/Controller';\r\n//import {TweenMax, Power0, Power3, Back } from 'gsap';\r\nimport {Events} from 'debugbase/events/Events';\r\nimport {CustomCursorEvent} from 'app/event/CustomCursorEvent';\r\nimport {ConstrainAroundCircle}  from 'app/module/home/homeUtil/ConstrainAroundCircle';\r\nimport {Point} from 'app/contracts/Geometry';\r\nimport * as fastdom from 'fastdom';\r\n\r\nexport class MouseController extends Controller {\r\n\t\r\n\tprivate _dragViewActive: boolean = false;\r\n\tprivate _$dragCursor: HTMLElement;\r\n\tprivate _$homeIntroCursor: HTMLElement;\r\n\tprivate _mouseCords: any = {x: 0, y: 0};\r\n\tprivate _updateInt: number;\r\n\tprivate _updateCounter: number = 1;\r\n\tprivate _dragdown: boolean;\r\n\tprivate _pauseHoldingFlag: boolean;\r\n\tprivate _touchActive: boolean = false;\r\n\tprivate _hidden: boolean = false;\r\n\tprivate _introActionActive: boolean = false;\r\n\tprivate _introConstrain: ConstrainAroundCircle = new ConstrainAroundCircle();\r\n\r\n\tpublic init(): void {\r\n\r\n\t}\r\n\r\n\tpublic DOMReady(): void {\r\n\t\tthis._$dragCursor = this.container.querySelector('.ui__cursordrag');\r\n\t\tEvents.on('mouseover', '.ui_hidecursor', this._mouseOver.bind(this));\r\n\t\tEvents.on('mouseout', '.ui_hidecursor', this._mouseOut.bind(this));\r\n\t\tEvents.on('touchstart', this.container, this._onTouchStart.bind(this));\r\n\t\tEvents.on('touchend', this.container, this._onTouchEnd.bind(this));\r\n\t\tEvents.on('mousemove', this.container, this._onMouseMove.bind(this));\r\n\t\tEvents.on('touchmove', this.container, this._onTouchMove.bind(this));\r\n\t\tEvents.on(CustomCursorEvent, this._onCursorEvent.bind(this));\r\n\t}\r\n\r\n\tpublic tick(): void {\r\n\t\t\r\n\t\tif (this._dragViewActive || this._introActionActive) {\r\n\t\t\t\r\n\t\t\tif (this._introActionActive) {\r\n\t\t\t\tlet introMousePoint: Point = this._introConstrain.limit(this._mouseCords);\r\n\t\t\t\tthis._$dragCursor.style.transform = `translate3d(${introMousePoint.x}px, ${introMousePoint.y}px, 0)`;\r\n\t\t\t} else {\r\n\t\t\t\tthis._$dragCursor.style.transform = `translate3d(${this._mouseCords.x}px, ${this._mouseCords.y}px, 0)`;\r\n\t\t\t}\r\n\r\n\t\t}\r\n\t\t/*if (this._introActionActive) {\r\n\t\t\tgsap.TweenMax.set(this._$homeIntroCursor, {\r\n\t\t\t\tx: this._mouseCords.x, \r\n\t\t\t\ty: this._mouseCords.y,\r\n\t\t\t\ttop: 0,\r\n\t\t\t\tleft: 0\r\n\t\t\t});\r\n\t\t}*/\r\n\t}\r\n\r\n\t/** When showing nav menu stop special state and save if active at time of pause */\r\n\tpublic pause(): void {\r\n\t\tthis._pauseHoldingFlag = this._dragViewActive;\r\n\t\tthis.setDragCursorActive(false, false);\r\n\t}\r\n\r\n\t/** When hiding nav menu show 'drag' state if it was showing at the time of pausing */\r\n\tpublic unpause(): void {\r\n\t\tif (this._pauseHoldingFlag) {\r\n\t\t\tthis.setDragCursorActive(true);\r\n\t\t}\r\n\t}\r\n\r\n\t/** Background can be affected by the parallax in home / work sections */\r\n\tpublic setHiddenState(hidden: boolean): void {\r\n\t\tif (this._hidden !== hidden) {\r\n\t\t\tthis.DOM.toggleClass(this._$dragCursor, '-hidden', hidden);\r\n\t\t\tthis._hidden = hidden;\r\n\t\t}\r\n\t}\r\n\r\n\t/** \r\n\t * Set the special drag cursor to be active on sections that can be dragged\r\n\t * @param {boolean} active - Turn on / off.\r\n\t * @param {boolean} [resetPauseHoldingFlag=true] - Reset any flags that hav have been set by pause action.\r\n\t*/\r\n\tpublic setDragCursorActive(active: boolean, resetPauseHoldingFlag: boolean = true): void {\r\n\r\n\t\tif (!this.container) {\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tif (resetPauseHoldingFlag) {\r\n\t\t\tthis._pauseHoldingFlag = false;\r\n\t\t}\r\n\r\n\t\tthis._dragViewActive = active;\r\n\t\tthis.DOM.toggleClass(this.container, '-dragcursor', this._dragViewActive);\r\n\t\tthis._setupMouseMove();\r\n\t\t\r\n\t}\r\n\r\n\t/** \r\n\t/* Set the special drag cursor to be active on sections that can be dragged (I.E grey on sections because of the white/black mix)\r\n\t/* @param {string} colour - Color class to change the curose to \r\n\t*/\r\n\tpublic setColour(colour: string): void {\r\n\t\t\r\n\t\tif (colour === 'light') {\r\n\t\t\tthis.DOM.removeClass(this.container, '-darkcursor');\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tthis.DOM.addClass(this.container, '-darkcursor');\r\n\r\n\t}\r\n\r\n\tpublic setDragDown(isDown: boolean, side: string = null, animationTime: number = 0.2): void {\r\n\t\t\r\n\t\tlet scale: number = (isDown) ? 1.4 : 1.0;\r\n\r\n\t\tthis._dragdown = isDown;\r\n\t\t(window as any).touchActive  = isDown;\r\n\r\n\t\t//gsap.TweenMax.to(this._$dragCursor, animationTime, {scale: scale});\r\n\t\tthis.DOM.toggleClass(this._$dragCursor, '-pressed', isDown);\r\n\t\t\r\n\t\tif (isDown) {\r\n\t\t\tlet showRight, showLeft: boolean = true;\r\n\t\t\tif (side === 'left') {\r\n\t\t\t\tshowRight = false;\r\n\t\t\t} else if (side === 'right') {\r\n\t\t\t\tshowLeft = false;\r\n\t\t\t}\r\n\t\t\tthis.DOM.toggleClass(this._$dragCursor, '-left', showLeft);\r\n\t\t\tthis.DOM.toggleClass(this._$dragCursor, '-right', showRight);\r\n\t\t}\r\n\r\n\t}\r\n\r\n\tpublic getMouseCords(): any {\r\n\r\n\t\tif (!this._mouseCords) {\r\n\t\t\treturn {x: window.innerWidth / 2, y: window.innerHeight / 2};\r\n\t\t}\r\n\r\n\t\treturn this._mouseCords; \r\n\r\n\t}\r\n\r\n\tpublic mouseIsDown(): boolean {\r\n\t\treturn this._dragdown;\r\n\t}\r\n\r\n\tpublic homeIntroStart(): void {\r\n\t\t//this.setHiddenState(true);\r\n\r\n\t\tthis._introConstrain.setConstraints( \r\n\t\t\t{x: (window.innerWidth/2), y: (window.innerHeight/2)  }, \r\n\t\t\t75\r\n\t\t);\r\n\r\n\t\tthis._introActionActive  = true;\r\n\t\t//this.setDragCursorActive(true);\r\n\t\tsetTimeout(() => this.DOM.addClass(this._$dragCursor, '-intro'), 200);\r\n\t\tgsap.TweenMax.fromTo(this._$dragCursor, 0.5, {autoAlpha: 0}, {autoAlpha: 1, delay: 1.5, ease: gsap.Power0.easeNone});\r\n\t}\r\n\r\n\tpublic homeIntroHover(): void {\r\n\r\n\t\tif (!this._introActionActive) {\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tthis.DOM.addClass(this._$dragCursor, '-introhover');\r\n\t\tthis.DOM.toggleClass(this.container, '-dragcursor', true);\r\n\t\tthis.DOM.addClass(document.querySelector('.home__action__text'), '-hover');\r\n\r\n\t\t/*if (!this._$homeIntroCursor ) {\r\n\t\t\tthis._$homeIntroCursor  = document.querySelector('.home__action');\r\n\t\t}\r\n\t\t\r\n\t\tthis._introActionActive =  true;\r\n\t\tthis.setDragCursorActive(true);\r\n\t\tsetTimeout(() => this.setHiddenState(false), 350);*/\r\n\r\n\t}\r\n\r\n\tpublic homeIntroMouseOut(): void {\r\n\r\n\t\tif (!this._introActionActive) {\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tthis.DOM.removeClass(this._$dragCursor, '-introhover');\r\n\t\tthis.DOM.toggleClass(this.container, '-dragcursor', false);\r\n\t\tthis.DOM.removeClass(document.querySelector('.home__action__text'), '-hover');\r\n\t}\r\n\r\n\tpublic introComplete(): void {\r\n\t\tthis.setHiddenState(true);\r\n\t\tthis.setDragCursorActive(true);\r\n\t\tthis.DOM.removeClass(this._$dragCursor, '-introhover');\r\n\t\tthis.DOM.removeClass(this._$dragCursor, '-intro');\r\n\t\tthis._introActionActive =  false;\r\n\t}\r\n\r\n\tprivate _setupMouseMove(): void {\r\n\r\n\t\t//$(this.container).off('mousemove', this._onMouseMove.bind(this));\r\n\t\t//if (this._dragViewActive) {\r\n\t\t//\t$(this.container).on('mousemove', this._onMouseMove.bind(this));\r\n\t\t//}\r\n\r\n\t}\r\n\r\n\tprivate _onTouchStart(e): void {\r\n\t\tthis.system.cordsFromTouch = true;\r\n\t\tthis._touchActive = true;\r\n\t\t(window as any).touchActive  = true;\r\n\t}\r\n\r\n\tprivate _onTouchEnd(e): void {\r\n\t\t(window as any).touchActive  = false;\r\n\t\tthis._touchActive = false;\r\n\t}\r\n\r\n\tprivate _onMouseMove(e): void {\r\n\t\t\r\n\t\tif (!this._touchActive )  {\r\n\t\t\tthis.system.cordsFromTouch = false;\r\n\t\t}\r\n\t\r\n\t\tthis._mouseCords.x = e.clientX;\r\n\t\tthis._mouseCords.y = e.clientY;\r\n\r\n\t}\r\n\r\n\tprivate _onTouchMove(e): void {\r\n\t\tthis.system.cordsFromTouch = true;\r\n\t\tthis._mouseCords.x = e.touches[0].clientX;\r\n\t\tthis._mouseCords.y = e.touches[0].clientY;\r\n\t}\r\n\r\n\tprivate _mouseOver(e: MouseEvent): void {\r\n\t\tif (this._dragViewActive) {\r\n\t\t\tthis.DOM.removeClass(this.container, '-dragcursor');\r\n\t\t}\r\n\t}\r\n\r\n\tprivate _mouseOut(e: MouseEvent): void {\r\n\t\tif (this._dragViewActive) {\r\n\t\t\tthis.DOM.addClass(this.container, '-dragcursor');\r\n\t\t}\r\n\t}\r\n\r\n\t/** Pickup event form other modules/controller to activate the cursor */\r\n\tprivate _onCursorEvent(e: CustomCursorEvent): void {\r\n\t\t\r\n\t\tif ( e.type === 'hitarea') {\r\n\t\t\tthis.setDragCursorActive(e.active, false);\r\n\t\t\tif (e.theme) {\r\n\t\t\t\tthis.setColour(e.theme);\r\n\t\t\t}\r\n\t\t} else if (e.type === 'drag') {\r\n\t\t\tthis.setDragDown(e.active);\r\n\t\t}\r\n\r\n\t}\r\n\r\n}\r\n","import {GA} from 'debugbase/tracking/GA';\r\nimport {Controller} from 'debugbase/abstract/Controller';\r\nimport { Events } from 'debugbase/events/Events';\r\nimport {AppEvents} from 'app/data/AppEvents';\r\nimport {MenuStateType, SectionType, InfoSectionType, DepartmentType} from 'app/data/Enums';\r\nimport {InfoController} from 'app/controller/InfoController';\r\nimport {HistoryStateModel} from 'app/model/HistoryStateModel';\r\n\r\n//import {TweenMax, Power0, Power3, Back } from 'gsap';\r\n\r\nexport class NavMenuController extends Controller {\r\n\r\n\tprivate _infoController: InfoController;\r\n\tprivate _$menuButton: HTMLElement; \r\n\tprivate _state: HistoryStateModel;\r\n\r\n\tpublic init(): void {}\r\n\r\n\t//** Set controller depencies */\r\n\tpublic setControllers(info: InfoController): void {\r\n\t\tthis._infoController = info;\r\n\t}\r\n\r\n\tpublic DOMReady(): void {\r\n\r\n\t\tthis._$menuButton = document.querySelector('.ui__hamburger');\r\n\r\n\t\tEvents.on('click', '.ui__hamburger', (e: MouseEvent) => {\r\n\t\t\te.preventDefault();\r\n\t\t\tthis._onMenuButtonClick(e);\r\n\t\t\treturn false;\r\n\t\t} );\r\n\r\n\t\tEvents.on('click', '.navmenu__link.-departmentlink', (e: MouseEvent) => {\r\n\t\t\te.preventDefault();\r\n\t\t\tthis._onMenuDepartmentLinkClick(e);\r\n\t\t\treturn false;\r\n\t\t} );\r\n\r\n\t\tEvents.on('click', '.navmenu__link.-infolink', (e: MouseEvent) => {\r\n\t\t\te.preventDefault();\r\n\t\t\tthis._onMenuInfoLinkClick(e);\r\n\t\t\treturn false;\r\n\t\t} );\r\n\r\n\t\tthis._setMenuSelectedState(this._state);\r\n\r\n\t}\r\n\r\n\t/** Is showing */\r\n\tpublic isShowing(): boolean {\r\n\t\treturn this.DOM.hasClass(this.container, '-open');\r\n\t}\r\n\r\n\t/** Section has change so set state */\r\n\tpublic setState(state: HistoryStateModel, updateMenuState: boolean = true): void {\r\n\t\tthis._state = state;\r\n\t\tif (updateMenuState) {\r\n\t\t\tthis._setMenuSelectedState(state);\r\n\t\t}\r\n\t}\r\n\r\n\t/** Reset the overlay nav menu after the transition to */ \r\n\tpublic reset(): void {\r\n\t\tthis._setMenuState(MenuStateType.CLOSED);\r\n\t}\r\n\r\n\t//PRIVATE \r\n\t//----------------------------------------------------------------------------\r\n\t//----------------------------------------------------------------------------\r\n\t//----------------------------------------------------------------------------\r\n\t//----------------------------------------------------------------------------\r\n\r\n\t/** Hamburger menu  press */\r\n\tprivate _onMenuButtonClick(e: MouseEvent): void {\r\n\t\tlet $hamburger: Element = (e.target as Element);\r\n\t\tlet state: MenuStateType = (this.DOM.hasClass($hamburger, '-open')) ? MenuStateType.CLOSED : MenuStateType.OPEN;\r\n\t\tthis._setMenuState(state);\r\n\r\n\t\t//Dispatch event so active controllers can be 'paused'\r\n\t\tEvents.dispatch(AppEvents.MENU_STATE_CHANGE, {state: state });\r\n\t}\r\n\r\n\t//** Select the selected state of menu */ \r\n\tprivate _setMenuSelectedState(state: HistoryStateModel): void {\r\n\t\tthis._removeAllSelectClassesFromMenu();\r\n\t\tlet $target: HTMLElement;\r\n\t\tif (state.section === SectionType.WORK || state.section === SectionType.INFO) {\r\n\t\t\t$target = this.container.querySelector(`.navmenu__link.-` + state.subsection);\r\n\t\t\tthis.DOM.addClass($target, '-selected');\r\n\t\t} \r\n\t}\r\n\r\n\t/** Remove all selected states */\r\n\tprivate _removeAllSelectClassesFromMenu(): void {\r\n\t\tthis.container.querySelectorAll('.navmenu__link').forEach( (link: Element) => {\r\n\t\t\tthis.DOM.removeClass(link, '-selected');\r\n\t\t});\r\n\t}\r\n\r\n\t/** Set Menu state */\r\n\tprivate _setMenuState(state: MenuStateType): void {\r\n\t\t//Toogle state from open/close\r\n\t\tif (state === MenuStateType.CLOSED) {\r\n\t\t\tthis.DOM.removeClass(this._$menuButton, '-open');\r\n\t\t\tthis.DOM.removeClass(this.container, '-open');\r\n\t\t\tsetTimeout(() => this.DOM.removeClass(this.container, '-active'), 350);\r\n\t\t\tthis._hideMenuContent();\r\n\t\t} else {\r\n\t\t\tthis.DOM.addClass(this._$menuButton, '-open');\r\n\t\t\tthis.DOM.addClass(this.container, '-open');\r\n\t\t\tthis.DOM.addClass(this.container, '-active');\r\n\t\t\t//Reset the content panel from any animations\r\n\t\t\tgsap.TweenMax.set('.navmenu__content', {x: '0%'});\r\n\t\t\t//Show the menu items \r\n\t\t\tthis._showMenuContent();\r\n\t\t}\r\n\t}\r\n\r\n\t//** Spaces / Screens  menu button click */ \r\n\tprivate _onMenuDepartmentLinkClick(e: MouseEvent): void {\r\n\r\n\t\t//Do Change section event: \r\n\t\tlet $link: Element = (e.target as HTMLElement);\r\n\t\tlet workSection: DepartmentType = $link.getAttribute('data-department') as DepartmentType;\r\n\t\t\r\n\t\t//If section is already active then menu is just sliding to start slide / index\t\r\n\t\tif (workSection === this._state.subsection && this._state.section !== SectionType.PROJECT) {\r\n\t\t\tEvents.dispatch(AppEvents.ACTIVE_DEPARTMENT_NAV_MENU_PRESS, workSection);\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tGA.event('UX', 'Nav menu big link', workSection);\r\n\r\n\t\t//Its a change of section to screens / spaces: \r\n\t\tlet title: string = (workSection === DepartmentType.SCREENS) ? 'Screens' : 'Spaces';\r\n\t\tEvents.dispatch(AppEvents.CHANGE_SECTION, {\r\n\t\t\thref: (e.target as HTMLElement).getAttribute('href'),\r\n\t\t\tsection: SectionType.WORK,\r\n\t\t\tsubsection: workSection,\r\n\t\t\tfromMenu: true,\r\n\t\t\ttitle: title,\r\n\t\t\tisDeepLink: true\r\n\t\t});\r\n\r\n\r\n\r\n\t}\r\n\r\n\t//**  Info menu button click - move to the info section and deep link to correct subsection */ \r\n\tprivate _onMenuInfoLinkClick(e: MouseEvent): void {\r\n\r\n\t\t//Animate off the container if not already on info: \r\n\t\tif (this._state.section !== SectionType.INFO) {\r\n\t\t\tgsap.TweenMax.to('.navmenu__content', 0.4, {x: '-100%'});\r\n\t\t} \r\n\r\n\t\tlet $link: Element = (e.target as HTMLElement);\r\n\t\tlet infoSection: InfoSectionType = $link.getAttribute('data-infosection') as InfoSectionType;\r\n\r\n\t\tGA.event('UX', 'Nav menu small link', infoSection);\r\n\r\n\t\t//Do Change section event: \r\n\t\tEvents.dispatch(AppEvents.CHANGE_SECTION, {\r\n\t\t\thref: $link.getAttribute('href'),\r\n\t\t\tsection: SectionType.INFO,\r\n\t\t\tsubsection: infoSection,\r\n\t\t\tfromMenu: true,\r\n\t\t\ttitle: this._infoController.getSubsectionTitle(infoSection)\r\n\t\t});\r\n\r\n\t}\r\n\r\n\t/** Show menu content */ \r\n\tprivate _showMenuContent(): void {\r\n\t\tgsap.TweenMax.staggerFromTo('.navmenu__link', 0.3, {y: -30, autoAlpha: 0}, {y: 0, autoAlpha: 1, delay: 0.2}, 0.04);\r\n\t\tgsap.TweenMax.fromTo('.navmenu__contact', 0.3, {y: 0, autoAlpha: 0}, {y: 0, autoAlpha: 1, delay: 0.4});\r\n\t}\r\n\r\n\t/** Hide menu content */ \r\n\tprivate _hideMenuContent(): void {\r\n\t\tgsap.TweenMax.staggerTo('.navmenu__link', 0.15, {y: -30, autoAlpha: 0}, 0.01);\r\n\t\tgsap.TweenMax.to('.navmenu__contact', 0.15, {y: 0, autoAlpha: 0});\r\n\t}\r\n\r\n}\r\n","import {Controller} from 'debugbase/abstract/Controller';\r\nimport {DepartmentType} from 'app/data/Enums';\r\n\r\nexport class PixiController extends Controller {\r\n\r\n\tprivate _$pixi: PIXI.Application;\r\n\tprivate _$backgroundContainer:  PIXI.Container;\r\n\tprivate _$workContainers: any = {screens: null, spaces: null};  \r\n\tprivate _$homeContainer:  PIXI.Container;\r\n\tprivate _projectHeaderSize: any = null;\r\n\r\n\tpublic init(): void {\r\n\t\tthis._createPixiApp();\r\n\t}\r\n\r\n\tpublic resize(): void {\r\n\t\t//Resize the renderer to 100% height and width: \r\n\t\tthis._$pixi.renderer.resize(window.innerWidth, window.innerHeight);\r\n\t}\r\n\r\n\tpublic pause(): void {\r\n\t\tthis._$pixi.stop();\r\n\t}\r\n\r\n\tpublic unpause(): void {\r\n\t\tthis._$pixi.start();\r\n\t}\r\n\r\n\tpublic getPixi(): PIXI.Application {\r\n\t\treturn this._$pixi;\r\n\t}\r\n\r\n\tpublic getBackground(): PIXI.Container {\r\n\t\treturn this._$backgroundContainer;\r\n\t}\r\n\r\n\tpublic getWork(department: DepartmentType): PIXI.Container {\r\n\t\treturn (department === DepartmentType.SCREENS) ? this._$workContainers.screens : this._$workContainers.spaces;\r\n\t}\r\n\r\n\tpublic getHome(): PIXI.Container {\r\n\t\treturn this._$homeContainer;\r\n\t}\r\n\r\n\tpublic getProjectHeaderSize(): any {\r\n\t\treturn this._projectHeaderSize;\r\n\t}\r\n\t\r\n\tpublic setProjectHeaderSize(size: any): void {\r\n\t\tthis._projectHeaderSize = size;\r\n\t}\r\n\r\n\t//PRIVATE \r\n\t//------------------------------------------------------------------------------------\r\n\tprivate _createPixiApp(): void {\r\n\r\n\t\t//Create a PIXI app to render all the big full screen bits: \r\n\t\tlet resolution = this._getPixiResolution();\r\n\t\tthis._$pixi = new PIXI.Application({\r\n\t\t\twidth: window.innerWidth, \r\n\t\t\theight: window.innerHeight, \r\n\t\t\tautoResize: true, \r\n\t\t\tresolution:  resolution\r\n\t\t});\r\n\t\t\r\n\t\t(window as any).pixiResolution = resolution;\r\n\t\t\r\n\t\t//Add to the view: \r\n\t\tdocument.body.appendChild(this._$pixi.view);\r\n\r\n\t\t//Add the section conatiners for easier layering: \r\n\t\tthis._$backgroundContainer = new PIXI.Container();\r\n\t\tthis._$backgroundContainer.interactive = false;\r\n\t\tthis._$backgroundContainer.interactiveChildren = false;\r\n\r\n\t\tthis._$homeContainer = new PIXI.Container();\r\n\t\tthis._$homeContainer.interactive = false;\r\n\t\tthis._$homeContainer.interactiveChildren  = false;\r\n\t\t\r\n\t\tthis._$workContainers.screens = new PIXI.Container();\r\n\t\tthis._$workContainers.screens.interactive = false;\r\n\t\tthis._$workContainers.screens.interactiveChildren = false;\r\n\r\n\t\tthis._$workContainers.spaces = new PIXI.Container();\r\n\t\tthis._$workContainers.spaces.interactive = false;\r\n\t\tthis._$workContainers.spaces.interactiveChildren = false;\r\n\t\r\n\t\tthis._$pixi.stage.addChild(\r\n\t\t\tthis._$backgroundContainer, \r\n\t\t\tthis._$homeContainer, \r\n\t\t\tthis._$workContainers.spaces,\r\n\t\t\tthis._$workContainers.screens,\r\n\t\t);\r\n\r\n\t}\r\n\r\n\t//Hi-res assets should not be loaded onto mobile, so add  logic here \r\n\t//Also may need to load low res onto Android devices: \r\n\tprivate _getPixiResolution(): number {\r\n\t\tlet resolution = window.devicePixelRatio || 1; \r\n\t\t//resolution = 2.0;\r\n\t\t//let resolution = (window.innerWidth < 900) ? 0.5 : 1.0;\r\n\t\treturn resolution;\r\n\t}\r\n\r\n}\r\n","import {Controller} from 'debugbase/abstract/Controller';\r\nimport {UIController} from 'app/controller/UIController';\r\nimport {SectionType, DepartmentType, PixiResourceType, InfoSectionType, ViewType} from 'app/data/Enums';\r\nimport {Events} from 'debugbase/events/Events';\r\nimport {CoreEvents} from 'debugbase/events/CoreEvents';\r\nimport {ImageLoader} from 'debugbase/loader/ImageLoader';\r\nimport {ImageSequenceLoader} from 'debugbase/loader/ImageSequenceLoader';\r\nimport {HTMLLoader} from 'debugbase/loader/HTMLLoader';\r\nimport {JSONLoader} from 'debugbase/loader/JSONLoader';\r\n\r\nimport {LoaderGroup} from 'debugbase/loader/LoaderGroup';\r\nimport {PixiLoader} from 'debugbase/loader/PixiLoader';\r\n\r\nimport {HistoryStateModel} from 'app/model/HistoryStateModel';\r\nimport {LoaderGraphic} from 'app/module/global/LoaderGraphic';\r\nimport {AppEvents} from 'app/data/AppEvents';\r\n\r\nimport {PixiResourceLoadEvent} from 'app/event/PixiResourceLoadEvent';\r\nimport {ViewReadyEvent} from 'app/event/ViewReadyEvent';\r\nimport {AjaxHTMLLoadedEvent} from 'app/event/AjaxHTMLLoadedEvent';\r\nimport {JSONLoadEvent} from 'app/event/JSONLoadEvent';\r\n\r\ninterface HTMLLoadingConfig {\r\n\tsection: string; \r\n\tpath: string; \r\n\tselector?: string;\r\n}\r\n\r\nexport class PreloadController extends Controller {\r\n\r\n\tpublic groupLoadDelay: number = 20;\t\t\t//Set to larger throttle to simulate slow connections\r\n\r\n\tprivate _openingPreloaderCreated: boolean = false;\r\n\tprivate _openingPreloadComplete: boolean = false;\r\n\tprivate _openingMinTimePassed: boolean = false;\r\n\tprivate _workParticlesLoaded: boolean = false;\r\n\r\n\tprivate _section: SectionType = SectionType.HOME;\r\n\tprivate _subsection: string;\r\n\tprivate _department: DepartmentType = DepartmentType.SCREENS;\t\t//The department type that its opened on (i.E /spaces/ OR /screens/)\r\n\r\n\tprivate _loaderGroups: Array<LoaderGroup> = [];\r\n\tprivate _loaderGroupIndex: number = 0;\r\n\r\n\tprivate _waitForGroupId: string;\r\n\tprivate _waitingForView: ViewType;\r\n\tprivate _historyStateTimeoutId: number;\r\n\r\n\tprivate _HTMLTemplates: any = {};\r\n\tprivate _loaderGraphic: LoaderGraphic;\r\n\r\n\tprivate _uiController: UIController;\r\n\r\n\tprivate readonly _htmlUrls: Array<HTMLLoadingConfig> = [\r\n\t\t{section: 'home', path: '/', selector: '.home'},\r\n\t\t//Work section: \r\n\t\t{section: 'screens', path: '/screens/', selector: '.work.-screens'},\r\n\t\t{section: 'spaces', path: '/spaces/', selector: '.work.-spaces'},\r\n\t\t//Info:\r\n\t\t{section: 'about', path: '/about/', selector: '.info__subsection.-about'},\r\n\t\t{section: 'studio', path: '/studio/', selector: '.info__subsection.-studio'},\r\n\t\t{section: 'jobs', path: '/jobs/', selector: '.info__subsection.-jobs'},\r\n\t\t{section: 'contact', path: '/contact/', selector: '.info__subsection.-contact'},\r\n\t];\r\n\r\n\tpublic setControllers(ui: UIController): void {\r\n\t\tthis._uiController = ui;\r\n\t}\r\n\r\n\t/** Set intial state: */\r\n\tpublic setIntialState(state: HistoryStateModel): void {\r\n\t\tthis._section = state.section;\r\n\t\tthis._subsection = state.subsection;\r\n\t}\r\n\t\t\r\n\t/** Show the view */\r\n\tpublic show(): void {\r\n\t\tgsap.TweenMax.to(this.container, 0.2, {autoAlpha: 1});\r\n\t\tthis._loaderGraphic.animateIn();\r\n\t}\r\n\r\n\t/** Loading is completed so hide: */\r\n\tpublic hide(): void {\r\n\t\t//this.container.style.display = 'none';\r\n\t\tgsap.TweenMax.to(this.container, 0.5, {autoAlpha: 0, delay: 0.4, ease: gsap.Power0.easeNone});\r\n\t\tthis._uiController.show();\r\n\t\tif (this._loaderGraphic) {\r\n\t\t\tthis._loaderGraphic.animateOut();\r\n\t\t}\r\n\t}\r\n\r\n\tpublic DOMReady(): void {\r\n\t\t\r\n\t\t//Section is set as soon as the app via URL routing: \r\n\t\tif (!this._openingPreloaderCreated) {\r\n\t\t\tthis._setPreloader();\r\n\t\t\tthis._createOpeningTimer();\r\n\t\t\tthis._openingPreloaderCreated  = true;\r\n\t\t}\r\n\r\n\t}\r\n\r\n\tpublic modulesMounted(): void {\r\n\t\tif (!this._loaderGraphic) {\r\n\t\t\tthis._loaderGraphic = (this.module.get('preload-graphic') as LoaderGraphic);\r\n\t\t}\r\n\t}\r\n\r\n\t//Set a loaded HTML template: \r\n\tpublic setHTML(section: string, element: Element): void {\r\n\t\telement.innerHTML = this._HTMLTemplates[section];\r\n\t}\r\n\r\n\t/** Show a quick loader to cover over history state changes. When complete triggers an event that is picked up in AppController */\r\n\tpublic showDeepLinkLoader(activeController: Controller): void {\r\n\r\n\t\tthis.show();\r\n\t\t\r\n\t\t//Test \r\n\t\tclearTimeout(this._historyStateTimeoutId);\r\n\t\tthis._historyStateTimeoutId = setInterval(() => {\r\n\t\t\tif ( (activeController as any).readyForDeeplink() ) {\r\n\t\t\t\tclearTimeout(this._historyStateTimeoutId);\r\n\t\t\t\tEvents.dispatch(AppEvents.DEEP_LINK_LOADER_COMPLETE);\r\n\t\t\t\tthis.hide();\r\n\t\t\t} \r\n\t\t}, 1000);\r\n\r\n\t}\r\n\r\n\t/** View is loaded, setup and ready to show */\r\n\tpublic viewReady(event: ViewReadyEvent): boolean {\r\n\r\n\t\tif (event.view === this._waitingForView) {\r\n\t\t\treturn true;\r\n\t\t}\r\n\r\n\t\treturn false;\r\n\r\n\t}\r\n\r\n\t//Loaders \r\n\t//(Maybe these should be automated through attributes)\r\n\t//-------------------------------------------------------------------------\r\n\r\n\tprivate _setPreloader(): void {\r\n\r\n\t\t//Use this ID to flag the intial load is ready\r\n\t\tthis._waitForGroupId = this._section.toString();\r\n\r\n\t\tif (this._section === SectionType.HOME) {\r\n\t\t\tthis._waitingForView = ViewType.HOME;\r\n\t\t\tthis._createHomeLoadOrder();\r\n\t\t} else if (this._section === SectionType.INFO) {\r\n\t\t\tthis._waitingForView = ViewType.INFO;\r\n\t\t\tthis._createInfoLoadOrder();\r\n\t\t} else if (this._section === SectionType.WORK) {\r\n\t\t\tthis._waitingForView = (this._subsection === DepartmentType.SCREENS) ? ViewType.SCREENS : ViewType.SPACES;\r\n\t\t\tthis._createWorkLoadOrder(this._subsection as DepartmentType);\r\n\t\t} else if (this._section === SectionType.PROJECT) {\r\n\t\t\tthis._waitingForView = ViewType.PROJECT;\r\n\t\t\tthis._createProjectLoadOrder(this._subsection as DepartmentType);\r\n\t\t}\r\n\r\n\t\t//Set the first load group to the 'waitId', (which will be screens/spaces)\r\n\t\tthis._loaderGroups[0].id = this._waitForGroupId;\r\n\r\n\t\t//Start primary group loading \r\n\t\tthis._loaderGroups[0].load();\r\n\r\n\t}\r\n\r\n\t/** Create an opening timer so intial preload does get caught in cache loading, which will look a bit rough an ready on */\r\n\tprivate _createOpeningTimer(): void {\r\n\t\tsetTimeout( () => {\r\n\t\t\tthis._openingMinTimePassed = true;\r\n\t\t\tthis._testOpeningComplete();\r\n\t\t}, 2000);\r\n\t}\r\n\r\n\t/** Test if the opening is 10% complete (timer and content loading) */\r\n\tprivate _testOpeningComplete(): void {\t\r\n\t\t\r\n\t\tif (!this._openingMinTimePassed || !this._openingPreloadComplete) {\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\t//Hide this \r\n\t\t//this.hide(); \r\n\t\t//Flag loaded event\r\n\t\t//Delay to allow the pixi loading to complete\r\n\t\tsetTimeout( () => Events.dispatch(AppEvents.INTIAL_PRELOAD_COMPLETE), 100);\r\n\r\n\t}\r\n\r\n\t/** Create Home loader - User is at / on top level */ \r\n\tprivate _createHomeLoadOrder(): void {\r\n\t\t\r\n\t\t//1.) Load backgrounds, PIXI home particles, moth, etc so home can be shown:\r\n\t\tthis._loaderGroups.push( this._createHomeLoaderGroup(true));\r\n\t\t\r\n\t\t//2.) Create a secondary loader group to load all supporting HTML required: \r\n\t\t//This will include about and both work sections \r\n\t\t//WHen returned the HTML will be send to the controller which can store ready to set when needed\r\n\t\tthis._loaderGroups.push( this._createHTMLLoaderGroup(['/about/', '/studio/', '/jobs/', '/contact/', '/screens/', '/spaces/']) );\r\n\r\n\t\t//3.) Load the work level (Fullscreen images and background )\r\n\t\t//If /spaces/ is set then piortise that content \r\n\t\tthis._createWorkSectionsLoader();\r\n\r\n\t}\r\n\r\n\t/** Load all item required to start on the main homepage */\r\n\tprivate _createHomeLoaderGroup(loadMainBackgrounds: boolean = false): LoaderGroup {\r\n\r\n\t\tlet textureSize: string = (window.innerWidth < 900) ? '@0.5' : '@1.0';\r\n\r\n\t\tlet pixiLoader = new PixiLoader();\r\n\t\tpixiLoader.resources = [ \r\n\t\t\t//{ref: 'home-particles', path: `/img/home/spritesheet/home-particles${textureSize}.json`, isSpriteSheet: true},\r\n\t\t\t{ref: 'home-particles', path: `/img/home/spritesheet/home-particles.json`, isSpriteSheet: true},\r\n\t\t];\r\n\r\n\t\t//If the loader group intial load then backgrounds will be needed:\r\n\t\tif (loadMainBackgrounds) {\r\n\t\t\tpixiLoader.resources.push({\r\n\t\t\t\tref: 'main-backgrounds', \r\n\t\t\t\t//path: `/img/home/spritesheet/main-backgrounds${textureSize}.json`,\r\n\t\t\t\tpath: `/img/home/spritesheet/main-backgrounds.json`,\r\n\t\t\t\tisSpriteSheet: true\r\n\t\t\t});\r\n\r\n\t\t\tpixiLoader.resources.push({ref: 'moth', path: `/img/home/spritesheet/moth.json`, isSpriteSheet: true});\r\n\t\t\t\r\n\t\t}\r\n\r\n\t\tpixiLoader.id = 'pixi-home';\r\n\t\tpixiLoader.onResourcesReady = this._onPixiLoaderReady.bind(this);\r\n\r\n\t\t//JSON config for home \r\n\t\tlet jsonLoader = new JSONLoader();\r\n\t\tjsonLoader.url = '/json/home.json';\r\n\t\tjsonLoader.id = 'json-home';\r\n\t\tjsonLoader.onComplete = this._onJSONLoaderReady.bind(this);\r\n\r\n\t\tlet loaderGroup = new LoaderGroup();\r\n\t\tloaderGroup.add(jsonLoader, pixiLoader);\r\n\t\tloaderGroup.onComplete = this._onLoaderGroupComplete.bind(this);\r\n\t\tloaderGroup.onProgress = this._onLoaderGroupProgress.bind(this);\r\n\t\tloaderGroup.load(); \r\n\r\n\t\treturn loaderGroup;\r\n\t\t\r\n\t}\r\n\r\n\t/**\r\n\t* Create Info Loader order\r\n\t* @param {DepartmentType}\r\n\t*/ \r\n\tprivate _createWorkLoadOrder(department: DepartmentType): void {\r\n\t\t\r\n\r\n\t\t//1.) Load the assets and HTML for the work section: \r\n\t\tthis._createWorkSectionsLoader(department, true);\r\n\t\r\n\t\t//2.) Load all the essential HTML \r\n\t\tlet departmentURL: string = (department === DepartmentType.SCREENS) ? '/spaces/' :  '/screens/';\r\n\t\tthis._loaderGroups.push( this._createHTMLLoaderGroup(['/', '/about/', '/studio/', '/jobs/', '/contact/', departmentURL]) );\r\n\r\n\t\t//3.) Load Home PIXI content for home \r\n\t\tthis._loaderGroups.push( this._createHomeLoaderGroup(false) );\r\n\r\n\t\t//4.) Load the PIXI content for the other work section \r\n\t\tlet otherWorkSection = (department === DepartmentType.SCREENS) ? DepartmentType.SPACES : DepartmentType.SCREENS;\r\n\t\tconsole.log('otherWorkSection', otherWorkSection);\r\n\t\tthis._createWorkSectionsLoader(otherWorkSection, false);\r\n\r\n\t}\r\n\r\n\t/** Create work / section loader */\r\n\tprivate _createWorkSectionsLoader(department: DepartmentType = null, loadMainBackgrounds: boolean = false): void {\r\n\t\t\r\n\t\t//PIXI JS elements --------------------------------------------------------\r\n\t\tif (!department || department === DepartmentType.SPACES) {\r\n\t\t\tthis._loaderGroups.push( this._createWorkLoaderGroup(DepartmentType.SPACES, null, loadMainBackgrounds));\r\n\t\t\t//only need to load the backgrounds once, so if here then can flag to false: \r\n\t\t\tloadMainBackgrounds = false;\r\n\t\t}\r\n\t\tif (!department || department === DepartmentType.SCREENS) {\r\n\t\t\tthis._loaderGroups.push( this._createWorkLoaderGroup(DepartmentType.SCREENS, null, loadMainBackgrounds));\r\n\t\t}\r\n\r\n\t\t//HTML for every section ---------------------------------------------------\r\n\t\tif (!department || department === DepartmentType.SPACES) {\r\n\t\t\tthis._loaderGroups.push( this._createHTMLLoaderGroup( this._getAllProjectURLs(DepartmentType.SPACES) ) );\r\n\t\t}\r\n\t\tif (!department || department === DepartmentType.SCREENS) {\r\n\t\t\tthis._loaderGroups.push( this._createHTMLLoaderGroup( this._getAllProjectURLs(DepartmentType.SCREENS) ) );\r\n\t\t}\r\n\r\n\t}\r\n\r\n\t/**Create Info Loader order */ \r\n\tprivate _createInfoLoadOrder(): void {\r\n\r\n\t\t//1.) Load all the supporting HTML for site:\r\n\t\tlet HTMLToLoad: Array<string> = ['/', '/screens/', '/spaces/'];\r\n\t\tObject.keys(InfoSectionType).forEach( (key: string) => {\r\n\t\t\tif (InfoSectionType[key].toString() !== this._subsection) {\r\n\t\t\t\tHTMLToLoad.push(`/${InfoSectionType[key].toString()}/`);\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t\t//WHen returned the HTML will be send to the controller which can store ready to set when needed\r\n\t\t//Pass wait so when item loades then page is shown\r\n\t\tthis._loaderGroups.push( this._createHTMLLoaderGroup(HTMLToLoad, this._waitForGroupId ) );\r\n\r\n\t\t//2.) Load the homepage structure (pass true to load the background pixi eleemnts as well):\r\n\t\tthis._loaderGroups.push( this._createHomeLoaderGroup(true) );\r\n\r\n\t\t//3.) Load the spaces / screens:\r\n\t\tthis._createWorkSectionsLoader();\r\n\r\n\t}\r\n\r\n\t//Load the essential HTML used across the site: \r\n\t//Note not all HTML is loaded into the DOM straight away \r\n\r\n\t//Create html loader: \r\n\tprivate _createHTMLLoader(id: string, url: string, element: Element = null): HTMLLoader {\r\n\t\tlet layout = (this.system.isPortraitDevice) ? 'mobile' : 'desktop';\r\n\t\tlet loader = new HTMLLoader(); \r\n\t\tloader.id = id;\r\n\t\tloader.url = url + `?headless=1&layout=${layout}`;\r\n\t\tloader.element = element;\r\n\t\tloader.onComplete =  this._onHTMLLoaderComplete.bind(this);\r\n\t\treturn loader;\r\n\t}\r\n\r\n\t/**Load a load page templates (store as varibles so they can ve quickly injected) */\r\n\tprivate _createHTMLLoaderGroup(urls: Array <string>, groupId: string = null): LoaderGroup {\r\n\t\tlet htmlLoaderGroup: LoaderGroup = new LoaderGroup();\r\n\t\thtmlLoaderGroup.id = groupId;\r\n\t\turls.forEach((htmlUrl) => {\r\n\t\t\tlet loader = this._createHTMLLoader(htmlUrl, htmlUrl);\r\n\t\t\thtmlLoaderGroup.add(loader);\r\n\t\t});\r\n\t\thtmlLoaderGroup.onComplete  = this._onLoaderGroupComplete.bind(this);\r\n\t\treturn htmlLoaderGroup;\r\n\r\n\t}\r\n\r\n\t/** Get all project URLS (so HTML can be AJAX loaded) */\r\n\tprivate _getAllProjectURLs(type: DepartmentType): Array<string> {\r\n\t\t\r\n\t\tif (type === DepartmentType.SCREENS) {\r\n\t\t\treturn ['/screens/march-for-giants/', '/screens/market-masters/', '/screens/toy-town/', '/screens/toy-store/', '/screens/total-darkness/'];\r\n\t\t}\telse if (type === DepartmentType.SPACES) {\r\n\t\t\treturn ['/spaces/ready-player-one/', '/spaces/anish-kapoor-into-yourself-fall/'];\r\n\t\t}\r\n\r\n\t\treturn [];\r\n\r\n\t}\r\n\r\n\t//Site is deep loaded to work so do that preloading: \r\n\t//TODO and mobile switch and \r\n\tprivate _createWorkLoaderGroup(type: DepartmentType, groupId: string = null, loadMainBackgrounds: boolean = false): LoaderGroup {\r\n\t\t\r\n\t\tlet resources: Array<any>;\r\n\t\tlet id: string;\r\n\t\tlet jsonPath: string = `/json/${type}.json`;\r\n\t\tlet jsonId: string = `json-${type}`;\r\n\r\n\t\tlet textureSize: string = (window.innerWidth < 900) ? '@0.5' : '@1.0';\r\n\r\n\t\tif (type === DepartmentType.SCREENS) {\r\n\t\t\tresources = [{\r\n\t\t\t\tref: 'work-background-screens', \r\n\t\t\t\tpath: `/img/work/spritesheet/work-backgrounds-screens${textureSize}.json`, \r\n\t\t\t\tisSpriteSheet: true\r\n\t\t\t}];\r\n\t\t\tid = 'pixi-screens';\r\n\r\n\t\t}\telse {\r\n\t\t\tresources = [{\r\n\t\t\t\tref: 'work-background-spaces', \r\n\t\t\t\tpath: `/img/work/spritesheet/work-backgrounds-spaces${textureSize}.json`, \r\n\t\t\t\tisSpriteSheet: true\r\n\t\t\t}];\r\n\t\t\tid = 'pixi-spaces-particles';\r\n\t\t}\r\n\r\n\t\t//If the loader group intial load then backgrounds will be needed:\r\n\t\t//Also as the paticles are shared then load those as well\r\n\t\tif (loadMainBackgrounds) {\r\n\t\t\tresources.push({\r\n\t\t\t\tref: 'main-backgrounds', \r\n\t\t\t\tpath: `/img/home/spritesheet/main-backgrounds${textureSize}.json`, \r\n\t\t\t\tisSpriteSheet: true\r\n\t\t\t});\t\t\t\t\t\t\r\n\t\t}\r\n\r\n\t\t//As the partciles spritesheets are shared across items them \r\n\t\tif (!this._workParticlesLoaded) {\r\n\t\t\tresources.push({\r\n\t\t\t\tref: 'work-particles', \r\n\t\t\t\tpath: `/img/work/spritesheet/work-particles${textureSize}.json`, \r\n\t\t\t\tisSpriteSheet: true\r\n\t\t\t} );\r\n\t\t\tthis._workParticlesLoaded = true;\r\n\t\t}\r\n\r\n\t\tlet pixiLoader = new PixiLoader();\r\n\t\tpixiLoader.resources = resources;\r\n\t\tpixiLoader.id = id;\r\n\t\tpixiLoader.onResourcesReady = this._onPixiLoaderReady.bind(this);\r\n\r\n\t\tlet jsonLoader = new JSONLoader();\r\n\t\tjsonLoader.url = jsonPath;\r\n\t\tjsonLoader.id = jsonId;\r\n\t\tjsonLoader.onComplete = this._onJSONLoaderReady.bind(this);\r\n\r\n\t\tlet loaderGroup = new LoaderGroup();\r\n\t\tloaderGroup.id  = groupId; \r\n\t\tloaderGroup.add(pixiLoader, jsonLoader);\r\n\t\tloaderGroup.onComplete = this._onLoaderGroupComplete.bind(this);\r\n\t\tloaderGroup.onProgress = this._onLoaderGroupProgress.bind(this);\r\n\t\treturn loaderGroup;\r\n\r\n\t}\r\n\r\n\tprivate _createProjectLoadOrder(department: DepartmentType): void {\r\n\r\n\t\t//Load all the images on a project: \r\n\t\tlet imageLoader = new ImageLoader();\r\n\t\timageLoader.element = document.querySelectorAll('.project img');\r\n\r\n\t\tlet loaderGroup = new LoaderGroup();\r\n\t\tloaderGroup.id  = 'Project'; \r\n\t\tloaderGroup.add(imageLoader);\r\n\t\tloaderGroup.onComplete = this._onLoaderGroupComplete.bind(this);\r\n\t\tloaderGroup.onProgress = this._onLoaderGroupProgress.bind(this);\r\n\t\tthis._loaderGroups.push( loaderGroup );\r\n\r\n\t}\r\n\r\n\t//Site is deep loaded direct to a project: \r\n\tprivate _createProjectLoaderGroup(): LoaderGroup {\r\n\t\tlet loaderGroup: LoaderGroup = new LoaderGroup();\r\n\t\treturn loaderGroup;\r\n\t}\r\n\r\n\t//Loader group progress, used to update the main loader \r\n\tprivate _onLoaderGroupProgress(data, loader) : void {\r\n\t\tif (this._loaderGraphic) {\r\n\t\t\tthis._loaderGraphic.progress(data.ratio);\r\n\t\t}\r\n\t}\r\n\r\n\t//A loader group is complete: \r\n\tprivate _onLoaderGroupComplete(id: string): void {\r\n\t\t\t\r\n\t\tconsole.log(\"_onLoaderGroupComplete\", this._loaderGroups[this._loaderGroupIndex]);\r\n\r\n\t\t//Check if opening preload has been completed \r\n\t\tif (this._waitForGroupId && this._waitForGroupId === id) {\r\n\t\t\tthis._intialGroupLoaded();\r\n\t\t}\r\n\r\n\t\t//Check if there is another loader group to load carry on loading\r\n\t\tthis._loadNextGroup();\r\n\r\n\t}\r\n\r\n\t/** The intial group is loaded so we are ready to show the app: */\r\n\tprivate _intialGroupLoaded(): void {\r\n\r\n\t\t//Project has simple preloading, so can trigger from here on intial load: \r\n\t\tif ( this._waitForGroupId === SectionType.PROJECT) {\r\n\t\t\tEvents.dispatch(new ViewReadyEvent({view: ViewType.PROJECT}), {delay: 1} );\r\n\t\t}\r\n\r\n\t\tthis._waitForGroupId = null;\r\n\t\t//Show the active controller / home / work / about / etc\r\n\t\tthis._openingPreloadComplete = true; \r\n\t\tthis._testOpeningComplete();\r\n\t\r\n\t}\r\n\r\n\t/** If there is a new group qued then load */ \r\n\tprivate _loadNextGroup(): void {\r\n\t\t\r\n\t\tsetTimeout( () => {\r\n\t\t\tthis._loaderGroupIndex += 1; \r\n\t\t\tif ( this._loaderGroupIndex < this._loaderGroups.length ) {\r\n\t\t\t\tthis._loaderGroups[this._loaderGroupIndex].load();\r\n\t\t\t}\r\n\t\t},  this.groupLoadDelay );\r\n\t\t\r\n\t}\r\n\r\n\t//Pixi Loader is ready: \r\n\tprivate _onPixiLoaderReady(loaderId: string, resources: any): void {\r\n\t\t\r\n\t\t//let sheet = PIXI.loader.resources[\"images/spritesheet.json\"];\r\n\t\tif (resources['main-backgrounds']) {\r\n\t\t\tEvents.dispatch(new PixiResourceLoadEvent({\r\n\t\t\t\ttype: PixiResourceType.BACKGROUNDS, \r\n\t\t\t\tresource: resources['main-backgrounds']\r\n\t\t\t}));\r\n\t\t}\r\n\r\n\t\t//Home parallax particles: \r\n\t\tif (resources['home-particles']) {\r\n\t\t\tEvents.dispatch( new PixiResourceLoadEvent({\r\n\t\t\t\ttype: PixiResourceType.HOME_PARTCILES, \r\n\t\t\t\tresource: resources['home-particles']\r\n\t\t\t}));\r\n\t\t}\r\n\r\n\t\t//Home logo morpth is loaded ready: \r\n\t\t/*if (resources['home-logo-morph']) {\r\n\t\t\tEvents.dispatch(new PixiResourceLoadEvent({\r\n\t\t\t\ttype: PixiResourceType.LOGO_MORPH, \r\n\t\t\t\tresource: resources['home-logo-morph']\r\n\t\t\t}));\r\n\t\t}*/\r\n\r\n\t\t//Work partciles: \r\n\t\tif (resources['work-particles']) {\r\n\t\t\tEvents.dispatch(new PixiResourceLoadEvent({\r\n\t\t\t\ttype: PixiResourceType.WORK_PARTICLES, \r\n\t\t\t\tresource: resources['work-particles']\r\n\t\t\t}));\r\n\t\t}\r\n\r\n\t\t//Work backgrounds screen: \r\n\t\tif (resources['work-background-screens']) {\r\n\t\t\tEvents.dispatch(new PixiResourceLoadEvent({\r\n\t\t\t\ttype: PixiResourceType.WORK_BACKGROUNDS_SCREEN, \r\n\t\t\t\tresource: resources['work-background-screens']\r\n\t\t\t}));\r\n\t\t}\r\n\r\n\t\t//Work backgrounds spaces: \r\n\t\tif (resources['work-background-spaces']) {\r\n\t\t\tEvents.dispatch(new PixiResourceLoadEvent({\r\n\t\t\t\ttype: PixiResourceType.WORK_BACKGROUNDS_SPACES, \r\n\t\t\t\tresource: resources['work-background-spaces']\r\n\t\t\t}));\r\n\t\t}\r\n\r\n\t\t//Home parallax particles: \r\n\t\tif (resources['moth']) {\r\n\t\t\tEvents.dispatch( new PixiResourceLoadEvent({\r\n\t\t\t\ttype: PixiResourceType.MOTH, \r\n\t\t\t\tresource: resources['moth']\r\n\t\t\t}));\r\n\t\t}\r\n\r\n\t}\r\n\r\n\t//HTML loader ready:\r\n\tprivate _onHTMLLoaderComplete(id: string, loader: HTMLLoader): void {\r\n\r\n\t\t//If there is no element then store the HTML so it can be set when required: \r\n\t\tEvents.dispatch( new AjaxHTMLLoadedEvent( {loader: loader} )  );\r\n\r\n\t\tif (!loader.element) {\r\n\t\t\tthis._HTMLTemplates[loader.id] = loader.html;\r\n\t\t} else {\r\n\t\t\tEvents.dispatch( CoreEvents.DOM_UPDATED );\r\n\t\t}\r\n\r\n\t\t//Destroy the loader as it's not needed anymore: \r\n\t\tloader.destroy();\r\n\r\n\t}\r\n\r\n\t/** JSON HAS LOADED - fire event\r\n\t* @param {loaderId} loaderId\r\n\t* @param {any} json\r\n\t* @param {JSONLoader} loader\r\n\t*/\r\n\tprivate _onJSONLoaderReady(loaderId: string, json: any, loader: JSONLoader): void {\r\n\t\tEvents.dispatch(new JSONLoadEvent({\r\n\t\t\tid: loaderId, \r\n\t\t\tjson: json\r\n\t\t}));\r\n\t}\r\n\r\n}\r\n","import {GA} from 'debugbase/tracking/GA';\r\nimport {Controller} from 'debugbase/abstract/Controller';\r\nimport {Events} from 'debugbase/events/Events';\r\nimport {AppEvents} from 'app/data/AppEvents';\r\nimport {SectionType, DepartmentType, ProjectSlugType} from 'app/data/Enums';\r\n//import {TimelineMax, TweenMax, Power0, Power3, Back } from 'gsap';\r\n//import {PageDrag} from 'debugbase/util/PageDrag';\r\nimport {HistoryStateModel} from 'app/model/HistoryStateModel';\r\nimport {MouseController} from 'app/controller/MouseController';\r\nimport {ScrollbarController} from 'app/controller/ScrollbarController';\r\nimport {PixiController} from 'app/controller/PixiController';\r\nimport {WorkController} from 'app/controller/WorkController';\r\n\r\nimport {SidePaging} from 'app/module/project/SidePaging';\r\nimport {SidePagingClickEvent} from 'app/event/SidePagingClickEvent';\r\nimport {SidebarChangeEvent} from 'app/event/SidebarChangeEvent';\r\nimport {QueProjectEvent} from 'app/event/QueProjectEvent';\r\n\r\ninterface HTMLRecord {\r\n\turl: string;\r\n\thtml: string;\r\n}\r\n\r\nexport class ProjectController extends Controller {\r\n\r\n\tprivate _active: boolean = false;\r\n\tprivate _isSetup: boolean = false;\r\n\tprivate _DOMStructureSet: boolean = false;\r\n\tprivate _closingProject: boolean = false;\r\n\tprivate _headerVideoPlaying: boolean = true;\r\n\tprivate _headerSized: boolean = false;\r\n\tprivate _queSetProjectHTML : boolean = false;\r\n\r\n\tprivate _$content: HTMLElement;\r\n\tprivate _$close: HTMLElement;\r\n\tprivate _$home: HTMLElement;\r\n\tprivate _$headerVideo: HTMLVideoElement;\r\n\tprivate _$headerSpacer: HTMLElement;\r\n\tprivate _$dynamicContent: HTMLElement;\r\n\tprivate _$loading: HTMLElement;\r\n\r\n\tprivate\t_$headerTitle: HTMLElement;\r\n\tprivate\t_$headerSubtitle: HTMLElement;\r\n\tprivate\t_$headerSkills: HTMLElement;\r\n\tprivate\t_$headerScroll: HTMLElement;\r\n\r\n\tprivate _mouseController: MouseController;\r\n\tprivate _scrollbarController: ScrollbarController;\r\n\tprivate _pixiController: PixiController;\t\r\n\tprivate _spacesController: WorkController;\r\n\tprivate _screensController: WorkController;\r\n\tprivate _activeWorkController: WorkController;\r\n\tprivate _sidePaging: SidePaging;\r\n\r\n\tprivate _activeDepartment: DepartmentType;\r\n\tprivate _activeSlug: ProjectSlugType;\r\n\tprivate _activeHTMLURL: string;\r\n\t\r\n\tprivate _html: Array <HTMLRecord> = [];\r\n\r\n\tprivate _timeouts: any = {};\r\n\tprivate _tweens: any = {};\r\n\tprivate _intervals: any = {};\r\n\r\n\tprivate _state: HistoryStateModel;\r\n\tprivate _oldState: HistoryStateModel;\r\n\tprivate _isDeeplink: boolean;\r\n\r\n\tprivate _innerHeight: number;\r\n\r\n\tpublic init(params: any): void {\r\n\t\t\r\n\t\tconsole.log('params', params);\r\n\r\n\t\t//Set the opening state to the homepage:\r\n\t\tthis._active = true;\r\n\t\tthis._activeSlug = params.project;\r\n\t\tlet projectTtle: string = 'TO SET PROJECT TITLE';\r\n\r\n\t\tlet openingState: HistoryStateModel = {\r\n\t\t\tsection: SectionType.PROJECT,\r\n\t\t\tsubsection: this._activeDepartment,\r\n\t\t\tprojectSlug: this._activeSlug,\r\n\t\t\ttitle: (this._activeDepartment === DepartmentType.SPACES) ? `${projectTtle} | Spaces` : `${projectTtle} | Screens`,\r\n\t\t\thref: `/${this._activeDepartment}/${this._activeSlug}/`,\r\n\t\t};\r\n\t\tEvents.dispatch(AppEvents.SET_INTIAL_STATE, openingState);\r\n\r\n\t\t//Direct link so DOM structure / content will be there on page load: \r\n\t\tthis._DOMStructureSet = true;\r\n\r\n\t}\t\r\n\r\n\t/** Screens route */\r\n\tpublic screens(params: any): void {\r\n\t\tthis._activeDepartment = DepartmentType.SCREENS;\r\n\t\tthis.init(params);\r\n\t}\r\n\r\n\t/** Spaces */\r\n\tpublic spaces(params: any): void {\r\n\t\tthis._activeDepartment = DepartmentType.SPACES;\r\n\t\tthis.init(params);\r\n\t}\r\n\r\n\t//Getters \r\n\t//-------------------------------------------------\r\n\tpublic isReadyToView(state: HistoryStateModel): boolean {\r\n\r\n\t\t//Need to check if HTML is loaded in background\r\n\r\n\t\treturn true;\r\n\t}\r\n\r\n\t//Setters \r\n\t//---------------------------------------------------\r\n\tpublic setControllers(mouse: MouseController, scrollbar: ScrollbarController, pixi: PixiController, screens: WorkController, spaces: WorkController): void {\r\n\t\tthis._mouseController = mouse;\r\n\t\tthis._scrollbarController = scrollbar;\r\n\t\tthis._pixiController = pixi;\r\n\t\tthis._screensController = screens;\r\n\t\tthis._spacesController = spaces;\r\n\t}\r\n\r\n\t//Save a projects HTML to record:  \r\n\tpublic setHTML(url: string, html: string): void {\r\n\t\t\r\n\t\tthis._html.push({url: url, html: html});\r\n\r\n\t\t//If the page is waiting for the HTML to load then \r\n\t\tif (this._queSetProjectHTML && this._activeHTMLURL === url) {\r\n\t\t\tthis._setProjectHTML(url);\r\n\t\t\tthis._queSetProjectHTML = false;\r\n\t\t\t//gsap.TweenMax.to(this._$loading, 0.2, {autoAlpha: 0, ease: gsap.Power0.easeNone, delay: 0.4});\r\n\t\t}\r\n\r\n\t}\r\n\r\n\t//---------------------------------------------------------------------\r\n\t\t//DOMReady: \r\n\tpublic DOMReady(): void {\r\n\t\tthis._addListeners();\r\n\t\tif (this._active) {\r\n\t\t\tthis._setRefs();\r\n\t\t\tthis._createSidePaging();\r\n\t\t}\r\n\t}\r\n\r\n\tpublic resize(): void {\r\n\t\tthis._innerHeight = window.innerHeight;\r\n\t\tthis._matchHeaderToPixi();\r\n\t}\r\n\r\n\tpublic freeze(): void {\r\n\r\n\t\tthis._queSetProjectHTML = false;\r\n\t\tthis._active = false;\r\n\t\tthis._scrollbarController.reset();\r\n\t\tthis._scrollbarController.setActive(false);\r\n\t\tthis._timeouts.freeze = setTimeout( () => this._cleanupAfterFreeze(), 500);\r\n\t\tthis._activeWorkController.freezeFromProjectView();\r\n\r\n\t}\r\n\r\n\tpublic scroll(y: number): void {\r\n\t\tlet ratio = y / (window.innerHeight * 0.55);\r\n\t}\r\n\r\n\tpublic tick() {\r\n\t\tthis._setHeaderVideoVisible();\r\n\t}\r\n\r\n\t/** reset */\r\n\tpublic reset(oldState: HistoryStateModel = null, isDeeplink: boolean = false): void {\r\n\t\t\r\n\t\tthis._queSetProjectHTML  = false;\r\n\t\tthis._oldState = oldState;\r\n\t\tthis._isDeeplink = isDeeplink;\r\n\r\n\t\tif (this._activeProjectIsSetup() ) {\r\n\t\t\tthis._reset();\r\n\t\t}\r\n\r\n\t}\r\n\r\n\t/** Pause when menu is shown */\r\n\tpublic pause(): void {\r\n\t\tgsap.TweenMax.to([this.container], 0.45, {scale: 1.2, ease: gsap.Power3.easeOut});\r\n\t}\r\n\r\n\t/** Pause when menu is hidden */\r\n\tpublic unpause(): void {\r\n\t\tgsap.TweenMax.to([this.container], 0.45, {scale: 1, ease: gsap.Power3.easeOut});\r\n\t}\r\n\r\n\t/** Show the view */\r\n\tpublic show(oldState: HistoryStateModel = null, isDeeplink: boolean = false): void {\r\n\r\n\t\tthis._innerHeight = window.innerHeight;\r\n\r\n\t\tif (this._activeProjectIsSetup() ) {\r\n\t\t\tthis._show();\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\t//HTML is not loaded so can't be setup: \t\t\r\n\t\tthis._isSetup = false;\r\n\r\n\t\t//Need to load the actual project HTML:\r\n\t\tif (!this._active) {\r\n\t\t\tthis._setProjectHTML(this._state.href);\r\n\t\t} else {\r\n\t\t\tthis._setup();\r\n\t\t\tthis._reset();\r\n\t\t\tthis._show();\r\n\t\t}\r\n\r\n\t\tthis._active = true;\r\n\r\n\t}\r\n\r\n\t/** Hide */\r\n\tpublic hide(newState: HistoryStateModel = null): void {\r\n\r\n\t\tthis._timeouts.showScrollbar = setTimeout( () => {\r\n\t\t\tthis._scrollbarController.reset();\r\n\t\t\tthis._scrollbarController.setActive(false);\r\n\t\t}, 700);\r\n\r\n\t\tthis._timeouts.hideView = setTimeout( () => {\r\n\t\t\tthis.DOM.removeClass(this.container, '-active');\r\n\t\t\tthis._closingProject = false;\r\n\t\t}, 1500);\r\n\r\n\t\tthis._hideHeaderVideo();\r\n\r\n\t\tthis._active = false;\r\n\r\n\t}\r\n\r\n\t/** Set active department / slug */\r\n\tpublic setState(state: HistoryStateModel): void {\r\n\t\tthis._state = state;\r\n\t\tthis._activeDepartment = state.subsection as DepartmentType;\r\n\t\tthis._activeSlug = state.projectSlug;\r\n\t\tthis._activeWorkController = (this._activeDepartment === DepartmentType.SCREENS) ? this._screensController : this._spacesController; \r\n\t}\r\n\r\n\t//Private methods: \r\n\t//-------------------------------------------------------------------------------------\r\n\t//-------------------------------------------------------------------------------------\r\n\t//-------------------------------------------------------------------------------------\r\n\t//-------------------------------------------------------------------------------------\r\n\r\n\tprivate _activeProjectIsSetup(): boolean {\r\n\t\treturn (this._state.href === this._activeHTMLURL && this._isSetup);\r\n\t}\r\n\r\n\t/** DOM elements for project should be aviable so  */\r\n\tprivate _setup(): void {\r\n\t\tthis._isSetup = true;\r\n\t}\r\n\t\r\n\tprivate _setRefs(): void {\r\n\t\t//Header buttons \r\n\t\tthis._$close = this.container.querySelector('.project__close');\r\n\t\tthis._$home = this.container.querySelector('.project__home');\r\n\t\t//Main full screen header video\r\n\t\tthis._$headerVideo = this.container.querySelector('.project__video');   \t\r\n\t\t//Content / scroll area\r\n\t\tthis._$content = this.container.querySelector('.project__content'); \r\n\t\tthis._$headerSpacer = this._$content.querySelector('.project__headerspacer'); \r\n\t\tthis._$dynamicContent = this._$content.querySelector('.project__dynamic__content'); \r\n\t\t//Loading panel \r\n\t\tthis._$loading = this.container.querySelector('.project__loading');\r\n\r\n\t\tthis._$headerTitle = this.container.querySelector('.project__intro__title');\r\n\t\tthis._$headerSubtitle = this.container.querySelector('.project__intro__subtitle');\r\n\t\tthis._$headerSkills = this.container.querySelector('.project__intro__skills');\r\n\t\tthis._$headerScroll = this.container.querySelector('.scrolldown-icon');\r\n\t\t\r\n\t\r\n\t}\r\n\r\n\tprivate _createSidePaging(): void {\r\n\t\t\r\n\t\tthis._sidePaging = new SidePaging(this.container.querySelector('.project__sidepaging'), this.DOM);\r\n\t\t\r\n\t\tEvents.on(SidePagingClickEvent, (event: SidePagingClickEvent) => {\r\n\t\t\tthis._scrollbarController.scrollToSelector(event.targetSelector);\r\n\t\t});\r\n\t\t\r\n\t\tEvents.on(SidebarChangeEvent, (event: SidebarChangeEvent) => {\r\n\t\t\tthis._sidePaging.selectIndex(event.index, event.theme);\r\n\t\t});\r\n\r\n\t}\r\n\r\n\tprivate _setSidePagingItems(): void {\r\n\t\tvar items = [];\r\n\t\tthis.container.querySelectorAll('.sidebartarget').forEach((element: HTMLElement) => {\r\n\t\t\titems.push({\r\n\t\t\t\ttargetSelector: `#${element.getAttribute('id')}`,\r\n\t\t\t\tlabel: element.getAttribute('data-sidebar-label'),\r\n\t\t\t});\r\n\t\t});\r\n\t\tthis._sidePaging.create(items);\r\n\t}\r\n\r\n\tprivate _addListeners(): void {\r\n\t\t\r\n\t\t\r\n\t\tEvents.on('click', '.project__close__button', this._onCloseClick.bind(this) );\r\n\t\tEvents.on(QueProjectEvent, this._onQueProject.bind(this) );\r\n\r\n\t\t//WHen orientation size event fires then can resize the header\r\n\t\twindow.addEventListener('orientationchange', () => {\r\n\t \t\t this._headerSized = false;\r\n\t \t\t this.resize();\r\n\t\t});\r\n\r\n\t}\r\n\r\n\tprivate _activateScrollbar(): void {\r\n\t\tthis._scrollbarController.setFocus(this._$content, 0.4);\r\n\t\tthis._scrollbarController.setActive(true);\r\n\t}\r\n\r\n\t/** Set HTML for project */\r\n\tprivate _setProjectHTML(url: string): void {\r\n\r\n\t\tthis._activeHTMLURL = url;\r\n\t\tlet html = this._getSubsectionHTML(this._activeHTMLURL);\r\n\r\n\t\t//If no is no HTML then que \r\n\t\tif (!html) {\r\n\t\t\tthis._queSetProjectHTML = true;\r\n\t\t\t//gsap.TweenMax.to(this._$loading, 0.3, {autoAlpha: 1, ease: gsap.Power0.easeNone, delay: 0.7});\r\n\t\t\tthis.DOM.addClass(this.container, '-active');\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tthis.DOM.setHTML(this._$dynamicContent, html, () => {\r\n\t\t\t\r\n\t\t\tthis.module.destoryByTag('project');\r\n\t\t\tthis._setup();\r\n\t\t\tthis._reset();\r\n\t\t\tthis._show();\r\n\t\t\t\r\n\t\t\tconsole.log('FIX OBSERVER !!!!!!');\r\n\t\t\t(window as any).observer.observe();\r\n\r\n\t\t});\r\n\r\n\t}\r\n\r\n\t/** Get HTML for subsection */\r\n\tprivate _getSubsectionHTML(url: string): string  {\r\n\r\n\t\tlet html: string = null;\r\n\t\tthis._html.forEach( (record: HTMLRecord) => {\r\n\t\t\tif (record.url === url) {\r\n\t\t\t\thtml = record.html;\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t\treturn html;\r\n\r\n\t}\r\n\r\n\t/** Que project up as it's focus on work timeline */\r\n\tprivate _onQueProject(event: QueProjectEvent): void {\r\n\r\n\t\t//If slug is null the exit (As its firts spacer item)\r\n\t\tif (event.slug === null) {\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\t//If DOM contaner for project is not setup yet then add and call the function again: \r\n\t\tif (!this._DOMStructureSet) {\r\n\t\t\tthis.DOM.append(document.querySelector('body'), this._createDOMStructure(), () => {\r\n\t\t\t\tthis.container = document.querySelector('.project');\r\n\t\t\t\tthis._setRefs();\r\n\t\t\t\tthis._createSidePaging();\r\n\t\t\t\tthis._DOMStructureSet = true;\r\n\t\t\t\tthis._onQueProject(event);\r\n\t\t\t});\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\t//Set the video \r\n\t\t//console.log('this._$headerVideo', this._$headerVideo);\r\n\t\tlet source = this._$headerVideo.querySelector('source');\r\n\t\tsource.setAttribute('src', `/video/${event.slug}.mp4`);\r\n\t\t//this._$headerVideo.load();\r\n\r\n\t\t//Set other header / first view infomation outside the main content\r\n\r\n\t}\r\n\r\n\t/** Create DOM structure to inject when needed */\r\n\tprivate _createDOMStructure(): string {\r\n\r\n\t\treturn `<section class='project'>\r\n\t\t\t<a href='/spaces/' class='project__close project__close__button'>Close</a>\r\n\t\t\t<a href='/' class='project__home'></a>\r\n\t\t\t<div class='project__sidepaging'></div>\r\n\r\n\r\n\t      <div class='project__loading'>\r\n\t     \t<h6 class='project__loading__text'>Loading</h6>\r\n\t     \t<h1 class='project__intro__title'>Toy Town</h1>\r\n\t     \t<h1 class='project__intro__subtitle'>7-Hour game for London's<br/>biggest Toy Store</h1>\r\n\t     \t<!--<ul class='project__intro__skills'>\r\n\t     \t\t<li class='-unity'>Unity</li>\r\n\t     \t\t<li class='-design'>Design</li>\r\n\t     \t\t<li class='-ux'>UX</li>\r\n\t     \t</ul>\r\n\t     \t-->\r\n\t     \t<dl class='project__intro__skills'>\r\n\t     \t\t\r\n\t     \t\t<dt>Debug role</dt>\r\n\t     \t\t<dd>Concept, Design & Development</dd>\r\n\t     \t\t<br/>\r\n\t     \t\t<dt>Platforms</dt>\r\n\t     \t\t<dd>Web, Mobile, Billboard</dd>\r\n\t     \t\t<br/>\r\n\t     \t\t<dt>Collaborators</dt>\r\n\t     \t\t<dd><a target='_blank' href='http://www.miura.gi/'>Miura</a></dd>\r\n\r\n\t     \t</dl>\r\n\r\n\t     \t<div class='scrolldown-icon'>\r\n\t     \t\t<p class='label'>Scroll</p>\r\n\t     \t\t<svg width=\"21px\" height=\"53px\" viewBox=\"0 0 21 53\"><style>.style0{fill:#fff;}.style1{stroke:#fff;stroke-width:2.5;stroke-linecap:round;}</style><path d=\"M9.42307692,0.085483871 C4.14615385,0.683391195 0,5.64602199 0,11.684886 L0,28.426291 C0,34.8537948 4.71153846,40.0854839 10.5,40.0854839 C16.2884615,40.0854839 21,34.8537948 21,28.426291 L21,11.684886 C21,5.64602199 16.8538462,0.683391195 11.5769231,0.085483871 L9.42307692,0.085483871 Z M19,28.6278568 C19,33.8448059 15.1887097,38.0854839 10.5,38.0854839 C5.81129032,38.0854839 2,33.8448059 2,28.6278568 L2,11.543111 C2,6.32616184 5.81129032,2.08548387 10.5,2.08548387 C15.1887097,2.08548387 19,6.32616184 19,11.543111 L19,28.6278568 L19,28.6278568 Z\" class=\"style0\"/><path d=\"M10.5,11.9188172 C11.6045695,11.9188172 12.5,11.0233867 12.5,9.9188172 C12.5,8.8142477 11.6045695,7.9188172 10.5,7.9188172 C9.3954305,7.9188172 8.5,8.8142477 8.5,9.9188172 C8.5,11.0233867 9.3954305,11.9188172 10.5,11.9188172 Z\" class=\"style0\"/><g class=\"arrows\"><path d=\"M10.5,23.7903226 L10.5,30.0200975\" class=\"style1 a1\"/><path d=\"M10.5,34.7903226 L10.5,41.0200975\" class=\"style1 a2\"/><path d=\"M10.5,45.6717982 L10.5,51.9015732\" class=\"style1 a3\"/><path d=\"M6 48 L10.5 52 \" class=\"style1 a3\"/><path d=\"M15,48 L10.5,51.9999994\" class=\"style1 a3\"/></g></svg>\r\n\t     \t</div>\r\n\r\n\t     </div>\r\n\r\n\r\n     \t\t<div class='project__video__container'>\r\n\t\t \t \t<video class='project__video' width=\"1920\" height=\"1080\"  muted loop playsinline>\r\n\t\t \t \t\t<source src='' type='video/mp4' />\r\n\t\t \t \t</video>\r\n\t \t \t</div>\r\n    \t \t<div class='project__content'>\r\n    \t \t\t<div class='project__headerspacer'></div>\r\n    \t \t\t<div class='project__dynamic__content'></div>\r\n    \t \t</div>\r\n\t\t</section>`;\r\n\r\n\t}\r\n\r\n\t//Reset functions \r\n\t//-------------------------------------------------------------------\r\n\r\n\tprivate _reset(): void {\r\n\r\n\t\t//Generic reset: \r\n\t\tthis._closingProject = false;\r\n\t\tthis._mouseController.setDragCursorActive(false);\r\n\r\n\t\t//Set the site bar items; \r\n\t\tthis._setSidePagingItems();\r\n\t\tthis._$headerSpacer = this._$content.querySelector('.project__headerspacer'); \r\n\r\n\t\t//Reste scale / Reset scroll of container: \r\n\t\tgsap.TweenMax.set([this.container], {scale: 1});\r\n\t\tthis._$content.style.transform = `translate3d(0,0,0)`;\r\n\r\n\t\t//Resize to ensure elements are at matching scale / sizes \r\n\t\tthis._headerSized = false;\r\n\t\tthis.resize();\r\n\r\n\t\t//Is a deeplink for get ready to show coming direct from Preoader \r\n\t\tif (this._isDeeplink) {\r\n\t\t\tthis._resetForDeeplink();\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tif (this._oldState.section === SectionType.WORK) {\r\n\t\t\tthis._resetFromWork(this._oldState.subsection as DepartmentType);\r\n\t\t}\r\n\r\n\t}\r\n\r\n\t/** Reset from fullscreen loader */\r\n\tprivate _resetForDeeplink(): void {\r\n\r\n\t}\r\n\r\n\t/** Reset from Work section */\r\n\tprivate _resetFromWork(department: DepartmentType): void {\r\n\t\tthis._headerSized = false;\r\n\t}\r\n\r\n\t/** After Freeze hidden to anything that can't be done while showing */\r\n\tprivate _cleanupAfterFreeze(): void {\r\n\t\tthis.DOM.removeClass(this.container, '-active');\r\n\t\tthis.DOM.removeClass(this._$home, '-active');\r\n\t\tthis.DOM.removeClass(this._$home, '-show');\r\n\t\t//gsap.TweenMax.set(this._$loading, {autoAlpha: 0});\r\n\t\tgsap.TweenMax.set([this.container], {scale: 1});\r\n\t\tthis._closingProject = false;\r\n\t\tif (this._$headerVideo) {\r\n\t\t\tthis._$headerVideo.pause();\r\n\t\t}\r\n\t}\r\n\r\n\t//Show functions\r\n\t//--------------------------------------------------------------------\r\n\r\n\tprivate _show(): void {\r\n\t\t\r\n\t\t//Generic show actions: \r\n\t\tthis.DOM.addClass(this.container, '-active');\r\n\t\tthis._timeouts.showScrollbar = setTimeout( () => this._activateScrollbar(), 1000 );\r\n\r\n\t\tif (this._isDeeplink) {\r\n\t\t\tthis._showForDeeplink();\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tif (this._oldState.section === SectionType.WORK) {\r\n\t\t\tthis._showFromWork(this._oldState.subsection as DepartmentType);\r\n\t\t}\r\n\r\n\t}\r\n\r\n\t/** Show from fullscreen preloader */\r\n\tprivate _showForDeeplink(): void {\r\n\r\n\t\t//gsap.TweenMax.fromTo(this._$home, 0.3, {autoAlpha: 0}, {autoAlpha: 1, ease: gsap.Power0.easeNone, delay: 0.6});\r\n\t\tthis.DOM.addClass(this._$home, '-active');\r\n\t\tthis.DOM.addClass(this._$home, '-show');\r\n\r\n\t\tgsap.TweenMax.set(this._$close, {autoAlpha: 0});\r\n\t\t//3.) Show the paging \r\n\t\tthis._sidePaging.show();\r\n\r\n\t\tthis._showHeaderVideo(0.7);\r\n\t\tthis._animateInHeaderContent();\r\n\r\n\t}\r\n\r\n\t/** Animate in the project */\r\n\tprivate _showFromWork(department: DepartmentType): void {\r\n\r\n\t\t//1.) Bring in the page lements / top-video \r\n\r\n\t\t//2.) Show the close button \r\n\t\t//gsap.TweenMax.fromTo(this._$close, 0.3, {autoAlpha: 0}, {autoAlpha: 1, ease: gsap.Power0.easeNone, delay: 0.6});\r\n\t\tthis._timeouts.closeButton = setTimeout( () => {\r\n\t\t\tthis.DOM.addClass(this._$close, '-active');\r\n\t\t\tif ( this._scrollbarController.getScroll() === 0) {\r\n\t\t\t\tthis.DOM.addClass(this._$close, '-show');\r\n\t\t\t}\r\n\t\t}, 2000);\r\n\r\n\t\tgsap.TweenMax.set(this._$home, {autoAlpha: 0});\r\n\t\tthis._showHeaderVideo(0.7);\r\n\t\tthis._animateInHeaderContent();\r\n\r\n\t\t///If mobile then content is visible along bottom\r\n\t\tif (window.innerWidth < 900) {\r\n\t\t\tgsap.TweenMax.fromTo(this._$dynamicContent, 0.5, {y: 200, autoAlpha:1}, {y: 0, autoAlpha: 1, delay: 0.7, ease: gsap.Power3.easeOut});\r\n\t\t}\r\n\r\n\t\t//3.) Show the paging \r\n\t\tthis._sidePaging.show();\r\n\r\n\t}\r\n\r\n\tprivate _animateInHeaderContent(): void {\r\n\t\t\r\n\t\tgsap.TweenMax.fromTo(this._$loading, 0.5, {autoAlpha: 0}, {autoAlpha: 1, delay: 0, ease: gsap.Power0.easeNone});\r\n\t\tgsap.TweenMax.fromTo(this._$headerTitle, 0.5, {y: 20, autoAlpha: 0}, {y: 0, autoAlpha: 1, delay: 0.4, ease: gsap.Power3.easeOut});\r\n\t\tgsap.TweenMax.fromTo(this._$headerSubtitle, 0.5, {y: 20, autoAlpha: 0}, {y: 0, autoAlpha: 1, delay: 0.6, ease: gsap.Power3.easeOut});\r\n\t\tgsap.TweenMax.fromTo(this._$headerSkills, 0.5, {y: 20, autoAlpha: 0}, {y: 0, autoAlpha: 1, delay: 0.8, ease: gsap.Power3.easeOut});\r\n\t\tgsap.TweenMax.fromTo(this._$headerScroll, 0.5, {y: 20, autoAlpha: 0}, {y: 0, autoAlpha: 1, delay: 1.8, ease: gsap.Power3.easeOut});\r\n\t\t\r\n\t\t//this._$headerTitle = this.container.querySelector('.project__intro__title');\r\n\t\t//this._$headerSubtitle = this.container.querySelector('.project__intro__subtitle');\r\n\t\t//this._$headerSkills = this.container.querySelector('.project__intro__skills');\r\n\t}\r\n\r\n\t/** Show and play the fullscreen header video */\r\n\tprivate _showHeaderVideo(delay: number = 0): void {\r\n\r\n\t\tthis._headerSized = false;\r\n\t\tthis._$headerVideo.load();\r\n\t\tgsap.TweenMax.fromTo(this._$headerVideo, 0.3, {autoAlpha: 0}, {\r\n\t\t\tautoAlpha: 1,\r\n\t\t\tease: gsap.Power0.easeNone,\r\n\t\t\tdelay: delay,\r\n\t\t\tonComplete: () => {\r\n\t\t\t\tthis._$headerVideo.play();\r\n\t\t\t\tthis._headerVideoPlaying = true;\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n\r\n\t/** Pause and hide the header video when transiting back to project */\r\n\tprivate _hideHeaderVideo(delay: number = 0): void {\r\n\t\tthis._$headerVideo.pause();\r\n\t\tgsap.TweenMax.to(this._$headerVideo, 0.3, {autoAlpha: 0, ease: gsap.Power0.easeNone, delay: delay});\r\n\t\t//Reset spacer reference = null\r\n\t\tthis._$headerSpacer = null;\r\n\t}\r\n\r\n\t//----------------------------------------------------------------------------\r\n\r\n\t/** \r\n\t* Close button click \r\n\t* @param {MouseEvent} event\r\n\t*/\r\n\tprivate _onCloseClick(event: MouseEvent): boolean {\r\n\t\t\r\n\t\tevent.preventDefault();\r\n\t\tif (this._closingProject) {\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tGA.event('UX', 'Close project button', window.location.pathname);\r\n\r\n\t\t//Flag close to stop repeating -------------------------------\r\n\t\tthis._closingProject = true;\r\n\t\tlet eventDelay: number = 0.3;\r\n\r\n\t\t//If there is any scroll then whip the project up and delay the change section event: \r\n\t\tif ( this._scrollbarController.getScroll() > 0 ) {\r\n\t\t\t\r\n\t\t\tsetTimeout( () => {\r\n\t\t\t\tthis._scrollbarController.scrollTo(0);\r\n\t\t\t\tthis._scrollbarController.setPause(true);\r\n\t\t\t}, 300);\r\n\r\n\t\t\teventDelay = 0.7;\r\n\t\t}\r\n\r\n\t\tgsap.TweenMax.to(this._$loading, 0.4, {autoAlpha: 0, delay: 0.4, ease: gsap.Power0.easeNone});\r\n\r\n\t\t///If mobile then content is visible along bottom\r\n\t\tif (window.innerWidth < 900) {\r\n\t\t\tgsap.TweenMax.to(this._$dynamicContent, 0.5, {y: 200, delay: eventDelay, ease: gsap.Power3.easeOut});\r\n\t\t}\r\n\r\n\t\t//Animate out close button  ------------------------------------------\r\n\t\t//gsap.TweenMax.to(this._$close, 0.3, {autoAlpha: 0, ease: gsap.Power0.easeNone});\r\n\t\tthis.DOM.removeClass(this._$close, '-active');\r\n\t\tthis.DOM.removeClass(this._$close, '-show');\r\n\t\tthis._sidePaging.hide();\r\n\r\n\t\t//Fire section change event -------------------------------------------\r\n\t\tlet newState: HistoryStateModel = {\r\n\t\t\tsection: SectionType.WORK,\r\n\t\t\tsubsection: this._activeDepartment,\r\n\t\t\ttitle: (this._activeDepartment === DepartmentType.SCREENS) ? 'Screens' : 'Spaces',\r\n\t\t\thref: `/${this._activeDepartment}/`,\r\n\t\t};\r\n\t\tEvents.dispatch(AppEvents.CHANGE_SECTION, newState, {delay: eventDelay});\r\n\r\n\t\treturn false;\r\n\r\n\t}\r\n\r\n\t/** Match Header video to the PIXI tile */\r\n\tprivate _matchHeaderToPixi(): void {\r\n\r\n\t\tif (!this._$headerVideo || !this._$headerSpacer || this._headerSized) {\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\t//1.) Get the size from the active tile. \r\n\t\t//Then just match width. The position is sorted via CSS transfrom and the \r\n\t\t//let rect = null;\r\n\t\t//let rect: any =\tthis._pixiController.getProjectHeaderSize();\r\n\r\n\t\t//If there no valid rect then project has probably been displayed from a deeplink:\r\n\t\t//TODO replace 'video sizes';\r\n\r\n\t\tlet videoSize = {width: 1920, height: 1080};\r\n\t\tlet containerSize = {width: window.innerWidth, height: window.innerHeight};\r\n\r\n\t\tif (!this._headerSized  || window.innerWidth >= 900) {\r\n\t\t\t\t\r\n\t\t\t(document.querySelector('.project__video__container') as HTMLElement).style.height = `${window.innerHeight * 1.0}px`;\r\n\t\t\r\n\t\t\t//If on mobile then header video is 100% height + width\r\n\t\t\t//Otherwise the spacer will be set to a fixed aspect ratio based on width (so it won't jank on mobile resize)\r\n\t\t\tif (window.innerWidth >= 900) {\r\n\t\t\t\t//containerSize = {width: window.innerWidth, height: window.innerHeight};\r\n\t\t\t\tthis._$headerSpacer.style.height = `${window.innerHeight * 1.0}px`;\r\n\t\t\t} \r\n\t\t\r\n\t\t\tlet rect = this.math.getCoverSize(videoSize, containerSize);\r\n\t\t\tthis._$headerVideo.style.width = `${rect.width}px`;\r\n\t\t\tthis._$headerVideo.style.height = `${rect.height}px`;\r\n\r\n\t\t\tthis._headerSized = true;\r\n\r\n\t\t}\r\n\t\r\n\t}\r\n\r\n\tprivate _setHeaderVideoVisible(): void {\r\n\t\tif (this._headerVideoPlaying && this._scrollbarController.getScroll() > this._innerHeight) {\r\n\t\t\tthis._headerVideoPlaying = false;\r\n\t\t\tthis._$headerVideo.pause();\r\n\t\t\tthis._$headerVideo.style.visibility = 'hidden';\r\n\t\t} else if (!this._headerVideoPlaying && this._scrollbarController.getScroll() <= this._innerHeight) {\r\n\t\t\tthis._$headerVideo.play();\r\n\t\t\tthis._$headerVideo.style.visibility = 'visible';\r\n\t\t\tthis._headerVideoPlaying = true;\r\n\t\t}\r\n\t}\r\n\r\n}\r\n","import {Controller} from 'debugbase/abstract/Controller';\r\nimport { Events } from 'debugbase/events/Events';\r\nimport {AppEvents} from 'app/data/AppEvents';\r\nimport {DirectionalKeyType, ScrollerType} from 'app/data/Enums';\r\nimport {ScrollBehaviourManager} from 'app/behaviour/managers/ScrollBehaviourManager';\r\nimport {DebugMouseWheelEvent} from 'app/event/DebugMouseWheelEvent';\r\nimport {DebugKeypressEvent} from 'app/event/DebugKeypressEvent';\r\n\r\nimport * as ResizeSensor from 'css-element-queries/src/ResizeSensor';\r\n//import {TweenMax, Power0, Power3, Back } from 'gsap';\r\n\r\n/** Handles custom scrollbar and vertical dragging */\r\nexport class ScrollbarController extends Controller {\r\n\r\n\tpublic endFlagged: boolean = false;\r\n\r\n\tprivate _scrollerType: ScrollerType;\r\n\tprivate _active: boolean = false;\r\n\tprivate _paused: boolean = false;\r\n\tprivate _dragging: boolean = false;\r\n\tprivate _hideScroller: boolean = true;\r\n\r\n\tprivate _$bar: HTMLElement;\r\n\tprivate _$target: HTMLElement;\r\n\tprivate _$heightTarget: HTMLElement;\r\n\tprivate _innerHeight: number;\r\n\tprivate _barHeight: number; \r\n\tprivate _maxBarScroll: number;\r\n\r\n\tprivate _planeY: number = 0; \r\n\tprivate _planeTargetY: number = 0; \r\n\tprivate _previousY: number = 0;\r\n\tprivate _minBarScroll: number = 0;\r\n\tprivate _maxTargetScroll: number = 0;\r\n\tprivate _easePower: number = 2;\r\n\r\n\t//Scrolling with bar\r\n\tprivate _dragStartClientY: number = 0;\r\n\tprivate _dragStartBarY: number = 0;\r\n\tprivate _barY: number = 0;\r\n\tprivate _eventIds: any = {move: null, up: null};\r\n\r\n\t//Touch scrolling \r\n\tprivate _touchStartY: number = 0;\r\n\r\n\tprivate _direction: number = 0;\r\n\r\n\t//Behaviours \r\n\tprivate _scrollBehaviourManager: ScrollBehaviourManager;\r\n\t\r\n\tpublic init(): void {\r\n\t\tthis._scrollBehaviourManager = new ScrollBehaviourManager();\r\n\t}\r\n\r\n\tpublic resize(): void {\r\n\r\n\t\tif (!this._active) {\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tthis._scrollBehaviourManager.resize();\r\n\t\tthis._setSizing();\r\n\t\tthis._resizeBar(0.3, false);\r\n\r\n\t}\r\n\r\n\t/** Get scroll as ration of max scroll */\r\n\tpublic getProgress(): number {\r\n\t\treturn this._planeY / this._maxTargetScroll;\r\n\t}\r\n\r\n\t/** Get scroll as a 0-1 value */\r\n\tpublic getScroll(): number {\r\n\t\treturn Math.abs(this._planeY);\r\n\t}\r\n\r\n\t/** Get scroll */\r\n\tpublic scrollTo(y: number): void {\r\n\t\t\r\n\t\tif (this._scrollerType === ScrollerType.CUSTOM) {\r\n\t\t\tthis._planeTargetY = this.math.constrain(y,  this._maxTargetScroll, 0);\r\n\t\t\tthis._syncBarToTargetY();\r\n\t\t} else {\r\n\t\t\tlet tweenOb = {scroll: Math.round(Math.abs(this._planeY))};\r\n\t\t\tgsap.TweenMax.to(tweenOb, 0.6, {\r\n\t\t\t\tscroll: 0,\r\n\t\t\t\tease: gsap.Power3.easeInOut,\r\n\t\t\t\tonUpdate: () => {\r\n\t\t\t\t\tthis._planeY = this._planeTargetY = -1 * tweenOb.scroll;\r\n\t\t\t\t\twindow.scrollTo(0, tweenOb.scroll);\r\n\t\t\t\t}\r\n\t\t\t});\r\n\r\n\t\t\t/*window.scrollBy({\r\n\t\t\t  top: 0,\r\n\t\t\t  left: 0,\r\n\t\t\t  behavior: 'smooth'\r\n\t\t\t});*/\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\t/** Scroll to an selector */\r\n\tpublic scrollToSelector(selector: string): void {\r\n\t\tlet element: HTMLElement = this._$target.querySelector(selector);\r\n\t\tlet y: number = this._getElementY(element);\r\n\t\tthis.scrollTo(y);\r\n\t}\r\n\r\n\t/** reset */\r\n\tpublic reset(): void {\r\n\t\tthis.setPause(false);\r\n\t\tthis._barY = this._planeTargetY = this._planeY = this._previousY = 0;\r\n\t}\r\n\r\n\t/** Set pause state (To allow interaction or not) */\r\n\tpublic setPause(pause: boolean): void {\r\n\t\tthis._paused = pause;\r\n\t}\r\n\r\n\t/** Set Active */\r\n\tpublic setActive(active: boolean) : void {\r\n\t\tthis._active = active;\r\n\t\tif (active) {\r\n\t\t\tthis.DOM.addClass(this.container, '-active');\r\n\t\t} else {\r\n\t\t\tthis.DOM.removeClass(this.container, '-active');\r\n\t\t}\r\n\t}\r\n\r\n\tpublic getActive() : boolean {\r\n\t\treturn this._active;\r\n\t}\r\n\r\n\tpublic getDirection(): number {\r\n\t\treturn this._direction;\r\n\t}\r\n\r\n\t/** Focus a new section */\r\n\tpublic setFocus($element: HTMLElement, animateTime: number = 0, $heightTarget: HTMLElement = null): void {\r\n\t\t\r\n\t\tlet reactivateAfterResize: boolean = false;\r\n\t\tthis.endFlagged = false;\r\n\t\tthis._$target = $element;\r\n\t\tthis._$heightTarget = ($heightTarget) ? $heightTarget :  $element;\r\n\t\t\r\n\t\tif (this._$target) {\r\n\t\t\t\r\n\t\t\t//If animating between targets then decative while animation is working: \r\n\t\t\tif (this._active && animateTime !== 0 ) {\r\n\t\t\t\tthis._active = false;\r\n\t\t\t\treactivateAfterResize = true;\r\n\t\t\t}\r\n\r\n\t\t\tthis._barY = this._planeTargetY = this._planeY =  0;\r\n\t\t\tthis._setSizing();\r\n\t\t\tthis._resizeBar(animateTime, reactivateAfterResize);\r\n\r\n\t\t\t//Set the container for the behaviours: \r\n\t\t\tthis._scrollBehaviourManager.setContainer(this._$target);\r\n\r\n\t\t\t//If there are modules that neeed to be created do so: \r\n\t\t\tthis.module.createModulesInTarget(this._$target);\r\n\r\n\t\t\t//this._$heightTarget.addEventListener('resize', this.resize.bind(this));\r\n\r\n\t\t\t//If the sldier is custom type, then track resizing on the actual alement with ResizeSensor class\r\n\t\t\tif (this._scrollerType === ScrollerType.CUSTOM) {\r\n\t\t\t\tvar razor: any = (window as any).ResizeSensor;\r\n\t\t\t\tvar sense = new razor( this._$heightTarget, () => this.resize() );\r\n\t\t\t}\r\n\r\n\t\t} else {\r\n\t\t\tthis._active = false;\r\n\t\t\tthis._planeY = this._barY =  this._planeTargetY = 0;\r\n\t\t\tthis._scrollBehaviourManager.setContainer(null);\r\n\t\t}\r\n\r\n\t}\r\n\r\n\t//** Tick - update scroll position, as there is inernia applied to the planes movement */\r\n\tpublic tick(): void {\r\n\t\t\r\n\t\tif (!this._active) {\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\t//Updatet the y position of scroll panel in occordance\r\n\t\t\r\n\t\tif (this._scrollerType === ScrollerType.CUSTOM && !this._hideScroller) {\r\n\t\t\tthis._updateTargetScroll();\r\n\t\t}\r\n\r\n\t\tthis._scrollBehaviourManager.updateScroll( Math.abs(this._planeY) );\r\n\r\n\t}\r\n\r\n\t/** Scrollbar will always be in global HTML so use DOMReady event to setup */\r\n\tpublic DOMReady(): void {\r\n\r\n\t\tthis._testScrollerType();\r\n\t\tthis._scrollBehaviourManager.setType(this._scrollerType);\r\n\r\n\t\tthis._$bar = this.container.querySelector('.scrollbar__bar');\r\n\r\n\r\n\t\tif (this._scrollerType === ScrollerType.CUSTOM) {\r\n\r\n\t\t\tEvents.on('mousedown', '.scrollbar__bar', this._onBarClick.bind(this));\r\n\t\t\tEvents.on('touchstart',  window, this._onTouchStart.bind(this));\r\n\r\n\t\t\t//Add mouse wheel events: \r\n\t\t\twindow.addEventListener('mousewheel', (e: MouseWheelEvent) => {this._onMouseWheel(e); }, false);\r\n\t\t\twindow.addEventListener('DOMMouseScroll', (e: MouseWheelEvent) => {this._onMouseWheel(e); }, false);\r\n\t\t\t//Add Keyboard events: \r\n\t\t\twindow.addEventListener('keyup', (e: KeyboardEvent) => { this._onKeyPress(e); }, false);\r\n\t\t}\r\n\r\n\t\t//Temp to test \r\n\t\t//this._active = true;\r\n\t\t//this.setFocus(document.querySelector(\"#testscroller\"));\r\n\r\n\t}\r\n\r\n\tpublic scroll(y: number ) {\r\n\t\tif (this._scrollerType === ScrollerType.STANDARD) {\r\n\t\t\tthis._planeY = this._planeTargetY = -1 * y;\t\r\n\t\t\tthis._setDirection();\r\n\t\t}\r\n\t}\r\n\r\n\t//private \r\n\t//____________________________________________________________________________________\r\n\t//____________________________________________________________________________________\r\n\t//____________________________________________________________________________________\r\n\t//____________________________________________________________________________________\r\n\t\r\n\t/** Set sizing after resize of retarget */\r\n\tprivate _setSizing(): void {\r\n\r\n\t\tthis._hideScroller = (this._$heightTarget.clientHeight < this._innerHeight);\r\n\r\n\t\tif (this._hideScroller) {\r\n\t\t\tthis.DOM.removeClass(this.container, '-active');\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tthis._innerHeight = window.innerHeight;\r\n\t\tlet ratio: number = this._innerHeight / this._$heightTarget.clientHeight;\r\n\t\tthis._maxTargetScroll = -1 *  (this._$heightTarget.clientHeight - this._innerHeight);\r\n\t\tthis._barHeight = this._innerHeight * ratio;\r\n\t\tthis._maxBarScroll = (this._innerHeight - this._barHeight) - 20;\r\n\r\n\t\tthis.DOM.addClass(this.container, '-active');\r\n\r\n\t}\r\n\r\n\t/** Resize the bar */\r\n\tprivate _resizeBar(animateTime: number = 0, reactivateAfterResize: boolean = false): void {\r\n\t\tlet completeCallback: any = (reactivateAfterResize) ? () => { this._active = true; } : null; \r\n\t\tgsap.TweenMax.to(this._$bar, animateTime, {y: this._barY, height: this._barHeight, onComplete: completeCallback});\r\n\t}\r\n\r\n\t/** Bar click event */ \r\n\tprivate _onBarClick(e: MouseEvent): void {\r\n\t\t\r\n\t\tif (!this._active || this._paused || this._hideScroller) {\r\n\t\t\treturn; \r\n\t\t}\r\n\r\n\t\r\n\t\tthis._dragStartBarY = this._barY;\r\n\t\tthis._dragStartClientY = e.clientY;\r\n\r\n\t\tthis.DOM.addClass(this.container, '-dragging');\r\n\t\tthis._dragging = true;\r\n\r\n\t\tthis._eventIds.move =  Events.on('mousemove', window, this._onBarDrag.bind(this));\r\n\t\tthis._eventIds.up =  Events.on('mouseup', window, this._onBarRelease.bind(this));\r\n\t\t\r\n\t}\r\n\r\n\t/** On drag of bar update the scroll position */ \r\n\tprivate _onBarDrag(e: MouseEvent): void {\r\n\t   \r\n\t    this._barY =  this.math.constrain(this._dragStartBarY + (e.clientY - this._dragStartClientY), this._minBarScroll, this._maxBarScroll); \r\n\t    gsap.TweenMax.set(this._$bar, {y: this._barY});\r\n\r\n\t    //Set the target Y position of the scroller to move the plane: \r\n\t    this._planeTargetY  =  this._maxTargetScroll * (this._barY /  this._maxBarScroll);\r\n\r\n\t}\r\n\r\n\t//** On release of drag bar */ \r\n\tprivate _onBarRelease(): void {\r\n\t\tEvents.offById(this._eventIds.move, this._eventIds.up);\r\n\t\tthis.DOM.removeClass(this.container, '-dragging');\r\n\t\tthis._dragging = false;\r\n\t}\r\n\r\n\tprivate _onTouchStart(e: TouchEvent): void {\r\n\r\n\t\tconsole.log('Touch start');\r\n\r\n\t\tif (!this._active || this._paused || this._hideScroller) {\r\n\t\t\treturn; \r\n\t\t}\r\n\r\n\t\tthis._dragging = true;\r\n\t\tthis._touchStartY = e.touches[0].clientY;\r\n\t\tthis._easePower = 4;\r\n\t\tthis._eventIds.moveTouch =  Events.on('touchmove', window, this._onTouchMove.bind(this));\r\n\t\tthis._eventIds.moveTouchUp =  Events.on('touchend', window, this._onTouchEnd.bind(this));\r\n\t\t\r\n\t}\r\n\r\n\tprivate _onTouchMove(e: TouchEvent): void {\r\n\t\t//Set the target Y position of the scroller to move the plane: \r\n\t  this._planeTargetY =  this.math.constrain(this._planeTargetY  + (e.touches[0].clientY - this._touchStartY) * 2, this._maxTargetScroll, 0);\r\n\t  this._touchStartY = e.touches[0].clientY;\r\n\r\n\t}\r\n\r\n\tprivate _onTouchEnd(e: TouchEvent): void {\r\n\t\tconsole.log('Touch end');\r\n\t\tEvents.offById(this._eventIds.moveTouch, this._eventIds.moveTouchUp);\r\n\t\tthis._dragging = false;\r\n\t\tthis._easePower = 5;\r\n\t}\r\n\r\n\t/** On Touch start \r\n\r\n\t//** On mouse wheel scrollet */ \r\n\tprivate _onMouseWheel(e): void {\r\n\r\n\t\tif (this._paused) {\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\t//Other controllers will need to use this wheel scroll event \r\n\t\tlet delta: number = Math.max(-1, Math.min(1, (e.wheelDelta || -e.detail)));\r\n\t\t\r\n\t\t//If active or dragging then there is page target that \r\n\t\tif (!this._active || this._dragging || this._hideScroller) {\r\n\t\t\t//If no target then send event as it can used by the scenes that have side parallax scrolling \r\n\t\t\tif (!this._active) {\r\n\t\t\t    Events.dispatch(new DebugMouseWheelEvent({delta: delta}));\r\n\t\t\t}\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tthis._planeTargetY = this.math.constrain( this._planeTargetY + (delta * this._getMouseWheelAmount()) ,  this._maxTargetScroll, 0);\r\n\t\t//Now sync the bar \r\n\t\tthis._syncBarToTargetY();\r\n\r\n\t}\r\n\r\n\tprivate _getElementY(element: HTMLElement): number {\r\n\r\n\t\tif (!element) {\r\n\t\t\ttry {\r\n\t\t\t\tthrow new Error('Target element does not exsist in target conatiner');\r\n\t\t\t} catch (e) {\r\n\t\t\t\tconsole.log(e);\r\n\t\t\t}\r\n\t\t\treturn 0;\r\n\t\t}\r\n\r\n\t\treturn element.offsetTop;\r\n\t}\r\n\r\n\t/** Pickup directional key presses to manage down, pageDown, up, pageUp */ \r\n\tprivate _onKeyPress(e: KeyboardEvent): void {\r\n\r\n\t\tlet key: number  = e.keyCode ? e.keyCode : e.which;\r\n\t\tlet keyType: DirectionalKeyType;\r\n\t\tlet move: number;\r\n\r\n\t\tif ( key === 40 ) {\r\n\t\t\tkeyType = DirectionalKeyType.DOWN;\r\n\t\t} else if ( key === 38 ) {\r\n\t\t\tkeyType = DirectionalKeyType.UP;\r\n\t\t} else if ( key === 34 ) {\r\n\t\t\tkeyType = DirectionalKeyType.PAGE_DOWN;\r\n\t\t}  else if ( key === 33 ) {\r\n\t\t\tkeyType = DirectionalKeyType.PAGE_UP;\r\n\t\t} else if ( key === 39 ) {\r\n\t\t\tkeyType = DirectionalKeyType.RIGHT;\r\n\t\t}  else if ( key === 37 ) {\r\n\t\t\tkeyType = DirectionalKeyType.LEFT;\r\n\t\t} \r\n\r\n\t\t// If this scrollbar is not actually active then dispatch the event to be used in other views (I.E in home/work to move the timeline)\r\n\t\tif ( (!this._active || this._paused || this._hideScroller) && keyType) {\r\n\t\t\tEvents.dispatch(new DebugKeypressEvent({keyType: keyType}) );\r\n\t\t\treturn;\r\n\t\t}\r\n\t\t\r\n\t\tmove = this._getKeyMoveAmount(keyType);\r\n\t\tif (!move) {\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tthis._planeTargetY = this.math.constrain( this._planeTargetY + move,  this._maxTargetScroll, 0);\r\n\t\t//Now sync the bar \r\n\t\tthis._syncBarToTargetY();\r\n\r\n\t}\r\n\r\n\t/**  On drag then update scrolling acordingly */\r\n\tprivate _onPageDrag(): void {\r\n\t\tif (!this._active) {\r\n\t\t\treturn; \r\n\t\t}\r\n\t}\r\n\r\n\t/** Update scroll position of plane */\r\n\tprivate _updateTargetScroll(): void {\r\n\r\n\t\tthis._planeY = this.math.constrain(this._planeY + ((this._planeTargetY - this._planeY ) / this._easePower ), this._maxTargetScroll, 0);\r\n\t\tthis._setDirection();\r\n\r\n\t\twindow.scrollTo(0, Math.round( -1 * (this._planeY) ));\r\n\t\tconsole.log(window.scrollY, this._planeY);\r\n\r\n\t\t//gsap.TweenMax.set(this._$target, {y: Math.round(this._planeY)});\r\n\t}\r\n\r\n\t/** Get a suitable mousewheel scroll amount. Harded to 200 but maybe shoule be based on screen size? **/\r\n\tprivate _getMouseWheelAmount(): number {\r\n\t\treturn 200;\r\n\t}\r\n\r\n\t/** Get a suitable key move amount  **/\r\n\tprivate _getKeyMoveAmount(keyType: DirectionalKeyType): number {\r\n\t\t\r\n\t\t//\r\n\t\tif (keyType === DirectionalKeyType.PAGE_UP || keyType === DirectionalKeyType.PAGE_DOWN) {\r\n\t\t\treturn (keyType === DirectionalKeyType.PAGE_UP) ? this._innerHeight : -1 *  this._innerHeight;\r\n\t\t}\r\n\t\t//Assume up/down key so do mini directional: \r\n\t\tif (keyType === DirectionalKeyType.UP || keyType === DirectionalKeyType.DOWN) {\r\n\t\t\treturn  (keyType === DirectionalKeyType.UP) ? 100 : -100;\r\n\t\t}\r\n\r\n\t\treturn 0;\r\n\r\n\t}\r\n\r\n\t/** Sync the bar to TargetY position -  when scrollweheel or arrrows are used  */\r\n\tprivate _syncBarToTargetY(): void {\r\n\r\n\r\n\r\n\t\tvar ratio: number = this._planeTargetY / this._maxTargetScroll;\r\n\t\tthis._barY = ratio * this._maxBarScroll;\r\n\t\tgsap.TweenMax.to(this._$bar, 0.3, {y: this._barY});\r\n\t}\r\n\r\n\t/** Set direction */\r\n\tprivate _setDirection(): void {\r\n\t\tif ( this._previousY < this._planeY) {\r\n\t\t\tthis._direction = -1;\r\n\t\t} else if (this._previousY > this._planeY) {\r\n\t\t\tthis._direction = 1;\r\n\t\t}\r\n\t\tthis._previousY = this._planeY;\r\n\t}\r\n\r\n\t/** Test the scroller type */\r\n\tprivate _testScrollerType(): void {\r\n\r\n\t\tthis._scrollerType = (window.innerWidth < 1030)  ? ScrollerType.STANDARD : ScrollerType.CUSTOM; \r\n\r\n\t\t//this._scrollerType = ScrollerType.STANDARD;\r\n\t\t//this._scrollerType = ScrollerType.CUSTOM;\r\n\r\n\t\tif ( this._scrollerType === ScrollerType.STANDARD) {\r\n\t\t\tthis.DOM.addClass(document.querySelector('body'), '-standardscroller');\r\n\t\t}\r\n\r\n\t}\r\n\r\n}\r\n","import {GA} from 'debugbase/tracking/GA';\r\nimport {Controller} from 'debugbase/abstract/Controller';\r\nimport {ScrollbarController} from 'app/controller/ScrollbarController';\r\nimport { Events } from 'debugbase/events/Events';\r\nimport {AppEvents} from 'app/data/AppEvents';\r\nimport {MenuStateType, SectionType, InfoSectionType, DepartmentType} from 'app/data/Enums';\r\nimport {InfoController} from 'app/controller/InfoController';\r\nimport {HistoryStateModel} from 'app/model/HistoryStateModel';\r\nimport {UIThemeChangeEvent} from 'app/event/UIThemeChangeEvent';\r\nimport {UIThemeColourType} from 'app/data/Enums';\r\n\r\n//import {TweenMax, Power0, Power3, Back } from 'gsap';\r\n\r\nexport class UIController extends Controller {\r\n\r\n\tprivate _$section: HTMLElement;\r\n\tprivate _$subsection: HTMLElement;\r\n\tprivate _animateInSubsection: boolean = false;\r\n\tprivate _subsection: string;\r\n\tprivate _subsectionTypeIndex: number;\r\n\tprivate _subsectionTypeDirection: number = 1;\r\n\tprivate _uiShowing: boolean = true;\r\n\r\n\tprivate _scrollbarController: ScrollbarController;\r\n\tprivate _state: HistoryStateModel;\r\n\r\n\tpublic init(): void {\r\n\t\tEvents.on(UIThemeChangeEvent, this._onThemeChange.bind(this) );\r\n\t}\r\n\r\n\tpublic setControllers(scrollbar: ScrollbarController): void {\r\n\t\tthis._scrollbarController = scrollbar;\r\n\t}\r\n\r\n\tpublic DOMReady(): void {\r\n\t\t\r\n\t\tthis._$section = this.container.querySelector('.-section');\r\n\t\tthis._$subsection = this.container.querySelector('.-subsection');\r\n\t\t\r\n\t\tEvents.on('click', '.ui__breadcrumb', (e: MouseEvent) => {\r\n\t\t\te.preventDefault();\r\n\t\t\tthis._onBreadcrumbClick(e);\r\n\t\t\treturn false;\r\n\t\t} );\r\n\r\n\t\tEvents.on('click', '.ui__logo__link', (e: MouseEvent) => {\r\n\t\t\te.preventDefault();\r\n\t\t\tEvents.dispatch(AppEvents.DEBUG_LOGO_PRESS);\r\n\t\t\treturn false;\r\n\t\t} );\r\n\r\n\t\tthis.setState(this._state);\r\n\r\n\t}\r\n\r\n\tpublic setNavState(state: MenuStateType): void {\r\n\r\n\t\tif (state  === MenuStateType.OPEN ) {\r\n\t\t\tthis.DOM.addClass(this.container, '-navopen');\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tthis.DOM.removeClass(this.container, '-navopen');\r\n\t}\r\n\r\n\t/** Section has change so set state */\r\n\tpublic setState(state: HistoryStateModel): void {\r\n\r\n\t\tthis._state = state;\r\n\t\tif (!this._$section) {\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tconsole.log('state', state);\r\n\r\n\t\tlet sectionName: string = null;\r\n\t\tlet sectionURL: string;\r\n\t\tlet subSectionName: string = null;\r\n\t\tlet subSectionURL: string;\r\n\r\n\t\t//If state is not home then it should have a breadcrumb showing \r\n\t\tif (state.section === SectionType.PROJECT) {\r\n\r\n\t\t\tsectionName = state.subsection.charAt(0).toUpperCase() + state.subsection.substr(1);\r\n\t\t\tsubSectionName = (state.projectSlug.charAt(0).toUpperCase() + state.projectSlug.substr(1)).replace(new RegExp('-', 'g'), ' ');\r\n\r\n\t\t\tsectionURL = `/${sectionName.toLowerCase()}/`;\r\n\t\t\tsubSectionURL = state.href;\r\n\r\n\t\t} else if (state.section !== SectionType.HOME  ) {\r\n\t\t\tif (state.section === SectionType.INFO || state.section === SectionType.WORK) {\r\n\t\t\t\tsectionName = state.subsection.charAt(0).toUpperCase() + state.subsection.substr(1);\r\n\t\t\t} else {\r\n\t\t\t\tsectionName = (state.section as string).charAt(0).toUpperCase() + (state.section as string).substr(1);\r\n\t\t\t}\r\n\r\n\t\t\tif ( state.section !== SectionType.INFO ) {\r\n\t\t\t\tsectionURL = `/${state.section}/`;\r\n\t\t\t} else {\r\n\t\t\t\tsectionURL = `/${state.subsection}/`;\r\n\t\t\t}\r\n\r\n\t\t} \r\n\t\tthis._setBreadcrumb(this._$section, sectionName, sectionURL);\r\n\r\n\t\t//Set the 2nd subsection breadcrumb: \r\n\t\tif (!subSectionName && state.subsection && state.section !== SectionType.INFO && state.section !== SectionType.WORK ) {\r\n\t\t\tsubSectionName = state.subsection.charAt(0).toUpperCase() + state.subsection.substr(1);\r\n\t\t} \r\n\t\tthis._setBreadcrumb(this._$subsection, subSectionName, subSectionURL);\r\n\r\n\r\n\t\tthis._setHomeClassState();\r\n\r\n\t}\r\n\r\n\t/** Set the section/subsection breadcrumb */\r\n\tprivate _setBreadcrumb($target: HTMLElement, name: string =  null, href: string = null): void {\r\n\t\tif (name) {\r\n\t\t\tthis.DOM.addClass($target, '-show');\r\n\t\t\tthis.DOM.setText($target, name);\r\n\t\t\tif (href) {\r\n\t\t\t\tthis.DOM.setAttribute($target, 'href', href);\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\tthis.DOM.removeClass($target, '-show');\r\n\t\t}\r\n\t}\r\n\r\n\t/** set the -home class if on home */ \r\n\tprivate _setHomeClassState(): void {\r\n\t\t\r\n\t\tif (this._state.section === SectionType.HOME ) {\r\n\t\t\tthis.DOM.addClass(this.container, '-home');\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tthis.DOM.removeClass(this.container, '-home');\r\n\r\n\t}\r\n\r\n\tpublic tick(): void {\r\n\r\n\t\tif (this._animateInSubsection) {\r\n\t\t\t\r\n\t\t\tthis.DOM.setText(this._$subsection, this._subsection.substr(0, this._subsectionTypeIndex));\r\n\t\t\t\r\n\t\t\tif (this._subsectionTypeDirection === 1) {\r\n\t\t\t\tthis._subsectionTypeIndex++;\r\n\t\t\t\tif (this._subsectionTypeIndex === this._subsection.length + 1) {\r\n\t\t\t\t\tthis._animateInSubsection = false; \r\n\t\t\t\t}\r\n\t\t\t} else if (this._subsectionTypeDirection === -1) {\r\n\t\t\t\tthis._subsectionTypeIndex--;\r\n\t\t\t\tif (this._subsectionTypeIndex === -1) {\r\n\t\t\t\t\tthis._animateInSubsection = false; \r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\t\r\n\t\t}\r\n\r\n\t\tthis._testUIVisiblity();\r\n\r\n\t\tif (!this._scrollbarController.endFlagged && this._scrollbarController.getProgress() > 0.95) {\r\n\t\t\tGA.event('Progress', 'End of page reached', window.location.pathname);\r\n\t\t\tthis._scrollbarController.endFlagged = true;\r\n\t\t}\r\n\t\r\n\t}\r\n\r\n\tpublic show(): void {\r\n\t\tgsap.TweenMax.fromTo('.ui__logo__link', 0.6, {autoAlpha: 0, scale: 2}, {scale: 1, autoAlpha: 1, delay: 0.3, ease: gsap.Power3.easeOut });\r\n\t\tgsap.TweenMax.to('.ui__hamburger', 0.4, {x: 0, ease: gsap.Power3.easeOut, delay: 0.3});\r\n\t\tgsap.TweenMax.to('.ui__logo__copy', 0.4, {autoAlpha: 1, ease: gsap.Power3.easeOut, delay: 0.3});\r\n\r\n\t\tthis.setState(this._state);\r\n\r\n\t}\r\n\r\n\tpublic hide(): void {\r\n\t\tgsap.TweenMax.to('.ui__logo__link', 0.4, {scale: 0, autoAlpha: 0, ease: gsap.Power3.easeOut });\r\n\t\tgsap.TweenMax.to('.ui__hamburger', 0.4, {x: 100, ease: gsap.Power3.easeOut });\r\n\t\tgsap.TweenMax.to('.ui__logo__copy', 0.4, {autoAlpha: 0, ease: gsap.Power3.easeOut});\r\n\t}\r\n\r\n\t/** Update scroll */\r\n\tpublic scroll(scrollY: number): void {\r\n\t\t//Need to test if the UI should be hidden (when scrolling)\r\n\t\tthis._testUIVisiblity();\r\n\t}\r\n\r\n\t//PRIVATE \r\n\t//----------------------------------------------------------------------------\r\n\t//----------------------------------------------------------------------------\r\n\t//----------------------------------------------------------------------------\r\n\t//----------------------------------------------------------------------------\r\n\r\n\t/** Logo area breadcrumb click */\r\n\tprivate _onBreadcrumbClick(e: MouseEvent): void {\r\n\t\tif (!this.DOM.hasClass((e.target as Element), '-active') ) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tGA.event('UX', 'Breadcrumb press');\r\n\t\tEvents.dispatch(AppEvents.CLOSE_PROJECT);\r\n\t}\r\n\r\n\t/** On theme change */\r\n\tprivate _onThemeChange(event: UIThemeChangeEvent): void {\r\n\r\n\t\t//TODO - move 'project close logic from this class'\r\n\t\tif (event.theme === UIThemeColourType.DARK) {\r\n\t\t\tthis.DOM.addClass(this.container, '-dark');\r\n\t\t\tthis.DOM.addClass(document.querySelector('.project__close'), '-dark');\r\n\t\t\tthis.DOM.addClass(document.querySelector('.project__home'), '-dark');\r\n\t\t\treturn;\r\n\t\t} \r\n\r\n\t\tthis.DOM.removeClass(this.container, '-dark');\r\n\t\tthis.DOM.removeClass(document.querySelector('.project__close'), '-dark');\r\n\t\tthis.DOM.removeClass(document.querySelector('.project__home'), '-dark');\r\n\t\t\r\n\t}\r\n\r\n\t/** Check if the UI should be shown / hidden based on scroll state */\r\n\tprivate _testUIVisiblity(): void {\r\n\r\n\t\tlet scrollY: number = this._scrollbarController.getScroll();\r\n\t\tlet scrollDirection: number = this._scrollbarController.getDirection();\r\n\r\n\t\t//1.) If showing then check: \r\n\t\t//+ If last direction was down (+1) then \r\n\t\t//- If scroll is moved from top and the \r\n\t\tif ( this._uiShowing && scrollDirection === 1) {\r\n\t\t\tif ( this._testUIHideFromScrollPos(scrollY) ) {\r\n\t\t\t\tthis._setUIVisiblity(false);\r\n\t\t\t}\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\t//2.) If not showing then check\r\n\t\t//- If direction is going back up then show \r\n\t\t//- If outside hide zone on scroller then show\r\n\t\t//- If scrolling is not active then show \r\n\t\t//- If navMenu is open then then show \r\n\t\tif (!this._uiShowing) {\r\n\t\t\tlet isScrollActive: boolean = this._scrollbarController.getActive();\r\n\t\t\tif (scrollDirection === -1 || !this._testUIHideFromScrollPos(scrollY) ||  !isScrollActive) {\r\n\t\t\t\tthis._setUIVisiblity(true);\r\n\t\t\t}\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t}\r\n\r\n\t/** SHow / hide all the UI that is triggered by */\r\n\t//TODO remove Project concerns like close / home button (Or move these UI controller!!)\r\n\tprivate _setUIVisiblity(show: boolean): void {\r\n\t\t\r\n\t\tthis._uiShowing = show;\r\n\r\n\t\tif (this._uiShowing) {\r\n\t\t\tthis.DOM.removeClass(this.container, '-hide');\r\n\t\t\tthis.DOM.addClass(document.querySelector('.project__close'), '-show');\r\n\t\t\tthis.DOM.addClass(document.querySelector('.project__homebutton'), '-show');\r\n\t\t\tthis.DOM.addClass(document.querySelector('#info-paging'), '-scrollshow');\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\t//The UI is hidden so flag this: \r\n\t\tthis.DOM.removeClass(document.querySelector('.project__close'), '-show');\r\n\t\tthis.DOM.removeClass(document.querySelector('.project__homebutton'), '-show');\r\n\t\tthis.DOM.removeClass(document.querySelector('#info-paging'), '-scrollshow');\r\n\t\t\r\n\t\tthis.DOM.addClass(this.container, '-hide');\r\n\r\n\t}\r\n\r\n\t/** Test if scroller is 'hide' zone for the UI elements */\r\n\tprivate _testUIHideFromScrollPos(scrollY: number): boolean {\r\n\t\tlet scrollRatio: number = this._scrollbarController.getProgress();\r\n\t\treturn (scrollY > 100 && scrollRatio < 0.95);\r\n\t}\r\n\r\n}\r\n","import {GA} from 'debugbase/tracking/GA';\r\nimport {Controller} from 'debugbase/abstract/Controller';\r\nimport {MouseController} from 'app/controller/MouseController';\r\nimport {PixiController} from 'app/controller/PixiController';\r\nimport {BackgroundController} from 'app/controller/BackgroundController';\r\nimport {Events} from 'debugbase/events/Events';\r\nimport {AppEvents} from 'app/data/AppEvents';\r\nimport {DepartmentType, SectionType, ProjectSlugType, ViewType, DirectionalKeyType} from 'app/data/Enums';\r\nimport { DragBreakpoints, axisType} from 'debugbase/util/DragBreakpoints';\r\nimport {Paging} from 'app/module/global/Paging';\r\nimport {HitArea} from 'app/module/global/HitArea';\r\n\r\nimport * as fastdom from 'fastdom';\r\n\r\nimport {WorkTilePixi} from 'app/module/work/WorkTilePixi';\r\n\r\nimport {ViewReadyEvent} from 'app/event/ViewReadyEvent';\r\nimport {DebugMouseWheelEvent} from 'app/event/DebugMouseWheelEvent';\r\nimport {DebugKeypressEvent} from 'app/event/DebugKeypressEvent';\r\nimport {QueProjectEvent} from 'app/event/QueProjectEvent';\r\n\t\r\nimport {HistoryStateModel} from 'app/model/HistoryStateModel';\r\nimport {WorkJSONModel} from 'app/model/WorkJSONModel';\r\nimport {ProjectJSONModel} from 'app/model/ProjectJSONModel';\r\n\r\nexport class WorkController extends Controller {\r\n\r\n\tprivate _state: HistoryStateModel;\r\n\t\r\n\tprivate _active:  boolean = false;\r\n\tprivate _readyToSetup: boolean = false;\t\t\t//Is ready to view. So can be setup for viewing oif required\r\n\tprivate _isSetup: boolean = false;\t\t\t\t//Is setup up ready to view\r\n\tprivate _isHTMLInjected: boolean = false;\t\t//Flag to stop the HTML inject action trigering twice\r\n\tprivate _htmlInjectionQeued: boolean = false;\t//Flagged when the view is required but not ready to setup\r\n\tprivate _homeViewReady: boolean = false;\t\t//Flagged when home loads \r\n\tprivate _canShowBack: boolean = false;\r\n\tprivate _backToHomeIsVisible: boolean = false;\r\n\r\n\tprivate _department: DepartmentType; \r\n\r\n\tprivate _html: string;\r\n\tprivate _json: WorkJSONModel;\r\n\tprivate _actualProgress: number;\r\n\tprivate _innerWidth: number;\r\n\r\n\t//Tile vars: \r\n\tprivate _tiles: Array<WorkTilePixi>;\r\n\tprivate _tileRatioShare: number;\r\n\tprivate _tileProgress: number;\r\n\tprivate _reduce: number;\r\n\tprivate _step: number;\r\n\tprivate _finalStep: number;\r\n\tprivate _loadFlags: any = {pixi: false, dom: false, json: false};\r\n\r\n\tprivate _$intro: HTMLElement;\r\n\tprivate _$backButton: HTMLElement;\r\n\r\n\tprivate _paging: Paging;\r\n\tprivate _pagingGuideActive: boolean = false;\r\n\tprivate _focusedIndex: number = 0;\r\n\r\n\tprivate _tileBreakpoints: DragBreakpoints;\r\n\tprivate _activeProjectTile: WorkTilePixi;\r\n\tprivate _activeProjectIndex: number = 0;\r\n\tprivate _activeProjectSlug: string;\r\n\tprivate _dragging: boolean = false;\r\n\t\r\n\tprivate _introActiveRange: number; \r\n\tprivate _introShowing: boolean = true;\r\n\tprivate _introX: number = 0;\r\n\r\n\tprivate _mouseController: MouseController;\r\n\tprivate _backgroundController: BackgroundController;\r\n\tprivate _pixiController: PixiController;\r\n\r\n\tprivate _disablePagingAutoUpdate: boolean = false; \r\n\tprivate _autoPagingCounter: number = 0; \r\n\r\n\t//Velocity / Rotation:\r\n\tprivate _frameProgress: number = 0;\r\n\tprivate _velocity: number = 0;\r\n\tprivate _velocityRotation: number = 0;\r\n\tprivate _rotationRadians: number = 0;\r\n\tprivate _velocityScale: number = 1.2;\r\n\r\n\t//Pixi app for Fullscreen / rich elements: \r\n\tprivate _$pixi: PIXI.Application;\r\n\tprivate _$backgroundContainer:  PIXI.Container;\r\n\tprivate _$workContainer:  PIXI.Container;\r\n\tprivate _particlesSpritesheet:  PIXI.Spritesheet;\r\n\tprivate _backgroundSpritesheet:  PIXI.Spritesheet;\r\n\r\n\tprivate _timeouts: any = {};\r\n\tprivate _tweens: any = {};\r\n\tprivate _intervals: any = {};\r\n\r\n\tprivate readonly INNER_TILE_STEP: number = 0.5;\r\n\t//private readonly VELOCITY_FACTOR: number = 2.0;\t\t\t\t//Every movement across timeline progress is multiplied by this to create the rotation on drag/slide\r\n\t//private readonly VELOCITY_FRICTION: number = 0.94;\t\t\t//The amount the rotation falls back to '0'\r\n\t//private readonly ROTATION_FACTOR: number = 30;\t\t\t\t//The base level of rotation\r\n\t//private readonly MAX_ROTATION: number = 45;\t\t\t\t\t//The max the rotation is allowed to go to +/- - Can be larger than base\r\n\r\n\t//Called when work is routed directly \r\n\t//(Never actually calls work as there is only /spaces/ and /screens/ routes)\r\n\tconstructor(id: string) {\r\n\t\t//Listen for view ready event\r\n\t\tsuper(id);\r\n\t\tEvents.on(ViewReadyEvent,  this._onViewReady.bind(this));\r\n\t}\r\n\r\n\tpublic init(): void {\r\n\t\t\r\n\t\t//this.state.set('section', SectionType.WORK);\r\n\t\tthis._active = true;\r\n\t\r\n\t\t//Set the opening state to the homepage: \r\n\t\tlet openingState: HistoryStateModel = {\r\n\t\t\tsection: SectionType.WORK,\r\n\t\t\tsubsection: this._department,\r\n\t\t\ttitle: (this._department === DepartmentType.SPACES) ? 'Spaces' : 'Screens',\r\n\t\t\thref: `/${this._department}/`,\r\n\t\t};\r\n\t\tEvents.dispatch(AppEvents.SET_INTIAL_STATE, openingState);\r\n\r\n\t}\r\n\r\n\t//Spaces route: \r\n\tpublic spaces(): void {\r\n\t\tthis._department = DepartmentType.SPACES;\r\n\t\tthis.init();\r\n\t}\r\n\r\n\t//Screens route: \r\n\tpublic screens(): void {\r\n\t\tthis._department = DepartmentType.SCREENS;\r\n\t\tthis.init();\r\n\t}\r\n\r\n\t/** Unless routed then class doesn't know if spaces / screens, so set directly */\r\n\tpublic setDepartment(department: DepartmentType): void {\r\n\t\tthis._department = department;\r\n\t}\r\n\r\n\t//Getters \r\n\t//-----------------------------------------------------------------------\r\n\t\r\n\t/** Get if ready to view. This is called when a deep link or loading is happening */ \r\n\tpublic isReadyToView(state: HistoryStateModel): boolean {\r\n\t\t//This is called when checking if the view is ready to load \r\n\t\treturn this._readyToSetup;\r\n\t}\r\n\r\n\t/** Is actually ready to 'show' - allow for delay in WebGL content being ready */\r\n\tpublic readyForDeeplink(state: HistoryStateModel): boolean {\r\n\r\n\t\t//If this function is being called then process is checking if it can show \r\n\t\t//So if its ready to setup but not actually been created then can setup here\r\n\t\tif (this._readyToSetup && !this._isSetup) {\r\n\t\t\tthis._setup();\r\n\t\t}\r\n\r\n\t\treturn (this._readyToSetup && this._isSetup);\r\n\r\n\t}\r\n\r\n\t//Setters ----------------------------------------------------------------\r\n\t/** AJAX loaded HTML  for the section: */\r\n\tpublic setHTML(html: string): void {\r\n\t\tthis._html = html;\r\n\t\tthis._loadFlags.dom = true;\r\n\t\tthis._testReadyToSetup();\r\n\t\tif (this._htmlInjectionQeued) {\r\n\t\t\tthis._injectHTML();\r\n\t\t}\r\n\t}\r\n\r\n\t/** Set JSON for project items and settings */\r\n\tpublic setJSON(json: WorkJSONModel): void {\r\n\t\tthis._json = json;\r\n\t\tthis._loadFlags.json = true;\r\n\t\tthis._testReadyToSetup(); \r\n\r\n\t}\r\n\r\n\t/** History state has been changed by / back forward */\r\n\tpublic setState(state: HistoryStateModel): void {\r\n\t\tthis._state = state;\r\n\t}\r\n\r\n\t//Set controller depencies (set from app controller): \r\n\tpublic setControllers(mouse: MouseController, background: BackgroundController, pixi: PixiController): void { \r\n\t\tthis._mouseController = mouse;\r\n\t\tthis._backgroundController = background;\r\n\t\tthis._pixiController = pixi;\r\n\t}\r\n\r\n\t//Pixi dependecies (set in app controller): \r\n\tpublic setPixi($pixi: PIXI.Application, $backgroundContainer: PIXI.Container, $workContainer: PIXI.Container): void {\r\n\t\tthis._$pixi = $pixi;\r\n\t\tthis._$backgroundContainer = $backgroundContainer;\r\n\t\tthis._$workContainer = $workContainer;\r\n\t}\r\n\r\n\t//Public -------------------------------------------------------------------\r\n\t//DOMReady. Add DOM element refs and event listeners: \r\n\tpublic DOMReady(): void {\r\n\t\t\r\n\t\tthis._innerWidth = window.innerWidth;\r\n\r\n\t\tif (this._active) {\r\n\t\t\t//Flag the is active \r\n\t\t\tthis._loadFlags.dom = true;\r\n\t\t\tthis._testReadyToSetup(); \r\n\t\t}\r\n\r\n\t\t//If active then directly loaded so \r\n\t\tif (this._readyToSetup) {\r\n\t\t\tthis._setup();\r\n\t\t\treturn;\r\n\t\t}\t\t\r\n\r\n\t\t//If injection of HTML is queded then preform that that complete the setup\r\n\t\tthis._testInjectonQeued();\r\n\r\n\t}\r\n\r\n\t/** Que for showing from home screen. Basically inject the HTML, which then triggers the _setup process */ \r\n\tpublic que(): void {\r\n\t\tif (this._html) {\r\n\t\t\tthis._injectHTML();\r\n\t\t} else {\r\n\t\t\tthis._htmlInjectionQeued =  true;\r\n\t\t}\r\n\t}\r\n\r\n\t/** Freeze */\r\n\tpublic freeze(): void {\r\n\t\tthis._active = false;\r\n\t\tthis._tileBreakpoints.setActive(false);\r\n\t\tthis._mouseController.setDragCursorActive(false);\r\n\t\tthis._timeouts.freeze = setTimeout( () => this._cleanupAfterFreeze(), 500);\r\n\t}\r\n\r\n\t/** If a deeplink is fired while project is opened then may need to reset this view  */\r\n\tpublic freezeFromProjectView(): void {\r\n\t\t\r\n\t\tif (this._$workContainer) {\r\n\t\t\tthis._resetAllProjects();\r\n\t\t\tthis._$workContainer.visible = false;\r\n\t\t\tthis.DOM.removeClass(this.container, '-active');\r\n\t\t}\r\n\t}\r\n\r\n\t/** Reset is always called before showing to put in correct state. Seperate from 'show' as a deplay might be needed between the 2 */\r\n\tpublic reset(oldState: HistoryStateModel = null, isDeeplink: boolean = false): void {\r\n\r\n\t\t//0.) Generic across all types of show: \r\n\t\tthis._resetIntervalsAndAnimations();\r\n\r\n\t\tthis._$workContainer.visible = true;\r\n\t\tgsap.TweenMax.set([this.container, document.querySelector('canvas')], {autoAlpha: 1, scale: 1});\r\n\t\tthis._introX = 0;\r\n\t\tthis._mouseController.setColour('light');\r\n\r\n\t\tif ( this._isSetup && (oldState === null || oldState.section !== SectionType.PROJECT)) {\r\n\t\t\tthis._resetProgress();\r\n\t\t\tthis._resetTiles();\r\n\t\t\tthis._paging.reset();\r\n\t\t\tthis._paging.setActiveIndex(0);\r\n\t\t\tgsap.TweenMax.set(this._paging.$container, {y: 100, x: '-50%'});\r\n\t\t}\r\n\t\t\r\n\t\t//Show the container by making it active\r\n\t\tthis.DOM.addClass(this.container, '-active');\r\n\r\n\t\t//Is a deeplink for get ready to show coming direct from Preoader \r\n\t\tif (isDeeplink) {\r\n\t\t\tthis._resetForDeeplink();\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\t//If transition from gome then the content needs to animate updwards\r\n\t\tif (oldState.section === SectionType.HOME) {\r\n\t\t\tthis._resetForHome();\r\n\t\t}\r\n\r\n\t\t//If transition back from project\r\n\t\tif (oldState.section === SectionType.PROJECT) {\r\n\t\t\tthis._resetForProject();\r\n\t\t}\r\n\r\n\t}\r\n\r\n\t/**\r\n\t* Show after preload, navigation or seamless transition from other section\r\n\t* @param {HistoryStateModel} oldState - The previous view state \r\n\t* @param {boolean} isDeepLink - Is coming from the preloader state rather than a seamless transition\r\n\t*/\r\n\tpublic show(oldState: HistoryStateModel, isDeeplink: boolean = false) : void {\r\n\r\n\t\tthis._pixiController.unpause();\r\n\r\n\t\t//If no state then coming from the intial preload / deeplink\r\n\t\tif (!oldState || isDeeplink) {\r\n\t\t\t//this._setInteractionEnabled(true);\r\n\t\t\tthis._showFromDeeplink();\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\t//If coming from home then section needs to aimate updwards\r\n\t\tif (oldState.section ===  SectionType.HOME) {\r\n\t\t\tthis._showFromHome();\r\n\t\t}\r\n\r\n\t\t//If coming from project then \r\n\t\tif (oldState.section ===  SectionType.PROJECT) {\r\n\t\t\tthis._showFromProject();\r\n\t\t}\r\n\r\n\t}\r\n\r\n\t/** \r\n\t* after section is moved away from. The new state is passed so can work out how to transition out \r\n\t* @param {HistoryStateModel} newState\r\n\t*/\r\n\tpublic hide(newState: HistoryStateModel = null): void {\r\n\t\tif (newState.section === SectionType.INFO) {\r\n\t\t\tthis._hideForInfo();\r\n\t\t} else if (newState.section === SectionType.HOME) {\r\n\t\t\tthis._hideForHome();\r\n\t\t} \r\n\t\tthis._active  = false;\r\n\t}\r\n\r\n\t/** Pause (For when nav menu is showing) */\r\n\tpublic pause(): void {\r\n\t\tthis._setInteractionEnabled(false);\r\n\t\tgsap.TweenMax.to([this.container, document.querySelector('canvas')], 0.45, {scale: 1.2, ease: gsap.Power3.easeOut});\r\n\t}\r\n\r\n\t/** Unpause (For when nav menu is hidden) */\r\n\tpublic unpause(): void {\r\n\t\tthis._setInteractionEnabled(true);\r\n\t\tgsap.TweenMax.to([this.container, document.querySelector('canvas')], 0.45, {scale: 1, ease: gsap.Power3.easeOut});\r\n\t}\r\n\r\n\t/**\r\n\t* Animate x to progress to a point in time  \r\n\t* @param {number} index -  will most probbaly '0' be for intro slide: \r\n\t*/\r\n\tpublic animateProgressToValue(index: number): void {\r\n\t\tthis.unpause();\r\n\t\tthis._activeProjectIndex = index;\r\n\t\tthis._tileBreakpoints.setIndex(index);\r\n\t}\r\n\r\n\t/** Resize event. Redo all the tiles */\r\n\tpublic resize(): void {\r\n\r\n\t\tif (!this._active) {\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tthis._setVirtualWidth();\r\n\t\tthis._innerWidth = window.innerWidth;\r\n\t\tlet skipUpdates: boolean;\r\n\t\tthis._tiles.forEach((tile) => {\r\n\t\t\t//Don't actually update actiive tile\r\n\t\t\tif (tile !== this._activeProjectTile) {\r\n\t\t\t\ttile.resize( );\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t}\r\n\r\n\t/** RequestAnimationFrame interval tick */\r\n\tpublic tick(): void {\r\n\t\tif (this._isSetup && this._active) {\r\n\t\t\tthis._processHitAreaUpdate();\r\n\t\t\tthis._processVelocity();\r\n\t\t\tthis._checkPagingGuidePassed();\r\n\t\t\tthis._checkBackToHomeVisible();\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t* Partciles spritesheet loaded so flag and deal with  \r\n\t* @param {PIXI.Spritesheet} spritesheet -  spritesheet of particle eleemnts \r\n\t*/\r\n\tpublic pixiParticlesLoaded(spritesheet: PIXI.Spritesheet ): void {\r\n\t\tthis._particlesSpritesheet = spritesheet;\r\n\t\tthis._checkPixiResourcesAreReady();\r\n\t\tconsole.log(\"WORK \", this._department, \"loaded\", this._loadFlags);\r\n\t}\r\n\t\r\n\t//Background spritesheet loaded so flag and deal with \r\n\tpublic pixiBackgroundsLoaded(spritesheet: PIXI.Spritesheet, department: DepartmentType): void {\r\n\t\tthis._backgroundSpritesheet = spritesheet;\r\n\t\tthis._checkPixiResourcesAreReady();\r\n\t}\r\n\r\n\t//Private methods: \r\n\t//-------------------------------------------------------------------------------------\r\n\t//-------------------------------------------------------------------------------------\r\n\t\r\n\t//-------------------------------------------------------------------------------------\r\n\t//-------------------------------------------------------------------------------------\r\n\r\n\t/** Test that the view is ready to setup */\r\n\tprivate _testReadyToSetup(): void {\r\n\t\tthis._readyToSetup =  (this._loadFlags.dom && this._loadFlags.pixi && this._loadFlags.json);\r\n\t}\r\n\r\n\t/** When background loaded then inject the HTML */ \r\n\tprivate _injectHTML(onInjected: Function = null): void {\r\n\t\r\n\t\t//Only do this injecton once!\r\n\t\tif (this._isHTMLInjected) {\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tthis.DOM.append(document.querySelector('body'), this._html, () => {\r\n\t\t\tthis.container = document.querySelector(`.work.-${this._department}`);\r\n\t\t\tthis._$intro =  this.container.querySelector('.work__slider__intro');\r\n\t\t\tthis._$backButton = this.container.querySelector('.work__homebutton');\r\n\t\t\tthis.module.createModulesInTarget(this.container as HTMLElement);\r\n\t\t\tif ( onInjected ) {\r\n\t\t\t\tonInjected();\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t\tthis._isHTMLInjected = true;\r\n\t\tthis._htmlInjectionQeued = false;\r\n\t}\r\n\r\n\t/** Test if injection is qued. If so then inject the html in. */ \r\n\tprivate _testInjectonQeued(): void {\r\n\t\tif (this._htmlInjectionQeued && this._readyToSetup ) {\r\n\t\t\tthis._injectHTML();\r\n\t\t}\r\n\t}\r\n\r\n\t/** DOM/PIXI ready so setup the view to interactive with */\r\n\tprivate _setup(): void {\r\n\r\n\t\tif (this._isSetup) {\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\t//If container doesn't exists then create. \r\n\t\tif (!this.container) {\r\n\t\t\tthis._injectHTML(() => this._setup());\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tthis._$intro =  this.container.querySelector('.work__slider__intro');\r\n\t\tthis._$backButton = this.container.querySelector('.work__homebutton');\r\n\r\n\t\tthis._setupPixi();\r\n\t\tthis._setupPaging(); \r\n\t\tthis._addListeners();\r\n\t\tthis._isSetup = true; \r\n\r\n\t\t//Trigger the VIEW_SETUP event, which can be picked up by any loading processes: \r\n\t\tlet view: ViewType = (this._department === DepartmentType.SCREENS) ? ViewType.SCREENS : ViewType.SPACES;\r\n\t\tEvents.dispatch(new ViewReadyEvent({\r\n\t\t\tview: view\r\n\t\t}), {delay: 1});\r\n\r\n\t}\r\n\r\n\t/** Set the virtual width for the break points */\r\n\tprivate _setVirtualWidth(): void {\r\n\t\t\r\n\t\tif ( window.innerWidth >= 900) {\r\n\t\t\tthis._tileBreakpoints.setVirtualWidth(this._tiles.length * window.innerWidth);\r\n\t\t\treturn;\r\n\t\t} \r\n\t\t\r\n\t\tthis._tileBreakpoints.setVirtualWidth((this._tiles.length * window.innerWidth) * 1.5);\r\n\t\t\r\n\t}\r\n\r\n\t/** Setup paging */\r\n\tprivate _setupPaging(): void {\r\n\t\tthis._paging = new Paging();\r\n\t\tthis._paging.setContainer( this.container.querySelector(`#${this._department}-paging`) );\r\n\t\tthis._paging.id  = `${this._department}-paging`;\r\n\t\tthis._paging.create();\r\n\t\tthis._paging.setCallbacks(this._gotoProject.bind(this));\r\n\t}\r\n\r\n\t/** Add Listeners for */\r\n\tprivate _addListeners(): void {\r\n\t\t//Listen for tile explore clicks \r\n\t\tEvents.on('click',  `.work.-${this._department} .worktitle__link`, this._onExploreProjectClick.bind(this));\r\n\t\tEvents.on('click',  `.work__homebutton`, this._onBackToHomeClick.bind(this));\r\n\t\tEvents.on(DebugMouseWheelEvent,  this._onMouseWheel.bind(this));\r\n\t\tEvents.on(DebugKeypressEvent,  this._onKeyPress.bind(this));\r\n\t}\r\n\r\n\t/** Check the state of availble ressources so can load the */\r\n\tprivate _checkPixiResourcesAreReady(): void {\r\n\t\t\r\n\t\tif (this._particlesSpritesheet && this._backgroundSpritesheet && !this._tiles) {\r\n\t\t\tthis._loadFlags.pixi = true;\r\n\t\t\tthis._testReadyToSetup();\r\n\t\t}\r\n\r\n\t\t//If active and ready then setup\r\n\t\tif (this._active && this._readyToSetup) {\r\n\t\t\tthis._setup();\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\t//If injection of HTML is queded then preform that that complete the setup\r\n\t\tthis._testInjectonQeued();\r\n\r\n\t}\r\n\r\n\t/** Setup PIXI elements */\r\n\tprivate _setupPixi(): void {\r\n\t\tthis._createTilesPixi();\r\n\t\tthis._createBreakpoints();\r\n\t}\r\n\r\n\t/** Create all the caoursel tiles: */\r\n\tprivate _createTilesPixi(): void {\r\n\t\t\r\n\t\tlet projects: Array<ProjectJSONModel> = this._json.projects;\r\n\t\tlet tileIndex: number;\r\n\t\tthis._tiles = []; \r\n\r\n\t\t//Add a blank spacer for the intro tile \r\n\t\tlet tile: WorkTilePixi = new WorkTilePixi(null, null, null, null, null);\r\n\t\tthis._tiles.push(tile);\r\n\r\n\t\t//Add the main set \r\n\t\tprojects.forEach( (project: ProjectJSONModel, index: number) => {\r\n\t\t\t\r\n\t\t\t//Allow for blank spacer in indexing logic: \r\n\t\t\ttileIndex = index;\r\n\t\t\t//Create the tile\r\n\t\t\tlet tile: WorkTilePixi = new WorkTilePixi(this._pixiController, tileIndex, project, this._$workContainer, this.container as HTMLElement);\r\n\t\t\ttile.setSpriteSheets(this._particlesSpritesheet, this._backgroundSpritesheet);\r\n\t\t\ttile.setHitarea( this.module.get(`${this._department}-hitarea-${index}`) as HitArea );\r\n\t\t\t\t\t\r\n\t\t\t//Explore from holding down on project tile: \r\n\t\t\ttile.onExploreProject = (data) => {\r\n\t\t\t\tGA.event('UX', 'Work > Explore Project Tile hold', data.slug);\r\n\t\t\t\tthis._projectSelected(data.slug, data.index + 1, data.href, data.title);\r\n\t\t\t};\r\n\r\n\t\t\ttile.create();\r\n\t\t\tthis._tiles.push(tile);\t\r\n\r\n\t\t});\r\n\t\t\r\n\t\tthis._tileRatioShare = 1.0 / this._tiles.length; \r\n\r\n\t\t//1st tile is on at 50% of it's timeline \r\n\t\t//That means is there are x5 then it starts at 0.1 ratio\r\n\t\t//Set this._activeProjectIndex to debug or jump straight to project)\r\n\t\tthis._tileProgress = (this._activeProjectIndex *  this._tileRatioShare);\r\n\r\n\t\t//Update the progress to move to correct start point \r\n\t\tthis._updateTileProgress();\r\n\r\n\t\t//Set the intro amount for calulating the animation of that HTMLElement \r\n\t\tthis._introActiveRange = 1 / this._tiles.length; \r\n\r\n\t}\r\n\r\n\tprivate _createBreakpoints(): void {\r\n\r\n\t\tif (this._tileBreakpoints) {\r\n\t\t\treturn;\r\n\t\t} \r\n\r\n\t\t//Create the 0% / 50% / 100% for SCREENS <> HOME <> SPACES layout \r\n\t\tthis._tileBreakpoints = new DragBreakpoints(this._tiles.length, true, 0, false);\r\n\r\n\t\tlet  allowProgressTo : number = 1.0 - (1.0 / this._tiles.length);\r\n\t\tthis._tileBreakpoints.setConstraints(0, allowProgressTo);\r\n\t\tthis._tileBreakpoints.setDragToMoveRatio(this._json.dragToMoveRatio);\r\n\t\tthis._tileBreakpoints.easePower = this._json.easePower;\r\n\t\tthis._tileBreakpoints.releaseEasePower = this._json.easePower;\r\n\t\tthis._tileBreakpoints.forceSnap = false;\r\n\t\tthis._tileBreakpoints.setProgress(0);\r\n\t\t\r\n\t\tthis._tileBreakpoints.onTick = (progressRatio: number) => {\r\n\r\n\t\t\tif (! this._active ) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\tthis._frameProgress  = progressRatio - this._tileProgress;\r\n\t\t\tthis._tileProgress = progressRatio;\r\n\t\t\tthis._updateTileProgress();\r\n\t\t\tthis._setIntroVisibleState();\r\n\t\t\tthis._updateIntroProgress();\r\n\t\t\tthis._setAutoPaging();\r\n\t\t\tthis._updateBGAnimation();\r\n\t\t\tthis._effectVelocity(this._frameProgress);\r\n\t\t};\r\n\r\n\t\tthis._tileBreakpoints.onStartDrag = () => {\r\n\r\n\t\t\tif (!this._active) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\r\n\t\t\t//this._mouseController.setDragDown(true);\r\n\t\t\tthis._mouseController.setDragDown(true, null, 0.7);\r\n\r\n\t\t\t//Process the tile hit area logic (i.e if not moving too fast, and shoing then check for a click)\r\n\t\t\tthis._processHitAreaMouseDown();\t\r\n\r\n\t\t\t//User is draging so no longer need to worry about next/back/paging animation\r\n\t\t\tthis._disablePagingAutoUpdate = false;\r\n\r\n\t\t};\r\n\r\n\t\tthis._tileBreakpoints.onStopDrag = () => {\r\n\t\t\tthis._mouseController.setDragDown(false);\r\n\t\t\t//Process the tile hit area logic (i.e if not moving too fast, and shoing then check for a click)\r\n\t\t\tthis._processHitAreaMouseUp();\t\r\n\t\t};\r\n\t\t\r\n\t\tthis._tileBreakpoints.onSnap = (snapIndex: number) => {\r\n\t\t\tthis._setProjectIndex(snapIndex);\r\n\t\t\tthis._mouseController.setDragDown(false);\r\n\t\t};\r\n\r\n\t\tthis._tileBreakpoints.setActive(false);\r\n\r\n\t}\r\n\r\n\t/** Process checking hit area on Drag press */\r\n\tprivate _processHitAreaMouseDown(): void {\r\n\t\tthis._tiles.forEach((tile: WorkTilePixi) => {\r\n\t\t\tif (tile.isVisible) {\r\n\t\t\t\ttile.mouseDown(this._mouseController.getMouseCords() );\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n\r\n\t/** Process checking hit area on Drag press */\r\n\tprivate _processHitAreaMouseUp(): void {\r\n\t\tthis._tiles.forEach((tile: WorkTilePixi) => {\r\n\t\t\tif (tile.isVisible && tile.hitAreaMouseDown) {\r\n\t\t\t\ttile.mouseUp();\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n\r\n\t/** Process checking hit area on Drag press */\r\n\tprivate _processHitAreaUpdate(): void {\r\n\t\tthis._tiles.forEach((tile: WorkTilePixi) => {\r\n\t\t\tif (tile.isVisible && tile.hitAreaMouseDown) {\r\n\t\t\t\ttile.updateMouseCords(this._mouseController.getMouseCords() );\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n\r\n\t//Reset methods \r\n\t//-----------------------------------------------------------------------------------\r\n\r\n\t/** Reset anything that is happening */\r\n\tprivate _resetIntervalsAndAnimations(): void {\r\n\t\tObject.keys(this._tweens).forEach( (key: string) => {\r\n\t\t\tthis._tweens[key].kill();\r\n\t\t});\r\n\t\tObject.keys(this._timeouts).forEach( (key: string) => {\r\n\t\t\tclearTimeout(this._timeouts[key]);\r\n\t\t});\r\n\t\tObject.keys(this._intervals).forEach( (key: string) => {\r\n\t\t\tclearInterval(this._intervals[key]);\r\n\t\t});\r\n\t}\r\n\r\n\t/** Reset for deeplink (opening, nav jump or history state) */\r\n\tprivate _resetForDeeplink(): void {\r\n\t\t\r\n\t\t//Need to also reset the background so that it is \r\n\t\tthis._backgroundController.reset(this._state); \r\n\r\n\t\t//2.) Make sure the intro is showing: \r\n\t\tgsap.TweenMax.set(this._$intro, {y: 0});\r\n\r\n\t}\r\n\r\n\t/** Reset for transition from home where the elements side in  */\r\n\tprivate _resetForHome(): void {\r\n\t\tthis._$workContainer.visible = false;\r\n\t\tgsap.TweenMax.set(this._$intro, {y: window.innerHeight + 100});\r\n\t}\r\n\r\n\t/** Reset when coming from project. Nothing special needed as it should be in required state */\r\n\tprivate _resetForProject(): void {\r\n\t\t//NOTHING NEEDS TO BE RESET HERE. SHOULD BE IN THE REQUIERD STATE ALREADY (Maybe resize?)\r\n\t}\r\n\r\n\t/** Reset the timeline right to start '0' progress */\r\n\tprivate _resetProgress(): void {\r\n\t\tthis._focusedIndex = 0;\r\n\t\tthis._tileProgress = 0;\r\n\t\tthis._frameProgress = 0;\r\n\t\tthis._tileBreakpoints.setProgress(0);\r\n\t}\r\n\r\n\t/** Reset the all the tiles to start state */\r\n\tprivate _resetTiles(): void {\r\n\t\tthis._tiles.forEach( (tile: WorkTilePixi) => tile.reset() );\r\n\t}\r\n\r\n\t/** Cleanup after freezing */\r\n\tprivate _cleanupAfterFreeze(): void {\r\n\t\tthis._$workContainer.visible = false;\r\n\t\tthis.DOM.removeClass(this.container, '-active');\r\n\t\tthis._resetProgress();\r\n\t\tthis._resetTiles();\r\n\t}\r\n\r\n\t//Show methods  \r\n\t//-----------------------------------------------------------------------------\r\n\r\n\t/** Show from the preloader state */\r\n\tprivate _showFromDeeplink(): void {\r\n\t    \r\n\t    this._active = true;\r\n\t\t\r\n\t\t//Stop scrolling before ui button comes in: \r\n\t \tthis._tileBreakpoints.setActive(true);\r\n\t\tthis._mouseController.setDragCursorActive(true);\r\n\r\n\t\t//Set the opening state of the slider: \r\n\t\tthis.resize();\r\n\t\tthis._updateTileProgress();\r\n\r\n\t\tthis._paging.show();\r\n\t\tthis._tweens.paging = gsap.TweenMax.to(\r\n\t\t\t\tthis._paging.$container, \r\n\t\t\t\t0.5, \r\n\t\t\t\t{y: 0, x: '-50%', ease: gsap.Power3.easeOut, delay: 0.5\r\n\t\t\t});\r\n\t\t\r\n\t\tthis._timeouts.paging = setTimeout( () => {\r\n\t\t\tthis._showPagingGuide();\r\n\t\t}, 1500);\r\n\r\n\r\n\r\n\t\tthis._timeouts.backButton = setTimeout( () => this._canShowBack = true, 2000);\r\n\r\n\t}\r\n\r\n\t/** Show from transition from Home */\r\n\tprivate _showFromHome(): void {\r\n\t\t\r\n\t\tthis._mouseController.setDragCursorActive(false);\r\n\t\t//1.) Animate in the intro from the bottom. Timeline is off screen so it doesn't need to be amimated\r\n\t\t\r\n\t\tgsap.TweenMax.set(this._$intro, {x: this._introX, autoAlpha: 1} );\r\n\t\tthis._tweens.home = gsap.TweenMax.to(this._$intro, 1.0, {y: 0, ease: gsap.Power3.easeOut, delay: 1.0, onComplete: () => {\r\n\t\t\t\r\n\t\t\tif (!this._isSetup) {\r\n\t\t\t\tthis._setup();\r\n\t\t\t}\r\n\r\n\t\t\tthis._tileBreakpoints.setActive(true);\r\n\t\t\tthis._mouseController.setDragCursorActive(true);\r\n\t\t\tthis._$workContainer.visible = true;\r\n\t\t\tthis._active = true;\r\n\t\t\tthis.resize();\r\n\t\t\tthis._updateTileProgress();\r\n\t\t\tthis._showPagingGuide();\r\n\t\t\tthis._timeouts.backButton = setTimeout( () => this._canShowBack = true, 1100);\r\n\r\n\t\t}});\r\n\r\n\t\tif (this._paging) {\r\n\t\t\tthis._paging.show();\r\n\t\t\tthis._tweens.paging = gsap.TweenMax.to(\r\n\t\t\t\tthis._paging.$container, \r\n\t\t\t\t0.5, \r\n\t\t\t\t{y: 0, x: '-50%', ease: gsap.Power3.easeOut, delay: 1.5}\r\n\t\t\t);\r\n\t\t}\r\n\r\n\t}\r\n\r\n\t/** Show from transition from Active / Zoomed in project  */\r\n\tprivate _showFromProject(): void {\r\n\t\t\r\n\t\t//1.) Reverse the animation of the tile to zoom back into the timeline \r\n\t\tif (this._activeProjectTile) {\r\n\t\t\tthis._activeProjectTile.backFromProject();\r\n\t\t}\r\n\r\n\t\t//Hacky to reslove potential resize issues: \r\n\t\tthis._active = true;\r\n\t\tthis.resize();\r\n\t\tthis._active = false;\r\n\r\n\t\t//2.) Show surrounding tiles again:\r\n\t\tthis._tiles.forEach( (tile: WorkTilePixi, index: number) =>  {\r\n\t\t\tif (index !== 0 && tile !== this._activeProjectTile) {\r\n\t\t\t\ttile.showFromProject();\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t\t//3.) Reset flags/vars and activate this view controller again\r\n\t\tthis._activeProjectTile = null;\r\n\t\tthis._backgroundController.setTweening(true);\r\n\t\tthis._timeouts.interaction = setTimeout(() => {\r\n\t\t\tthis._backgroundController.startParallaxEaseIn();\r\n\t\t\tthis._setInteractionEnabled(true);\r\n\t\t\tthis._backgroundController.resize();\r\n\t\t\tthis._paging.show();\r\n\t\t}, 1000);\r\n\r\n\t\tthis._timeouts.sizeFix = setTimeout(() => {\r\n\t\t\tthis.resize();\r\n\t\t}, 1200);\r\n\t\t\r\n\t\t//Restart the WebGL\r\n\t\tthis._pixiController.unpause();\r\n\r\n\t}\r\n\r\n\t/** Show homepage guid */\r\n\tprivate _showPagingGuide(): void {\r\n\t\tthis._pagingGuideActive = true;\r\n\t\tthis._paging.startGuideEffect();\r\n\t}\r\n\r\n\t//Hide methods \r\n\t//-------------------------------------------------------------------------------\r\n\r\n\t//** Hide to move to info section. Means hiding pixi and Home HTML elements */\r\n\tprivate _hideForInfo(): void {\r\n\t\tthis._tweens.container = gsap.TweenMax.to([this.container, document.querySelector('canvas')], 0.5, {\r\n\t\t\tautoAlpha: 0, \r\n\t\t\tdelay: 0.5,\r\n\t\t\t onComplete: () => {\r\n\t\t\t\tthis._$workContainer.visible = false;\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n\r\n\t//** Hide to move to info section. Means hiding pixi and Home HTML elements */\r\n\tprivate _hideForHome(): void {\r\n\t\t\r\n\t\tthis._active = false;\r\n\t\tthis._tileBreakpoints.setActive(false);\r\n\t\tthis._canShowBack = false;\r\n\t\tthis._checkBackToHomeVisible();\r\n\t\tthis._backgroundController.animateToHome(this._department);\r\n\t\t\r\n\t\t//Reset intro positon for TweenMax then animate off the screen: \r\n\t\tgsap.TweenMax.set(this._$intro, {x: this._introX} );\r\n\t\tthis._tweens.home = gsap.TweenMax.to(this._$intro, 1.0, {\r\n\t\t\ty: window.innerHeight, \r\n\t\t\tease: gsap.Power3.easeIn,\r\n\t\t\tonComplete: () => {\r\n\t\t\t\tthis.DOM.removeClass(this.container, '-active');\r\n\t\t\t\tthis._$workContainer.visible = false;\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t\t//Animate paging down: \r\n\t\tthis._tweens.paging = gsap.TweenMax.to(this._paging.$container, 0.5, {y: 200, ease: gsap.Power3.easeIn});\r\n\t\t\r\n\t}\r\n\r\n\t//-------------------------------------------------------------------------------\r\n\r\n\t/** Set interactoon to on/off */\r\n\tprivate _setInteractionEnabled(enabled: boolean): void {\r\n\t\tthis._active = enabled;\r\n\t\tthis._tileBreakpoints.setActive(enabled);\r\n\t\tthis._mouseController.setDragCursorActive(enabled);\r\n\t}\r\n\r\n\tprivate _gotoProject(index: number): void {\r\n\t\tthis._tileBreakpoints.setIndex(index);\r\n\t\tthis._setProjectIndex(index);\r\n\t\tthis._focusIndexChanged(index);\r\n\t\tthis._disablePagingAutoUpdate  = true; \r\n\t\tclearInterval(this._timeouts.disablePaging );\r\n\t\tthis._timeouts.disablePaging = setTimeout(() => {\r\n\t\t\tthis._disablePagingAutoUpdate = false;\r\n\t\t}, 1000);\r\n\t}\r\n\r\n\tprivate _setProjectIndex(index: number): void {\r\n\t\tthis._activeProjectTile = this._tiles[index];\r\n\t\tthis._paging.setActiveIndex(index);\r\n\t}\r\n\r\n\t//Explore project has been click \r\n\t//---------------------------------------------------------------\r\n\tprivate _onExploreProjectClick(e: MouseEvent): boolean {\r\n\t\te.preventDefault();\r\n\t\te.stopPropagation();\r\n\t\tthis.DOM.addClass(e.target as HTMLElement, '-clicked');\r\n\t\tlet slug = this.DOM.getAttribute(e.target, 'data-slug');\r\n\t\tlet title = this.DOM.getAttribute(e.target, 'data-title');\r\n\t\tlet href = this.DOM.getAttribute(e.target, 'href');\r\n\t\tlet index = parseInt(this.DOM.getAttribute(e.target, 'data-index'), 10) + 1;\r\n\r\n\t\tGA.event('UX', 'Work > Explore Project Button', slug);\r\n\r\n\t\tthis._projectSelected(slug, index, href, title);\r\n\t\treturn false; \r\n\t}\r\n\r\n\t/** Back to home button click */\r\n\tprivate _onBackToHomeClick(e: MouseEvent): boolean {\r\n\t\t\r\n\t\te.preventDefault();\r\n\r\n\t\t//Trigger event to switch to home controller view \r\n\t\tlet newState: HistoryStateModel = {\r\n\t\t\tsection: SectionType.HOME,\r\n\t\t\ttitle: 'Home',\r\n\t\t\thref: `/`,\r\n\t\t};\r\n\t\tEvents.dispatch(AppEvents.CHANGE_SECTION, newState);\r\n\r\n\t\tGA.event('UX', 'Work > Back to home button', this._state.subsection);\r\n\r\n\t\treturn false;\r\n\r\n\t}\r\n\t\r\n\t//Let the main controller know which is selected and that handles letting all controllers know what is going on \r\n\tprivate _projectSelected(slug: string, index: number, href: string, title: string): void {\r\n\t\t\r\n\t\t//------------------------------------------\r\n\t\tthis._paging.hide();\r\n\t\tthis._activeProjectTile = this._tiles[index];\r\n\t\tthis._activeProjectTile.animateToProject();\r\n\t\tthis._tileBreakpoints.setActive(false);\r\n\t\tthis._hideAllProjects(index);\r\n\r\n\t\t//Pause the WebGL view because it causes major conflict with fullscreen video playing: \r\n\t\tthis._timeouts.pauseWebGL = setTimeout( () => this._pixiController.pause(), 1000 );\r\n\r\n\t\tthis._backgroundController.setTweening(true);\r\n\t\t\r\n\t\t//Trigger event to switch to 'work' controller for department: \r\n\t\tlet newState: HistoryStateModel = {\r\n\t\t\tsection: SectionType.PROJECT,\r\n\t\t\tsubsection: this._department,\r\n\t\t\tprojectSlug: slug as ProjectSlugType,\r\n\t\t\ttitle: title,\r\n\t\t\thref: `${href}`,\r\n\t\t};\r\n\t\tEvents.dispatch(AppEvents.CHANGE_SECTION, newState, {delay: 0.9});\t\r\n\r\n\t}\r\n\r\n\t/** Hide all projects (APart from spacer tile and actiive index) */\r\n \tprivate _hideAllProjects(skipIndex: number = -1): void {\r\n \t\tthis._tiles.forEach((tile, index) => {\r\n \t\t\tif (index !== 0 && index !== skipIndex) {\r\n \t\t\t\ttile.hideForProject();\t\r\n \t\t\t}\r\n \t\t} );\r\n \t}\r\n\r\n \t private _resetAllProjects(skipIndex: number = -1): void {\r\n \t\tthis._tiles.forEach((tile, index) => {\r\n \t\t\tif (index !== 0 && index !== skipIndex) {\r\n \t\t\t\ttile.resetForProject();\t\r\n \t\t\t}\r\n \t\t} );\r\n \t}\r\n\r\n \t/** Check Paging is passed */\r\n \tprivate _checkPagingGuidePassed(): void {\r\n\r\n \t\tif (!this._pagingGuideActive) {\r\n \t\t\treturn;\r\n \t\t}\r\n\r\n \t\tif (this._tileProgress > 0) {\r\n \t\t\tthis._pagingGuideActive = false;\r\n \t\t\tthis._paging.removeGuideEffect();\r\n \t\t}\r\n\r\n \t}\r\n\r\n\t/** Set auto paging. Don't check every frame as not animation critical */\r\n\tprivate _setAutoPaging(): void {\r\n\r\n\t\tif (this._pagingGuideActive) {\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tthis._autoPagingCounter--; \r\n\t\tif (!this._disablePagingAutoUpdate && this._autoPagingCounter <= 0) {\r\n\t\t\t\r\n\t\t\tlet oldIndex: number = this._paging.getActiveIndex(); \r\n\t\t\tlet newIndex: number = this._paging.checkIndexFromRatio( this._tileProgress % 1);\r\n\t\t\tthis._autoPagingCounter = 30;\r\n\r\n\t\t\tif (oldIndex !== newIndex) {\r\n\t\t\t\tthis._focusIndexChanged(newIndex);\r\n\t\t\t\tGA.event('Progress', `Work > ${this._state.subsection} > project displayed`, `index ${newIndex}`);\r\n\t\t\t}\r\n\r\n\t\t}\r\n\t}\r\n\r\n\t/** Focused index has changed. */\r\n\tprivate _focusIndexChanged(index: number): void {\r\n\t\t//The user is over a project in the line, so que the video (or image) for preloading\r\n\t\t//If project HTML section has not been injected, it will at this point\r\n\t\tthis._focusedIndex = index;\r\n\t\tEvents.dispatch(new QueProjectEvent({\r\n\t\t\tslug: this._paging.getActiveSlug(this._focusedIndex),\r\n\t\t\tindex: index,\r\n\t\t}));\r\n\t}\t\r\n\r\n\t/** Check if the backToHome button should be shown */\r\n\tprivate _checkBackToHomeVisible(): void {\r\n\r\n\t\tif (!this._$backButton) {\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\r\n\t\tif (!this._backToHomeIsVisible  && this._shouldBackShow() ) {\r\n\t\t\tthis._backToHomeIsVisible = true; \r\n\t\t\tthis.DOM.addClass(this._$backButton, '-show');\r\n\t\t} else if (this._backToHomeIsVisible && !this._shouldBackShow() ) {\r\n\t\t\tthis._backToHomeIsVisible = false; \r\n\t\t\tthis.DOM.removeClass(this._$backButton, '-show');\r\n\t\t}\r\n\r\n\t}\r\n\r\n\t/** Logic for working out if back buttons meets conditions be shown */\r\n\tprivate _shouldBackShow(): boolean {\r\n\t\t\r\n\t\tif (this._canShowBack && this._homeViewReady && this._tileProgress <= (this._tileRatioShare * 0.12) && (this._tileProgress < 0.0001 || this._velocity <= 0)) {\r\n\t\t\treturn true;\r\n\t\t}\r\n\r\n\t\treturn false;\r\n\r\n\t}\r\n\r\n\t/** Update each tile progress based on the */\r\n\tprivate _updateTileProgress(): void {\r\n\r\n\t\t//Progress could be <0.0 or >1.0 so get the decimal part: \r\n\t\tthis._actualProgress = this._tileProgress % 1;\r\n\t\tthis._reduce = (this._actualProgress  / this._tileRatioShare) * this.INNER_TILE_STEP;\r\n\t\t\r\n\t\t//Each tile is active bewteen its share of the ratio:  \r\n\t\tfor (let i = 0; i < this._tiles.length; i++) {\r\n\t\t\t//progress = 0.1 \r\n\t\t\t//item1 progress = 0.5 \r\n\t\t\t//item 2 progress = 1.0 \r\n\t\t\t//item 5 progress = 0.0\r\n\t\t\t//ratio = 0.3 then item 2 has progress = 0.5 and item 1 has progress = 0\r\n\t\t\tthis._step = (i + 1)  * this.INNER_TILE_STEP;\r\n\t\t\tthis._finalStep = this._step - this._reduce;\r\n\t\t\tthis._tiles[i].setTimelineProgress(this._finalStep, false);\r\n\t\t} \r\n\r\n\t}\r\n\r\n\t/** Decide if the intro should be shown or hidden */\r\n\tprivate _setIntroVisibleState(): void {\r\n\t\tif (!this._introShowing && this._tileProgress <= this._introActiveRange) {\r\n\t\t\tthis._$intro.style.visibility = 'visible';\r\n\t\t\tthis._introShowing = true;\r\n\t\t} else if (this._introShowing && this._tileProgress > this._introActiveRange) {\r\n\t\t\tthis._$intro.style.visibility = 'hidden';\r\n\t\t\tthis._introShowing = false;\r\n\t\t}\r\n\t}\r\n\r\n\t/** Update the animation of the intro */\r\n\tprivate _updateIntroProgress(): void {\r\n\t\t\r\n\t\tif (!this._introShowing) {\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tif (this._$intro) {\r\n\t\t\tthis._introX = -1 * (this._innerWidth * (this._tileProgress / this._introActiveRange));\r\n\t\t\tthis._$intro.style.transform = `translateX(${ this._introX }px)`;\r\n\t\t\tthis._$intro.style.opacity =  `${1 - (1 * (this._tileProgress / this._introActiveRange))}`;\r\n\t\t}\r\n\r\n\t}\r\n\r\n\t/** Move the main background along the */\r\n\tprivate _updateBGAnimation(): void {\r\n\r\n\t\tif (!this._active) {\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\t//Allow for the intro in the calulations \r\n\t\t//Intro takes up tile slide share of the movement \r\n\t\tthis._actualProgress =  this._tileProgress % 1;\r\n\t\tthis._backgroundController.setXProgress(  this._actualProgress );\r\n\r\n\t}\r\n\r\n\t/** Process velocity speed */\r\n\tprivate _effectVelocity(frameMoveRatio: number): void {\r\n\t\tthis._velocity += (frameMoveRatio * this._json.velocityFactor);\r\n\t}\r\n\r\n\t/** Tick function to effect velcoity and rotation */\r\n\tprivate _processVelocity(): void {\r\n\t\tthis._velocity *= this._json.velocityFriction;\r\n\t\tthis._velocityRotation = this.math.constrain(this._velocity * this._json.rotationFactor, this._json.maxRotation * -1, this._json.maxRotation);\r\n\t\tthis._velocityRotation\t*= -1; \r\n\t\tthis._rotationRadians = this._velocityRotation * Math.PI / 180;\r\n\t\tthis._tiles.forEach(\r\n\t\t\t(tile: WorkTilePixi) => tile.setVelocityRotation( this._rotationRadians )\r\n\t\t);\r\n\t}\r\n\r\n\t//Get active project by slug string \r\n\tprivate _getProjectTileBySlug(slug: string): WorkTilePixi {\r\n\t\treturn this._tiles[0];\r\n\t}\r\n\r\n\t//Scrollwheel / mouse press \r\n\t//------------------------------------------------------------------------------------\r\n\tprivate _onMouseWheel(event: DebugMouseWheelEvent): void {\r\n\r\n\t\tif (!this._active || this._disablePagingAutoUpdate) {\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tthis._gotoProject(this.math.constrain(this._paging.getActiveIndex() + (-1 * event.delta), 0, this._tiles.length - 1));\r\n\r\n\t}\r\n\r\n\tprivate _onKeyPress(event: DebugKeypressEvent): void {\r\n\t\t\r\n\t\tif (!this._active) {\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tlet direction = (event.keyType === DirectionalKeyType.LEFT || event.keyType === DirectionalKeyType.PAGE_UP) ? -1 : 1;\r\n\t\tthis._gotoProject(this.math.constrain(this._paging.getActiveIndex() + direction, 0, this._tiles.length - 1));\r\n\r\n\t}\r\n\r\n\t/** View ready event */\r\n\tprivate _onViewReady(event: ViewReadyEvent): void {\r\n\t\tif (event.view === ViewType.HOME) {\r\n\t\t\tthis._homeViewReady = true;\r\n\t\t}\r\n\t}\r\n\r\n\t//UTIL (GENERICS): \r\n\t//-------------------------------------------------------------------------------------\r\n\r\n\tprivate _orderByArray<T, K extends keyof T>(values: T[], orderType: K): T[] {\r\n\t\tvalues.sort(function(a: T, b: T) {\r\n\t\t\treturn (a[orderType] as any) - (b[orderType] as any);\r\n\t\t});\r\n\t\treturn values;\r\n\t}\r\n\r\n\tprivate _orderByConfigValue<T>(values: T[], orderType: any): T[] {\r\n\r\n\t\tvalues.sort(function(a: T, b: T) {\r\n\t\t\treturn (a['config'][orderType] as any) - (b['config'][orderType] as any);\r\n\t\t});\r\n\r\n\t\treturn values;\r\n\r\n\t}\r\n\r\n}\r\n","import { Controller } from 'debugbase/abstract/Controller';\r\nimport { MouseController } from 'app/controller/MouseController';\r\n//import { TimelineMax, TweenMax, Power0, Power3, Back } from 'gsap';\r\n//import { LogoMorphTimeline } from 'app/module/home/LogoMorphTimeline';\r\n\r\nimport { TimelineItem, TimelineItemConfig, TimelineItemType} from 'app/module/home/TimelineItem';\r\nimport { MaskedText } from 'app/module/home/MaskedText';\r\nimport { ParticleField } from 'app/module/home/ParticleField';\r\nimport { RelativeChildren } from 'app/module/home/RelativeChildren';\r\nimport { TimelineRegionManager} from 'app/module/home/TimelineRegionManager';\r\nimport { TimelineRegionParams} from 'app/module/home/TimelineRegion';\r\n\r\nimport { ImageSequenceLoader } from 'debugbase/loader/ImageSequenceLoader';\r\nimport { Debugbase } from 'debugbase/Debugbase';\r\nimport { DOMHelper } from 'debugbase/helper/DOMHelper';\r\n\r\nimport { DepartmentType, HomeParticleType} from 'app/data/Enums';\r\n\r\nimport {HomeJSONModel} from 'app/model/HomeJSONModel';\r\nimport {HomeParticleJSONModel} from 'app/model/HomeParticleJSONModel';\r\nimport {HomeCSSElementJSONModel} from 'app/model/HomeCSSElementJSONModel';\r\n//import * as PIXI from 'pixi.js';\r\nimport {Point} from 'app/contracts/Geometry';\r\nimport {TextScramble}  from 'app/module/home/homeUtil/TextScramble';\r\n\r\nexport enum TimelineStateType {\r\n\tINTRO,\r\n\tHOME_LOGO_OVER,\r\n\tHOME_LOGO_OUT,\r\n\tSCREENS_TRANSITION,\r\n\tSCREENS, \r\n\tSPACES_TRANSITION,\r\n\tSPACES,\r\n\tHOME\r\n}\r\n\r\ninterface CSSElement {\r\n\tid: string;\r\n\t$target: HTMLElement;\r\n\tmin: number;\r\n\tmax: number; \r\n\tshowing: boolean;\r\n\tonce?: boolean;\r\n\tsyncX?: boolean;\r\n\trelativeX?: number;\r\n\tanchorX?: number;\r\n\twidth?: number;\r\n\tparallaxPower?: number;\r\n\thideCallback?: Function;\r\n\txRecord?: number;\r\n}\r\n\r\nexport class HomeTimelineMain extends Controller {\r\n\r\n\tpublic activeLogoRange: number = 0.5;\r\n\tpublic onCompleteExit: Function;\r\n\r\n\tprivate _config: HomeJSONModel;\r\n\tprivate _active: boolean = true;\r\n\tprivate _created: boolean = false;\r\n\tprivate _animatingToWork: boolean = false;\r\n\t//private _logoTimeline: LogoMorphTimeline;\r\n\r\n\tprivate _progress: number = 0.5;\r\n\tprivate _velocity: number = 0;\r\n\tprivate _mouseController: MouseController;\r\n\r\n\tprivate _$intro: HTMLElement;\r\n\tprivate _$screens: HTMLElement;\r\n\tprivate _$spaces: HTMLElement;\r\n\tprivate _$dragToExplore: HTMLElement;\r\n\r\n\tprivate _$homeContainer: PIXI.Container;\r\n\tprivate _innerWidth: number;\r\n\tprivate _innerHeight: number;\r\n\tprivate _virtualWidth: number;\r\n\tprivate _virtualHeight: number;\r\n\tprivate _containerX: number;\r\n\r\n\tprivate _relativeParallaxX: number;\r\n\tprivate _relativeParallaxXToProgressRatio: number;\r\n\r\n\tprivate _items: Array<TimelineItem> = [];\r\n\tprivate _particles: Array<TimelineItem> = [];\r\n\r\n\tprivate _cssElements: Array<CSSElement> = [];\r\n\tprivate _dom: DOMHelper;\r\n\tprivate _domRefs: any;\r\n\r\n\tprivate _timeouts: any = {};\r\n\tprivate _tweens: any = {};\r\n\tprivate _intervals: any = {};\r\n\r\n\tprivate _state: TimelineStateType  = TimelineStateType.INTRO;\r\n\r\n\tprivate _timelineRegionManager: TimelineRegionManager;\r\n\r\n\tprivate _pagingTextScrable: TextScramble;\r\n\t\r\n\t//Explore button label: \r\n\tprivate _screensTextScrable: TextScramble;\r\n\tprivate _spacesTextScrable: TextScramble;\r\n\tprivate _spacesButtonLabel: HTMLElement;\r\n\tprivate _screensButtonLabel: HTMLElement;\r\n\tprivate _screensButtonTextShowing: boolean = false;\r\n\tprivate _spacesButtonTextShowing: boolean = false;\r\n\r\n\tconstructor(mouseController: MouseController, config: HomeJSONModel ) {\r\n\t\t\r\n\t\tsuper('HomeTimelineMain');\r\n\t\tthis._timelineRegionManager = new TimelineRegionManager();\r\n\t\tthis._mouseController = mouseController;\r\n\t\tthis._dom = Debugbase.DOM;\r\n\t\tthis._config = config;\r\n\r\n\r\n\r\n\t}\r\n\r\n\tpublic get containerX(): number {\r\n\t\treturn this._containerX;\r\n\t}\r\n\r\n\tpublic get progress(): number {\r\n\t\treturn this._progress;\r\n\t}\r\n\r\n\tpublic create(): void {\r\n\t\t\r\n\t}\r\n\r\n\t/** Home particle textures are ready so */\r\n\tpublic createParticlesPixi($homeContainer: PIXI.Container, spritesheet: PIXI.Spritesheet): void {\r\n\t\tthis.resize();\r\n\t\tthis._setContainerX();\r\n\t\tthis._$homeContainer = $homeContainer;\r\n\t\tthis._createItems($homeContainer, spritesheet);\r\n\t\tthis._created = true;\r\n\t}\r\n\r\n\t/** Set if the timeline is active or not */\r\n\tpublic setActive(active: boolean): void {\r\n\t\tthis._active = active;\r\n\t}\r\n\r\n\t/** Update the progress based on the users X drag */\r\n\tpublic setProgress(ratio: number, overrideActiveFlag: boolean = false): void {\r\n\r\n\t\tif (!this._created) {\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tif (!overrideActiveFlag && !this._active) {\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tthis._progress = ratio;\r\n\t\tthis._setContainerX();\r\n\r\n\t}\r\n\r\n\t/** Set the CORE UI refs for elements overlaid over the home screen: */\r\n\tpublic setUIRefs($intro: HTMLElement, $screens: HTMLElement, $spaces: HTMLElement, $dragToExplore: HTMLElement ): void {\r\n\t\t\r\n\t\tthis._domRefs = {\r\n\t\t\tscreens: $screens,\r\n\t\t\tspaces: $spaces\r\n\t\t};\r\n\r\n\r\n\t\tthis._cssElements = [\r\n\t\t\t{id: 'intro', $target: $intro, showing: true, min: 0.42, max: 0.58, syncX: false, relativeX: 0.5, anchorX: 0.5, width: $intro.clientWidth, parallaxPower: 0.4},\r\n\t\t\t{id: 'dragToExplore', $target: $dragToExplore, showing: true, min: 0.47, max: 0.53, once: false, \r\n\t\t\thideCallback: () => { this.get('Home').stopPagingGuide(); }\r\n\t\t\t},\r\n\t\t\t{id: DepartmentType.SCREENS, $target: $screens, showing: false, min: -1, max: 0.1, syncX: true, relativeX: 0.02, anchorX: 0, width: 0, parallaxPower: 0.4},\r\n\t\t\t{id: DepartmentType.SPACES, $target: $spaces, showing: false, min: 0.9, max: 2, syncX: true, relativeX: 0.985, anchorX: 1, width: $spaces.clientWidth, parallaxPower: 0.4 },\r\n\t\t];\r\n\r\n\r\n\r\n\t\tthis._screensButtonLabel = document.querySelector('.home__explore__area.-screens .home__explore__area__label');\r\n\t\tconsole.log('this._screensButtonLabel', this._screensButtonLabel);\r\n\t\tthis._spacesButtonLabel = document.querySelector('.home__explore__area.-spaces .home__explore__area__label');\r\n\t\tthis._screensTextScrable = new TextScramble(this._screensButtonLabel, 15);\r\n\t\tthis._spacesTextScrable = new TextScramble(this._spacesButtonLabel, 15);\r\n\r\n\r\n\t}\r\n\r\n\t/** Set virtual width */\r\n\tpublic setVirtualWidth(width: number): void {\r\n\t\tthis._virtualWidth = width;\r\n\t\tthis.resize();\r\n\t}\r\n\r\n\t/** Resize event */\r\n\tpublic resize(): void {\r\n\r\n\t\tthis._innerHeight = window.innerHeight;\r\n\t\tthis._innerWidth = window.innerWidth;\r\n\t\tthis._virtualHeight = window.innerHeight;\r\n\t\t\r\n\t\t//Set the scale of the \r\n\t\tlet scale = this._virtualWidth  / (1920 * 3);\r\n\t\tif (scale > 1.0) {\r\n\t\t\tscale = 1.0;\r\n\t\t}\r\n\r\n\t\t//Loop through the items and pass the new values: \r\n\t\tthis._items.forEach((item: TimelineItem) => {\r\n\t\t\titem.resize(this._virtualWidth, this._virtualHeight, scale, this._innerWidth);\r\n\t\t});\r\n\t\t\r\n\t\t//Reset the width of the tracked elements\r\n\t\tthis._cssElements.forEach((css: CSSElement) => {\r\n\t\t\tif (css.$target.clientWidth) {\r\n\t\t\t\tcss.width = css.$target.clientWidth;\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t}\r\n\r\n\tpublic tick(mousecords: any = null, mouseIsDown: boolean = null, velocity: number = null, instant: boolean = false, skipCheck: boolean = false): void {\r\n\r\n\t\tif (!skipCheck && this._animatingToWork) {\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tthis._velocity = velocity;\r\n\t\tlet ratioYPos = (mousecords.y / this._innerHeight) - 0.5 ;\r\n\t\tlet ratioXPos = (mousecords.x / this._innerWidth) - 0.5 ;\r\n\t\tlet velocityRatio = (this._velocity / 10);\r\n\r\n\t\tthis._timelineRegionManager.tick(mousecords, this._containerX, this._virtualWidth, this._virtualHeight, this._progress, this._velocity);\r\n\r\n\t\tthis._items.forEach((item: TimelineItem) => {\r\n\t\t\titem.tick(this._progress, this._containerX, ratioYPos, ratioXPos, mouseIsDown, velocityRatio, instant, mousecords);\r\n\t\t});\r\n\r\n\t\t//Decide if UI style elements should be shown by setting their class to -show \r\n\t\tthis._setCSSClasses(instant);\r\n\r\n\t\t//Process the explore text scramble effect: \r\n\t\tthis._processExploreButtonHideShow();\r\n\r\n\t}\r\n\r\n\tpublic animateToWork(department: DepartmentType): void {\r\n\r\n\t\t//Freeze normal behaviours:\r\n\t\tthis._animatingToWork = true;\r\n\r\n\t\t//Loop through and animate to \r\n\t\t//todo add a filter to determine what side is in\r\n\t\tlet offY: number = this._getWorkOffY();\r\n\t\tthis._items.forEach((item: TimelineItem) => {\r\n\t\t\t//if (item.department === department) {\r\n\t\t\t\titem.animateToWork(offY);\r\n\t\t\t//}\r\n\t\t});\r\n\r\n\t\t//Animate off the UI:\r\n\t\t//Set x/y before as its being handle with style direct to stop TweenMax.set being called on every frame \r\n\t\tlet cssElement: CSSElement =  this._getCSSElementById(department);\r\n\t\tlet $ui: HTMLElement = this._domRefs[department];\r\n\t\tgsap.TweenMax.set($ui, {x: cssElement.xRecord, y: 0});\r\n\t\tthis._tweens.ui = gsap.TweenMax.to($ui, 0.8, {y: offY, ease: gsap.Power3.easeIn});\r\n\t\tthis._timeouts.out = setTimeout( () =>  this.onCompleteExit(), 1500);\r\n\r\n\t}\r\n\r\n\tpublic animateFromWork(department: DepartmentType, delay: number = 1): void {\r\n\r\n\t\tthis._progress = (department === DepartmentType.SCREENS) ? 0 : 1;\r\n\r\n\t\t//Freeze normal behaviours:\r\n\t\tthis._animatingToWork = true;\r\n\r\n\t\t\t//this._setCSSClasses(true);\r\n\r\n\t\t//Animate off the UI:\r\n\r\n\t\tlet $ui: HTMLElement = this._domRefs[department];\r\n\t\t\r\n\t\tsetTimeout( () => { \r\n\r\n\t\tthis._items.forEach((item: TimelineItem) => {\r\n\t\t\tif (item.department === department) {\r\n\t\t\t\titem.animateFromWork(delay);\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t\tthis._setCSSClasses(true);\r\n\t\tlet cssElement: CSSElement =  this._getCSSElementById(department);\r\n\r\n\t\tgsap.TweenMax.set($ui, {x: cssElement.xRecord, y: this._getWorkOffY()});\r\n\t\tthis._tweens.ui = gsap.TweenMax.to($ui, 0.8, {y: 0, x: cssElement.xRecord, ease: gsap.Power3.easeOut, delay: delay});\r\n\r\n\t\t}, 100);\r\n\t\t\r\n\t}\r\n\r\n/** Remove any animations */\r\n\tpublic resetIntervalsAndAnimations(): void {\r\n\r\n\t\t//Loop through and kill any tweens: \r\n\t\tObject.keys(this._tweens).forEach( (key: string) => {\r\n\t\t\t//If active section then it will just be a blank string (as HTML is on main page load an not needed)\r\n\t\t\tthis._tweens[key].kill();\r\n\t\t});\r\n\r\n\t\t//Loop through the partciles: \r\n\t\tthis._items.forEach((item: TimelineItem) => {\r\n\t\t\titem.resetIntervalsAndAnimations();\r\n\t\t});\r\n\r\n\t}\r\n\r\n\t/** Reset for deeplink */\r\n\tpublic resetForDeeplink(): void {\r\n\r\n\t\tthis._animatingToWork = false;\r\n\r\n\t\t//Loop through home particles at reset: \r\n\t\tthis._items.forEach((item: TimelineItem) => {\r\n\t\t\titem.reset();\r\n\t\t});\r\n\r\n\t\t//Reset the y position of the spaces / screens UI elements: \r\n\t\tgsap.TweenMax.set([this._domRefs.screens, this._domRefs.spaces], {y: 0});\r\n\r\n\t}\r\n\r\n\t/** Reset when coming back from work */\r\n\tpublic resetFromWork(department: DepartmentType): void {\r\n\t\r\n\t\tthis._animatingToWork = false;\r\n\r\n\t\tlet offY: number = this._getWorkOffY();\t\r\n\r\n\t\t//Loop through home particles at reset \r\n\t\tthis._items.forEach((item: TimelineItem) => {\r\n\t\t\t//If active department then reset in place for the animation in\r\n\t\t\t//Otherwise just reset as standard tile \r\n\t\t\tif (item.department ===  department) {\r\n\t\t\t\titem.resetFromWork(offY);\r\n\t\t\t} else {\r\n\t\t\t\titem.reset();\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t\t//Put the HTML ui element for the department off-screen: \r\n\t\tlet $ui: HTMLElement = this._domRefs[department];\r\n\t\tgsap.TweenMax.set($ui,  {y: offY});\r\n\r\n\t}\r\n\r\n\t/** Show for deeplink (fullscreen preloader) */\r\n\tpublic showForDeeplink(): void {\r\n\t\t//ANIMATE IN MAIN ITEMS AS REQUIRD HERE: \r\n\t}\r\n\r\n\tpublic resetAnimationFreeze(): void {\r\n\t\tthis._animatingToWork = false;\r\n\t}\r\n\r\n\tpublic homeIntroHover(): void {\r\n\t\t(window as any ).introActive = true;\r\n\t\tthis._setParticleState('HomeParticles', TimelineStateType.HOME_LOGO_OVER);\r\n\t}\r\n\r\n\tpublic setButtonHover(center: Point): void {\r\n\t\t(window as any ).buttonActive = true;\r\n\t\tthis._setParticleState('HomeParticles', TimelineStateType.HOME_LOGO_OVER);\r\n\t\tthis._setParticleRepellCenter('HomeParticles', center);\r\n\t}\r\n\r\n\tpublic setButtonOut(type: DepartmentType): void {\r\n\t\t(window as any ).buttonActive = false;\r\n\t\tlet stateType = (type === DepartmentType.SCREENS) ? TimelineStateType.SCREENS : TimelineStateType.SPACES; \r\n\t\tthis._setParticleState('HomeParticles', stateType);\r\n\t}\r\n\r\n\tpublic homeIntroMouseOut(): void {\r\n\r\n\t\tif ( (window as any ).introComplete ) {\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tthis._setParticleState('HomeParticles', TimelineStateType.INTRO);\r\n\t}\r\n\r\n\t//Private \r\n\t//-----------------------------------------------------------------------------------------------\r\n\t//-----------------------------------------------------------------------------------------------\r\n\t//-----------------------------------------------------------------------------------------------\r\n\t//-----------------------------------------------------------------------------------------------\r\n\r\n\t//Create the larger items used in the home structure like logos, swirls, etc\r\n\tprivate _createItems($homeContainer: PIXI.Container, spritesheet: PIXI.Spritesheet): void {\r\n\r\n\t\t//Loop through and create all particles: \r\n\t\tthis._config.particles.forEach( (particleData: HomeParticleJSONModel) => {\r\n\t\t\tif (!particleData.disable) {\r\n\t\t\t\tthis._createParticle($homeContainer, spritesheet, particleData);\t\t\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t\t//Loop through and create all particles: \r\n\t\tthis._config.regions.forEach( (region: TimelineRegionParams) => {\t\r\n\t\t\tthis._createTimelineRegion(region);\r\n\t\t});\r\n\r\n\t\tthis._setContainerX();\r\n\t\tthis.resize();\r\n\r\n\t}\r\n\r\n\t/** Create single partcile */\r\n\tprivate _createParticle($homeContainer: PIXI.Container, spritesheet: PIXI.Spritesheet, particleData: HomeParticleJSONModel): void {\r\n\t\t\r\n\t\tlet item: TimelineItem;\r\n\t\tif (particleData.type === HomeParticleType.MASKED_TEXT ) {\r\n\t\t\t\r\n\t\t\t//Maked text setup\r\n\t\t\titem = new MaskedText( );\r\n\t\t\titem = this._configParticle<MaskedText>(item as MaskedText, particleData);\r\n\t\t\titem.create(particleData, {\r\n\t\t\t\tcontainer: $homeContainer,\r\n\t\t\t\tmaskTexture: spritesheet.textures[particleData.maskTexture],\r\n\t\t\t\tbackgroundTexture: spritesheet.textures[particleData.backgroundTexture]\r\n\t\t\t}); \r\n\r\n\t\t} else if (particleData.type === HomeParticleType.RELATIVE_CHILDREN ) {\r\n\t\t\t\r\n\t\t\t//Maked text setup\r\n\t\t\tconsole.log('SETUP relative-children');\r\n\t\t\titem = new RelativeChildren( );\r\n\t\t\titem = this._configParticle<RelativeChildren>(item as RelativeChildren, particleData);\r\n\r\n\t\t\titem.create(particleData, {\r\n\t\t\t\tcontainer: $homeContainer,\r\n\t\t\t\ttextures: spritesheet.textures\r\n\t\t\t}); \r\n\r\n\t\t}  else if (particleData.type === HomeParticleType.FIELD ) {\r\n\r\n\t\t\t//Particle fields: \r\n\t\t\t//Create a group of textures from the strings \r\n\t\t\tlet textures: Array <PIXI.Texture> = [];\r\n\t\t\tparticleData.textures.forEach( (textureString) => {\r\n\t\t\t\ttextures.push(spritesheet.textures[textureString]);\r\n\t\t\t});\r\n\r\n\t\t\t//Maked text setup\r\n\t\t\titem = new ParticleField( );\r\n\t\t\titem = this._configParticle<ParticleField>(item as ParticleField, particleData);\r\n\t\t\titem.create(particleData, {\r\n\t\t\t\tcontainer: $homeContainer,\r\n\t\t\t\ttextures: textures,\r\n\t\t\t\tparticleCount: particleData.particleCount\r\n\t\t\t}); \r\n\r\n\t\t} else {\r\n\t\t\t//A normal pixi sprite that will be animated along the timeline\r\n\t\t\titem = new TimelineItem();\r\n\t\t\titem = this._configParticle<TimelineItem>(item, particleData);\r\n\t\t\titem.create(particleData, {\r\n\t\t\t\tcontainer: $homeContainer,\r\n\t\t\t\ttexture: spritesheet.textures[particleData.texture]\r\n\t\t\t});\r\n\r\n\t\t}\r\n\r\n\t\t//Push in the item \r\n\t\tthis._items.push(item);\r\n\r\n\t}\r\n\r\n\t/** Config common particle settings */\r\n\tprivate _configParticle<T extends TimelineItem>(item: T, config: HomeParticleJSONModel): T {\r\n\t\t\r\n\t\titem.relativeX = config.relativeX;\r\n\t\titem.relativeY = config.relativeY;\r\n\t\titem.easePower = config.easePower;\r\n\t\titem.parallaxOffsetPower = config.parallaxOffsetPower;\r\n\t\titem.parallaxPowerMouse = config.parallaxPowerMouse;\t\r\n\r\n\t\tif (config.alpha) {\r\n\t\t\titem.alpha = config.alpha;\r\n\t\t}\r\n\r\n\t\tif (config.tint) {\r\n\t\t\titem.tint = config.tint;\r\n\t\t}\r\n\t\t\r\n\t\treturn item;\r\n\r\n\t}\r\n\r\n\t/** Set the container x Postion */\r\n\tprivate _setContainerX(): void {\r\n\t\tthis._containerX = -1 * (this._progress * (this._virtualWidth - this._innerWidth));\r\n\t}\r\n\r\n\t//Turn off on CSS classes based on their \r\n\t//Used to hide show the intro para and the screens / spaces UI \r\n\tprivate _setCSSClasses(instant: boolean = false): void {\r\n\t\t\r\n\t\tthis._cssElements.forEach((element) => {\r\n\t\t\t\r\n\t\t\tif (element.syncX) {\r\n\t\t\t\t//element.$target.style.transform = this._getCSSXtransform(element, instant);\r\n\t\t\t\t//gsap.TweenMax.set(element.$target, {x: this._getCSSY(element, instant)} );\r\n\t\t\t\telement.xRecord = this._getCSSX(element, instant);\t\r\n\t\t\t\telement.$target.style.transform = `translate3d(${element.xRecord}px, 0px, 0)`;\r\n\t\t\t}\t\r\n\r\n\t\t\tif (!element.showing && !element.once && this._progress >  element.min && this._progress < element.max && this._velocity < 0.01) {\r\n\t\t\t\tthis._dom.addClass(element.$target, '-show');\r\n\t\t\t\telement.showing = true;\r\n\t\t\t\tif (element.id === 'dragToExplore') {\r\n\t\t\t\t\t//gsap.TweenMax.to('#home-paging .ui__paging__item', 0.4, {autoAlpha: 0, ease: gsap.Power0.easeNone} );\r\n\t\t\t\t\tsetTimeout(() => this._pagingTextScrable.setText('Drag to explore'), 10);\t\r\n\t\t\t\t}\r\n\t\t\t} else if (element.showing && (this._progress <  element.min || this._progress > element.max)) {\r\n\t\t\t\tthis._dom.removeClass(element.$target, '-show');\r\n\t\t\t\r\n\r\n\t\t\t\telement.showing = false;\r\n\t\t\t\tif ( element.hideCallback) {\r\n\t\t\t\t\telement.hideCallback(element);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t});\r\n\t}\r\n\t\r\n\tprivate _getCSSX(element: CSSElement, instant: boolean = false): number {\t\t\r\n\t\treturn (this._virtualWidth * element.relativeX) + this._containerX - (element.anchorX * element.$target.clientWidth) + this._calculateParallaxDragOffsetX(element.relativeX, element.parallaxPower, instant);\r\n\t}\r\n\r\n\t//Calculate the parallax offset caused by draging left <> right: \r\n\tprivate _calculateParallaxDragOffsetX(relativeX: number, parallaxPower: number, instant: boolean = false): number {\r\n\t\t//Correct thing to allow for the fact the start/photoshop point of the timeline is center/0.5/home \r\n\t\tthis._relativeParallaxX = relativeX - 0.5;\r\n\t\t//Translate this into the current progress \r\n\t\tthis._relativeParallaxXToProgressRatio = this._relativeParallaxX - (this._progress - 0.5);\r\n\t\t//Set the offset as percentage of the container width (half the width because of the 0.5 logic). \r\n\t\t//let easePower: number = (instant) ? 1 : 2;\r\n\t\treturn this._relativeParallaxXToProgressRatio * parallaxPower * (this._virtualWidth / 2);\r\n\t}\r\n\r\n\t/** Get work off Y for when animating items off screen to work */\r\n\tprivate  _getWorkOffY(): number {\r\n\t\treturn (-1 * this._innerHeight) + 100;\r\n\t}\r\n\r\n\t/** Get the CSS element from an ID string */\r\n\tprivate _getCSSElementById(id: string): CSSElement {\r\n\t\tlet element: CSSElement = null;\r\n\t\tthis._cssElements.forEach( (item) => {\r\n\t\t\tif (item.id === id ) {\r\n\t\t\t\telement = item;\r\n\t\t\t}\r\n\t\t} );\r\n\t\treturn element;\r\n\t}\r\n\r\n\t/** Timeline region effects */\r\n\tprivate _createTimelineRegion(params: TimelineRegionParams): void {\r\n\t\tparams.pixiContainer = this._$homeContainer;\r\n\t\tparams.onEnter = (id: string) => this._onTimeRegionEnter( id );\r\n\t\tparams.onExit = (id: string) => this._onTimeRegionExit( id );\r\n\t\tthis._timelineRegionManager.add( params );\r\n\t}\r\n\r\n\t\r\n\tpublic introComplete(): void {\r\n\t\tthis._state = TimelineStateType.HOME;\r\n\t\tthis._setParticleState('HomeParticles', TimelineStateType.HOME_LOGO_OVER);\r\n\t\tthis._getParticles('intro')[0].fadeIn(0.8);\r\n\t\tlet logoItems: Array<TimelineItem> = this._getParticles('homeLogoLetter');\r\n\t\tlogoItems.forEach( (item) =>  item.fadeIn(0.5 ));\r\n\r\n\t\tgsap.TweenMax.to('#home-paging', 0.4, {autoAlpha: 1, ease: gsap.Power0.easeNone, delay: 2} );\r\n\t\t\r\n\t\t//Scramble in drag to explore: \r\n\t\t//TODO move to paging class: \r\n\t\tlet pagingCopy: HTMLElement = document.querySelector('#home-paging .ui__paging__title');\r\n\t\t//this.DOM.setText(pagingCopy, '');\r\n\t\tthis._pagingTextScrable = new TextScramble(pagingCopy, 15);\t\r\n\t\tsetTimeout( () =>  this._pagingTextScrable.setText('Drag to explore'), 2500);\r\n\r\n\t}\r\n\r\n\tprivate _onTimeRegionEnter(id: string): void {\r\n\r\n\t\tif (this._state ===  TimelineStateType.INTRO) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\t\r\n\t\tif (id === 'HomeLogoArea' && this._state === TimelineStateType.HOME) {\r\n\t\t\tthis._mouseController.setHiddenState(true);\r\n\t\t\tthis._setParticleState('HomeParticles', TimelineStateType.HOME_LOGO_OVER);\r\n\t\t}\r\n\r\n\t\tif (id === 'Screens') {\r\n\t\t\tthis._setParticleState('HomeParticles', TimelineStateType.SCREENS);\r\n\t\t\tthis.get('Home').setPagingIndex(0);\r\n\t\t\tthis._state =  TimelineStateType.SCREENS;\r\n\t\t\tthis._mouseController.setHiddenState(false);\r\n\t\t}\r\n\r\n\t\t//if (id === 'SpacesTransition') {\r\n\t\t//\tthis._setParticleState('HomeParticles', TimelineStateType.SPACES);\r\n\t\t//\tthis._mouseController.setHiddenState(false);\r\n\t\t//}\r\n\r\n\t\tif (id === 'Spaces') {\r\n\t\t\tthis._setParticleState('HomeParticles', TimelineStateType.SPACES);\r\n\t\t\tthis.get('Home').setPagingIndex(2);\r\n\t\t\tthis._state =  TimelineStateType.SPACES;\r\n\t\t\tthis._mouseController.setHiddenState(false);\r\n\t\t}\r\n\r\n\t\tif (id === 'Home') {\r\n\t\t\tthis._setParticleState('HomeParticles', TimelineStateType.HOME_LOGO_OUT);\r\n\t\t\tthis.get('Home').setPagingIndex(1);\r\n\t\t\tthis._state =  TimelineStateType.HOME;\r\n\t\t\tthis._mouseController.setHiddenState(false);\r\n\t\t}\r\n\r\n\t}\r\n\r\n\tprivate _onTimeRegionExit(id: string): void {\r\n\r\n\t\tif (this._state ===  TimelineStateType.INTRO) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\t\r\n\t\tif (id === 'HomeLogoArea' && this._state === TimelineStateType.HOME) {\r\n\t\t\tthis._mouseController.setHiddenState(false);\r\n\t\t\tthis._setParticleState('HomeParticles', TimelineStateType.HOME_LOGO_OUT);\r\n\t\t}\r\n\t}\r\n\r\n\tprivate _getParticles(id: string): Array<TimelineItem> {\r\n\t\tlet particles: Array<TimelineItem> = [];\r\n\r\n\t\tthis._items.forEach( (timelineItem: TimelineItem) =>  {\r\n\r\n\t\t\tif (timelineItem.id === id) {\r\n\r\n\t\t\t\tif (timelineItem.type === TimelineItemType.PARTICLE_FIELD || timelineItem.type === TimelineItemType.RELATIVE_CHILDREN) {\r\n\t\t\t\t\tlet particlesItems = (timelineItem as ParticleField).getItems();\r\n\t\t\t\t\tfor (let i = 0; i < particlesItems.length; i++) {\r\n\t\t\t\t\t\tparticles.push(particlesItems[i]);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif (timelineItem.type === TimelineItemType.PARTICLE) {\r\n\t\t\t\t\tparticles.push(timelineItem);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\t\r\n\t\t} );\r\n\r\n\t\treturn particles;\r\n\r\n\t}\r\n\r\n\tprivate _setParticleState(particlesId: string, timelineState: TimelineStateType): void {\r\n\t\tthis._getParticles(particlesId).forEach( (particle: TimelineItem) => {\r\n\t\t\tparticle.setTimelineState(timelineState);\r\n\t\t});\r\n\t}\r\n\r\n\tprivate _setParticleRepellCenter(particlesId: string, center: Point): void {\r\n\t\tthis._getParticles(particlesId).forEach( (particle: TimelineItem) => {\r\n\t\t\tparticle.setParticleRepellCenter(center);\r\n\t\t});\r\n\t}\r\n\r\n\tprivate _onIntroMouseDown(): void {\r\n\r\n\t}\r\n\r\n\tprivate _processExploreButtonHideShow(): void {\r\n\r\n\t\tif (!this._screensButtonTextShowing && this._progress < 0.02) {\r\n\t\t\tthis._screensButtonTextShowing = true;\r\n\t\t\tthis._screensTextScrable.setText('Explore');\r\n\t\t} else if (this._screensButtonTextShowing && this._progress >= 0.02) {\r\n\t\t\tthis._screensButtonTextShowing = false;\r\n\t\t\t//this.DOM.setText(this._screensButtonLabel, '');\r\n\t\t\tthis._screensTextScrable.setText('');\r\n\t\t}\r\n\r\n\t\tif (!this._spacesButtonTextShowing && this._progress > 0.98) {\r\n\t\t\tthis._spacesButtonTextShowing = true;\r\n\t\t\tthis._spacesTextScrable.setText('Explore');\r\n\t\t} else if (this._spacesButtonTextShowing && this._progress <= 0.98) {\r\n\t\t\tthis._spacesButtonTextShowing = false;\r\n\t\t\t//this.DOM.setText(this._spacesButtonLabel, '');\r\n\t\t\tthis._spacesTextScrable.setText('');\r\n\t\t}\r\n\r\n\t}\r\n\r\n}\r\n","export class AppEvents {\r\n\t\r\n\t//Loading\r\n\tpublic static readonly PIXI_RESOURCE_LOADED: string = 'PIXI_RESOURCE_LOADED'; \r\n\tpublic static readonly AJAX_HTML_LOADED: string = 'AJAX_HTML_LOADED'; \r\n\tpublic static readonly INTIAL_PRELOAD_COMPLETE: string = 'INTIAL_PRELOAD_COMPLETE'; \r\n\tpublic static readonly DEEP_LINK_LOADER_COMPLETE: string = 'DEEP_LINK_LOADER_COMPLETE';\r\n\r\n\tpublic static readonly VIEW_SETUP: string = 'VIEW_SETUP'; \r\n\t\r\n\t//Section chanegs / site naviagtion \r\n\tpublic static readonly CHANGE_SECTION: string = 'CHANGE_SECTION'; \r\n\tpublic static readonly SET_INTIAL_STATE: string = 'SET_INTIAL_STATE'; \r\n\tpublic static readonly POP_HISTORY_STATE: string = 'POP_HISTORY_STATE'; \r\n\t\r\n\t//Legacy, siwtch all to use change section...\r\n\tpublic static readonly WORK_DEPARMENT_SELECTED: string = 'WORK_DEPARMENT_SELECTED'; \r\n\tpublic static readonly PROJECT_SELECTED: string = 'PROJECT_SELECTED'; \r\n\t\r\n\tpublic static readonly CLOSE_PROJECT: string = 'CLOSE_PROJECT'; \r\n\tpublic static readonly DEBUG_LOGO_PRESS: string = 'DEBUG_LOGO_PRESS'; \r\n\tpublic static readonly SCROLL_WHEEL_NO_TARGET: string = 'SCROLL_WHEEL_NO_TARGET';\r\n\r\n\tpublic static readonly ACTIVE_DEPARTMENT_NAV_MENU_PRESS: string = 'ACTIVE_DEPARTMENT_NAV_MENU_PRESS';\r\n\tpublic static readonly MENU_STATE_CHANGE: string = 'MENU_STATE_CHANGE';\r\n\tpublic static readonly RESET_NAV_MENU: string = 'RESET_NAV_MENU';\r\n\t\r\n}\r\n","export enum SectionType {HOME = 'home', WORK = 'work', PROJECT = 'project', INFO = 'info'}\r\nexport enum InfoSectionType {ABOUT = 'about', STUDIO = 'studio', CONTACT = 'contact', JOBS = 'jobs'}\r\nexport enum DepartmentType {SCREENS = 'screens', SPACES = 'spaces'}\r\nexport enum BackgroundSetType {HOME = 'home', SCREENS = 'screens', SPACES = 'spaces'}\r\nexport enum ViewType {HOME = 'home', SCREENS = 'screens', SPACES = 'spaces', PROJECT = 'project', INFO = 'info'}\r\n\r\nexport enum DirectionalKeyType {UP = 'up', DOWN = 'down', PAGE_UP = 'pageup', PAGE_DOWN = 'pagedown', LEFT = 'left', RIGHT = 'right'}\r\nexport enum MenuStateType {OPEN = 'open', CLOSED = 'closed'}\r\n\r\nexport enum ProjectSlugType {\r\n\tMARKET_MASTERS = 'market-masters',\r\n\tMARCH_FOR_GIANTS = 'march-for-giants',\r\n\tTOY_TOWN = 'toy-town',\r\n\tTOTAL_DARKNESS = 'total-darkness',\r\n}\r\n\r\nexport enum PixiResourceType {\r\n\tBACKGROUNDS = 'backgrounds',  \r\n\tHOME_PARTCILES = 'home-partciles',\r\n\tLOGO_MORPH = 'logo-morph',  \r\n\tWORK_PARTICLES = 'work-particles-screens', \r\n\tWORK_BACKGROUNDS_SCREEN = 'work-background-screens',\r\n\tWORK_BACKGROUNDS_SPACES = 'work-background-spaces',\r\n\tMOTH = 'moth'\r\n}\r\n\r\nexport enum HomeParticleType {\r\n\tSTANDARD = 'standard',\r\n\tMASKED_TEXT = 'masked-text',\r\n\tFIELD = 'field',\r\n\tRELATIVE_CHILDREN = 'relative-children'\r\n}\r\n\r\nexport enum UIThemeColourType {\r\n\tLIGHT = 'light',\r\n\tDARK = 'dark',\r\n}\r\n\r\nexport enum ScrollerType {STANDARD = 'standard', CUSTOM = 'custom'}\r\n\r\n","import {DebugEvent} from 'debugbase/abstract/DebugEvent';\r\nimport {HTMLLoader} from 'debugbase/loader/HTMLLoader';\r\n\r\ninterface AjaxHTMLLoadedEventInterface {\r\n\tloader: HTMLLoader;\r\n}\r\n\r\nexport class AjaxHTMLLoadedEvent extends DebugEvent implements AjaxHTMLLoadedEventInterface {\r\n\t\r\n\tpublic static eventName: string = 'AJAX_HTML_LOADED_EVENT';\r\n\tpublic loader: HTMLLoader;\r\n\r\n\tconstructor (parameters: AjaxHTMLLoadedEventInterface) {\r\n\t\tsuper(parameters);\r\n\t}\r\n\r\n}\r\n","import {DebugEvent} from 'debugbase/abstract/DebugEvent';\r\nimport {ViewType} from 'app/data/Enums';\r\n\r\ninterface CustomCursorEventInterface {\r\n\ttype: string;\r\n\tactive: boolean;\r\n\tid: string;\r\n\ttheme?: string;\r\n}\r\n\r\nexport class CustomCursorEvent extends DebugEvent implements CustomCursorEventInterface {\r\n\t\r\n\tpublic static eventName: string = 'CUSTOM_CURSOR_EVENT';\r\n\tpublic type: string;\r\n\tpublic active: boolean;\r\n\tpublic id: string;\r\n\tpublic theme: string;\r\n\r\n\tconstructor (parameters: CustomCursorEventInterface) {\r\n\t\tsuper(parameters);\r\n\t}\r\n\r\n}\r\n","import {DebugEvent} from 'debugbase/abstract/DebugEvent';\r\nimport {DirectionalKeyType} from 'app/data/Enums';\r\n\r\ninterface DebugKeypressEventInterface {\r\n\tkeyType: DirectionalKeyType;\r\n}\r\n\r\nexport class DebugKeypressEvent extends DebugEvent implements DebugKeypressEventInterface {\r\n\t\r\n\tpublic static eventName: string = 'KEYPRESS_EVENT';\r\n\tpublic keyType: DirectionalKeyType;\r\n\r\n\tconstructor (parameters: DebugKeypressEventInterface) {\r\n\t\tsuper(parameters);\r\n\t}\r\n\r\n}\r\n","import {DebugEvent} from 'debugbase/abstract/DebugEvent';\r\n\r\ninterface DebugMouseWheelEventInterface {\r\n\tdelta: number;\r\n}\r\n\r\nexport class DebugMouseWheelEvent extends DebugEvent implements DebugMouseWheelEventInterface {\r\n\t\r\n\tpublic static eventName: string = 'MOUSE_WHEEL_EVENT';\r\n\tpublic delta: number;\r\n\r\n\tconstructor (parameters: DebugMouseWheelEventInterface) {\r\n\t\tsuper(parameters);\r\n\t}\r\n\r\n}\r\n","import {DebugEvent} from 'debugbase/abstract/DebugEvent';\r\nimport {DepartmentType} from 'app/data/Enums';\r\n\r\ninterface HomeDepartmentReachedEventInterface {\r\n\tdepartment: DepartmentType;\r\n}\r\n\r\nexport class HomeDepartmentReachedEvent extends DebugEvent implements HomeDepartmentReachedEventInterface {\r\n\t\r\n\tpublic static eventName: string = 'HOME_DEPARTMENT_REACHED';\r\n\tpublic department: DepartmentType;\r\n\r\n\tconstructor (parameters: HomeDepartmentReachedEventInterface) {\r\n\t\tsuper(parameters);\r\n\t}\r\n\r\n}\r\n","import {DebugEvent} from 'debugbase/abstract/DebugEvent';\r\nimport {HTMLLoader} from 'debugbase/loader/HTMLLoader';\r\n\r\ninterface JSONLoadEventInterface {\r\n\tid: string;\r\n\tjson: any;\r\n}\r\n\r\nexport class JSONLoadEvent extends DebugEvent implements JSONLoadEventInterface {\r\n\t\r\n\tpublic static eventName: string = 'JSON_LOAD_EVENT';\r\n\tpublic id: string;\r\n\tpublic json: any;\r\n\r\n\tconstructor (parameters: JSONLoadEventInterface) {\r\n\t\tsuper(parameters);\r\n\t}\r\n\r\n}\r\n","import {DebugEvent} from 'debugbase/abstract/DebugEvent';\r\nimport {PixiResourceType} from 'app/data/Enums';\r\n\r\ninterface PixiResourceLoadEventInterface {\r\n\ttype: PixiResourceType;\r\n\tresource: any;\r\n}\r\n\r\nexport class PixiResourceLoadEvent extends DebugEvent implements PixiResourceLoadEventInterface {\r\n\t\r\n\tprotected static eventName: string = 'PIXI_RESOURCE_READY_EVENT';\r\n\ttype: PixiResourceType;\r\n\tresource: any;\r\n\r\n\tconstructor (parameters: PixiResourceLoadEventInterface) {\r\n\t\tsuper(parameters);\r\n\t}\r\n\r\n}\r\n","import {DebugEvent} from 'debugbase/abstract/DebugEvent';\r\n\r\ninterface QueProjectEventInterface {\r\n\tslug: string;\r\n\tindex: number;\r\n}\r\n\r\nexport class QueProjectEvent extends DebugEvent implements QueProjectEventInterface {\r\n\t\r\n\tpublic static eventName: string = 'QUE_PROJECT_EVENT';\r\n\tpublic slug: string;\r\n\tpublic index: number;\r\n\r\n\tconstructor (parameters: QueProjectEventInterface) {\r\n\t\tsuper(parameters);\r\n\t}\r\n\r\n}\r\n","import {DebugEvent} from 'debugbase/abstract/DebugEvent';\r\nimport {ViewType} from 'app/data/Enums';\r\nimport {BehaviourConfig } from 'app/behaviour/managers/ScrollBehaviourManager';\r\n\r\ninterface RegionViewportEventInterface {\r\n\tviewable: boolean;\r\n\tregion: HTMLElement;\r\n\tconfig: BehaviourConfig;\r\n}\r\n\r\nexport class RegionViewportEvent extends DebugEvent implements RegionViewportEventInterface {\r\n\t\r\n\tpublic static eventName: string = 'REGION_VIEWPORT_EVENT';\r\n\tpublic viewable: boolean;\r\n\tpublic region: HTMLElement;\r\n\tpublic config: BehaviourConfig;\r\n\r\n\tconstructor (parameters: RegionViewportEventInterface) {\r\n\t\tsuper(parameters);\r\n\t}\r\n\r\n}\r\n","import {DebugEvent} from 'debugbase/abstract/DebugEvent';\r\n\r\ninterface SidePagingClickEventInterface {\r\n\tindex: number;\r\n\ttargetSelector: string;\r\n}\r\n\r\nexport class SidePagingClickEvent extends DebugEvent implements SidePagingClickEventInterface {\r\n\t\r\n\tpublic static eventName: string = 'SIDE_PAGING_CLICK_EVENT';\r\n\tpublic index: number;\r\n\tpublic targetSelector: string;\r\n\r\n\tconstructor (parameters: SidePagingClickEventInterface) {\r\n\t\tsuper(parameters);\r\n\t}\r\n\r\n}\r\n","import {DebugEvent} from 'debugbase/abstract/DebugEvent';\r\nimport {UIThemeColourType} from 'app/data/Enums';\r\n\r\ninterface SidebarChangeEventInterface {\r\n\ttheme: UIThemeColourType;\r\n\tindex: number;\r\n}\r\n\r\nexport class SidebarChangeEvent extends DebugEvent implements SidebarChangeEventInterface {\r\n\t\r\n\tpublic static eventName: string = 'SIDEBAR_CHANGE_EVENT';\r\n\tpublic theme: UIThemeColourType;\r\n\tpublic index: number;\r\n\r\n\tconstructor (parameters: SidebarChangeEventInterface) {\r\n\t\tsuper(parameters);\r\n\t}\r\n\r\n}\r\n","import {DebugEvent} from 'debugbase/abstract/DebugEvent';\r\nimport {UIThemeColourType} from 'app/data/Enums';\r\n\r\ninterface UIThemeChangeEventInterface {\r\n\ttheme: UIThemeColourType;\r\n}\r\n\r\nexport class UIThemeChangeEvent extends DebugEvent implements UIThemeChangeEventInterface {\r\n\t\r\n\tpublic static eventName: string = 'UI_THEME_CHANGE_EVENT';\r\n\tpublic theme: UIThemeColourType;\r\n\r\n\tconstructor (parameters: UIThemeChangeEventInterface) {\r\n\t\tsuper(parameters);\r\n\t}\r\n\r\n}\r\n","import {DebugEvent} from 'debugbase/abstract/DebugEvent';\r\nimport {ViewType} from 'app/data/Enums';\r\n\r\ninterface ViewReadyEventInterface {\r\n\tview: ViewType;\r\n}\r\n\r\nexport class ViewReadyEvent extends DebugEvent implements ViewReadyEventInterface {\r\n\t\r\n\tpublic static eventName: string = 'VIEW_READY_EVENT';\r\n\tpublic view: ViewType;\r\n\r\n\tconstructor (parameters: ViewReadyEventInterface) {\r\n\t\tsuper(parameters);\r\n\t}\r\n\r\n}\r\n","import {GA} from 'debugbase/tracking/GA';\r\nimport {DragBreakpoints, axisType} from 'debugbase/util/DragBreakpoints';\r\nimport {Module} from 'debugbase/abstract/Module';\r\nimport { Events } from 'debugbase/events/Events';\r\n\r\nimport {CustomCursorEvent} from 'app/event/CustomCursorEvent';\r\n\r\n/** To manage side dragging elements  */\r\nexport class DragPanel extends Module {\r\n\r\n\tpublic config = {\r\n\t\tdragToMoveRatio: 0.32,\r\n\t\tdragEasePower: 6,\r\n\t\treleaseEasePower: 10,\r\n\t\tforceSnap: false,\r\n\t\tstartProgress: 0,\r\n\t\tcursorTheme: 'dark',\r\n\t\tvelocityFriction: 0.8,\r\n\t};\r\n\r\n\tprivate _$draw: HTMLElement;\t\t\t\t\t\t\t\t\t//The inner element that slides left / right \r\n\tprivate _width: number;\t\t\t\t\t\t\t\t\t\t\t//The cached clientWidth ofthe draw\r\n\tprivate _x: number = 0;\t\t\t\t\t\t\t\t\t\t\t//X position of the drag in px\r\n\tprivate _targetX: number = 0;\t\t\t\t\t\t\t\t\t//X target \r\n\tprivate _maxScroll: number = 0; \t\t\t\t\t\t\t\t//Max scroll of the panel (will be a minius number)\r\n\tprivate _dragController: DragBreakpoints;\t\t\t\t\t\t//The controller for the dragging / inernia, borrowed from the home/work timelines\r\n\tprivate _easePower: number;\r\n\tprivate _sizeSet: boolean = false;\r\n\tprivate _velocity: number = 0;\r\n\r\n\tpublic create() {\r\n\t\tthis._easePower = this.config.releaseEasePower;\r\n\t\tthis._$draw = this.$container.querySelector('.dragpanel__draw');\r\n\t\tthis._$draw.addEventListener('resize', this._onResize.bind(this));\r\n\t\tthis.$container.addEventListener('mouseover', this._onMouseOver.bind(this));\r\n\t\tthis.$container.addEventListener('mouseout', this._onMouseOut.bind(this));\r\n\t\tthis._createDragControl();\r\n\t\tthis._onResize();\r\n\r\n\t\tif (window.innerWidth < 1030) {\r\n\t\t\tthis.config.dragEasePower = 5;\r\n\t\t\tthis.config.releaseEasePower = 5;\r\n\t\t}\r\n\t}\r\n\r\n\tpublic destroy(): void {\r\n\t\tthis._$draw.removeEventListener('resize', this._onResize.bind(this));\r\n\t\tthis.$container.removeEventListener('mouseover', this._onMouseOver.bind(this));\r\n\t\tthis.$container.removeEventListener('mouseout', this._onMouseOut.bind(this));\r\n\t\tthis._$draw = null;\r\n\t\tsuper.destroy();\r\n\t}\r\n\r\n\tpublic resize(): void {\r\n\t\tthis._onResize();\r\n\t}\r\n\r\n\tpublic tick(): void {\r\n\r\n\t\tif (!this._sizeSet && this.$container.clientWidth) {\r\n\t\t\tthis._onResize();\r\n\t\t\tthis._sizeSet = true;\r\n\t\t}\r\n\r\n\t\tif (this._sizeSet) {\r\n\t\t\tthis._setDrawPosition();\r\n\t\t}\r\n\r\n\t}\r\n\r\n\t//Private \r\n\t//--------------------------------------------------------------------------------\r\n\tprivate _onResize(): void {\r\n\t\tthis._width = this._$draw.scrollWidth;\r\n\t\tthis._maxScroll =  -1 * (this._width - this.$container.clientWidth);\r\n\t\tthis._dragController.setVirtualWidth(this._width);\r\n\t\tthis.math.constrain(this._targetX, this._maxScroll, 0);\r\n\t}\r\n\r\n\tprivate _onMouseOver(e: MouseEvent): void {\r\n\t\tEvents.dispatch(new CustomCursorEvent({type: 'hitarea', active: true, id: this.id, theme: this.config.cursorTheme}));\r\n\t}\r\n\r\n\tprivate _onMouseOut(e: MouseEvent): void {\r\n\t\tEvents.dispatch(new CustomCursorEvent({type: 'hitarea', active: false, id: this.id, theme: this.config.cursorTheme}) );\r\n\t}\r\n\r\n\tprivate _createDragControl(): void {\r\n\r\n\t\tthis._dragController = new DragBreakpoints(8, false, 1, false, this.$container);\r\n\t\tthis._dragController.setDragToMoveRatio(this.config.dragToMoveRatio);\r\n\t\tthis._dragController.easePower = 1;\r\n\t\tthis._dragController.releaseEasePower = 1;\r\n\t\t\r\n\t\tthis._dragController.setStartThreshold(0.02);\r\n\r\n\t\tthis._dragController.forceSnap = false;\r\n\t\tthis._dragController.setProgress(this.config.startProgress);\r\n\t\tthis._dragController.setActive(true);\r\n\r\n\t\t//Ticker: \r\n\t\tthis._dragController.onTick = (progressRatio: number) => { \r\n\t\t\tthis._targetX  = progressRatio * this._maxScroll;\r\n\t\t};\r\n\r\n\t\tthis._dragController.onStartDrag = () => {\r\n\t\t\tEvents.dispatch(new CustomCursorEvent({type: 'drag', active: true, id: this.id}));\r\n\t\t\tthis._easePower = this.config.dragEasePower;\r\n\t\t};\r\n\r\n\t\tthis._dragController.onStopDrag = () => {\r\n\t\t\tEvents.dispatch(new CustomCursorEvent({type: 'drag', active: false, id: this.id}));\r\n\t\t\tthis._easePower = this.config.releaseEasePower;\r\n\t\t};\r\n\t}\r\n\r\n\tprivate _setDrawPosition(): void {\r\n\t\tthis._x = this._x  + (( this._targetX - this._x ) / this._easePower );\r\n\t\tthis._$draw.style.transform = `translate3d(${this._x}px, 0, 0)`;\r\n\t}\r\n\r\n\tprivate _processVelocity(): void {\r\n\t\tthis._velocity *= this.config.velocityFriction;\r\n\t}\r\n\r\n}\r\n","/** Class that setups a touch / mouse down that resets itself after too long */\r\nimport {Module} from 'debugbase/abstract/Module';\r\nexport class HitArea extends Module {\r\n\t\r\n\tpublic config: any = {\r\n\t\tonUpdate: null,\r\n\t\tonCancel: null,\r\n\t\tonComplete: null,\r\n\t\txTolerence: 30,\r\n\t\tyTolerence: 30,\r\n\t\tstartAmount: 15,\r\n\t\tcompleteAmount: 55,\t\r\n\t\tslug: 'market-masters',\t\t\r\n\t\ttitle: '',\r\n\t\tindex: 0,\r\n\t\thref: '/screens/market-masters/'\t\r\n\t};\r\n\r\n\tprivate _rect: DOMRect;\r\n\tprivate _mouseIsDown: boolean;\r\n\tprivate _isIntersecting: boolean;\r\n\tprivate _mouseDownCords: any;\r\n\tprivate _tickCount: number = 0;\r\n\r\n\tcreate(): void {\r\n\t\tconsole.log('Create', this.id);\r\n\t}\r\n\r\n\tpublic get mouseIsDown(): boolean {\r\n\t\treturn this._mouseIsDown;\r\n\t}\r\n\r\n\t/** Start mousedown of touchstart */\r\n\tpublic startMouseDown(cords: any): void {\r\n\t\tthis._mouseDownCords = {x: cords.x , y: cords.y};\r\n\t\tthis._checkIsIntersecting(this._mouseDownCords);\r\n\t\tif (this._isIntersecting) {\r\n\t\t\tthis._mouseIsDown = true;\r\n\t\t}\r\n\t}\r\n\r\n\tpublic mouseUp(): void {\r\n\t\tthis._reset();\r\n\t}\r\n\r\n\t/** Update mouse / touchmove cords */\r\n\tpublic updateMouseCords(cords: any): void {\r\n\t\tthis._checkIsIntersecting(cords);\r\n\t\tif ( this._mouseIsDown  && this._isIntersecting) {\r\n\t\t\tthis._update();\r\n\t\t\tthis._checkComplete();\r\n\t\t\tthis._checkMoveTolerence(cords);\r\n\t\t}\r\n\t}\r\n\r\n\t/** Set x/y/scale of hit area */\r\n\tpublic setPosition(x: number, y: string, scale: number): void {\r\n\t\t(this.$container as HTMLElement).style.transform = `translate3d(${x}px, ${y}, 0) scale(${scale})`;\r\n\t} \r\n\r\n\t//Private \r\n\t//---------------------------------------------------------------------\r\n\r\n\t/** Check if cords are intersecting with this element */\r\n\tprivate _checkIsIntersecting(cords: any): void {\r\n\t\tthis._rect = this.$container.getBoundingClientRect() as DOMRect;\r\n\t\tthis._isIntersecting =   this._rect.x <= cords.x && cords.x <= this._rect.x + this._rect.width &&\r\n               this._rect.y <= cords.y &&  cords.y  <= this._rect.y + this._rect.height;\r\n\t}\r\n\r\n\t/** Check if the user moves too far (and therefor resets the action) */\r\n\tprivate _checkMoveTolerence(cords: any): void {\r\n\r\n\t\tif (!this._mouseIsDown) {\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tif ( Math.abs(cords.x - this._mouseDownCords.x) >  this.config.xTolerence || \r\n\t\t\tMath.abs(cords.y - this._mouseDownCords.y)  > this.config.yTolerence) {\r\n\t\t\tthis._reset();\r\n\t\t\tif (this.config.onCancel) {\r\n\t\t\t\tthis.config.onCancel();\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t}\r\n\r\n\t/** Update */\r\n\tprivate _update(): void {\r\n\t\tthis._tickCount += 1;\r\n\t\tif (this.config.onUpdate && this._tickCount > this.config.startAmount) {\r\n\t\t\t\r\n\t\t\tthis.config.onUpdate({\r\n\t\t\t\tcount: this._tickCount, \r\n\t\t\t\tratio: Math.min(1, (this._tickCount - this.config.startAmount) / (this.config.completeAmount - this.config.startAmount))\r\n\t\t\t});\r\n\r\n\t\t}\r\n\t}\r\n\r\n\t/** check if the click is complete */\r\n\tprivate _checkComplete(): void {\r\n\t\tif (this._tickCount >= this.config.completeAmount) {\r\n\t\t\tthis._reset();\r\n\t\t\tif (this.config.onComplete) {\r\n\t\t\t\tthis.config.onComplete(this.config);\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\t/* reset */\r\n\tprivate _reset(): void {\r\n\t\tthis._tickCount = 0;\r\n\t\tthis._mouseIsDown = false;\r\n\t\tthis._isIntersecting = false;\r\n\t\tthis._mouseDownCords = null;\r\n\t}\r\n\r\n}\r\n","import {Module} from 'debugbase/abstract/Module';\r\n//import {TweenMax} from 'gsap';\r\n\r\nexport class LoaderGraphic extends Module {\r\n\r\n\tprivate _$maskedLogo: HTMLElement;\r\n\r\n\tpublic create(): void {\r\n\t\tthis._$maskedLogo = this.$container.querySelector('.home__logo__image.-masked');\r\n\t}\r\n\r\n\tpublic progress(ratio: number): void {\r\n\t\tvar width: number = 278 * ratio; \r\n\t\tgsap.TweenMax.to(this._$maskedLogo, 0, {width: width} );\r\n\t}\r\n\r\n\tpublic animateOut(): void {\r\n\t\t//gsap.TweenMax.to('.home__logo__image', 0.35, {scale: 1.15});\r\n\t\t//gsap.TweenMax.to('.home__logo__image', 0.35, {scale: 1, delay: 0.35});\r\n\t\tgsap.TweenMax.to('.home__logo__image', 0.6, {autoAlpha: 0, scale:2, ease: gsap.Power3.easeOut });\r\n\t}\r\n\r\n\tpublic animateIn(): void {\r\n\t\t//gsap.TweenMax.to('.home__logo__image', 0.35, {scale: 1.15});\r\n\t\t//gsap.TweenMax.to('.home__logo__image', 0.35, {scale: 1, delay: 0.35});\r\n\t\tgsap.TweenMax.to('.home__logo__image', 0.6, {autoAlpha: 1, scale:1, ease: gsap.Power3.easeOut });\r\n\t}\r\n\r\n}\r\n","import {GA} from 'debugbase/tracking/GA';\r\nimport {Module} from 'debugbase/abstract/Module';\r\n//import {TweenMax, Back, Power3, Power0} from 'gsap';\r\nimport {Events} from 'debugbase/events/Events';\r\n\r\nexport class Paging extends Module {\r\n\r\n\tpublic config = {\r\n\t\tactiveIndex: 0,\r\n\t\tfreezeInteractionOnClick: 0,\r\n\t\ttrack: true,\r\n\t};\r\n\r\n\tprivate _$items: NodeListOf<HTMLElement>;\r\n\tprivate _onClick: Function;\r\n\tprivate _checkIndex: number;\r\n\tprivate _guideCycleInt: number;\r\n\tprivate _guideIndex: number = 0;\r\n\tprivate _oldGuideIndex: number;\r\n\tprivate _guideDirection: number = 1;\r\n\tprivate _freezeClick: boolean = false; \r\n\r\n\tpublic create(): void {\r\n\t\t\r\n\t\tthis._$items = this.$container.querySelectorAll('.ui__paging__item');\r\n\t\tthis.DOM.addClass(this.$container, `-items-${this._$items.length}`);\r\n\t\tthis.DOM.addClass(this._$items[this.config.activeIndex], '-selected');\r\n\r\n\t\tthis._guideIndex = this.config.activeIndex;\r\n\t\t\r\n\t\tlet itemSelector = `#${this.id} .ui__paging__link`;\r\n\t\tEvents.on('click', itemSelector, this._itemClick.bind(this));\r\n\t\tEvents.on('mouseover', itemSelector, (e: MouseEvent) => e.preventDefault() );\r\n\r\n\t\tif ( this.DOM.hasClass(this.$container, '-guide')) {\r\n\t\t\tthis.startGuideEffect();\r\n\t\t}\r\n\r\n\t}\r\n\r\n\tpublic setCallbacks(click: Function): void {\r\n\t\tthis._onClick = click;\r\n\t}\r\n\r\n\t/** set container  for when manually creating the module */\r\n\tpublic setContainer(element: HTMLElement): void {\r\n\t\tthis.$container = element;\r\n\t\tthis.mounted = true;\r\n\t}\r\n\r\n\tpublic hide(type: string = 'cascade', delay: number = 0): void {\r\n\t\tif (type === 'cascade') {\r\n\t\t\tgsap.TweenMax.set(`#${this.id} .ui__paging__item`, {y: 20, autoAlpha: 0});\r\n\t\t} else if (type === 'fade') {\r\n\t\t\tgsap.TweenMax.to(this.$container, 0.2, {autoAlpha: 0, ease: gsap.Power0.easeNone, delay: delay});\r\n\t\t}\r\n\t}\r\n\r\n\tpublic show(type: string = 'cascade', delay: number = 0): void {\r\n\t\t\r\n\t\tgsap.TweenMax.set(this.$container, {display: 'block'});\r\n\r\n\t\tif (type === 'cascade') {\r\n\t\t\tgsap.TweenMax.set(this.$container, {autoAlpha: 1});\r\n\t\t\tgsap.TweenMax.set(`#${this.id} .ui__paging__item`, {y: 20, autoAlpha: 0});\r\n\t\t\tgsap.TweenMax.staggerTo(`#${this.id} .ui__paging__item`, 0.4, {\r\n\t\t\ty: 0,  autoAlpha: 1, ease: gsap.Back.easeOut, delay: delay}, 0.08);\r\n\t\t} else if (type === 'fade') {\r\n\t\t\tgsap.TweenMax.set(this.$container, {autoAlpha: 0});\r\n\t\t\tgsap.TweenMax.to(this.$container, 0.5, {autoAlpha: 1, ease: gsap.Power0.easeNone, delay: delay});\r\n\t\t\tgsap.TweenMax.set(`#${this.id} .ui__paging__item`, {y: 0, autoAlpha: 1});\r\n\t\t}\r\n\r\n\t}\r\n\r\n\tpublic setActiveIndex(index: number, forDisplayPurposesOnly: boolean = false): void {\r\n\t\t\r\n\t\tlet oldIndex = this.config.activeIndex;\r\n\r\n\t\tif (!forDisplayPurposesOnly)  {\r\n\t\t\tthis.config.activeIndex = index;\r\n\t\t} else {\r\n\t\t\toldIndex = this._oldGuideIndex;\r\n\t\t}\r\n\r\n\t\tthis.config.activeIndex = index;\r\n\r\n\t\tthis.DOM.removeClass(this._$items[oldIndex], '-selected');\r\n\t\t\r\n\t\tif (index > oldIndex) {\r\n\t\t\tthis.DOM.addClass(this._$items[oldIndex], '-reverse');\r\n\t\t\tthis.DOM.removeClass(this._$items[index], '-reverse');\r\n\t\t} else {\r\n\t\t\tthis.DOM.removeClass(this._$items[oldIndex], '-reverse');\r\n\t\t\tthis.DOM.addClass(this._$items[index], '-reverse');\r\n\t\t}\r\n\t\t\r\n\t\tthis.DOM.addClass(this._$items[index], '-selected');\r\n\r\n\t}\r\n\r\n\tpublic getActiveIndex(): number {\r\n\r\n\t\tif (this._guideCycleInt) {\r\n\t\t\treturn 0;\r\n\t\t}\r\n\r\n\t\treturn this.config.activeIndex;\r\n\t}\r\n\r\n\t/** Get the slug off the paging item */\r\n\tpublic getActiveSlug(index: number): string {\r\n\t\treturn this._$items[index].getAttribute('data-slug');\r\n\t}\r\n\r\n\t/** Use a ratio to check what paging should be selected */\r\n\tpublic checkIndexFromRatio(ratio: number): number  {\r\n\r\n\t\tthis._checkIndex = Math.round(this._$items.length * ratio);\r\n\r\n\t\tif (this._checkIndex !== this.config.activeIndex ) {\r\n\t\t\tthis.setActiveIndex(this._checkIndex);\r\n\t\t}\r\n\r\n\t\treturn this.config.activeIndex;\r\n\r\n\t}\r\n\r\n\t/** Start guid effect */\r\n\tpublic startGuideEffect(): void {\r\n\t\tthis.DOM.addClass(this.$container, '-guide');\r\n\t\tclearInterval(this._guideCycleInt);\r\n\t\tthis._guideCycleInt = setInterval(() => {\r\n\t\t\tthis._guideCycle();\r\n\t\t}, 700);\r\n\t}\r\n\r\n\t/** Stop the guide from animating (Used to guide the user) */\r\n\tpublic removeGuideEffect(selectIndex: number = null): void {\r\n\t\tclearInterval(this._guideCycleInt);\r\n\t\tthis._guideCycleInt = null;\r\n\t\tthis.DOM.removeClass(this.$container, '-guide');\r\n\t\tif (selectIndex !== null) {\r\n\t\t\tthis.setActiveIndex(selectIndex);\r\n\t\t}\r\n\t}\r\n\r\n\r\n\t/** Reset */\r\n\tpublic reset(): void {\r\n\t\tclearInterval(this._guideCycleInt);\r\n\t\tthis._guideIndex = 0;\r\n\t}\r\n\r\n\t/** Set active */\r\n\tpublic setActive(active: boolean): void {\r\n\r\n\t\tif (active) {\r\n\t\t\tthis.DOM.addClass(this.$container, '-active');\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tthis.DOM.removeClass(this.$container, '-active');\r\n\r\n\t}\r\n\r\n\t/**Set class on module */\r\n\tpublic setClass(className: string): void {\r\n\t\tthis.DOM.addClass(this.$container, className);\r\n\t}\r\n\r\n\tpublic removeClass(className: string): void {\r\n\t\tthis.DOM.removeClass(this.$container, className);\r\n\t}\r\n\t\r\n\t//Private \r\n\t//----------------------------------------------------------------------------------------------------\r\n\t//----------------------------------------------------------------------------------------------------\r\n\t//----------------------------------------------------------------------------------------------------\r\n\t//----------------------------------------------------------------------------------------------------\r\n\r\n\tprivate _itemClick(e: MouseEvent): boolean {\r\n\t\t\r\n\t\te.preventDefault();\r\n\r\n\t\tif (this._freezeClick) {\r\n\t\t\treturn false;\r\n\t\t}\r\n\r\n\t\tlet index = parseInt(this.DOM.getAttribute(e.target, 'data-index') );\r\n\t\tif (this._onClick) {\r\n\t\t\tthis._onClick(index);\r\n\t\t}\r\n\r\n\t\tif (this.config.track) {\r\n\t\t\tGA.event('UX', 'Paging click', `index ${index}`);\r\n\t\t}\r\n\t\t\r\n\t\tif (this.config.freezeInteractionOnClick > 0) {\r\n\t\t\tthis._freezeClick = true;\r\n\t\t\tsetTimeout( () =>  this._freezeClick  = false, this.config.freezeInteractionOnClick * 1000);\r\n\t\t}\r\n\r\n\t\treturn false;\r\n\r\n\t}\r\n\r\n\tprivate _guideCycle(): void {\r\n\r\n\t\tthis._oldGuideIndex = this._guideIndex;\r\n\t\tthis._guideIndex += this._guideDirection;\r\n\r\n\t\tif (this._guideIndex === this._$items.length - 1 || this._guideIndex === 0) {\r\n\t\t\tthis._guideDirection *= -1;\r\n\t\t} \r\n\r\n\t\tthis.setActiveIndex(this._guideIndex, true);\r\n\r\n\t}\r\n\r\n}\r\n","import { TimelineItem, TimelineItemConfig } from 'app/module/home/TimelineItem';\r\nimport {HomeParticleJSONModel} from 'app/model/HomeParticleJSONModel';\r\n//import * as PIXI from 'pixi.js';\r\n\r\n//Masked text item timeline item used for Debug logo \r\nexport class MaskedText extends TimelineItem {\r\n\r\n\tprivate _background: PIXI.Sprite;\r\n\tprivate _mask: PIXI.Sprite;\r\n\r\n\tpublic create(jsonConfig: HomeParticleJSONModel, settings: TimelineItemConfig): void {\r\n\t\tsuper.create(jsonConfig, settings);\r\n\t\tthis._background = new PIXI.Sprite(settings.backgroundTexture);\r\n\t\tthis._mask = new PIXI.Sprite(settings.maskTexture);\r\n\t\r\n\t\tthis._mask.anchor.set(0.5, 0.5);\r\n\t\tthis._background.anchor.set(0.5, 0.5);\r\n\t\tthis._sprite.anchor.set(0.5, 0.5);\r\n\t\tthis._sprite.addChild(this._background, this._mask);\r\n\t\tthis._background.mask = this._mask;\r\n\r\n\t}\r\n\r\n}\r\n","import {Debugbase} from 'debugbase/Debugbase';\r\nimport {MathHelper, Point} from 'debugbase/helper/MathHelper';\r\nimport {ParticlePath}  from 'app/module/home/ParticlePath';\r\nimport {ParticleRepell}  from 'app/module/home/ParticleRepell';\r\nimport {MouseController}  from 'app/controller/MouseController';\r\nimport {TimelineStateType} from 'app/controller/home/HomeTimelineMain';\r\nimport {RelativeTimelinePosition}  from 'app/module/home/homeUtil/RelativeTimelinePosition';\r\n\r\nexport class ParticleAttract {\r\n\r\n\tprivate _state: TimelineStateType =  TimelineStateType.INTRO;\r\n\tprivate _math: MathHelper;\r\n\tprivate _distance: number;\t\t\t\t\t//Distance to mouse from Math helper \r\n\tprivate _distanceTolerence: number;\t\t\t//Distance to (randomly seeded to create partciles that will go furter to meet the mouse)\r\n\tprivate _distanceToTolerenceRatio: number;\t//The ratio of how close mouse is to limit\t\r\n\tprivate _attractSeed: number;\t\t\t\t//How close the partcile attrack to mouse seeded to short / overshot \r\n\tprivate _baseEasePower: number;\t\t\t\t//Normal ease power when not effected by mouse proximity (Essentially the )\r\n\tprivate _attractEasePower: number;\t\t\t//Final ease power that takes into account the \r\n\tprivate _moveXTarget: number = 0;\r\n\tprivate _moveYTarget: number = 0;\r\n\tprivate\t_moveX: number = 0;\r\n\tprivate\t_moveY: number = 0; \r\n\tprivate _sprite: PIXI.Sprite;\t\r\n\r\n\tprivate _forceX: number = 0;\r\n\tprivate _forceY: number = 0;\r\n\tprivate _powerX: number = 0;\r\n\tprivate _powerY: number = 0;\r\n\r\n\tprivate _offsetTargetX: number = 0;\r\n\tprivate _offsetTargetY: number = 0;\r\n\r\n\tprivate _particlePathOrbit: ParticlePath;\r\n\tprivate _particlePathSine: ParticlePath;\r\n\tprivate _particleRepell: ParticleRepell;\r\n\r\n\tprivate _mouse: MouseController;\r\n\r\n\tprivate _introActive: boolean = false;\r\n\tprivate _buttonActive: boolean = false;\r\n\r\n\t//private _screensTargetX : number = 0;\r\n\t//private _screensTargetY : number = 0;\r\n\r\n\tprivate _spacesTargetPosition: RelativeTimelinePosition;\r\n\tprivate _screensTargetPosition: RelativeTimelinePosition;\r\n\r\n\tpublic set introActive(v : boolean) {\r\n\t\tthis._introActive = v;\r\n\t}\r\n\r\n\tpublic set buttonActive(v : boolean) {\r\n\t\tthis._buttonActive = v;\r\n\t}\r\n\r\n\tconstructor(sprite : PIXI.Sprite, particlePathOrbit: ParticlePath = null,  particlePathSine: ParticlePath = null, particleRepell: ParticleRepell = null) {\r\n\r\n\t\tthis._mouse = Debugbase.controller.get('Mouse') as MouseController;\r\n\t\tthis._math = Debugbase.math;\r\n\t\tthis._sprite = sprite;\r\n\t\tthis._particlePathOrbit = particlePathOrbit;\r\n\t\tthis._particlePathSine = particlePathSine;\r\n\t\tthis._particleRepell = particleRepell;\r\n\r\n\t\tthis._attractSeed = 0.8 + (Math.random() * 0.9);\r\n\t\tthis._attractSeed = 1;\r\n\t\t//this._attractSeed  = 3;\r\n\t\tthis._baseEasePower = 2 + (Math.random() * 2);\r\n\t\t\r\n\t\t//For hoz split:\r\n\t\tthis._distanceTolerence = 500 + (Math.random() * 500);\r\n\t\t//For vertical split: \r\n\t\tthis._distanceTolerence = 1200 + (Math.random() * 400);\r\n\r\n\t\t//Points \r\n\t\t//this._offsetTargetX = (Math.random() * 1  < 0.5) ? -50 : 50;\r\n\t\t//this._offsetTargetY = (Math.random() * 1  < 0.5) ? -50 : 50;\r\n\r\n\t\t//Centered\r\n\t\tthis._offsetTargetX = 0;\r\n\t\tthis._offsetTargetY = 0;\r\n\r\n\t\t//this._screensTargetX = 0 + (Math.random() * 1800);\r\n\t\t//this._screensTargetY = Math.random() * 1000;\r\n\r\n\t\t//When screens then target the logo: \r\n\t\t//this._screensTargetPosition = new RelativeTimelinePosition(0.24, 0.54);\r\n\r\n\t\tthis._screensTargetPosition = new RelativeTimelinePosition(\r\n\t\t\t-0.05 + (Math.random() * 0.22), \r\n\t\t\t0.6 + Math.random() * 0.4\r\n\t\t);\r\n\r\n\t\t//When screens then target to position under logo:\r\n\t\tthis._spacesTargetPosition = new RelativeTimelinePosition(\r\n\t\t\t0.78 + (Math.random() * 0.22), \r\n\t\t\tMath.random() * 1\r\n\t\t);\r\n\r\n\t}\r\n\r\n\tpublic resize(containerWidth: number, containerHeight: number): void {\r\n\t\tthis._screensTargetPosition.resize(containerWidth, containerHeight);\r\n\t\tthis._spacesTargetPosition.resize(containerWidth, containerHeight);\r\n\r\n\t}\r\n\r\n\tpublic tick(mouseCords: Point, absoluteX: number, containerX: number, absoluteY: number, mouseOffsetX: number, dragOffsetX: number): void {\r\n\t\t\r\n    \t//this._repell.distancey = mouseCords.y - (this._absoluteY + this._offsetY);\r\n    \tthis._distance = this._math.distance(\r\n    \t\t{x: mouseCords.x + this._offsetTargetX, y: mouseCords.y + this._offsetTargetY}, \r\n    \t\t{x: this._sprite.x, y: this._sprite.y}\r\n    \t);\r\n\r\n        this._distanceToTolerenceRatio = 0;\r\n\r\n        let maxVelocity: number = (this._state === TimelineStateType.HOME_LOGO_OVER) ? 200 : 50;\r\n        let easePower: number = 5;\r\n\r\n        if (this._state === TimelineStateType.SPACES_TRANSITION) {\r\n        \tmaxVelocity = 100;\r\n        } else if (this._state === TimelineStateType.SPACES) {\r\n        \tmaxVelocity = 1000;;\r\n        \teasePower = 40;\r\n        }\r\n\r\n       // if (this._state === TimelineStateType.SPACES) {\r\n\t\t\t\r\n\t\t//\tthis._moveXTarget  = 2000;\r\n\t\t//\tmaxVelocity = 200;\r\n\r\n\t\t//} \r\n\r\n\r\n\r\n\t\tif ( (this._distance < this._distanceTolerence &&  this._state === TimelineStateType.HOME_LOGO_OVER) || this._state === TimelineStateType.SPACES_TRANSITION || this._state === TimelineStateType.SPACES || this._state === TimelineStateType.SCREENS) {\r\n\r\n\t\t\tthis._particlePathOrbit.setActive(true);\r\n\t\t\tthis._particlePathSine.setActive(false);\r\n\t\t\tthis._particleRepell.setActive(true);\r\n\t\r\n\r\n\t\t \tthis._distanceToTolerenceRatio = this._distance / this._distanceTolerence;\r\n\t\t \tif (this._distanceToTolerenceRatio > 1) {\r\n\t\t \t\tthis._distanceToTolerenceRatio = 1;\r\n\t\t \t}\r\n\r\n\t\t \t// Reverse ratio: \r\n\t\t \tthis._distanceToTolerenceRatio = 1 - this._distanceToTolerenceRatio;\r\n\t\t \r\n\t\t \tthis._moveXTarget  = mouseCords.x - (absoluteX + containerX) + this._offsetTargetX - mouseOffsetX - dragOffsetX;\r\n\t\t \tthis._moveYTarget  = mouseCords.y - absoluteY + this._offsetTargetY;\r\n\r\n\t\t\t if (this._state === TimelineStateType.SPACES) {\r\n\t\t\t \t\r\n\t\t\t \t//Update the target position based on the drag/mouse/effect offsets: \r\n\t\t\t \tthis._spacesTargetPosition.update(\r\n\t\t\t \t\tcontainerX + this._offsetTargetX + mouseOffsetX + dragOffsetX,\r\n\t\t\t \t\tthis._offsetTargetY\r\n\t\t\t \t);\r\n\r\n\t\t \t\t//this._moveXTarget  = this._screensTargetX - (absoluteX + containerX) + this._offsetTargetX - mouseOffsetX - dragOffsetX;\r\n\t\t \t\t//this._moveYTarget  = this._screensTargetY - absoluteY + this._offsetTargetY;\r\n\t\t \t\tthis._moveXTarget  = this._spacesTargetPosition.x - (absoluteX + containerX) + this._offsetTargetX - mouseOffsetX - dragOffsetX;\r\n\t\t \t\tthis._moveYTarget  = this._spacesTargetPosition.y - absoluteY + this._offsetTargetY;\r\n\r\n\t\t \t}\r\n\r\n\t\t    if (this._state === TimelineStateType.SCREENS) {\r\n\t\t \r\n\t\t \t\tthis._screensTargetPosition.update(\r\n\t\t\t \t\tcontainerX + mouseOffsetX + dragOffsetX,\r\n\t\t\t \t\tthis._offsetTargetY\r\n\t\t\t \t);\r\n\r\n\t\t \t\tthis._moveXTarget  = this._screensTargetPosition.x - (absoluteX + containerX) + this._offsetTargetX - mouseOffsetX - dragOffsetX;\r\n\t\t \t\tthis._moveYTarget  = this._screensTargetPosition.y - absoluteY - this._offsetTargetY;\r\n\r\n\t\t \t}\r\n\r\n\t\t \tif ( (window as any ).introActive && !this._introActive) {\r\n\t\t\t\tthis._moveXTarget = 0;\r\n\t\t\t\tthis._moveYTarget = 0;\r\n\t\t\t}\r\n\r\n\t\t }  else {\r\n\r\n\t\t \tthis._particlePathOrbit.setActive(false);\r\n\t\t \tthis._particlePathSine.setActive(true);\r\n\t\t \tthis._particleRepell.setActive(false);\r\n\t\t \tthis._moveXTarget =  0;\r\n\t\t \tthis._moveYTarget = 0;\r\n\r\n\t\t }\r\n\r\n\t\tthis._attractEasePower = this._baseEasePower + (easePower * this._distanceToTolerenceRatio);\r\n\t\t\r\n\t\t//Only allow so much velocity: \r\n\t\t//For hoz split:\r\n\t\r\n\t\t//For vertical split:\r\n\t\t//let maxVelocity: number = 100;\r\n\r\n\r\n\t\tif (this._moveXTarget - this._moveX > maxVelocity) {\r\n\t\t\tthis._moveXTarget = this._moveX + maxVelocity;\r\n\t\t} else if (this._moveXTarget - this._moveX < -maxVelocity) {\r\n\t\t\tthis._moveXTarget = this._moveX - maxVelocity;\r\n\t\t}\r\n\r\n\t\tif (this._moveYTarget - this._moveY > maxVelocity) {\r\n\t\t\tthis._moveYTarget = this._moveY + maxVelocity;\r\n\t\t} else if (this._moveYTarget - this._moveY < -maxVelocity) {\r\n\t\t\tthis._moveYTarget = this._moveY - maxVelocity;\r\n\t\t}\r\n\r\n\t\tthis._moveX  = this._moveX + ((this._moveXTarget - this._moveX ) /  this._attractEasePower );\r\n\t\tthis._moveY  = this._moveY + ((this._moveYTarget - this._moveY ) / this._attractEasePower );\r\n\r\n\t}\t\r\n\r\n\tpublic getX() {\r\n\t\treturn this._moveX;\r\n\t} \r\n\r\n\tpublic getY() {\r\n\t\treturn this._moveY;\r\n\t} \r\n\r\n\t/** Set the timeline state for */\r\n\tpublic setTimelineState( state: TimelineStateType ): void {\r\n\t\tthis._state = state;\r\n\t}\r\n\r\n}\r\n","import { TimelineItem, TimelineItemConfig, TimelineItemType} from 'app/module/home/TimelineItem';\r\nimport {HomeParticleJSONModel} from 'app/model/HomeParticleJSONModel';\r\nimport { DepartmentType } from 'app/data/Enums';\r\nimport {PathShapeType }  from 'app/module/home/ParticlePath';\r\n//import * as PIXI from 'pixi.js';\r\n\r\nexport enum LayoutModeType {RANDOM = 'random', GRID = 'grid'}\r\n\r\n//Masked text item timeline item used for Debug logo \r\nexport class ParticleField extends TimelineItem {\r\n\r\n\t//Child partciles\r\n\tprivate _childParticles: Array<TimelineItem> = [];\r\n\tprivate _textureCount: number = 0;\r\n\tprivate _layoutMode: LayoutModeType = LayoutModeType.RANDOM;\r\n\r\n\tpublic create(jsonConfig: HomeParticleJSONModel, settings: TimelineItemConfig): void {\r\n\t\t//Set the department based on postion \r\n\t\tthis._layoutMode = (jsonConfig.layoutMode) ? jsonConfig.layoutMode : LayoutModeType.RANDOM;\r\n\t\tthis.id  = jsonConfig.id;\r\n\t\tthis.type = TimelineItemType.PARTICLE_FIELD;\r\n\t\tthis._repellActive = true;\r\n\t\tthis.department = (this.relativeX < 0.5) ? DepartmentType.SCREENS : DepartmentType.SPACES;\r\n\t\tthis._createChildParticles(jsonConfig, settings);\r\n\t}\r\n\r\n\tpublic resize(containerWidth: number, containerHeight: number, displayScale: number, innerwidth: number) {\r\n\t\tthis._childParticles.forEach( (particle) => {\r\n\t\t\tparticle.resize(containerWidth, containerHeight, displayScale, innerwidth);\r\n\t\t});\r\n\t}\r\n\r\n\tpublic tick(xProgressRatio: number, containerX: number, mouseYRatio: number, mouseXRatio: number, mouseIsDown: boolean = false, velocityRatio: number = 0, instant: boolean = false, mousecords: any = null, mothcords: any = null): void {\r\n\t\tthis._childParticles.forEach( (particle) => {\r\n\t\t\tparticle.tick(xProgressRatio, containerX, mouseYRatio, mouseXRatio, mouseIsDown, velocityRatio, instant, mousecords, mothcords);\r\n\t\t});\r\n\t}\r\n\r\n\tpublic animateToWork(moveY: number, delay: number = 0): void {\r\n\t\tthis._childParticles.forEach( (particle) => {\r\n\t\t\tparticle.animateToWork(moveY, delay);\r\n\t\t});\r\n\t}\r\n\r\n\tpublic animateFromWork(delay: number = 1.0): void {\r\n\t\tthis._childParticles.forEach( (particle) => {\r\n\t\t\tparticle.animateFromWork(delay);\r\n\t\t});\r\n\t}\r\n\r\n\tpublic resetIntervalsAndAnimations(): void {\r\n\t\tthis._childParticles.forEach( (particle) => {\r\n\t\t\tparticle.resetIntervalsAndAnimations();\r\n\t\t});\r\n\t}\r\n\r\n\tpublic reset(): void {\r\n\t\tthis._childParticles.forEach( (particle) => {\r\n\t\t\tparticle.reset();\r\n\t\t});\r\n\t}\r\n\r\n\tpublic resetFromWork(offY: number): void {\r\n\t\tthis._childParticles.forEach( (particle) => {\r\n\t\t\tparticle.resetFromWork(offY);\r\n\t\t});\r\n\t}\r\n\r\n\tpublic getItems(): Array<TimelineItem> {\r\n\t\treturn this._childParticles;\r\n\t}\r\n\r\n\t//Private \r\n\t//----------------------------------------------------------------------------------------\r\n\tprivate _createChildParticles(masterConfig: HomeParticleJSONModel, settings: TimelineItemConfig): void {\r\n\r\n\t\tlet relativeX: number;\r\n\t\tlet relativeY: number;\r\n\t\tlet easePower: number;\r\n\t\tlet parallaxOffsetPower: number;\r\n\t\tlet parallaxPowerMouse: number;\r\n\t\tlet gridRelativeX: number = masterConfig.relativeX - masterConfig.relXSeed;\r\n\t\tlet gridRelativeY: number = masterConfig.relativeY - masterConfig.relYSeed;\r\n\t\tlet gridRelativeWidth: number =  masterConfig.relXSeed * 2;\r\n\t\tlet gridRelativeHeight: number = masterConfig.relYSeed * 2;\r\n\t\tlet cols: number = 39;\r\n\t\tlet rows: number = Math.round(masterConfig.particleCount / cols);\r\n\t\tlet gridSpacingX: number = gridRelativeWidth / cols;\r\n\t\tlet gridSpacingY: number = gridRelativeHeight / rows;\r\n\t\tlet colIndex: number = 0;\r\n\t\tlet rowIndex: number = 0;\r\n\t\tlet pathStartIndexRatio: number = 0;\r\n\t\tlet pathIndexShare: number = 1 / cols;\r\n\r\n\t\tfor (let i = 0; i < masterConfig.particleCount; i++) {\r\n\r\n\t\t\tif (this._layoutMode === LayoutModeType.RANDOM) {\r\n\t\t\t\trelativeX = this._randomiseParticleAttribute(masterConfig.relativeX, masterConfig.relXSeed, true);\r\n\t\t\t\trelativeY = this._randomiseParticleAttribute(masterConfig.relativeY, masterConfig.relYSeed, true);\r\n\t\t\t\teasePower =  this._randomiseParticleAttribute(masterConfig.easePower, masterConfig.easeSeed);\r\n\t\t\t\tparallaxOffsetPower = this._randomiseParticleAttribute(masterConfig.parallaxOffsetPower, masterConfig.offsetSeed);\r\n\t\t\t\tparallaxPowerMouse = this._randomiseParticleAttribute(masterConfig.parallaxOffsetPower, masterConfig.parallaxSeed);\r\n\t\t\t} else if (this._layoutMode === LayoutModeType.GRID) {\r\n\t\t\t\trelativeX  = gridRelativeX + (colIndex * gridSpacingX);\r\n\t\t\t\trelativeY  = gridRelativeY + (rowIndex * gridSpacingY);\r\n\t\t\t\t//easePower = masterConfig.easePower - (rowIndex * 0.02);\r\n\t\t\t\teasePower = masterConfig.easePower;\r\n\t\t\t\tparallaxOffsetPower = masterConfig.parallaxOffsetPower;\r\n\t\t\t\t//parallaxPowerMouse = -1 *  masterConfig.parallaxPowerMouse + (rowIndex * 0.02);\r\n\t\t\t\tparallaxPowerMouse = -1 *  masterConfig.parallaxPowerMouse;\r\n\t\t\t\tpathStartIndexRatio = colIndex * pathIndexShare;\r\n\t\t\t\tcolIndex++;\r\n\t\t\t\tif (colIndex === cols) {\r\n\t\t\t\t\tcolIndex = 0;\r\n\t\t\t\t\trowIndex++;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tlet config: HomeParticleJSONModel = {\r\n\t\t\t\tid: `${masterConfig.id}-particle-${i}`,\r\n\t\t\t\trelativeX: relativeX,\r\n\t\t\t\trelativeY: relativeY,\r\n\t\t\t\teasePower: easePower,\r\n\t\t\t\tparallaxOffsetPower: parallaxOffsetPower,\r\n\t\t\t\tparallaxPowerMouse: parallaxPowerMouse,\r\n\t\t\t\tautoScale: masterConfig.autoScale,\r\n\t\t\t\tautoRotate: masterConfig.autoRotate,\r\n\t\t\t\tautoAlpha: masterConfig.autoAlpha,\r\n\t\t\t\trandomRotation: masterConfig.randomRotation,\r\n\t\t\t\tstartScale:  masterConfig.startScale,\r\n\t\t\t\tminScale:  masterConfig.minScale,\r\n\t\t\t\tmaxScale:  masterConfig.maxScale,\r\n\t\t\t\tautoRange:  masterConfig.autoRange,\r\n\t\t\t\trepell: true,\r\n\t\t\t\talpha: masterConfig.alpha,\r\n\t\t\t\tbioAlphaMax: (masterConfig.bioAlphaMax) ? masterConfig.bioAlphaMax : null,\r\n\t\t\t\tbioAlphaMin: (masterConfig.bioAlphaMin) ? masterConfig.bioAlphaMin : null,\r\n\t\t\t\ttint: (masterConfig.tint) ? masterConfig.tint : null,\r\n\t\t\t\tpath: (masterConfig.path) ? masterConfig.path : null,\r\n\t\t\t\tpathDirection: (masterConfig.pathDirection) ? masterConfig.pathDirection : null,\r\n\t\t\t\tpathStartIndexRatio: pathStartIndexRatio,\r\n\t\t\t};\r\n\r\n\t\t\tlet texture: PIXI.Texture = this._getTexture(settings.textures as Array<PIXI.Texture>);\r\n\r\n\t\t\tthis._childParticles.push( this._createChildParticle(config, texture, settings.container) );\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\tprivate _randomiseParticleAttribute(base: number, seed: number, baseOne: boolean = false): number  {\r\n\t\t\r\n\t\tlet direction: number = (Math.random() < 0.5) ? -1 : 1;\r\n\t\tlet seededValue: number;\r\n\t\t\r\n\t\tif (baseOne) {\r\n\t\t\tseededValue  =  (1 * (seed * Math.random()));\r\n\t\t} else {\r\n\t\t\tseededValue = base * (seed * Math.random());\r\n\t\t}\r\n\r\n\t\treturn base + (seededValue * direction);\r\n\t}\r\n\r\n\tprivate _getTexture(textures: Array<PIXI.Texture>): PIXI.Texture {\r\n\r\n\t\tlet texture: PIXI.Texture = textures[this._textureCount];\r\n\r\n\t\tthis._textureCount++;\r\n\t\tif (this._textureCount === textures.length) {\r\n\t\t\tthis._textureCount = 0;\r\n\t\t}\r\n\r\n\t\treturn texture; \r\n\r\n\t}\r\n\r\n\tprivate _createChildParticle(config: HomeParticleJSONModel, texture: PIXI.Texture, container: PIXI.Container): TimelineItem {\r\n\t\t\r\n\t\t//A normal pixi sprite that will be animated along the timeline\r\n\t\tlet item = new TimelineItem();\r\n\t\t\t\t\r\n\t\titem.relativeX = config.relativeX;\r\n\t\titem.relativeY = config.relativeY;\r\n\t\titem.easePower = config.easePower;\r\n\t\titem.parallaxOffsetPower = config.parallaxOffsetPower;\r\n\t\titem.parallaxPowerMouse = config.parallaxPowerMouse;\t\r\n\r\n\t\tif (config.alpha) {\r\n\t\t\titem.alpha = config.alpha;\r\n\t\t}\r\n\r\n\t\tif (config.tint) {\r\n\t\t\titem.tint = config.tint;\r\n\t\t}\r\n\r\n\t\t\r\n\t\t//if() {\r\n\t\t\t//config.path = PathShapeType.CIRCLE;\r\n\t\t//}\r\n\r\n\r\n\t\titem.create(config, {\r\n\t\t\tcontainer: container,\r\n\t\t\ttexture: texture\r\n\t\t});\r\n\r\n\t\treturn item;\r\n\r\n\t}\r\n\r\n}\r\n","interface Point {\r\n\tx: number;\r\n\ty: number;\r\n}\r\n\r\nexport class ParticleLamp {\r\n\r\n\tprivate _screenCords: Point;\t\t\t\t//Current screen cords of the partcile\r\n\tprivate _innerRadius: number;\t\t\t\t//Inner 'bright' radius\r\n\tprivate _outterRadius: number;\t\t\t\t//Outter visible radius\r\n\tprivate _minAlpha: number;\t\t\t\t\t//Min alpha\r\n\tprivate _maxAlpha: number;\t\t\t\t\t//Max alpha the partcile will go \r\n\tprivate _alphaRange: number;\r\n\tprivate _distanceX: number;\t\t\t\t\t//Distance\r\n\tprivate _distanceY: number;\t\t\t\t\t//Distance\r\n\tprivate _distance: number;\t\t\t\t\t//Distance\r\n\tprivate _sprite: PIXI.Sprite;\t\r\n\r\n\tconstructor(sprite : PIXI.Sprite, innerRadius : number, outterRadius : number, minAlpha: number, maxAlpha: number) {\r\n\t\tthis._sprite = sprite;\r\n\t\tthis._innerRadius = innerRadius;\r\n\t\tthis._outterRadius = outterRadius;\r\n\t\tthis._minAlpha = minAlpha;\r\n\t\tthis._maxAlpha = maxAlpha;\r\n\t\tthis._alphaRange = this._maxAlpha - this._minAlpha ;\r\n\t}\r\n\r\n\tpublic tick(mouseCords: Point): void {\r\n\t\t\r\n\t\tthis._distanceX = mouseCords.x - this._sprite.position.x;\r\n\t\tthis._distanceY = mouseCords.y - this._sprite.position.y;\r\n\t\tthis._distance = Math.sqrt((this._distanceX * this._distanceX) + (this._distanceY * this._distanceY));\r\n\r\n\t\tif (this._distance < this._innerRadius) {\r\n    \t\tthis._sprite.alpha  = this._maxAlpha;\r\n    \t} else {\r\n    \t\tthis._sprite.alpha =   this._minAlpha + (this._alphaRange - ( this._alphaRange * (this._distance / this._outterRadius)));\r\n    \t\tif (this._sprite.alpha < this._minAlpha) {\r\n    \t\t\tthis._sprite.alpha = this._minAlpha;\r\n    \t\t}\r\n    \t}\r\n\r\n\t}\r\n\r\n}\r\n","import {TimelineStateType} from 'app/controller/home/HomeTimelineMain';\r\n\r\ninterface Point {\r\n\tx: number;\r\n\ty: number;\r\n\tscale?: number;\r\n}\r\n\r\nexport enum PathShapeType {CIRCLE = 'circle', SINE_WAVE = 'sine_wave'}\r\n\r\nexport class ParticlePath {\r\n\r\n\t//Array of 0-1 x/y points around a path\r\n\tprivate _state: TimelineStateType =  TimelineStateType.INTRO;\r\n\tprivate _sprite: PIXI.Sprite;\t\r\n\tprivate _active: boolean = true;\r\n\tprivate _type: PathShapeType;\r\n\tprivate _path: Array<Point> = [];\r\n\tprivate _pathIndex: number = 0;\r\n\tprivate _xMuliplier: number = 100;\r\n\tprivate _yMuliplier: number = 100;\r\n\tprivate _direction: number = 1;\r\n\tprivate _scaleSeed: number;\r\n\tprivate _scaleIndex: number = 1;\r\n\tprivate _expandMuliplier: number = 1;\r\n\tprivate _expandMuliplierTarget: number = 1;\r\n\tprivate _expandMuliplierBase: number = 1;\r\n\tprivate _distance: number = 0;\r\n\tprivate _distanceX: number = 0;\r\n\tprivate _distanceY: number = 0;\r\n\r\n\tprivate _screensTargetX : number = 0;\r\n\tprivate _screensTargetY : number = 0;\r\n\r\n\tprivate _introActive: boolean = false;\r\n\tprivate _buttonActive: boolean = false;\r\n\r\n\tpublic set introActive(v : boolean) {\r\n\t\tthis._introActive = v;\r\n\t}\r\n\t\r\n\tpublic set buttonActive(v : boolean) {\r\n\t\tthis._buttonActive = v;\r\n\t}\r\n\t\r\n\tconstructor(sprite: PIXI.Sprite, type: PathShapeType, direction: number = 1, startIndexRatio: number = null) {\r\n\r\n\t\t//this._direction = direction;\r\n\t\tthis._sprite = sprite;\r\n\t\tthis._type = type;\r\n\t\tthis._direction = (Math.random() < 0.5) ? 1 : -1;\r\n\t\tthis._direction = 1;\r\n\t\tthis._scaleSeed = Math.random();\r\n\t\t\r\n\t\tthis._yMuliplier =  30 + (Math.random() * 100);\r\n\t\tthis._xMuliplier = 30 + (Math.random() * 100 );\r\n\t\t//this._xMuliplier = this._yMuliplier;\r\n\t\t//this._yMuliplier = 10 + (Math.random() * 150);\r\n\r\n\t\tif (type === PathShapeType.CIRCLE) {\r\n\t\t\tthis._circle();\r\n\t\t} else if (type === PathShapeType.SINE_WAVE) {\r\n\t\t\tthis._sineWave(startIndexRatio);\r\n\t\t}\r\n\t}\r\n\r\n\tpublic get active(): boolean {\r\n\t\treturn this._active;\r\n\t}\r\n\r\n\tpublic tick(mouseCords: Point = null): void {\r\n\t\t\r\n\t\tthis._pathIndex += this._direction;\r\n\t\t\r\n\t\tif (this._pathIndex >= this._path.length) {\r\n\t\t\tthis._pathIndex = 0;\r\n\t\t} else if (this._pathIndex <= 0 ) {\r\n\t\t\tthis._pathIndex = this._path.length - 1;\r\n\t\t}\r\n\r\n\t\tthis._scaleIndex += this._direction;\r\n\r\n\t\tif (this._scaleIndex >= this._path.length) {\r\n\t\t\tthis._scaleIndex = 0;\r\n\t\t} else if (this._scaleIndex <= 0 ) {\r\n\t\t\tthis._scaleIndex = this._path.length - 1;\r\n\t\t}\r\n\r\n\t\tif (!mouseCords) {\r\n\t\t\tthis._expandMuliplierTarget = ( (window as any).touchActive ) ? this._expandMuliplierBase * 2 : this._expandMuliplierBase * 1;\r\n\t\t\tif ( (window as any ).introActive && !this._introActive) {\r\n\t\t\t\tthis._expandMuliplierTarget = 0;\r\n\t\t\t}\r\n\r\n\t\t} else {\r\n\r\n\t\t\t/*this._distanceX = mouseCords.x - this._sprite.position.x;\r\n\t\t\tthis._distanceY = mouseCords.y - this._sprite.position.y;\r\n\t\t\tthis._distance = Math.sqrt((this._distanceX * this._distanceX) + (this._distanceY * this._distanceY));\r\n\r\n\t\t\tthis._expandMuliplier  = 0.5;\r\n\t\t\tif (this._distance < 200) {\r\n\t\t\t\tthis._expandMuliplier =  0.5 + (0.5 - ( 0.5 * (this._distance / 200) ) );\r\n\t\t\t}*/\r\n\t\t\tthis._expandMuliplierTarget = ( (window as any).touchActive && this._state !== TimelineStateType.HOME_LOGO_OUT ) ? this._expandMuliplierBase * 2 : this._expandMuliplierBase * 1;\r\n\r\n\r\n\t\t}\r\n\r\n\t\tif ( (window as any ).introActive || (window as any ).buttonActive ) {\r\n\t\t\tthis._expandMuliplierTarget = this._expandMuliplierTarget * 0.5;\r\n\t\t\tif ((window as any ).buttonActive ) {\r\n\t\t\t\tthis._expandMuliplierTarget = this._expandMuliplierTarget * 0.7;\r\n\t\t\t}\r\n\t\t\tif ( (window as any).touchActive ) {\r\n\t\t\t\t//this._expandMuliplierTarget *= 2;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t//When in transition chill out the ranges: \r\n\t\tif (this._state === TimelineStateType.SPACES_TRANSITION) {\r\n\t\t\tthis._expandMuliplierTarget = 0.9;\r\n\t\t}\r\n\r\n\t\tif (this._state === TimelineStateType.SPACES) {\r\n\t\t\tthis._expandMuliplierTarget = 0.1;\r\n\t\t}\r\n\r\n\t\tif (this._state === TimelineStateType.INTRO) {\r\n\t\t\tthis._expandMuliplierTarget = 0.1;\r\n\t\t}\r\n\r\n\t\tthis._expandMuliplier  = this._expandMuliplier + ((this._expandMuliplierTarget - this._expandMuliplier ) / 10 );\r\n\r\n\t\t//this._expandMuliplierTarget = 0;\r\n\t\t//this._expandMuliplier = 0;\r\n\t\t\r\n\t}\r\n\r\n\tpublic setActive(active: boolean): void {\r\n\t\tthis._active = active;\r\n\t\tif (this._type === PathShapeType.SINE_WAVE) {\r\n\t\t\tthis._expandMuliplierBase = (active) ? 1 : 0;\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tthis._expandMuliplierBase = (active) ? 1 : 0.05;\r\n\t\t//this._expandMuliplierBase = (active) ? 1 : 2;\r\n\t}\r\n\r\n\tpublic getX(): number {\r\n\t\treturn this._path[this._pathIndex].x * (this._xMuliplier * this._expandMuliplier);\r\n\t}\r\n\r\n\tpublic getY(): number {\r\n\t\treturn this._path[this._pathIndex].y * (this._yMuliplier * this._expandMuliplier);\r\n\t}\r\n\r\n\tpublic getScale(): number {\r\n\r\n\t\tif (this._state === TimelineStateType.INTRO) {\r\n\t\t\treturn 0;\r\n\t\t}\r\n\r\n\t\tif (this._state === TimelineStateType.SPACES_TRANSITION) {\r\n\t\t\treturn 0.1 +  (0.25 * (this._scaleIndex / this._path.length) );\r\n\t\t}\r\n\r\n\t\tif (this._state === TimelineStateType.SPACES) {\r\n\t\t\treturn 0.1 +  (0.15 * (this._scaleIndex / this._path.length) );\r\n\t\t}\r\n\r\n\t\tif (this._type === PathShapeType.SINE_WAVE && this._active) {\r\n\t\t\t//return 0.4 + (0.2 * this._expandMuliplier);\r\n\t\t\treturn this._path[this._pathIndex].scale;\r\n\t\t}\r\n\r\n\t\tif ( (window as any ).introActive && !this._introActive) {\r\n\t\t\treturn 0;\r\n\t\t}\r\n\r\n\t\tif ( (window as any ).buttonActive && !this._buttonActive) {\r\n\t\t\treturn 0;\r\n\t\t} \r\n\r\n\t\tif ( (window as any ).buttonActive && this._buttonActive) {\r\n\t\t\treturn 0.1 +  (0.2 * (this._scaleIndex / this._path.length) );\r\n\t\t}\r\n\r\n\t\treturn 0.1 +  (0.3 * (this._scaleIndex / this._path.length) );\r\n\r\n\t}\r\n\r\n\tprivate  _circle(): void {\r\n\t\tlet steps: number = 90 + Math.round(Math.random() * 800);\r\n\t\tfor (var i = 0; i < steps; i++) {\r\n\t\t\tthis._path.push({\r\n\t\t\t\tx: (0 + 1 * Math.cos(2 * Math.PI * i / steps)),\r\n\t\t\t\ty: (0 + 1 * Math.sin(2 * Math.PI * i / steps))\r\n\t\t\t});\r\n\t\t}\r\n\r\n\t\tthis._pathIndex = Math.round(Math.random() * steps - 1);\r\n\t\t//this._pathIndex = 1;\r\n\t\tthis._scaleIndex = Math.round(this._path.length * this._scaleSeed);\r\n\t\t//this._scaleIndex = this._pathIndex;\r\n\t}\r\n\r\n\tprivate _sineWave( startIndexRatio: number = null ): void {\r\n\t\t\r\n\t\t//let steps: number = 90 + Math.round(Math.random() * 400);\r\n\t\tthis._yMuliplier = 24 +  (Math.random() * 12 );\r\n\t\tthis._xMuliplier = -5 + (Math.random() * 10 );\r\n\t    let steps: number = 320;\r\n\t    let height: number = 2;\r\n\t    let xStep: number = 1;\r\n\r\n\t    var x = 0;\r\n\t    var y = 0;\r\n\t    var amplitude = 1.4;\r\n\t    var frequency = 40;\r\n\t    let i: number = 0;\r\n\t    let exit: boolean = false;\r\n\r\n\r\n\t    let scaleSeed: number = 0.2  + Math.round(Math.random() * 0.15);\r\n\t    let xSeed: number = Math.random() * 10;\r\n\r\n\t    //ctx.moveTo(x, y);\r\n\t     while (i < steps || !exit) {\r\n\t        y =  amplitude * Math.sin(x / frequency);\r\n\t        x += xStep;\r\n\t        this._path.push({\r\n\t\t\t\tx: y,\r\n\t\t\t\ty: y,\r\n\t\t\t\tscale: scaleSeed + (scaleSeed * ( (y + 1.4 ) / 2.8))\r\n\t\t\t});\r\n\t\t\ti++;\r\n\t\t\tif (i >= steps) {\r\n\t\t\t\tif (y > 0 && y < 0.01) {\r\n\t\t\t\t\texit = true;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t    }\r\n\r\n\t    if (startIndexRatio !== null ) {\r\n\t\t\tthis._pathIndex = Math.floor(startIndexRatio * steps);\r\n\t\t}\r\n\r\n\t}\r\n\r\n\t/** Set the timeline state for */\r\n\tpublic setTimelineState( state: TimelineStateType ): void {\r\n\t\tthis._state = state;\r\n\t}\r\n\r\n}\r\n","import {Debugbase} from 'debugbase/Debugbase';\r\nimport {MathHelper, Point} from 'debugbase/helper/MathHelper';\r\n\r\nexport class ParticleRepell {\r\n\r\n\tprivate _math: MathHelper;\r\n\tprivate _distance: number;\t\t\t\t\t//Distance to mouse from Math helper \r\n\tprivate _distanceTolerence: number;\t\t\t//Distance to (randomly seeded to create partciles that will go furter to meet the mouse)\r\n\tprivate _easePower: number;\t\t\t\t//Normal ease power when not effected by mouse proximity (Essentially the )\r\n\tprivate _mouseRepellPower: number;\r\n\tprivate _moveXTarget: number = 0;\r\n\tprivate _moveYTarget: number = 0;\r\n\tprivate\t_moveX: number = 0;\r\n\tprivate\t_moveY: number = 0; \r\n\tprivate _powerX: number = 0;\r\n\tprivate _powerY: number = 0;\r\n\tprivate _sprite: PIXI.Sprite;\t\r\n\r\n\tprivate _repellSeed: number = 1;\r\n\tprivate _repellLimit: number = 50;\r\n\tprivate _repellAmountActive: number;\r\n\tprivate _repellAmount: number;\r\n\tprivate _repellAmountIntro: number;\r\n\tprivate _repellAmountButton: number;\r\n\tprivate _active: boolean = true;\r\n\tprivate _center: Point;\r\n\tprivate _repellCenter: Point;\r\n\r\n\tconstructor(sprite : PIXI.Sprite, distanceTolerence: number = 50, easePower: number = 20) {\r\n\t\tthis._math = Debugbase.math;\r\n\r\n\t\tthis._sprite = sprite;\r\n\t\tthis._distanceTolerence = distanceTolerence;\r\n\t\tthis._easePower = easePower;\r\n\t\tthis._mouseRepellPower = 20;\r\n\t\tthis._repellSeed = 1 + (Math.random() * 0.7);\r\n\t\tthis._repellAmount = 40 + (Math.random() * 20);\r\n\t\tthis._repellAmountIntro = 60 + (Math.random() * 20);\r\n\t\tthis._repellAmountButton = 40 + (Math.random() * 10);\r\n\r\n\t\tthis._center = {\r\n\t\t\tx: window.innerWidth / 2,\r\n\t\t\ty: window.innerHeight / 2,\r\n\t\t};\r\n\r\n\t}\r\n\r\n\tpublic setActive(active: boolean): void {\r\n\t\tthis._active = active;\r\n\t}\r\n\r\n\tpublic retarget(mouseCords: Point, targetCords: Point): Point {\r\n\t\t\r\n\t\tif (!this._active) {\r\n\t\t\treturn targetCords;\r\n\t\t}\r\n\r\n\t\tthis._repellCenter =  ( (window as any ).introActive  || (window as any ).buttonActive ) ? this._center : mouseCords;\r\n\r\n    \tthis._distance = Math.sqrt(Math.pow(targetCords.x - this._repellCenter.x, 2) + Math.pow(targetCords.y - this._repellCenter.y, 2));\r\n\r\n\t\tthis._repellLimit = ( (window as any ).introActive ) ? 75 : 50;\r\n\t\tthis._repellAmountActive = ( (window as any ).introActive ) ? this._repellAmountIntro : this._repellAmount;\r\n\r\n\t\tif( (window as any).buttonActive ) {\r\n\t\t\tthis._repellLimit = 50;\r\n\t\t\tthis._repellAmountActive  = this._repellAmountButton;\r\n\t\t\t//this._repellAmountActive = 50;\r\n\t\t}\r\n\r\n\t    if (this._distance < this._repellLimit) {\r\n\t    \tlet radians = Math.atan2(targetCords.y - this._repellCenter.y, targetCords.x - this._repellCenter.x);\r\n\t     \ttargetCords.x =  this._repellCenter.x + (Math.cos(radians) *  this._repellAmountActive);\r\n\t    \ttargetCords.y = this._repellCenter.y +  (Math.sin(radians) *  this._repellAmountActive);\r\n\t    }\r\n\r\n\t    return targetCords;\r\n             \r\n\t}\r\n\r\n\tpublic setParticleRepellCenter(center: Point): void {\r\n\t\tthis._center = center;\r\n\t}\r\n\r\n\tpublic getY(): number {\r\n\t\treturn this._moveY;\r\n\t}\r\n\r\n\tpublic getX(): number {\r\n\t\treturn this._moveX;\r\n\t}\r\n\r\n}\r\n","import { TimelineItem, TimelineItemConfig, TimelineItemType} from 'app/module/home/TimelineItem';\r\nimport {HomeParticleJSONModel} from 'app/model/HomeParticleJSONModel';\r\nimport { DepartmentType } from 'app/data/Enums';\r\n//import * as PIXI from 'pixi.js';\r\n\r\nexport class RelativeChildren extends TimelineItem {\r\n\r\n\t//Child partciles\r\n\tprivate _childParticles: Array<TimelineItem> = [];\r\n\r\n\tpublic create(jsonConfig: HomeParticleJSONModel, settings: TimelineItemConfig): void {\r\n\t\t//Set the department based on postion \r\n\t\tthis.id  = jsonConfig.id;\r\n\t\tthis.type = TimelineItemType.RELATIVE_CHILDREN;\r\n\t\tthis._repellActive = true;\r\n\t\tthis.department = (this.relativeX < 0.5) ? DepartmentType.SCREENS : DepartmentType.SPACES;\r\n\t\tthis._createChildParticles(jsonConfig, settings);\r\n\t}\r\n\r\n\tpublic resize(containerWidth: number, containerHeight: number, displayScale: number, innerwidth: number) {\r\n\t\tthis._childParticles.forEach( (particle) => {\r\n\t\t\tparticle.resize(containerWidth, containerHeight, displayScale, innerwidth);\r\n\t\t});\r\n\t}\r\n\r\n\tpublic tick(xProgressRatio: number, containerX: number, mouseYRatio: number, mouseXRatio: number, mouseIsDown: boolean = false, velocityRatio: number = 0, instant: boolean = false, mousecords: any = null, mothcords: any = null): void {\r\n\t\tthis._childParticles.forEach( (particle) => {\r\n\t\t\tparticle.tick(xProgressRatio, containerX, mouseYRatio, mouseXRatio, mouseIsDown, velocityRatio, instant, mousecords, mothcords);\r\n\t\t});\r\n\t}\r\n\r\n\tpublic animateToWork(moveY: number, delay: number = 0): void {\r\n\t\tthis._childParticles.forEach( (particle) => {\r\n\t\t\tparticle.animateToWork(moveY, delay);\r\n\t\t});\r\n\t}\r\n\r\n\tpublic animateFromWork(delay: number = 1.0): void {\r\n\t\tthis._childParticles.forEach( (particle) => {\r\n\t\t\tparticle.animateFromWork(delay);\r\n\t\t});\r\n\t}\r\n\r\n\tpublic resetIntervalsAndAnimations(): void {\r\n\t\tthis._childParticles.forEach( (particle) => {\r\n\t\t\tparticle.resetIntervalsAndAnimations();\r\n\t\t});\r\n\t}\r\n\r\n\tpublic reset(): void {\r\n\t\tthis._childParticles.forEach( (particle) => {\r\n\t\t\tparticle.reset();\r\n\t\t});\r\n\t}\r\n\r\n\tpublic getItems(): Array<TimelineItem> {\r\n\t\treturn this._childParticles;\r\n\t}\r\n\r\n\tpublic resetFromWork(offY: number): void {\r\n\t\tthis._childParticles.forEach( (particle) => {\r\n\t\t\tparticle.resetFromWork(offY);\r\n\t\t});\r\n\t}\r\n\r\n\t//Private \r\n\t//----------------------------------------------------------------------------------------\r\n\tprivate _createChildParticles(parentConfig: HomeParticleJSONModel, settings: TimelineItemConfig): void {\r\n\r\n\t\tlet baseX: number = parentConfig.relativeX;\r\n\t\tlet rangeX: number = parentConfig.relativeChildrenWidth;\r\n\r\n\t\tlet baseY: number = parentConfig.relativeY;\r\n\t\tlet rangeY: number = parentConfig.relativeChildrenHeight;\r\n\r\n\t\tparentConfig.children.forEach( (child: HomeParticleJSONModel, index: number) => {\r\n\r\n\t\t\tlet config: HomeParticleJSONModel = {\r\n\t\t\t\tid: `${parentConfig.id}-particle-${index}`,\r\n\t\t\t\trelativeX: baseX + (child.relativeX * rangeX),\r\n\t\t\t\trelativeY: baseY + (child.relativeY * rangeY),\r\n\t\t\t\teasePower: parentConfig.easePower,\r\n\t\t\t\tparallaxOffsetPower: parentConfig.parallaxOffsetPower,\r\n\t\t\t\tparallaxPowerMouse: 0,\r\n\t\t\t\tautoScale: parentConfig.autoScale,\r\n\t\t\t\tautoRotate: parentConfig.autoRotate,\r\n\t\t\t\tautoAlpha: parentConfig.autoAlpha,\r\n\t\t\t\trandomRotation: parentConfig.randomRotation,\r\n\t\t\t\tstartScale:  parentConfig.startScale,\r\n\t\t\t\tminScale:  parentConfig.minScale,\r\n\t\t\t\tmaxScale:  parentConfig.maxScale,\r\n\t\t\t\tautoRange:  parentConfig.autoRange,\r\n\t\t\t\talpha:  parentConfig.alpha,\r\n\t\t\t\ttint:  parentConfig.tint,\r\n\t\t\t\trepell: false,\r\n\t\t\t\trepellDistance: parentConfig.repellDistance,\r\n\t\t\t\tmouseRepellPower: parentConfig.mouseRepellPower,\r\n\t\t\t\tmouseRepelEasePower: parentConfig.mouseRepelEasePower\r\n\t\t\t};\r\n\r\n\t\t\tlet texture: PIXI.Texture = settings.textures[child.texture] as PIXI.Texture;\r\n\t\t\tthis._childParticles.push( this._createChildParticle(config, texture, settings.container) );\r\n\r\n\t\t});\r\n\r\n\t}\r\n\r\n\tprivate _createChildParticle(config: HomeParticleJSONModel, texture: PIXI.Texture, container: PIXI.Container): TimelineItem {\r\n\t\t\r\n\t\t//A normal pixi sprite that will be animated along the timeline\r\n\t\tlet item = new TimelineItem();\r\n\t\t\t\t\r\n\t\titem.relativeX = config.relativeX;\r\n\t\titem.relativeY = config.relativeY;\r\n\t\titem.easePower = config.easePower;\r\n\t\titem.parallaxOffsetPower = config.parallaxOffsetPower;\r\n\t\titem.parallaxPowerMouse = 0;\t\r\n\r\n\t\tif (config.alpha) {\r\n\t\t\titem.alpha = config.alpha;\r\n\t\t}\r\n\r\n\t\tif (config.tint) {\r\n\t\t\titem.tint = config.tint;\r\n\t\t}\r\n\t\t\r\n\t\tif ( config.mouseRepellPower) {\r\n\t\t\titem.mouseRepellPower = config.mouseRepellPower;\r\n\t\t}\r\n\r\n\t\tif ( config.repellDistance) {\r\n\t\t\titem.repellDistance = config.repellDistance;\r\n\t\t}\r\n\r\n\t\tif ( config.mouseRepelEasePower) {\r\n\t\t\titem.mouseRepelEasePower = config.mouseRepelEasePower;\r\n\t\t}\r\n\r\n\t\titem.create(config, {\r\n\t\t\tcontainer: container,\r\n\t\t\ttexture: texture\r\n\t\t});\r\n\r\n\t\treturn item;\r\n\r\n\t}\r\n\r\n}\r\n","//import * as PIXI from 'pixi.js';\r\n\r\nimport {TimelineStateType} from 'app/controller/home/HomeTimelineMain';\r\nimport {HomeParticleJSONModel} from 'app/model/HomeParticleJSONModel';\r\nimport { DepartmentType } from 'app/data/Enums';\r\nimport { Debugbase } from 'debugbase/Debugbase';\r\n\r\n//Special partcile events\r\nimport {RelativeTimelinePosition}  from 'app/module/home/homeUtil/RelativeTimelinePosition';\r\nimport {ParticlePath, PathShapeType}  from 'app/module/home/ParticlePath';\r\nimport {ParticleLamp}  from 'app/module/home/ParticleLamp';\r\nimport {ParticleAttract}  from 'app/module/home/ParticleAttract';\r\nimport {ParticleRepell}  from 'app/module/home/ParticleRepell';\r\n\r\nimport {Point} from 'app/contracts/Geometry';\r\n\r\nexport interface TimelineItemConfig {\r\n\tcontainer: PIXI.Container;\r\n\ttexture?: PIXI.Texture;\r\n\tbackgroundTexture?: PIXI.Texture;\r\n\tmaskTexture?: PIXI.Texture;\r\n\ttextures?: Array<PIXI.Texture> | {[key: string] : PIXI.Texture };\r\n\tparticleCount?: number; \r\n}\r\n\r\nexport enum TimelineItemType {PARTICLE, PARTICLE_FIELD, RELATIVE_CHILDREN}\r\n\r\n//Item on the timeline \r\n//Can be a particle of something \r\n//Will be position relatively across the \r\n//So an item at 0.5 / 0.5 will be in the center middle \r\nexport class TimelineItem {\r\n\r\n\tpublic department: DepartmentType;\r\n\tpublic type: TimelineItemType = TimelineItemType.PARTICLE;\r\n\tpublic id: string;\r\n\tpublic relativeX: number;\r\n\tpublic relativeY: number; \r\n\tpublic scale: number = 1;\t\t\t\t\t//Scale when fully visible \r\n\tpublic easePower: number = 10;\t\t\r\n\r\n\tpublic parallaxOffsetPower: number = 0;\t\t\r\n\tpublic parallaxPowerMouse: number = 0.2;\t\t\t//Ratio to effecy height by\t\r\n\tpublic tint: number;\r\n\tpublic alpha: number;\r\n\r\n\tprivate _easePowers: any = {};\r\n\tprotected _x: number = 0;\t\t\t\t\t//X current value \r\n\tprivate _targetPosition: RelativeTimelinePosition;\r\n\tprotected _absoluteY: number; \t\t\t\t//Translated Y to px values \r\n\tprotected _dragOffsetX: number = 0;\t\t\t//The amount the item is moved on X because or dragging inernia or being repelled by  \r\n\tprotected _offsetY: number = 0;\t\t\t\t//The amount the item is moved on Y because or dragging inernia or being repelled by  \r\n\tprivate _offsetX: number = 0;\r\n\tprotected _offsetTargetX: number = 0;\t\t//The target the x offset is moving towaards \r\n\tprotected _offsetTargetY: number = 0;\t\t//The target the y offset is moving towaards  \r\n\r\n\tprotected _mouseOffsetX: number = 0;\r\n\tprotected _mouseOffsetTargetX: number = 0;\r\n\r\n\tprotected _containerHeight: number;\r\n\tprotected _containerWidth: number;\r\n\tprivate _innerWidth: number;\r\n\t\r\n\t//Parallax calulations: \r\n\tprivate _relativeParallaxX: number;\r\n\tprivate _relativeParallaxXToProgressRatio: number;\r\n\r\n\tprivate _parallaxMultiplerStartValue: number = 30;\r\n\tprivate _parallaxEaseMultipler: number = 1;\r\n\r\n\tprotected _scale: number = 1;\r\n\tprotected _scaleTarget: number = 1;\r\n\tprotected _displayScale: number = 1;\r\n\r\n\tprotected _rotationTarget: number = 0;\r\n\tprotected _rotation: number = 0;\r\n\r\n\tprivate _alpha: number = 1;\r\n\r\n\tprotected _sprite: PIXI.Sprite;\t\r\n\r\n\tprivate _tween: gsap.Tween;\r\n\r\n\tprivate _settings: TimelineItemConfig;\r\n\tprivate _json: HomeParticleJSONModel;\r\n\r\n\tprivate _hasAutoEffect: boolean = false;\r\n\tprivate _effectRange: number = 200;\r\n\tprivate _startRangeAt: number = 0;\r\n\tprivate _autoStartRotation: number = 0;\r\n\tprivate _autoStartAlpha: number = 0;\r\n\tprivate _autoStartScale: number = 0.4;\r\n\r\n\tprivate _finalScale: number = 1;\r\n\tprivate _finalRotation: number = 0;\r\n\r\n\tprotected _repellActive: boolean = false;\r\n\tprivate _isPortraitDevice: boolean = false;\r\n\tprivate _repell: any  = {\r\n\t\thomex: 0,\r\n\t    homey: 0,\r\n\t\tforcex: 0,\r\n\t\tforcey: 0,\r\n\t    magnet: 200,\r\n\t    distancex: 0,\r\n\t    distancey: 0,\r\n\t    distance: 0,\r\n\t    powerx: 0, \r\n\t    powery: 0,\r\n\t    moveX: 0, \r\n\t    moveY: 0,\r\n\r\n\t    //Moth \r\n\t    magnetMoth: 200,\r\n\t    distancexMoth: 0,\r\n\t    distanceyMoth: 0,\r\n\t    distanceMoth: 0,\r\n\t    powerxMoth: 0, \r\n\t    poweryMoth: 0,\r\n\t    moveXMoth: 0, \r\n\t    moveYMoth: 0,\r\n\r\n\t};\r\n\r\n\tprivate _repellDistance: number = 150;\r\n\tprivate _repellDistanceDefault: number;\r\n\tprivate _mouseRepellPowerDefault: number = 10;\r\n\tprivate _mouseRepelEasePower: number = 10;\r\n\tprivate _mouseRepellPower: number;\r\n\tprivate _mothRepellPower: number;\r\n\r\n\tprivate _bioAlphaMax: number = null;\r\n\tprivate _bioAlphaMin: number = null;\r\n\r\n\r\n\tprivate _particlePathOrbit: ParticlePath;\r\n\tprivate _particlePathSine: ParticlePath;\r\n\tprivate _particleLamp: ParticleLamp;\r\n\tprivate _particleAttract: ParticleAttract;\r\n\tprivate _particleAttractRepell: ParticleRepell;\r\n\r\n\tprivate _attractSeed: number = 1; \r\n\r\n\tprivate _distanceTolerence: number = 400;\r\n\r\n\tpublic set mouseRepellPower(v : number) {\r\n\t\tthis._mouseRepellPowerDefault = v;\r\n\t}\r\n\r\n\tpublic set repellDistance(v : number) {\r\n\t\tthis._repellDistanceDefault = v;\r\n\t}\r\n\r\n\tpublic set mouseRepelEasePower(v : number) {\r\n\t\tthis._mouseRepelEasePower = v;\r\n\t}\r\n\r\n\tpublic create(jsonConfig: HomeParticleJSONModel, settings: TimelineItemConfig): void {\r\n\t\t\r\n\t\tthis.id = jsonConfig.id;\r\n\t\tthis._json = jsonConfig;\r\n\t\tthis._isPortraitDevice = Debugbase.system.isPortraitDevice;\r\n\r\n\t\tthis._hasAutoEffect = (this._json.autoAlpha ||  this._json.autoRotate ||  this._json.autoScale);\r\n\r\n\t\tthis._targetPosition = new RelativeTimelinePosition(jsonConfig.relativeX, jsonConfig.relativeY);\r\n\r\n\t\tif (jsonConfig.randomRotation) {\r\n\t\t\tthis._finalRotation  = Math.random() * 120 * Math.PI / 180;\r\n\t\t\tif ( Math.random() < 0.5)  {\r\n\t\t\t\tthis._finalRotation *= -1;\r\n\t\t\t}\r\n\t\t\t\r\n\t\t} \r\n\r\n\t\tif (jsonConfig.minScale) {\r\n\t\t\tlet range: number = jsonConfig.maxScale - jsonConfig.minScale;\r\n\t\t\tthis._finalScale = jsonConfig.minScale + (range * Math.random() );\r\n\t\t}\r\n\r\n\t\tif (this._hasAutoEffect) {\r\n\t\t\tthis._autoStartRotation =  this._finalRotation + (this._json.startRotation * Math.PI / 180) ||   this._finalRotation  + (-1 * (Math.random() * 30 * Math.PI / 180));\r\n\t\t\tthis._autoStartAlpha =  this._json.startAlpha ||  0;\r\n\t\t\tthis._autoStartScale =  this._json.startScale ||  0.4;\r\n\t\t\tthis._startRangeAt = this._json.startRangeAt ||  0;\r\n\t\t} \r\n\r\n\t\tthis._sprite = new PIXI.Sprite();\r\n\t\tthis._sprite.interactive = false;\r\n\t\tthis._sprite.anchor.set(0.5, 0.5);\r\n\t\tif (settings.texture) {\r\n\t\t\tthis._sprite.texture = settings.texture;\r\n\t\t} \r\n\t\t\r\n\t\tsettings.container.addChild(this._sprite);\r\n\t\t\r\n\t\tif (this._json.tint) {\r\n\t\t\tthis._sprite.tint = this.tint;\r\n\t\t}\r\n\r\n\t\tif (this._json.alpha) {\r\n\t\t\tthis._sprite.alpha = this.alpha;\r\n\t\t}\r\n\r\n\t\t\r\n\r\n\t\tif (jsonConfig.bioAlphaMax) {\r\n\t\t\tthis._bioAlphaMax = jsonConfig.bioAlphaMax;\r\n\t\t\tthis._bioAlphaMin = jsonConfig.bioAlphaMin;\r\n\t\t}\r\n\r\n\t\tlet introActive: boolean = (Math.random() < 0.15);\r\n\t\tlet buttonActive: boolean = (Math.random() < 0.25);\r\n\r\n\t\t//Create animation path if set \r\n\t\tif (jsonConfig.path) {\r\n\t\t\tlet direction = (jsonConfig.pathDirection) ? jsonConfig.pathDirection  : 1;\r\n\t\t\tlet pathStartIndex = (jsonConfig.pathStartIndexRatio) ? jsonConfig.pathStartIndexRatio : 0;\r\n\t\t\t\r\n\t\t\tthis._particlePathOrbit = new ParticlePath(this._sprite, PathShapeType.CIRCLE, direction);\r\n\t\t\tthis._particlePathOrbit.introActive = introActive;\r\n\t\t\tthis._particlePathOrbit.buttonActive = buttonActive;\r\n\r\n\r\n\t\t\tthis._particlePathSine = new ParticlePath(this._sprite, PathShapeType.SINE_WAVE, direction, pathStartIndex);\r\n\r\n\t\t}\r\n\r\n\t\tif (jsonConfig.path) {\r\n\t\t\tthis._particleLamp = new ParticleLamp(\r\n\t\t\t\tthis._sprite,\r\n\t\t\t\t100,\r\n\t\t\t\t600,\r\n\t\t\t\t//For hoz split:\r\n\t\t\t\t//0.4,\r\n\t\t\t\t//For vertical split:\r\n\t\t\t\t0.1,\r\n\t\t\t\t0.7\r\n\t\t\t);\r\n\t\t}\r\n\r\n\t\tif (jsonConfig.path) {\r\n\t\t\tthis._particleAttractRepell = new ParticleRepell(this._sprite);\r\n\t\t\tthis._particleAttract = new ParticleAttract(this._sprite, this._particlePathOrbit, this._particlePathSine, this._particleAttractRepell);\r\n\t\t\tthis._particleAttract.introActive = introActive;\r\n\t\t\tthis._particleAttract.buttonActive = buttonActive;\r\n\t\t\t\r\n\t\t} else {\r\n\t\t\tif ( this._json.repell) {\r\n\t\t\t\tthis._repellActive = true;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tif (jsonConfig.maxScale || jsonConfig.minScale) {\r\n\t\t\tlet minScale: number = jsonConfig.minScale || jsonConfig.maxScale || 1;\r\n\t\t\tlet maxScale: number = jsonConfig.maxScale || 1;\r\n\t\t\tlet range = maxScale - minScale;\r\n\t\t\tthis._scaleTarget  = this._scale = minScale + (Math.random() * range);\r\n\t\t}\r\n\r\n\t\t//Set the department based on postion \r\n\t\tthis.department = (this.relativeX < 0.5) ? DepartmentType.SCREENS : DepartmentType.SPACES;\r\n\r\n\t\tthis._attractSeed = 0.8 + (Math.random() * 0.9);\r\n\r\n\t\tthis._mouseRepelEasePower = 10 + (Math.random() * 30);\r\n\t\tthis._distanceTolerence = 50 + (Math.random() * 350);\r\n\r\n\t}\r\n\r\n\tpublic fadeIn(delay: number) {\r\n\t\tgsap.TweenMax.to(this._sprite, 0.3, {alpha: 1, delay: delay, ease: gsap.Power0.easeNone});\r\n\t}\r\n\t\r\n\t//Resize event. \r\n\t//Pass in the made-up container size of the home partciles container\r\n\t//Also pass in displayScale to determine sizing as \r\n\tpublic resize(containerWidth: number, containerHeight: number, displayScale: number, innerwidth: number) {\r\n\t\t\r\n\t\t//Resize the abs postion values in \r\n\t\tthis._containerHeight = containerHeight;\r\n\t\tthis._containerWidth = containerWidth;\r\n\t\tthis._absoluteY = containerHeight * this.relativeY;\r\n\r\n\t\tthis._targetPosition.resize(this._containerWidth, this._containerHeight);\r\n\r\n\t\tif (this._particleAttract) {\r\n\t\t\tthis._particleAttract.resize(this._containerWidth, this._containerHeight);\r\n\t\t}\r\n\r\n\t\tthis._displayScale = displayScale;\r\n\t\tthis._innerWidth = innerwidth;\r\n\r\n\t\tthis._repellDistance  = this._repellDistanceDefault;\r\n\t\tthis._mouseRepellPower  = this._mouseRepellPowerDefault;\r\n\t\tthis._mothRepellPower  = 8;\r\n\r\n\t\tif (this._innerWidth < 500) {\r\n\t\t\tthis._repellDistance  = this._repellDistanceDefault * 0.4;\r\n\t\t\tthis._mothRepellPower = 2.3;\r\n\t\t} else if (Debugbase.system.isSmallDevice) {\r\n\t\t\tthis._repellDistance  = this._repellDistanceDefault * 0.5;\r\n\t\t\tthis._mothRepellPower = 5;\r\n\t\t}\r\n\r\n\t\tif (this._hasAutoEffect) {\r\n\t\t\tthis._effectRange = this._json.autoRange * this._innerWidth || 0.12 * this._innerWidth;\r\n\t\t}\r\n\r\n\t}\r\n\r\n\t//Global tick to update animation:\r\n\tpublic tick(xProgressRatio: number, containerX: number, mouseYRatio: number, mouseXRatio: number, mouseIsDown: boolean = false, velocityRatio: number = 0, instant: boolean = false, mouseCords: any = null, mothPosition: any = null): void {\r\n\t\t\r\n\t\t//Deal with inernia on offset (used for things particle repelling)\r\n\t\t//this._offsetX = this._offsetX + ((this._offsetTargetX - this._offsetX ) / this.easePower );\r\n\r\n\t\r\n\t\t//Process X using the virtual containerX poosition \r\n\t\t//Note container is not actually moved on the x, just the items. This allows each to have their own inernia/ease powers\t\r\n\r\n\t\tthis._setParallaxEaseMultipler();\r\n\t\tthis._setEasePowers(mouseIsDown, instant);\r\n\t\tthis._calculateParallaxDragOffsetX(xProgressRatio, this._containerWidth);\r\n\r\n\t\tif (this._repellActive) {\r\n\t\t\tthis._processRepell(mouseCords, mothPosition);\r\n\t\t}\r\n\r\n\t\t//Get mouseOffsetX to add parallax \r\n\t\t//Use the _containerHeight value\r\n\r\n\t\t//Only process mouse parallax on mouse (as its too extreme on touch actions)\r\n\t\t//if (!Debugbase.system.cordsFromTouch ) {\r\n\t\tif (!Debugbase.system.isPortraitDevice) { \r\n\t\t\tthis._offsetTargetY = -1 * (mouseYRatio * (this._containerHeight * (this.parallaxPowerMouse / this._easePowers.y)) );\r\n\t\t\tthis._offsetY = this._offsetY + ((this._offsetTargetY - this._offsetY ) / this._easePowers.mouse );\r\n\r\n\t\t\tthis._mouseOffsetTargetX = -1 * (mouseXRatio * (this._containerHeight * ( this.parallaxPowerMouse / 2)) );\r\n\t\t\tthis._mouseOffsetX = this._mouseOffsetX + ((this._mouseOffsetTargetX - this._mouseOffsetX ) / this._easePowers.mouse );\r\n\r\n\t\t}\r\n\t\t\r\n\t\t//Set the offset factors (drag, mouseX, repell)\r\n\t\tthis._offsetX = containerX + this._dragOffsetX + this._mouseOffsetX + this._repell.moveX;\r\n\t\r\n\t\t//Set the new target position passed on time line position \r\n\t\tthis._targetPosition.update(this._offsetX, this._offsetY +  this._repell.moveY + this._repell.moveYMoth);\r\n\r\n\t\t//Run through list of modifier to effect the target (attract / repell / etc)\r\n\t\t//------------------------------------------------------------------------------------\r\n\r\n\t\tif (this._particlePathOrbit) {\r\n\t\t\tthis._particlePathOrbit.tick();\r\n\t\t\tif (this._particlePathOrbit.active) {\r\n\t\t\t\tthis._scaleTarget = this._particlePathOrbit.getScale();\r\n\t\t\t}\r\n\t\t\tthis._targetPosition.increase( this._particlePathOrbit.getX(),  this._particlePathOrbit.getY());\r\n\t\t}\r\n\r\n\t\tif (this._particlePathSine) {\r\n\t\t\tthis._particlePathSine.tick(mouseCords);\r\n\t\t\tthis._targetPosition.increase( this._particlePathSine.getX(),  this._particlePathSine.getY());\r\n\t\t\tif (this._particlePathSine.active) {\r\n\t\t\t\tthis._scaleTarget = this._particlePathSine.getScale();\r\n\t\t\t}\r\n\t\t\r\n\t\t}\r\n\r\n\t\tlet attractEffectX = 0;\r\n\t\tlet attractEffectY = 0;\r\n\t\t//Deal with partcile attracting logic\r\n\t\tif (this._particleAttract) {\r\n\t\t\t//Pull the particle towards the mouse\r\n\t\t\tthis._particleAttract.tick(mouseCords, this._targetPosition.absoluteX, containerX, this._targetPosition.absoluteY, this._mouseOffsetX, this._dragOffsetX);\r\n\t\t\tthis._targetPosition.increase(this._particleAttract.getX(),  this._particleAttract.getY());\r\n\t\t}\r\n\r\n\t\tif (this._particleAttract) {\r\n\t\t\tlet target = this._particleAttractRepell.retarget(mouseCords, {\r\n\t\t\t\tx: this._targetPosition.x,\r\n\t\t\t\ty: this._targetPosition.y\r\n\t\t\t});\r\n\r\n\t\t\tthis._targetPosition.setPosition(target);\r\n\t\t}\r\n\r\n\t\tthis._x = \tthis._x  + (( this._targetPosition.x - this._x ) / this._easePowers.x  );\r\n\r\n\r\n\t\t//Effect Y postion. Effect by mouse position and the acceloremeter: \r\n\t\t//Scale effect (For whoozy-ness) ----------------------------------------:\r\n\t\t//this._scaleTarget = 1.0 +  Math.abs(velocityRatio * 2.0);\r\n\t\t\r\n\t\t//If autosclaing is on: \r\n\t\tif (this._hasAutoEffect) {\r\n\t\t\t\t\r\n\t\t\tif (this._json.autoScale ) {\r\n\t\t\t\tif (this.department === DepartmentType.SCREENS && this._x < this._effectRange) {\r\n\t\t\t\t\tthis._scaleTarget  =  this._autoStartScale +  ( (this._finalScale - this._autoStartScale)  * Math.max(0, Math.min(this._finalScale, this._x / this._effectRange)) ); \r\n\t\t\t\t} else if (this.department === DepartmentType.SPACES && this._x > (this._innerWidth - this._effectRange)) {\r\n\r\n\t\t\t\t\tlet realRange = this._effectRange;\r\n\t\t\t\t\tlet realX = this._x;\r\n\t\t\t\t\tlet realWidth = this._innerWidth;\r\n\t\t\t\t\tif (this._startRangeAt) {\r\n\t\t\t\t\t\tlet rangeStartPx = this._innerWidth * this._startRangeAt;\r\n\t\t\t\t\t\trealRange = this._effectRange - rangeStartPx;\r\n\t\t\t\t\t\trealWidth = this._innerWidth - rangeStartPx;\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tthis._scaleTarget  =  this._autoStartScale +  ( (this._finalScale - this._autoStartScale)  * Math.max(0, Math.min(this._finalScale, (realWidth - this._x) / realRange)) ); \r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tif (this._json.autoAlpha) {\r\n\r\n\t\t\t\tif (this.department === DepartmentType.SCREENS && this._x < this._effectRange) {\r\n\t\t\t\t\tthis._alpha  = this._autoStartAlpha +  ( (1.0 - this._autoStartAlpha) * Math.max(0, Math.min(1, this._x / this._effectRange)));\r\n\t\t\t\t} else if (this.department === DepartmentType.SPACES && this._x > (this._innerWidth - this._effectRange)) {\r\n\t\t\t\t\tthis._alpha =  this._autoStartAlpha +  ((1.0 - this._autoStartAlpha) * Math.max(0, Math.min(1, (this._innerWidth - this._x) / this._effectRange))); \r\n\t\t\t\t}\r\n\r\n\t\t\t\tthis._sprite.alpha = this._alpha;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif (this._json.autoRotate) {\r\n\r\n\t\t\t\tif (this.department === DepartmentType.SCREENS && this._x < this._effectRange) {\r\n\t\t\t\t\tthis._rotationTarget  = this._finalRotation + (this._autoStartRotation * Math.max(0, Math.min(1,  (this._effectRange - this._x) / this._effectRange )));\r\n\t\t\t\t} else if (this.department === DepartmentType.SPACES && this._x > (this._innerWidth - this._effectRange)) {\r\n\t\t\t\t\t//this._alpha =  Math.max(0, Math.min(1, (this._innerWidth - this._x) / this._effectRange)); \r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\t\t\t\r\n\t\t}\r\n\r\n\t\tthis._scale = this._scale + ((this._scaleTarget - this._scale ) / this._easePowers.scale );\r\n\r\n\t\t//Rotation: -------------------------------------------------------------\r\n\t\t//this._rotationTarget = velocityRatio * 2.0;\r\n\t\t//this._rotationTarget = velocityRatio * 0.6;\r\n\t\tthis._rotation = this._rotation + ((this._rotationTarget - this._rotation ) / this._easePowers.rotation );\r\n\r\n\t\t//Set the final positions ----------------------------------------------\r\n\t\tthis._sprite.position.set(this._x, this._targetPosition.y);\r\n\t\tthis._sprite.scale.set(this._scale * this._displayScale, this._scale * this._displayScale);\r\n\t\tthis._sprite.rotation = this._rotation;\r\n\r\n\t\t//Deal with partcile lamp lighting: \r\n\t\tif (this._particleLamp) {\r\n\t\t\tthis._particleLamp.tick(mouseCords);\r\n\t\t}\r\n\t\r\n\t}\r\n\r\n\t/**\r\n\t* Animate off for work section \r\n\t* @param {number} moveY\r\n\t* @param {number} delay\r\n\t*/\r\n\tpublic animateToWork(moveY: number, delay: number = 0): void {\r\n\r\n\t\tif (this._particleAttractRepell) {\r\n\t\t\tthis._particleAttractRepell.setActive(false);\r\n\t\t} \r\n\r\n\t\tthis._tween = gsap.TweenMax.to(this._sprite, 1 - (0.5 * this.parallaxOffsetPower), \r\n\t\t\t{y: moveY, ease: gsap.Power3.easeIn, delay: delay, onComplete: () => this._startParallaxEaseIn()}\r\n\t\t);\r\n\t}\r\n\r\n\t/** \r\n\t* Animate back from work. Note reset manages setting start positons \r\n\t* @param {number} delay\r\n\t*/\r\n\tpublic animateFromWork(delay: number = 1.0): void {\r\n\t\tlet y: number = this._targetPosition.absoluteY + this._offsetY;\r\n\t\tthis._tween = gsap.TweenMax.to(this._sprite, 1 - (0.5 * this.parallaxOffsetPower), \r\n\t\t\t{y: y, ease: gsap.Power3.easeOut, delay: delay, onComplete: () => this._startParallaxEaseIn()}\r\n\t\t);\r\n\t}\r\n\r\n\t/** Remove any animations / interval on reset */\r\n\tpublic resetIntervalsAndAnimations(): void {\r\n\t\tif (this._tween) {\r\n\t\t\tthis._tween.kill();\r\n\t\t}\r\n\t}\r\n\r\n\t/** General reset */\r\n\tpublic reset(): void {\r\n\t\tthis._sprite.y = this._targetPosition.absoluteY + this._offsetY;\r\n\t}\r\n\r\n\t/** \r\n\t* Reset when coming back from work. Tiles need to be put off screen. (X position is managed through normal updates)\r\n\t* @param {number} offY\r\n\t*/\r\n\tpublic resetFromWork(offY: number): void {\r\n\t\tthis._sprite.y = offY;\r\n\t}\r\n\r\n\t/** Set the timeline state for */\r\n\tpublic setTimelineState(state: TimelineStateType ): void {\r\n\t\t\r\n\t\tif ( this._particleAttract ) {\r\n\t\t\tthis._particleAttract.setTimelineState(state);\r\n\t\t}\r\n\t\t\r\n\t\tif ( this._particlePathOrbit ) {\r\n\t\t\tthis._particlePathOrbit.setTimelineState(state);\r\n\t\t}\r\n\r\n\t\tif ( this._particlePathSine ) {\r\n\t\t\tthis._particlePathSine.setTimelineState(state);\r\n\t\t}\r\n\r\n\t}\r\n\r\n\tpublic setParticleRepellCenter(center: Point): void {\r\n\r\n\t\tif ( this._particleAttractRepell ) {\r\n\t\t\tthis._particleAttractRepell.setParticleRepellCenter(center);\r\n\t\t}\r\n\t}\r\n\r\n\t//PRIVATE \r\n\t//----------------------------------------------------------------------------------------------\r\n\t//----------------------------------------------------------------------------------------------\r\n\t//----------------------------------------------------------------------------------------------\r\n\t//----------------------------------------------------------------------------------------------\r\n\r\n\t//Calculate the parallax offset caused by draging left <> right: \r\n\tprivate _calculateParallaxDragOffsetX(progress: number, containerWidth: number): void {\r\n\t\t//Correct thing to allow for the fact the start/photoshop point of the timeline is center/0.5/home \r\n\t\tthis._relativeParallaxX = this.relativeX - 0.5;\r\n\t\t//Translate this into the current progress \r\n\t\tthis._relativeParallaxXToProgressRatio = this._relativeParallaxX - (progress - 0.5);\r\n\t\t//Set the offset as percentage of the container width (half the width because of the 0.5 logic). \r\n\t\tthis._dragOffsetX  = this._relativeParallaxXToProgressRatio * this.parallaxOffsetPower * (containerWidth / 2);\r\n\t}\r\n\r\n\tprivate _setEasePowers(mouseIsDown: boolean, instant: boolean = false): void {\r\n\r\n\t\t//When instant don't any ineria stuff. Just put at the correct state: \r\n\t\tif (instant) {\r\n\t\t\tthis._easePowers.mouse = 1;\r\n\t\t\tthis._easePowers.x = 1;\r\n\t\t\tthis._easePowers.y = 1;\r\n\t\t\tthis._easePowers.scale = 1;\r\n\t\t\tthis._easePowers.rotation = 1;\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tthis._easePowers.mouse = (mouseIsDown) ? 5 * this._parallaxEaseMultipler : 20 * this._parallaxEaseMultipler;\r\n\t\tthis._easePowers.x = 1 * this._parallaxEaseMultipler;\r\n\t\tthis._easePowers.y = 4 * this._parallaxEaseMultipler;\r\n\t\tthis._easePowers.scale = 8 * this._parallaxEaseMultipler;\r\n\t\tthis._easePowers.rotation = 2 * this._parallaxEaseMultipler;\r\n\r\n\t}\r\n\r\n\t/** Ease in parallax (To stop harsh movement after tranition tweens complete) */\r\n\tprivate _startParallaxEaseIn(): void {\r\n\t\tthis._parallaxEaseMultipler = this._parallaxMultiplerStartValue;\r\n\t}\r\n\r\n\t/** Set the easeMultiple on each frame to reduce back to 1 */\r\n\tprivate _setParallaxEaseMultipler(): void {\r\n\t\tif (this._parallaxEaseMultipler > 1) {\r\n\t\t\tthis._parallaxEaseMultipler -= 0.5;\r\n\t\t}\r\n\t}\r\n\r\n\t/** Process repell force */\r\n\tprivate _processRepell(mouseCords: any, mothCords: any): void {\r\n    \t\r\n    \t//If mouse cords from mouse then process repell\r\n    \tif (!Debugbase.system.isPortraitDevice) { \r\n    \t\tthis._processRepellMouse(mouseCords);\r\n    \t}\r\n\r\n\t}\r\n\r\n\tprivate _processRepellMouse(mouseCords: any): void {\r\n\t\t\r\n\t\t//Reworked from: \r\n\t\t//https://codepen.io/biblos/pen/KRJmey\r\n\r\n\t\tthis._repell.distancex  = mouseCords.x - this._x;\r\n    \tthis._repell.distancey = mouseCords.y - (this._absoluteY + this._offsetY);\r\n    \tthis._repell.distance = Math.sqrt((this._repell.distancex * this._repell.distancex) + (this._repell.distancey * this._repell.distancey));\r\n        this._repell.powerx =  (this._repell.distancex / this._repell.distance) * this._repell.magnet / this._repell.distance;\r\n        this._repell.powery = (this._repell.distancey / this._repell.distance) * this._repell.magnet / this._repell.distance;\r\n\r\n        //this._repell.forcex =  ( this._repell.forcex  + (this._x - this._x) / 2) / 2.1;\r\n\r\n        let ratio = 0;\r\n\t\t if ( this._repell.distance < this._distanceTolerence) {\r\n\r\n\t\t \tthis._repell.moveXTarget =  this._repell.powerx * -this._mouseRepellPower;\r\n\t\t \tthis._repell.moveYTarget =  this._repell.powery * -this._mouseRepellPower;\r\n\r\n\t\t \t//this._repell.moveXTarget =  this._mouseRepellPower - (this._repell.powerx * -this._mouseRepellPower);\r\n\t\t \t//this._repell.moveYTarget = this._mouseRepellPower - (this._repell.powery * -this._mouseRepellPower);\r\n\r\n\t\t \t/*ratio = this._repell.distance / this._distanceTolerence;\r\n\t\t \tif (ratio > 1) {\r\n\t\t \t\tratio = 1;\r\n\t\t \t}\r\n\r\n\t\t \tratio = 1 - ratio;\r\n\r\n\t\t \tlet x =  (this._repell.distancex) * this._attractSeed;\r\n\t\t \tlet y =  (mouseCords.y - (this._absoluteY + this._offsetY)) * this._attractSeed;\r\n\r\n\t\t \tthis._repell.moveXTarget =  x;\r\n\t\t \tthis._repell.moveYTarget = y;*/\r\n\r\n\t\t \t//this._repell.moveX = this._repell.powerx + this._repell.forcex ;\r\n\t\t }  else {\r\n\t\t \tthis._repell.moveXTarget =  this._repell.moveYTarget = 0;\r\n\t\t }\r\n\r\n\r\n\r\n\t\tlet easeP = this._mouseRepelEasePower + (100 * ratio);\r\n\t\tthis._repell.moveX  = this._repell.moveX + ((this._repell.moveXTarget - this._repell.moveX ) /  easeP);\r\n\t\tthis._repell.moveY  = this._repell.moveY + ((this._repell.moveYTarget - this._repell.moveY ) / easeP);\r\n\r\n\t\t/*if (this._bioAlphaMax !== null) {\r\n\t\t\tlet alpha =  1 - ( (this._repell.distance / 150) * 0.7);\r\n\t\t\tif (alpha < this._bioAlphaMin) {\r\n\t\t\t\talpha = this._bioAlphaMin;\r\n\t\t\t}\r\n\t\t\tif (alpha > this._bioAlphaMax) {\r\n\t\t\t\talpha = this._bioAlphaMax;\r\n\t\t\t}\r\n\t\t\tthis._sprite.alpha = alpha;\r\n\t\t}*/\r\n\r\n\t}\r\n\r\n\tprivate _processRepellMoth( mothCords: any): void {\r\n\r\n\t\tif ( !mothCords ) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\t\r\n\t\tthis._repell.distancexMoth  = mothCords.x - this._x;\r\n    \tthis._repell.distanceyMoth = mothCords.y - (this._absoluteY + this._offsetY);\r\n    \tthis._repell.distanceMoth = Math.sqrt((this._repell.distancexMoth * this._repell.distancexMoth) + (this._repell.distanceyMoth * this._repell.distanceyMoth));\r\n        this._repell.powerxMoth =  (this._repell.distancexMoth / this._repell.distanceMoth) * this._repell.magnetMoth / this._repell.distanceMoth;\r\n        this._repell.poweryMoth = (this._repell.distanceyMoth / this._repell.distanceMoth) * this._repell.magnetMoth / this._repell.distanceMoth;\r\n\r\n\t\tif ( this._repell.distancexMoth < this._repellDistance) {\r\n\t\t \tthis._repell.moveXTargetMoth =  this._repell.powerxMoth * -this._mothRepellPower;\r\n\t\t \tthis._repell.moveYTargetMoth =  this._repell.poweryMoth * -this._mothRepellPower;\r\n\t\t}   else {\r\n\t\t \tthis._repell.moveXTargetMoth =  this._repell.moveYTargetMoth = 0;\r\n\t\t}\r\n\r\n\t\t this._repell.moveXMoth  = this._repell.moveXMoth + ((this._repell.moveXTargetMoth - this._repell.moveXMoth ) / 10 );\r\n\t\t this._repell.moveYMoth  = this._repell.moveYMoth + ((this._repell.moveYTargetMoth - this._repell.moveYMoth ) / 10 );\r\n\r\n\t}\r\n\r\n}\r\n","import {Rect, Range} from 'app/contracts/Geometry';\r\nexport enum TimelineRegionType {RECTANGLE = 'rectangle', PROGRESS = 'progress'}\r\n\r\nexport interface TimelineRegionParams {\r\n\tid: string;\r\n\ttype: TimelineRegionType;\r\n\trect: Rect;\r\n\trange: Range;\r\n\tonEnter: Function;\r\n\tonExit: Function;\r\n\tpixiContainer: PIXI.Container;\r\n}\r\n\r\ninterface MouseCords {\r\n\tx: number;\r\n\ty: number;\r\n\trelX: number;\r\n\trelY: number;\r\n}\r\n\r\nexport class TimelineRegion {\r\n\r\n\tprivate _id: string;\r\n\tprivate _type: TimelineRegionType;\r\n\tprivate _rect: Rect;\r\n\tprivate _range: Range;\r\n\tprivate _onEnter: Function;\r\n\tprivate _onExit: Function;\r\n\tprivate _intersecting: boolean = false;\r\n\tprivate _entered: boolean = false;\r\n\r\n\tpublic get id() : string {\r\n\t\treturn this._id;\r\n\t}\r\n\r\n\tpublic constructor(params: TimelineRegionParams) {\r\n\t\tthis._id = params.id;\r\n\t\tthis._type = params.type;\r\n\t\tthis._rect = params.rect || null;\r\n\t\tthis._range = params.range || null;\r\n\t\tthis._onEnter = params.onEnter;\r\n\t\tthis._onExit = params.onExit;\r\n\t}\r\n\r\n\tpublic tick(mouseCords: MouseCords, progress: number, velocity: number) {\r\n\r\n\t\tif (this._type === TimelineRegionType.RECTANGLE) {\r\n\t\t\tthis._processRectangle(mouseCords, velocity);\r\n\t\t} else if (this._type === TimelineRegionType.PROGRESS) {\r\n\t\t\tthis._processProgress(progress);\r\n\t\t}\r\n\r\n\t}\r\n\r\n\tprivate _processRectangle(mouseCords: MouseCords, velocity: number) {\r\n\r\n\t\tthis._intersecting = (\r\n\t\t\tmouseCords.relX > this._rect.x  \r\n\t\t\t&& mouseCords.relX < this._rect.x + this._rect.w \r\n\t\t\t&& mouseCords.relY > this._rect.y  \r\n\t\t\t&& mouseCords.relY < this._rect.y + this._rect.h\r\n\t\t);\r\n\t\t\t\r\n\t\tthis._checkEnterState(velocity, true);\r\n\t}\r\n\r\n\tprivate  _processProgress(progress: number): void {\r\n\t\tthis._intersecting = (progress > this._range.min && progress <= this._range.max);\r\n\t\tthis._checkEnterState();\r\n\t}\r\n\r\n\tprivate _checkEnterState(velocity: number = 0, checkMouse: boolean = false): void {\r\n\r\n\t\tlet mouseDown: boolean = (checkMouse && (window as any).touchActive );\r\n\t\tif (!this._entered && this._intersecting && Math.abs(velocity) < 0.02 && !mouseDown) {\r\n\t\t\tthis._entered = true;\r\n\t\t\tthis._onEnter(this._id);\r\n\t\t} else if ( this._entered && !this._intersecting) {\r\n\t\t\tthis._entered = false;\r\n\t\t\tthis._onExit(this._id);\r\n\t\t}\r\n\t}\r\n\r\n}\r\n","import {TimelineRegion, TimelineRegionType, TimelineRegionParams} from 'app/module/home/TimelineRegion';\r\nimport {Point} from 'app/contracts/Geometry';\r\n\r\nexport class TimelineRegionManager {\r\n\r\n\tprivate _regions: Array<TimelineRegion> = [];\r\n\r\n\tpublic add(params: TimelineRegionParams): void {\r\n\t\tthis._regions.push( new TimelineRegion(params)  );\r\n\t}\r\n\r\n\tpublic tick(mouseCords: Point, containerX: number, containerWidth: number, containerHeight, progress: number, velocity: number): void {\r\n\r\n\t\tthis._regions.forEach( (region: TimelineRegion ) => {\r\n\t\t\tregion.tick({\r\n\t\t\t\tx: mouseCords.x,\r\n\t\t\t\ty: mouseCords.y,\r\n\t\t\t\trelX:  (Math.abs(containerX) + mouseCords.x) / containerWidth,\r\n\t\t\t\trelY:  mouseCords.y / containerHeight\r\n\t\t\t}, progress, velocity); \r\n\t\t});\r\n\r\n\t}\r\n\r\n}\r\n","import {Point} from 'app/contracts/Geometry';\r\nimport {DistanceBetweenTwoPoints} from './DistanceBetweenTwoPoints';\r\n\r\n/** https://stackoverflow.com/questions/8515900/how-to-constrain-movement-within-the-area-of-a-circle */\r\nexport class ConstrainAroundCircle {\r\n\r\n\tprivate _distanceRuler: DistanceBetweenTwoPoints = new DistanceBetweenTwoPoints();\r\n\tprivate _center: Point;\r\n\tprivate _radius: number;\r\n\tprivate _distance: number;\r\n\tprivate _x: number;\r\n\tprivate _y: number;\r\n\tprivate _radians: number;\r\n\r\n\tpublic setConstraints(center: Point, radius: number): void {\r\n\t\tthis._center = center;\r\n\t\tthis._radius = radius;\r\n\t}\r\n\r\n\tpublic limit(mousePosition: Point) {\r\n\t    this._distance = this._distanceRuler.measure(mousePosition, this._center);\r\n\t    if (this._distance <= this._radius) {\r\n\t        return {x: mousePosition.x, y: mousePosition.y};\r\n\t    } else {\r\n\t        this._x = mousePosition.x - this._center.x;\r\n\t        this._y  = mousePosition.y - this._center.y;\r\n\t        this._radians = Math.atan2(this._y, this._x);\r\n\t        return {\r\n\t            x: Math.cos(this._radians) * this._radius + this._center.x,\r\n\t            y: Math.sin(this._radians) * this._radius + this._center.y\r\n\t        };\r\n\t    } \r\n\r\n    }\r\n\r\n}\r\n","import {Point} from 'app/contracts/Geometry';\r\n\r\n/** https://stackoverflow.com/questions/8515900/how-to-constrain-movement-within-the-area-of-a-circle */\r\nexport class DistanceBetweenTwoPoints {\r\n\r\n\tpublic measure(p1: Point, p2: Point): number {\r\n\t\treturn Math.sqrt( Math.pow(p1.x - p2.x, 2) + Math.pow(p1.y - p2.y, 2) );\r\n\t}\r\n\r\n}\r\n","import {Point} from 'app/contracts/Geometry';\r\n\r\n\r\n/** Calculate the actual position of an element from relative cords (Allowing for offsets) */\r\nexport class RelativeTimelinePosition {\r\n\r\n\tconstructor (private _relativeX: number, private _relativeY: number) {}\r\n\r\n\tprivate _absoluteX: number;\r\n\tprivate _absoluteY: number;\r\n\tprivate _x: number;\r\n\tprivate _y: number;\r\n\r\n\tpublic get x() : number {\r\n\t\treturn this._x;\r\n\t}\r\n\r\n\tpublic get y() : number {\r\n\t\treturn this._y;\r\n\t}\r\n\r\n\tpublic get absoluteX() : number {\r\n\t\treturn this._absoluteX;\r\n\t}\r\n\r\n\tpublic get absoluteY() : number {\r\n\t\treturn this._absoluteY;\r\n\t}\r\n\r\n\tpublic resize(containerWidth: number, containerHeight: number) {\r\n\t\tthis._absoluteX = containerWidth * this._relativeX;\r\n\t\tthis._absoluteY = containerHeight * this._relativeY;\t\r\n\t}\r\n\r\n\tpublic update(offsetX: number, offsetY: number): void {\r\n\t\tthis._x = this._absoluteX + offsetX;\r\n\t\tthis._y = this._absoluteY + offsetY;\r\n\t}\r\n\r\n\tpublic increase(x: number, y: number): void {\r\n\t\tthis._x += x;\r\n\t\tthis._y += y;\r\n\t}\r\n\r\n\tpublic setPosition(point: Point): void {\r\n\t\tthis._x = point.x;\r\n\t\tthis._y = point.y;\r\n\t}\r\n\r\n}\r\n","//Justin Windle:\r\n//https://codepen.io/soulwire/pen/mErPAK\r\n\r\n// \r\n// TextScramble\r\n// \r\n\r\nexport class TextScramble {\r\n\r\n  private speed;\r\n  private el;\r\n  private chars;\r\n  private queue;\r\n  private resolve;\r\n  private frameRequest;\r\n  private frame;\r\n\r\n  constructor(el, speed) {\r\n\r\n    this.speed = 10;\r\n    this.el = el;\r\n    this.chars = '!<>-_\\\\/[]{}=+*^?#________';\r\n    this.update = this.update.bind(this);\r\n\r\n    if (speed) {\r\n      this.speed = speed;\r\n    }\r\n\r\n  }\r\n  setText(newText) {\r\n    const oldText = this.el.innerText;\r\n    const length = Math.max(oldText.length, newText.length);\r\n    const promise = new Promise((resolve) => this.resolve = resolve);\r\n    this.queue = [];\r\n    for (let i = 0; i < length; i++) {\r\n      const from = oldText[i] || '';\r\n      const to = newText[i] || '';\r\n      const start = Math.floor(Math.random() * this.speed );\r\n      const end = start + Math.floor(Math.random() * this.speed );\r\n      this.queue.push({ from, to, start, end });\r\n    }\r\n    cancelAnimationFrame(this.frameRequest);\r\n    this.frame = 0;\r\n    this.update();\r\n    return promise;\r\n  }\r\n  update() {\r\n    let output = '';\r\n    let complete = 0;\r\n    for (let i = 0, n = this.queue.length; i < n; i++) {\r\n      let { from, to, start, end, char } = this.queue[i];\r\n      if (this.frame >= end) {\r\n        complete++;\r\n        output += to;\r\n      } else if (this.frame >= start) {\r\n        if (!char || Math.random() < 0.28) {\r\n          char = this.randomChar();\r\n          this.queue[i].char = char;\r\n        }\r\n        output += `<span class=\"dud\">${char}</span>`;\r\n      } else {\r\n        output += from;\r\n      }\r\n    }\r\n    this.el.innerHTML = output;\r\n    if (complete === this.queue.length) {\r\n      this.resolve();\r\n    } else {\r\n      this.frameRequest = requestAnimationFrame(this.update);\r\n      this.frame++;\r\n    }\r\n  }\r\n  randomChar() {\r\n    return this.chars[Math.floor(Math.random() * this.chars.length)];\r\n  }\r\n} \r\n","import {Module} from 'debugbase/abstract/Module';\r\nimport {Events} from 'debugbase/events/Events';\r\n\r\ninterface MarkerPoint {\r\n\tlat: number;\r\n\tlong: number;\r\n\timage?: string;\r\n}\r\n\r\nexport class GoogleMap extends Module {\r\n\r\n\tpublic config = {\r\n\t\tlat: 51.5491144,\r\n\t\tlong: -0.076880,\r\n\t\tstyle: [{\"featureType\":\"all\",\"elementType\":\"labels.text.fill\",\"stylers\":[{\"saturation\":36},{\"color\":\"#000000\"},{\"lightness\":40}]},{\"featureType\":\"all\",\"elementType\":\"labels.text.stroke\",\"stylers\":[{\"visibility\":\"on\"},{\"color\":\"#000000\"},{\"lightness\":16}]},{\"featureType\":\"all\",\"elementType\":\"labels.icon\",\"stylers\":[{\"visibility\":\"off\"}]},{\"featureType\":\"administrative\",\"elementType\":\"geometry.fill\",\"stylers\":[{\"color\":\"#000000\"},{\"lightness\":20}]},{\"featureType\":\"administrative\",\"elementType\":\"geometry.stroke\",\"stylers\":[{\"color\":\"#000000\"},{\"lightness\":17},{\"weight\":1.2}]},{\"featureType\":\"landscape\",\"elementType\":\"geometry\",\"stylers\":[{\"color\":\"#000000\"},{\"lightness\":20}]},{\"featureType\":\"poi\",\"elementType\":\"geometry\",\"stylers\":[{\"color\":\"#000000\"},{\"lightness\":21}]},{\"featureType\":\"road.highway\",\"elementType\":\"geometry.fill\",\"stylers\":[{\"color\":\"#000000\"},{\"lightness\":17}]},{\"featureType\":\"road.highway\",\"elementType\":\"geometry.stroke\",\"stylers\":[{\"color\":\"#000000\"},{\"lightness\":29},{\"weight\":0.2}]},{\"featureType\":\"road.arterial\",\"elementType\":\"geometry\",\"stylers\":[{\"color\":\"#000000\"},{\"lightness\":18}]},{\"featureType\":\"road.local\",\"elementType\":\"geometry\",\"stylers\":[{\"color\":\"#000000\"},{\"lightness\":16}]},{\"featureType\":\"transit\",\"elementType\":\"geometry\",\"stylers\":[{\"color\":\"#000000\"},{\"lightness\":19}]},{\"featureType\":\"water\",\"elementType\":\"geometry\",\"stylers\":[{\"color\":\"#000000\"},{\"lightness\":17}]}],\r\n\t\tzoom: 16,\r\n\t\ttype: 'ROADMAP',\r\n\t\tcontrol: 'LEFT_BOTTOM',\r\n\t\tbackgroundColour: '#333333',\r\n\t\tmarkerImage: '/img/ui/google-map-marker.png',\r\n\t\tscrollWheel: false,\r\n\t\tdirectionsSelector: null,\r\n\t\treplaceAtWidth: 1000,\r\n\t\treplaceImage: '/img/ui/mobile-map.jpg',\r\n\t\treplaceSelector: null,\r\n\t};\r\n\r\n\tprivate _markerData: Array<MarkerPoint> = [];\r\n\tprivate _map: google.maps.Map;\r\n\r\n\t//Mapping features: \r\n\tprivate _directionsStep: number = 1;\r\n\r\n\tprivate _$directionsContainer: HTMLElement;\r\n\tprivate _$directionsTypes: HTMLElement;\r\n\tprivate _$directionsAutoComplete: HTMLInputElement;\r\n\tprivate _$directionsTitle: HTMLElement;\r\n\r\n\tprivate _travelMode: google.maps.TravelMode;\r\n\tprivate _directionsService: google.maps.DirectionsService;\r\n\tprivate _directionsDisplay: google.maps.DirectionsRenderer;\r\n\tprivate _place: any; //What is this type?\r\n\tprivate _autocomplete:  google.maps.places.Autocomplete;\r\n\r\n\tpublic create(): void {\r\n\r\n\t\tif (this.config.replaceImage &&  window.innerWidth <= this.config.replaceAtWidth) {\r\n\t\t\tthis._replaceMap();\r\n\t\t\tthis.destroy();\r\n\t\t\treturn; \r\n\t\t}\r\n\r\n\t\tthis._createMap();\r\n\t\t//if (this.config.markerImage) {\r\n\t\t\tthis._setupMainMarker();\r\n\t\t\tthis._createMarkers();\r\n\t\t//}\r\n\t\tif (this.config.directionsSelector) {\r\n\t\t\tthis._setupDirections();\r\n\t\t}\r\n\t\tthis.resize();\r\n\t}\r\n\r\n\r\n\tpublic resize(): void {\r\n\t\t(this.$container as HTMLElement).style.height = `${window.innerHeight * 0.9}px`;\r\n\t}\r\n\r\n\t//Private \r\n\t//------------------------------------------------------------------------------------------\r\n\tprivate _createMap(): void {\r\n\t\r\n\t\tvar center = new google.maps.LatLng(this.config.lat, this.config.long);\r\n\t\tvar mapOptions: google.maps.MapOptions = {\r\n\t        zoom: this.config.zoom,\r\n\t        center: center,\r\n\t        mapTypeId: google.maps.MapTypeId[this.config.type],\r\n\t        mapTypeControl: false,\r\n\t        panControl: false,\r\n\t\t\tscrollwheel: this.config.scrollWheel,\r\n\t \t\tstyles:  this.config.style as any,\r\n            zoomControlOptions: {\r\n                style: google.maps.ZoomControlStyle.LARGE,\r\n                position: google.maps.ControlPosition[this.config.control]\r\n             },\r\n             streetViewControlOptions : { position : google.maps.ControlPosition[this.config.control] },\r\n             backgroundColor: this.config.backgroundColour\r\n\t     };\r\n\r\n\t    this._map = new google.maps.Map(this.$container, mapOptions);\r\n\r\n\t}\r\n\r\n\tprivate _setupMainMarker(): void {\r\n\t\tthis._markerData.push({lat: this.config.lat, long: this.config.long, image: this.config.markerImage});\r\n\t}\r\n\r\n\tprivate _createMarkers(): void {\r\n\r\n\t\tif (this._markerData.length === 0) {\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tthis._markerData.forEach( (data: MarkerPoint) => this._createMarker(data) );\r\n\r\n\t}\r\n\r\n\tprivate _createMarker(data: MarkerPoint): void {\r\n\r\n\t\tvar icon = {\r\n\t\t\turl: data.image, // url\r\n\t\t\tscaledSize: new google.maps.Size(74, 96), // scaled size\r\n\t\t\torigin: new google.maps.Point(0, 0), // origin\r\n\t\t\tanchor: new google.maps.Point(37, 96) // anchor\r\n\t\t}; \r\n\r\n\t\tvar point  = new google.maps.LatLng(data.lat, data.long);\r\n\t\tvar marker = new google.maps.Marker({\r\n\t\t\tdraggable: false,\r\n\t\t\ticon: icon,\r\n\t\t\tmap: this._map,\r\n\t\t\tposition: point\r\n\t\t});\r\n\t}\r\n\r\n\tprivate _setupDirections(): void {\r\n\r\n\t\tthis._$directionsContainer = document.querySelector(this.config.directionsSelector);\r\n\t\t\r\n\t\tthis._directionsService = new google.maps.DirectionsService;\r\n        this._directionsDisplay = new google.maps.DirectionsRenderer({\r\n\t\t    polylineOptions: {\r\n\t\t      strokeColor: '#01dcf7',\r\n\t\t      strokeWeight: 5\r\n\t\t    },\r\n\t\t    markerOptions: {visible: false, position: null}\r\n  \t\t});\r\n\r\n  \t\tthis._directionsDisplay.setMap(this._map);\r\n\r\n  \t\t//Add auto comlete feature ----------------------------------------------------------------\r\n  \t\tthis._autocomplete = new google.maps.places.Autocomplete(\r\n\t\t\tthis._$directionsContainer.querySelector('.googlemap__autocomplete') as HTMLInputElement,\r\n\t\t\t{types: ['geocode']}\r\n\t\t);\r\n\r\n\t\t// When the user selects an address from the dropdown, populate the address\r\n\t\t// fields in the form.\r\n\t\tthis._autocomplete.addListener('place_changed', () => this._fillInAddress());\r\n\r\n\t\t//Add travel type button events: \r\n\t\tEvents.on('click', `${this.config.directionsSelector} .googlemap__traveltype`, (e: MouseEvent) => {\r\n\t\t\t//Get the type number: \r\n\t\t\tlet type: string =  (e.target as HTMLElement).getAttribute('data-travel-type');\r\n\t\t\tlet travelMode: google.maps.TravelMode = google.maps.TravelMode[type];\r\n\r\n\t\t\tthis._setTravelMode(travelMode);\r\n\t\t\treturn false;\r\n\t\t});\r\n\r\n\t\tEvents.on('click', `${this.config.directionsSelector}`, (e: MouseEvent) => {\r\n\t\t\tthis._directionsHolderPress();\r\n\t\t\treturn false;\r\n\t\t});\r\n\r\n\t\t//Set refs \r\n\t\tthis._$directionsTypes = (this._$directionsContainer.querySelector(`.googlemap__traveltypes`) as HTMLElement);\r\n\t\tthis._$directionsAutoComplete = (this._$directionsContainer.querySelector(`.googlemap__autocomplete`) as HTMLInputElement);\r\n\t\tthis._$directionsTitle = (this._$directionsContainer.querySelector(`.googlemap__title`) as HTMLElement);\r\n\r\n\t}\r\n\r\n\tprivate _directionsHolderPress(): void {\r\n\r\n\t\tif (this._directionsStep > 1) {\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tthis._setupDirectionsStep(this._directionsStep + 1);\r\n\r\n\t}\r\n\r\n\tprivate _fillInAddress() {\r\n\t\t// Get the place details from the autocomplete object.\r\n\t\tthis._place = this._autocomplete.getPlace();\r\n\r\n\t\tlet point:  google.maps.LatLng | string;\r\n\t\t\t\t\t\r\n\t\tif ( this._place.geometry) {\r\n\t  \t\tlet lat = this._place.geometry.location.lat();\r\n\t   \t\tlet lng = this._place.geometry.location.lng();\r\n\t   \t\tpoint = new google.maps.LatLng(lat, lng);\r\n\t\t} else {\r\n\t\t\tpoint = this._place.name;\r\n\t\t}\r\n\r\n\t\tthis._calculateAndDisplayRoute(point);\r\n\t}\r\n\r\n\tprivate _onUserSelectLocationCallback() {\r\n\t\t//Select location logic ------\r\n\t}\r\n\r\n\tprivate _onTravelTypeSelectCallback(): void {\r\n\t\t//Select Travel type logic ------\r\n\t}\r\n\r\n\tprivate _setTravelMode(mode: google.maps.TravelMode) {\r\n\r\n\t\tthis._travelMode = mode;\r\n\t\tthis._setupDirectionsStep(this._directionsStep + 1);\r\n\r\n\t}\r\n\r\n\tprivate _calculateAndDisplayRoute(destinationPoint: google.maps.LatLng | string) {\r\n\r\n\t\tlet originPoint: google.maps.LatLng = new google.maps.LatLng(this.config.lat, this.config.long);\r\n\r\n\t\tthis._directionsService.route({\r\n\t          origin: originPoint,\r\n\t          destination: destinationPoint,\r\n\t          travelMode: this._travelMode\r\n\t        }, (response, status: google.maps.DirectionsStatus) => {\r\n\t          if (status === google.maps.DirectionsStatus.OK) {\r\n\t            this._directionsDisplay.setDirections(response);\r\n\t            this._setupDirectionsStep(1);\r\n\t\r\n\t          } else {\r\n\t            window.alert('Sorry location not found, please try again.');\r\n\t           \t//$pop.app.getModule('contact').onLocationErrorCallback();\r\n\t          }\r\n\t    });\r\n\r\n\t}\r\n\r\n\tprivate _setupDirectionsStep(step: number): void {\r\n\r\n\t\tthis._directionsStep = step;\r\n\r\n\t\tif (this._directionsStep === 1) {\r\n\t\t\t\r\n\t\t\t//Reset / show start\r\n\t\t\tthis._$directionsAutoComplete.style.display = 'none';\r\n\t\t\tgsap.TweenMax.to(this._$directionsContainer, 0.3, {height: 70});\r\n\t\t\tthis.DOM.setText(this._$directionsTitle, 'Get new directions?');\r\n\r\n\t\t} else if (this._directionsStep === 2) {\r\n\t\t\t\r\n\t\t\t//Show Travel types\r\n\t\t\tthis._$directionsTypes.style.display = 'inline-block';\r\n\t\t\tthis.DOM.setText(this._$directionsTitle, 'How you traveling?');\r\n\r\n\t\t\t//Animate in -------------------------------------------\r\n\t\t\tgsap.TweenMax.to(this._$directionsContainer, 0.3,  {height: 180});\r\n\t\t\tgsap.TweenMax.set(this._$directionsTypes, {autoAlpha: 1});\r\n\t\t\tthis.DOM.addClass(this._$directionsTypes, '-active');\r\n\t\t\tgsap.TweenMax.staggerFromTo(`${this.config.directionsSelector} .googlemap__traveltype`, 0.4, {scale: 0}, {scale: 1, delay: 0.25}, 0.06);\r\n\r\n\t\t} else if (this._directionsStep === 3) {\r\n\t\t\t//Show location input\r\n\t\t\tthis._$directionsTypes.style.display = 'none';\r\n\t\t\tthis._$directionsAutoComplete.style.display = 'inline-block';\r\n\t\t\tthis._$directionsAutoComplete.value = '';\r\n\t\t\tgsap.TweenMax.fromTo(this._$directionsAutoComplete, 0.3, {autoAlpha: 0, y: 10},  {autoAlpha: 1, y: 0});\r\n\t\t\tthis.DOM.setText(this._$directionsTitle, 'Where you coming from?');\r\n\t\t}\r\n\r\n\t\tgsap.TweenMax.fromTo(this._$directionsTitle, 0.3, {autoAlpha: 0},  {autoAlpha: 1});\r\n\r\n\t}\r\n\r\n\tprivate _replaceMap(): void {\r\n\t\t\r\n\t\tlet replaceElement = (this.config.replaceSelector) ? document.querySelector(this.config.replaceSelector) : this.DOM.parent(this.$container);\r\n\t\tlet newElement: string = `<img src='${this.config.replaceImage}' class='googlemap__replacement'  />`;\r\n\r\n\t\tif (this.config.replaceSelector) {\r\n\t\t\tthis.DOM.setHTML(replaceElement, newElement);\r\n\t\t} else {\r\n\t\t\tthis.$container.remove();\r\n\t\t\tthis.DOM.append(replaceElement, newElement);\r\n\t\t}\r\n\t\t\r\n\t}\r\n\r\n}\r\n","import {Module} from 'debugbase/abstract/Module';\r\nimport {Events} from 'debugbase/events/Events';\r\n\r\nexport class LazyLoadImage extends Module {\r\n\t\r\n\tpublic config = {\r\n\t\tratio: 'square',\r\n\t\tfade: true,\r\n\t\tfadeTime: 0.25,\r\n\t};\r\n\r\n\tpublic create(): void {\r\n\r\n\t\tif (this.config.fade) {\r\n\t\t\tlet image: HTMLImageElement = this.$container.querySelector('img');\r\n\t\t\tgsap.TweenMax.set(image, {autoAlpha: 0});\r\n\t\t\timage.addEventListener('load', (e) => {\r\n\t\t\t\timage.onload = null;\r\n\t\t\t\tgsap.TweenMax.to(image, this.config.fadeTime, {autoAlpha: 1, ease: gsap.Power0.easeNone});\r\n\t\t\t\tthis.destroy();\r\n\t\t\t});\r\n\t\t}\r\n\r\n\t}\r\n\r\n}\r\n","import {Events} from 'debugbase/events/Events';\r\nimport {DOMHelper} from  'debugbase/helper/DOMHelper';\r\nimport {SidePagingClickEvent} from 'app/event/SidePagingClickEvent';\r\nimport {UIThemeColourType} from 'app/data/Enums';\r\n\r\ninterface ItemConfig {\r\n\tlabel: string;\r\n\ttargetSelector: string;\r\n}\r\n\r\ninterface Item {\r\n\ttarget: HTMLElement;\r\n\ttargetSelector: string;\r\n}\r\n\r\nexport class SidePaging {\r\n\t\r\n\tprivate _items: Array<Item>;\r\n\tprivate _activeIndex: number = 1;\r\n\r\n\tconstructor (public container: HTMLElement, public dom: DOMHelper) {\r\n\t\tEvents.on('click', '.project__sidepaging__item', this._onItemClick.bind(this));\r\n\t}\r\n\r\n\tpublic create(itemsData: Array<ItemConfig>): void {\r\n\t\tthis._createItemsHTML(itemsData);\r\n\t}\r\n\r\n\tpublic destroy(): void {\r\n\t\tthis._items = null;\r\n\t}\r\n\r\n\tpublic show(): void {\r\n\t\tgsap.TweenMax.fromTo(this.container, 0.3, {autoAlpha: 0}, {autoAlpha: 1, ease: gsap.Power0.easeNone, delay: 0.6});\r\n\t}\r\n\r\n\tpublic hide(): void {\r\n\t\tgsap.TweenMax.to(this.container, 0.3, {autoAlpha: 0, ease: gsap.Power0.easeNone, delay: 0});\r\n\t}\r\n\r\n\tpublic selectIndex(index: number, theme: UIThemeColourType): void {\r\n\r\n\t\tif (theme === UIThemeColourType.DARK) {\r\n\t\t\tthis.dom.addClass(this.container, '-dark');\r\n\t\t} else {\r\n\t\t\tthis.dom.removeClass(this.container, '-dark');\r\n\t\t}\r\n\r\n\t\tthis._selectIndex(index);\r\n\r\n\t}\r\n\r\n\t//Private \r\n\t//----------------------------------------------------------------\r\n\tprivate _onItemClick(e: MouseEvent): boolean {\r\n\t\te.preventDefault();\r\n\t\tthis._selectIndex( parseInt((e.target as HTMLElement).getAttribute('data-index'), 10) );\r\n\t\tEvents.dispatch(new SidePagingClickEvent({\r\n\t\t\tindex: this._activeIndex, \r\n\t\t\ttargetSelector: this._items[this._activeIndex].targetSelector\r\n\t\t}));\r\n\t\treturn false;\r\n\t}\r\n\r\n\tprivate _selectIndex(index: number): void {\r\n\t\tthis._activeIndex = index;\r\n\t\tthis._setSelectedState();\r\n\t}\r\n\r\n\tprivate _createItemsHTML(itemsData: Array<ItemConfig>): void {\r\n\t\tlet html = '';\r\n\t\titemsData.forEach((config: ItemConfig, index: number) => {\r\n\t\t\thtml += this._createItemHTML(config, index);\r\n\t\t});\r\n\t\tthis.dom.setHTML(this.container, html, () => this._createItems(itemsData));\r\n\t}\r\n\r\n\tprivate _createItemHTML(config: ItemConfig, index: number): string {\r\n\t\treturn `<a class='project__sidepaging__item -index${index}' data-index='${index}' href='#'>\r\n\t\t${config.label}\r\n\t\t</a>`;\r\n\t}\r\n\r\n\tprivate _createItems(itemsData: Array<ItemConfig>): void {\r\n\t\tthis._items = [];\r\n\t\titemsData.forEach((config: ItemConfig, index: number) => {\r\n\t\t\tthis._items.push({\r\n\t\t\t\ttarget: this.container.querySelector(`.project__sidepaging__item.-index${index}`),\r\n\t\t\t\ttargetSelector: config.targetSelector,\r\n\t\t\t});\r\n\t\t});\r\n\t}\r\n\r\n\tprivate _setSelectedState(): void {\r\n\t\tthis._items.forEach((item: Item, index: number) => {\r\n\t\t\tif (index === this._activeIndex) {\r\n\t\t\t\tthis.dom.addClass(item.target, '-selected');\r\n\t\t\t} else {\r\n\t\t\t\tthis.dom.removeClass(item.target, '-selected');\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n\r\n}\r\n\r\n","import {Module} from 'debugbase/abstract/Module';\r\nexport class VideoSwitch extends Module {\r\n\r\n\tpublic config = {\r\n\t\tdesktopSrc: null,\r\n\t\tmobileSrc: null\r\n\t};\r\n\r\n\tpublic create(): void {\r\n\t\t\r\n\t\tlet src = (this.system.isPortraitDevice) ? this.config.mobileSrc : this.config.desktopSrc;\r\n\t\tthis.$container.querySelector('source').setAttribute('src', src);\r\n\t\t(this.$container as HTMLVideoElement).load();\r\n\r\n\t\t//Not needed for anything else at the moment so destroy \r\n\t\tthis.destroy();\r\n\r\n\t}\r\n\r\n}\r\n","import {Module} from 'debugbase/abstract/Module';\r\nimport {Events} from 'debugbase/events/Events';\r\nimport {Debugbase} from 'debugbase/Debugbase';\r\n\r\nexport class LoadMore extends Module {\r\n\t\r\n\tpublic config = {\r\n\t\ttotal: null,\r\n\t\tactiveCount: 0,\r\n\t\tloadCount: 0,\r\n\t\timgSrc: '',\r\n\t\tselector: '.load-more__items',\r\n\t\tbuttonSelector : 'load-more__button'\r\n\t};\r\n\r\n\tprivate _$contentContainer: HTMLElement;\r\n\tprivate _$button: HTMLElement;\r\n\tprivate _eventId: number; \r\n\r\n\tpublic create(): void {\r\n\t\tthis._$contentContainer = this.$container.querySelector(this.config.selector);\r\n\t\tthis._$button = document.querySelector(this.config.buttonSelector);\r\n\t\tthis._eventId = Events.on('click', this._$button, () => this._loadMore() );\r\n\t}\r\n\r\n\tpublic destroy(): void {\r\n\t\tEvents.offById( this._eventId );\r\n\t\tthis._$contentContainer  = null;\r\n\t\tthis._$button  = null;\r\n\t\tsuper.destroy();\r\n\t}\r\n\r\n\tprivate _loadMore(): void {\r\n\r\n\t\tlet html: string = '';\r\n\t\tlet startCount: number = this.config.activeCount + 1;\r\n\t\tthis.config.activeCount = (startCount +  this.config.loadCount <  this.config.total)  ? startCount +  this.config.loadCount : this.config.total;\r\n\r\n\t\tfor (let i = startCount; i <= this.config.activeCount; i++) {\r\n\t\t\tlet imgSrc = Debugbase.string.template(this.config.imgSrc, {n: i} );\r\n\t\t\thtml += this._img(imgSrc);\r\n\t\t}\r\n\r\n\t\tDebugbase.DOM.append(this._$contentContainer, html);\r\n\r\n\t\tif (this.config.activeCount >= this.config.total) {\r\n\t\t\tgsap.TweenMax.to(this._$button, 0.5, {autoAlpha: 0});\r\n\t\t}\r\n\r\n\t}\r\n\r\n\tprivate _img(src: string): string {\r\n\t\treturn `<div class='grid__item'>\r\n\t\t\t<div class='lazy-load-image -ratio-square'>\r\n\t\t\t\t<div class=\"lazy-load-image__inner\">\r\n\t\t\t\t\t<img src=\"${src}\">\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\t</div>`;\r\n\t}\r\n\r\n}\r\n","import {Debugbase} from 'debugbase/Debugbase';\r\n//import { TimelineMax, TweenMax, Power0, Power1, Power3, Back, Tween,  } from 'gsap';\r\n//import  {PixiPlugin} from  'gsap/PixiPlugin';\r\nimport {ZoomConfig, Size} from './WorkTilePixi';\r\n//import * as PIXI from 'pixi.js';\r\n//import { GlowFilter } from '@pixi/filter-glow';\r\n\r\nexport interface WorkTileImageConfig {\r\n\tmaskPath?: string; \r\n\tscaleStart?: number;\r\n\tscaleEnd?: number;\r\n\tstartScaleRange?: number;\r\n\tendScaleRange?: number;\r\n\talphaStart?: number;\r\n\talphaEnd?: number;\r\n\tstartAlphaRange?: number;\r\n\tendAlphaRange?: number;\r\n\ttint?: number;\r\n}\r\n\r\ninterface Tweens {\r\n\timage?: gsap.Tween;\r\n\tmask?: gsap.Tween;\r\n\timageLeft?: gsap.Tween;\r\n\timageRight?: gsap.Tween;\r\n\tsupport?: gsap.Tween;\r\n\tblackout? : gsap.Tween;\r\n}\r\n\r\ninterface WorkTileImagePixiTextures {\r\n\timage: PIXI.Texture;\r\n\tmask: PIXI.Texture;\r\n\tbevel: PIXI.Texture;\r\n\tblack: PIXI.Texture;\r\n\tglow: PIXI.Texture;\r\n}\r\n\r\nexport class WorkTileImagePixi {\r\n\r\n\tprivate _tint: number;\r\n\tprivate _textures: WorkTileImagePixiTextures;\r\n\r\n\tprivate _$innerContainer: PIXI.Container;\r\n\tprivate _$image: PIXI.Sprite;\r\n\tprivate _$glow: PIXI.Sprite;\r\n\tprivate _$bevel: PIXI.Sprite;\r\n\tprivate _$blackout: PIXI.Sprite;\r\n\r\n\tprivate _$mask: PIXI.Sprite;\r\n\tprivate _alpha: number;\r\n\tprivate _scale: number;\r\n\tprivate _mouseDownScale: number = 0;\r\n\tprivate _displayScale: number = 1;\r\n\tprivate _processedProgress: number;\r\n\tprivate _tweens: Tweens = {};\r\n\tprivate _timeouts: any = {};\r\n\tprivate _availbleMaskSize: Size; \r\n\tprivate _fullRange: number = 0.2;\t\t\t//The amount the image is at 100% for\r\n\r\n\tconstructor (private _$pixi: PIXI.Application, private _$container: PIXI.Container, private _config: WorkTileImageConfig) {\r\n\t\tthis._config.scaleStart = 0.5; \r\n\t\tthis._config.scaleEnd = 0.4;\r\n\t\tthis._config.alphaStart = 0.01; \r\n\t\tthis._config.alphaEnd = 0.01;\r\n\t\tthis._config.startScaleRange = 1.0 - this._config.scaleStart;\r\n\t\tthis._config.endScaleRange = 1.0 - this._config.scaleEnd;\r\n\t\tthis._config.startAlphaRange = 1.0 - this._config.alphaStart;\r\n\t\tthis._config.endAlphaRange = 1.0 - this._config.alphaEnd;\r\n\t}\r\n\r\n\t//Set the glow tint: \r\n\tpublic setTint(tint: number): void {\r\n\t\tthis._tint = tint;\r\n\t}\r\n\r\n\t//Set required textures: \r\n\tpublic setTextures(textures: WorkTileImagePixiTextures): void {\r\n\t\tthis._textures = textures;\r\n\t}\r\n\r\n\t//All dependies set so create the image: \r\n\tpublic  create(): void {\r\n\t\tthis._createMaskedImage(); \t\r\n\t\tthis._createTintTweens();\r\n\t}\r\n\r\n\t//Update the item ro animate \r\n\t//Rotation of image is determined by velocity of movement and so passed in: \r\n\tpublic update(progress: number, rotation: number = 0.0, skipPixiUpdate: boolean = false): void {\r\n\r\n\t\tif (progress < (0.5 - (this._fullRange / 2) ) ) {\r\n\t\t\tthis._processedProgress = progress / (0.5 - (this._fullRange / 2) );\r\n\t\t\tthis._scale = this._config.scaleStart + (this._config.startScaleRange *  this._processedProgress );\r\n\t\t\tthis._alpha = this._config.alphaStart + (this._config.startAlphaRange * this._processedProgress );\r\n\t\t} else if (progress > (0.5 + (this._fullRange / 2) ) ) { \r\n\t\t\tprogress -= (0.5 + (this._fullRange / 2) ); \r\n\t\t\tthis._processedProgress = progress / (0.5 + (this._fullRange / 2));\r\n\t\t\tthis._scale = 1.0 -  (this._processedProgress * this._config.endScaleRange);\r\n\t\t\tthis._alpha = 1.0 -  (this._processedProgress * this._config.endAlphaRange);\r\n\t\t} else {\r\n\t\t\tthis._scale = 1.0;\r\n\t\t\tthis._alpha = 1.0; \r\n\t\t}\r\n\r\n\t\tif (skipPixiUpdate) {\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tif (this._mouseDownScale > 0) {\r\n\t\t\tthis._mouseDownScale -= 0.015;\r\n\t\t}\r\n\r\n\t\tthis._scale += this._mouseDownScale;\r\n\r\n\t\t//Set the state of the image: \r\n\t\t//this._$image.alpha = this._alpha;\r\n\t\t//this._$image.scale.x = this._$image.scale.y = this._scale * this._displayScale;\r\n\t\t//this._$image.rotation = this._$mask.rotation = rotation;\r\n\r\n\t\t//this._$innerContainer.alpha = this._alpha;\r\n\t\tthis._$blackout.alpha = 1.0 - this._alpha;\r\n\t\tthis._$innerContainer.scale.set(this._scale * this._displayScale, this._scale * this._displayScale);\r\n\t\tthis._$glow.scale.set(this._scale * this._displayScale, this._scale * this._displayScale);\r\n\t\tthis._$blackout.scale.set(this._scale * this._displayScale, this._scale * this._displayScale);\r\n\r\n\t\tthis._$glow.alpha = 0;\r\n\t\r\n\t\tthis._$innerContainer.rotation = this._$glow.rotation  = this._$blackout.rotation  = rotation;\r\n\r\n\t}\r\n\r\n\t//Zoom into project, save the tweens so they can reversved \r\n\tpublic zoomToProject(instant: boolean = false, config: ZoomConfig, delay: number = 0.0): void {\r\n\r\n\t\tthis._$innerContainer.cacheAsBitmap = false;\r\n\r\n\t\tlet tweenTime: number = (instant) ? 0.0 : 0.8;\r\n\r\n\t\tthis._tweens.image = gsap.TweenMax.to(this._$image, tweenTime, \r\n\t\t{pixi: {scaleX: config.imageScale,  scaleY: config.imageScale}, ease: gsap.Power3.easeInOut, delay: delay,\r\n\t\t});\r\n\t\r\n\t\tthis._tweens.mask = gsap.TweenMax.to([this._$mask, this._$glow, this._$bevel, this._$blackout], tweenTime, {\r\n\t\t\tpixi: {scaleX: config.maskScaleX,  scaleY: config.maskScaleY} , ease: gsap.Power3.easeInOut, delay: delay,\r\n\t\t});\r\n\r\n\t\tthis._tweens.support  = gsap.TweenMax.to([this._$innerContainer, this._$glow,  this._$blackout], tweenTime, \r\n\t\t{x: config.imageX, y: config.imageY, ease: gsap.Power3.easeInOut, delay: delay,\r\n\t\tpixi: {scaleX: 1,  scaleY: 1}, \t\r\n\t\t} );\r\n\r\n\t\tthis._tweens.blackout  = gsap.TweenMax.to(this._$blackout, tweenTime, {alpha: 0} );\r\n\t\t\r\n\t}\r\n\r\n\t//Exit out of a project \r\n\tpublic zoomFromProject(): void {\r\n\t\t\r\n\t\t/*this._tweens.image.reverse();\r\n\t\tthis._tweens.mask.reverse();\r\n\t\tthis._tweens.support.reverse();\r\n\t\tthis._tweens.blackout.reverse();\r\n\t\t*/ \r\n\r\n\t\t//Update the values based (Doesn't actually update display, but just gives access to the values)\r\n\t\t//this.update();\r\n\r\n\t\t\t/*\r\n\t\tthis._tweens.image = gsap.TweenMax.to(this._$image,  0.8, \r\n\t\t{pixi: {scaleX: 1,  scaleY: 1}, ease: gsap.Power3.easeInOut, delay: 0,\r\n\t\t});\r\n\t\r\n\t\tthis._tweens.mask = gsap.TweenMax.to([this._$mask, this._$glow, this._$bevel, this._$blackout],  0.8, {\r\n\t\t\tpixi: {scaleX: 1,  scaleY: 1} , ease: gsap.Power3.easeInOut, delay: 0,\r\n\t\t});\r\n\r\n\t\tthis._tweens.support  = gsap.TweenMax.to([this._$innerContainer, this._$glow,  this._$blackout],  0.8, \r\n\t\t{x: this._availbleMaskSize.width / 2, y: this._availbleMaskSize.height / 2, ease: gsap.Power3.easeInOut, delay: 0,\r\n\t\tpixi: {scaleX: 1 * this._displayScale,  scaleY: 1 * this._displayScale}, \t\r\n\t\t} );\r\n\r\n\t\tthis._tweens.blackout  = gsap.TweenMax.to(this._$blackout,  0.8, {alpha: 0} );\r\n\r\n\t\t//Turning caching back on for the tile as transition will be complete: \r\n\t\t*/\r\n\r\n\t\tthis._tweens.image.reverse();\r\n\t\tthis._tweens.mask.reverse();\r\n\t\tthis._tweens.support.reverse();\r\n\t\tthis._tweens.blackout.reverse();\r\n\t\tthis._timeouts.zoom = setTimeout( () => this._$innerContainer.cacheAsBitmap = true, 1000);\r\n\t\t\r\n\t}\r\n\r\n\t//Get the native image sizes: \r\n\tpublic getImageSizes(): Size {\r\n\t\treturn {\r\n\t\t\twidth: this._$image.texture.width,\r\n\t\t\theight: this._$image.texture.height\r\n\t\t};\r\n\t}\r\n\r\n\t//Get the native mask sizes: \r\n\tpublic getMaskSizes(): Size {\r\n\t\treturn {\r\n\t\t\twidth: this._$mask.texture.width,\r\n\t\t\theight: this._$mask.texture.height\r\n\t\t};\r\n\t}\r\n\r\n\t//Get the display scale (Used to scale particle logic to keep relative to the main image): \r\n\tpublic getDisplayScale(): number {\r\n\t\treturn this._displayScale;\r\n\t}\r\n\r\n\tpublic getActualScale(): number {\r\n\t\treturn this._scale * this._displayScale;\r\n\t}\r\n\r\n\tpublic setMouseDownScale(ratio: number) {\r\n\t\tthis._mouseDownScale = ratio * 0.25;\r\n\t}\r\n\r\n\t//Set the aviable mask size on resize: \r\n\tpublic resize(availbleMaskSize: Size, skipChanges: boolean = false): void {\r\n\t\t\r\n\t\tthis._availbleMaskSize = availbleMaskSize;\r\n\t\tthis._setDisplayScale();\r\n\t\r\n\t\tif ( skipChanges ) {\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tthis._positionImages();\r\n\t\tthis._setContainerPivot();\r\n\r\n\t}\r\n\r\n\t//Get the native mask sizes: \r\n\tpublic getMaskAvailableSizes(): Size {\r\n\t\treturn this._availbleMaskSize;\r\n\t}\r\n\r\n\t//Private \r\n\t//--------------------------------------------------------------------------------------------\r\n\t//--------------------------------------------------------------------------------------------\r\n\t//--------------------------------------------------------------------------------------------\r\n\t//--------------------------------------------------------------------------------------------\r\n\t\r\n\t//Add the masked image to the container:\r\n\tprivate _createMaskedImage(): void {\r\n\r\n\t\t//Note: anchors 0.5 / 0.5  are set in spritesheet / texture packer for all 'particle' items\r\n\t\tthis._$innerContainer = new PIXI.Container();\r\n\t \r\n\t\tthis._$mask = new PIXI.Sprite( this._textures.mask );\r\n\t\tthis._$bevel = new PIXI.Sprite(this._textures.bevel); \r\n\r\n\t\tthis._$bevel.visible = false;\r\n\t\t\r\n\t\tthis._$blackout = new PIXI.Sprite( this._textures.black); \r\n\t\tthis._$glow = new PIXI.Sprite( this._textures.glow  ); \r\n\t\tthis._$glow.tint = this._tint;\r\n\t\t\r\n\t\tthis._$image = new PIXI.Sprite(this._textures.image); \r\n\t\tthis._$image.anchor.set(0.5, 0.5);\r\n\t\tthis._$image.mask = this._$mask;\r\n\r\n\t\tthis._$image.interactive = true;\r\n\t\tthis._$image.hitArea = new PIXI.Rectangle( 0, 0, 100000, 100000 );\r\n\r\n\t\tthis._$image\r\n\t\t\t.on('mousedown', () => console.log('mouse down on tile'))\r\n\t\t\t.on('touchstart', () => console.log('touch on tile'));\r\n\r\n\t\tthis._$mask\r\n\t\t\t.on('mousedown', () => console.log('mouse down on tile'))\r\n\t\t\t.on('touchstart', () => console.log('touch on tile'));\r\n\t\r\n\t\tthis._$container.addChild(this._$glow, this._$innerContainer, this._$blackout);\r\n\t\tthis._$innerContainer.addChild(this._$image, this._$mask, this._$bevel);\r\n\r\n\t\t//Scale and size image as needed\r\n\t\tthis._setDisplayScale();\r\n\t\tthis._positionImages();\r\n\r\n\t\t//Cache the container\r\n\t\tthis._$innerContainer.cacheAsBitmap = true;\r\n\r\n\t}\r\n\r\n\tprivate _createTintTweens(): void {\r\n\t\t//this._tweens.imageLeft = TweenMax.fromTo(1, {}, {} );\r\n\t\t//this._tweens.imageRight = TweenMax.fromTo(1, {}, {} );\r\n\t}\r\n\r\n\t//Set the pivot of the image/mask/dropshadow container \r\n\tprivate _setContainerPivot(): void {\r\n\t\t\r\n\t\tif (!this._$innerContainer) {\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tlet bounds = this._$innerContainer.getBounds();\r\n\t\tthis._$innerContainer.pivot.x = bounds.width / 2;\r\n\t\tthis._$innerContainer.pivot.y = bounds.height / 2;\r\n\r\n\t}\r\n\r\n\t//Scale the scaling so the image scaling will stay in sync\r\n\tprivate _setDisplayScale(): void {\r\n\r\n\t\tlet maskSize: Size = this.getMaskSizes();\r\n\r\n\t\tif (!maskSize.width || !this._availbleMaskSize) {\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tthis._displayScale = 1.0; \r\n\r\n\t\tif (maskSize.width > this._availbleMaskSize.width || maskSize.height > this._availbleMaskSize.height) {\r\n\t\t\tlet wR: number = this._availbleMaskSize.width / maskSize.width;\r\n\t\t\tlet hR: number =  this._availbleMaskSize.height / maskSize.height;\r\n\t\t\tthis._displayScale = (hR < wR) ? hR : wR;\r\n\t\t}\r\n\r\n\t}\r\n\r\n\t//Position element in the middle of the area available for the mask on the Tile: \r\n\tprivate _positionImages(): void {\r\n\r\n\t\tif (!this._availbleMaskSize) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\t\r\n\t\tthis._$innerContainer.x = this._$glow.x = this._$blackout.x = this._availbleMaskSize.width / 2;\r\n\t\tthis._$innerContainer.y =  this._$glow.y = this._$blackout.y  = this._availbleMaskSize.height / 2;\r\n\r\n\r\n\t    this._$mask.x = (this._$mask.scale.x * this._$mask.width) / 2;\r\n\t\tthis._$mask.y = (this._$mask.scale.y * this._$mask.height) / 2;\r\n\r\n\t\tthis._$image.x =  this._$bevel.x  = this._$mask.x;\r\n\t\tthis._$image.y = this._$bevel.y = this._$mask.y;\r\n\r\n\t\tthis._$image.scale.set(0.65, 0.65);\r\n\r\n\t}\r\n\r\n\tprivate _playZoomTween(): void {\r\n\t\t//Replaying so reverse last time: \r\n\t\tthis._tweens.image.reverse();\r\n\t\tthis._tweens.mask.reverse();\r\n\t}\r\n\r\n}\r\n","import {Debugbase} from 'debugbase/Debugbase';\r\n//import { TimelineMax, TweenMax, Power0, Power1, Power3, Back } from 'gsap';\r\nimport {ZoomConfig, Size} from './WorkTilePixi';\r\n//import * as PIXI from 'pixi.js';\r\n\r\nexport interface WorkTileParticleConfig {\r\n\t\r\n\talpha?: ParticleAnimationConfig;\r\n\tscale?: ParticleAnimationConfig;\r\n\tx?: ParticleAnimationConfig;\r\n\ty?: ParticleAnimationConfig;\r\n\trotation?: ParticleAnimationConfig;\r\n\t//Passed in settings\r\n\ttexture: PIXI.Texture;\t\r\n\txOrg?: number;\r\n\tyOrg?: number;\r\n\tspeed?: number;\r\n\tautoRotate?: boolean;\r\n\tautoScale?: boolean;\r\n\tautoAlpha?: boolean;\r\n\r\n\t//startY endY //Positions of end relative to image anchor center -1 is aligned left +1 is aligned right:\r\n\tleftY?: number;\t\r\n\trightY?: number;\r\n\r\n}\r\n\r\ninterface ParticleAnimationConfig {\r\n\tvalue: number;\r\n\tstart: number;\r\n\tend: number; \r\n\tstartRange?: number;\r\n\tendRange?: number;\r\n\torg?: number;\r\n}\r\n\r\nexport class WorkTileParticlePixi {\r\n\r\n\tprivate _$image: PIXI.Sprite;\r\n\tprivate _alpha: number;\r\n\tprivate _scale: number;\r\n\tprivate _x: number;\r\n\tprivate _y: number;\r\n\tprivate _rotation: number;\r\n\tprivate _parallaxSpeed: number = 0;\r\n\tprivate _parallaxEasePower: number = 10;\r\n\tprivate _displayScale: number = 1;\r\n\tprivate _processedProgress: number;\r\n\tprivate _config: WorkTileParticleConfig;\r\n\r\n\tconstructor (private _$pixi: PIXI.Application, private _$container: PIXI.Container, config: WorkTileParticleConfig) {\r\n\r\n\t\tthis._config = {texture: config.texture}; \r\n\t\t\r\n\t\tvar s = 1.0;\r\n\t\tthis._config.scale = {\r\n\t\t\tvalue:  s, \r\n\t\t\tstart: (!config.autoScale) ? 1 : 0,\r\n\t\t\tend: (!config.autoScale) ? 1 : 0,\r\n\t\t};\r\n\r\n\t\tthis._config.scale.startRange = this._config.scale.value - this._config.scale.start;\r\n\t\tthis._config.scale.endRange = this._config.scale.value - this._config.scale.end;\r\n\r\n\t\ts = 1;\r\n\t\tthis._config.alpha = {\r\n\t\t\tvalue: 1,\r\n\t\t\tstart: (!config.autoAlpha) ? 1 :  0,\r\n\t\t\tend: (!config.autoAlpha) ? 1 : 0,\r\n\t\t};\r\n\r\n\t\tthis._config.alpha.startRange = this._config.alpha.value - this._config.alpha.start;\r\n\t\tthis._config.alpha.endRange = this._config.alpha.value - this._config.alpha.end;\r\n\t\tvar x = 50 + (Math.random( ) * 1000);\r\n\r\n\t\t//X/Y values need to be calculated releative to image:\r\n\t\t//TODO has releance on resize running to work - so fix. \r\n\t\tthis._config.x = {value: 0, start: 0, end: 0, org: config.xOrg};\r\n\r\n\t\tlet startY = (config.leftY) ? config.leftY : config.yOrg;\r\n\t\tlet endY = (config.rightY) ? config.rightY : config.yOrg;\r\n\t\tthis._config.y = {value: 0, start: startY, end: endY, org: config.yOrg};\r\n\r\n\t\t//var r = -180 + Math.random() * 180 * Math.PI / 180;\r\n\t\tvar r = 0; \r\n\t\tthis._config.rotation = {\r\n\t\t\tvalue: r,\r\n\t\t\tstart: (!config.autoRotate) ? 0 : r + Math.random() * 60 * Math.PI / 180,\r\n\t\t\tend: (!config.autoRotate) ? 0 : r - Math.random() * 60 * Math.PI / 180\r\n\t\t};\r\n\r\n\t\tthis._config.rotation.startRange = this._config.rotation.value - this._config.rotation.start;\r\n\t\tthis._config.rotation.endRange = this._config.rotation.value - this._config.rotation.end;\r\n\r\n\t\t//Set the parallax speed if passed. Determinds how much the partcile will move on the x (to create a sense of parallax)\r\n\t\tif (config.speed) {\r\n\t\t\tthis._parallaxSpeed = config.speed;\r\n\t\t}\r\n\r\n\t\tthis._createParticle(); \t\r\n\r\n\t}\r\n\r\n\t//Update the item ro animate \r\n\t//Rotation of image is determined by velocity of movement and so passed in: \r\n\tpublic update(progress: number): void {\r\n\r\n\t\tif (progress < 0.5) {\r\n\t\t\tthis._processedProgress = progress / 0.5;\r\n\t\t\tthis._scale = this._config.scale.start + (this._config.scale.startRange *  this._processedProgress );\r\n\t\t\tthis._alpha = this._config.alpha.start + (this._config.alpha.startRange * this._processedProgress );\r\n\t\t\tthis._x = this._config.x.start - (this._config.x.startRange - (this._config.x.startRange * this._processedProgress) );\r\n\t\t\tthis._y = this._config.y.value + (this._config.y.startRange * (1.0 - this._processedProgress) );\r\n\t\t\tthis._rotation = this._config.rotation.start + ( this._config.rotation.startRange * this._processedProgress );\r\n\t\t} else {\r\n\r\n\t\t\tprogress -= 0.5; \r\n\t\t\tthis._processedProgress = progress / 0.5;\r\n\t\t\tthis._scale = this._config.scale.value -  (this._processedProgress * this._config.scale.endRange);\r\n\t\t\tthis._alpha = this._config.alpha.value -  (this._processedProgress * this._config.alpha.endRange);\r\n\t\t\tthis._x = this._config.x.value +  (this._processedProgress * this._config.x.endRange);\r\n\t\t\tthis._y = this._config.y.value  -  (this._processedProgress * this._config.y.endRange);\r\n\t\t\tthis._rotation = this._config.rotation.value  - (this._processedProgress * this._config.rotation.endRange);\r\n\t\t}\r\n\r\n\t\t//Set the state of the image:\r\n\t\tthis._$image.alpha = this._alpha;\r\n\t\tthis._$image.scale.set(this._scale * this._displayScale, this._scale * this._displayScale);\r\n\t\tthis._$image.position.set(this._$image.x  + (( this._x - this._$image.x  ) / this._parallaxEasePower ), this._y);\r\n\t\tthis._$image.rotation = this._rotation;\r\n\r\n\t}\r\n\r\n\t//App has been sized so save the new scale of the tile (As all partciles are scale and move relative to the image)\r\n\tpublic resize(imageDisplayScale: number, imageSize: Size, imageArea: Size): void {\r\n\t\tthis._displayScale = imageDisplayScale;\r\n\t\tthis._calculateParticlePositions(imageSize, imageArea);\r\n\t}\r\n\r\n\t/** Zoom to project on click */\r\n\tpublic zoomToProject(): void {\r\n\t\tgsap.TweenMax.to(this._$image, 0.4, {pixi: {scaleY: 0, scaleX: 0, /*y: this._$image.y - 100,*/ alpha: 0} });\r\n\t}\r\n\r\n\t/** Zoom back from project on close press */\r\n\tpublic zoomFromProject(): void {\r\n\t\tgsap.TweenMax.to(this._$image, 0.5, { \r\n\t\t\tdelay: 0.4, ease: gsap.Power3.easeOut, \r\n\t\t\tpixi: {scaleY: this._scale * this._displayScale, scaleX: this._scale * this._displayScale, alpha: 1} \r\n\t\t});\r\n\t}\r\n\r\n\t//Private \r\n\t//--------------------------------------------------------------------------------------------\r\n\t//--------------------------------------------------------------------------------------------\r\n\t//--------------------------------------------------------------------------------------------\r\n\t//--------------------------------------------------------------------------------------------\r\n\t\r\n\t//Add the masked image to the container:\r\n\tprivate _createParticle(): void {\r\n\t\t\r\n\t\tthis._$image = new PIXI.Sprite( this._config.texture ); \r\n\t\tthis._$image.anchor.x = 0.5;\r\n\t\tthis._$image.anchor.y = 0.5;\r\n\t\tthis._$container.addChild(this._$image);\r\n\r\n\t\tthis._$image.x = this._config.x.value;\r\n\t\tthis._$image.y = this._config.y.value;\r\n\r\n\t}\r\n\r\n\t//Particle positions are calculated dynamically on every resize:\r\n\tprivate _calculateParticlePositions(imageSize: Size, imageArea: Size): void {\r\n\t\t\r\n\t\t//Recalculate start/on/off x/y of paricles \r\n\t\t//These are all set as relative to the center of the image space \r\n\t\tthis._config.x.value = (imageArea.width / 2) + ((imageSize.width / 2) * this._config.x.org);\r\n\t\tthis._config.y.value = (imageArea.height / 2) + ((imageSize.height / 2) * this._config.y.org);\r\n\r\n\t\tthis._config.x.start = this._config.x.value;\r\n\t\t//this._config.y.start = this._config.y.value;\r\n\r\n\t\t//Set the x and y ranges: \r\n\t\tthis._config.x.endRange = imageSize.width * this._parallaxSpeed;\r\n\t\t//Work out the end range of movement for +0.5 range \r\n\t\tthis._config.y.endRange =  this._config.y.value - ( (imageArea.height / 2) + ((imageSize.height / 2) * this._config.y.end) );\r\n\r\n\t\tthis._config.x.startRange = imageSize.width * this._parallaxSpeed;\r\n\t\tthis._config.y.startRange = ( (imageArea.height / 2) + ((imageSize.height / 2) * this._config.y.start) ) - this._config.y.value;\r\n\r\n\t}\r\n\r\n}\r\n","import {Debugbase} from 'debugbase/Debugbase';\r\n//import {TimelineMax, TweenMax, Power0, Power1, Power3, Back, Tween } from 'gsap';\r\n//import  {PixiPlugin} from  'gsap/PixiPlugin';\r\n//import * as PIXI from 'pixi.js';\r\nimport {HitArea} from 'app/module/global/HitArea';\r\n\r\nimport {PixiController} from 'app/controller/PixiController';\r\nimport {WorkTileImagePixi, WorkTileImageConfig} from './WorkTileImagePixi';\r\nimport {WorkTileParticlePixi, WorkTileParticleConfig} from './WorkTileParticlePixi';\r\nimport {DepartmentType} from 'app/data/Enums';\r\n\r\nimport {ProjectJSONModel} from 'app/model/ProjectJSONModel';\r\nimport {ProjectParticleJSONModel} from 'app/model/ProjectParticleJSONModel';\r\n\r\nexport interface Size {\r\n\twidth: number;\r\n\theight: number;\r\n}\r\n\r\n//Config when the project is focused and zoomed in: \r\nexport interface ZoomConfig {\r\n\ttileX: number;\r\n\ttileY: number; \r\n\timageX: number; \r\n\timageY: number; \r\n\timageScale: number; \r\n\tmaskScaleX: number; \r\n\tmaskScaleY: number; \r\n}\r\n\r\ninterface WorkSpritesheets {\r\n\tparticles: PIXI.Spritesheet;\r\n\tbackgrounds: PIXI.Spritesheet;\r\n}\r\n\r\nexport class WorkTilePixi {\r\n\r\n\tpublic onExploreProject: Function;\r\n\r\n\t//PIXI JS elements \r\n\tprivate _$pixi: PIXI.Application;\r\n\tprivate _$container: PIXI.Container;\r\n\tprivate _$bgGraphicGuide: PIXI.Graphics;\r\n\tprivate _spritesheets: WorkSpritesheets;\r\n\tprivate _maskedimage: WorkTileImagePixi;\r\n\tprivate _particles: Array <WorkTileParticlePixi> = [];\r\n\r\n\tprivate _$copy: HTMLElement;\r\n\tprivate _copyX: number; \r\n\tprivate _copyY: string;\r\n\tprivate _copyVisible: boolean = false; \r\n\tprivate _hitCopyInt: number;\r\n\r\n\tprivate _$hitarea: HitArea;\r\n\tprivate _$exploreProgress: HTMLElement;\r\n\tprivate _hitX: number;\r\n\tprivate _hitY: string;\r\n\tprivate _hitScale: number = 1;\r\n\tprivate _exploreProgressRatio: number  = 0;\r\n\r\n\tprivate _width: number = 1000;\r\n\tprivate _height: number = 600;\r\n\tprivate\t_innerWidth: number;\r\n\tprivate\t_innerHeight: number;\r\n\tprivate _maskArea: Size;\r\n\t\r\n\tprivate WIDTH_RATIO: number =  0.68;\r\n\tprivate HEIGHT_RATIO: number =  0.68;\r\n\tprivate MAX_WIDTH: number =  1200;\r\n\tprivate MAX_HEIGHT: number =  900;\r\n\tprivate MOBILE_BREAKPOINT: number =  800; \r\n\r\n\tprivate _progress: number = 0.0; \r\n\tprivate _disortProgress: number = 0.0;\r\n\tprivate _maxProgress: number = 2.0;\r\n\tprivate _progressFlip: number = 1.2;\r\n\tprivate _minProgress: number = -1.0;\r\n\tprivate _minProgressFlip: number = -0.2;\r\n\r\n\tprivate _velocityRotation: number = 0.0;\r\n\r\n\tprivate _projectActive: boolean;\r\n\tprivate _hiddenForProject: boolean = false;\r\n\tprivate _isBlankSpacer: boolean = false;\r\n\r\n\tprivate _zoomTween: gsap.Tween; \r\n\r\n\tprivate _timeouts: any = {};\r\n\tprivate _tweens: any = {};\r\n\tprivate _intervals: any = {};\r\n\r\n\tprivate _indentationSizes = {\r\n\t\tratio: 0.3, \t\t\t//Ratio of masked shape width\r\n\t\tmax: 200,\t\t\t\t//max in pixels\r\n\t\tvalue: 0,\t\t\t\t//calulated value\r\n\t};\r\n\r\n\t//DEBUG \r\n\t//-------------\r\n\tprivate _displayBackgroundGuide: boolean = false;\r\n\t\r\n\tconstructor (private _pixi: PixiController, private _index: number, private _data: ProjectJSONModel, private _$workContainer: PIXI.Container, parentContainer: HTMLElement) {\r\n\t\t\r\n\t\t//If Pixi is not set this is a 'blank' spacer \t\t\r\n\t\tif (!_pixi) {\r\n\t\t\tthis._isBlankSpacer = true;\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tthis._innerWidth = window.innerWidth;\r\n\t\tthis._innerHeight = window.innerHeight;\r\n\r\n\t\tthis._$pixi = _pixi.getPixi();\r\n\t\tthis._$copy = parentContainer.querySelector(`.worktitle__copy.-index${_index}`);\r\n\t\tthis._$exploreProgress = this._$copy.querySelector(`.ui__explore__progress`);\r\n\t\t\r\n\t\t//if ( !this._testCopyIsValidElement() ) {\r\n\t\t//\tthis._isBlankSpacer = true;\r\n\t\t//}\r\n\r\n\t}\r\n\r\n\t//Set the spritesheet refs to load backgrounds and images from \r\n\tpublic setSpriteSheets(particles: PIXI.Spritesheet, backgrounds: PIXI.Spritesheet): void {\r\n\t\tthis._spritesheets = {\r\n\t\t\tparticles: particles,\r\n\t\t\tbackgrounds: backgrounds\r\n\t\t};\r\n\t} \r\n\r\n\t/** Set the hit area for the space over the tile */\r\n\tpublic setHitarea(area: HitArea): void {\r\n\t\t\r\n\t\tthis._$hitarea = area;\r\n\r\n\t\tif (this._$hitarea) {\r\n\t\t\tthis._$hitarea.config.onUpdate = (updateOb: any) => {\r\n\t\t\t\tthis._maskedimage.setMouseDownScale(updateOb.ratio);\r\n\t\t\t\tthis._exploreProgressRatio = updateOb.ratio;\r\n\t\t\t\tthis._$exploreProgress.style.transform = `scaleX(${this._exploreProgressRatio})`;\r\n\t\t\t};\r\n\t\t\tthis._$hitarea.config.onComplete = (data) => {\r\n\t\t\t\tthis.onExploreProject(data);\r\n\t\t\t};\r\n\t\t}\r\n\r\n\t}\r\n\r\n\tpublic get isVisible(): boolean {\r\n\t\treturn (this._$container && this._$container.visible);\r\n\t}\r\n\r\n\tpublic get hitAreaMouseDown(): boolean {\r\n\t\treturn (this._$hitarea && this._$hitarea.mouseIsDown);\r\n\t}\r\n\r\n\t//Create the tile \r\n\tpublic create(): void {\r\n\r\n\t\tthis._createContainer();\r\n\r\n\t\t//Add partciles below, then image, then top partciles: \r\n\t\tthis._createParticles(-1); \r\n\t\tthis._createMaskedImage();\r\n\t\tthis._createParticles(1); \r\n\r\n\t\t//Trigger resize to make sure everything is in place: \r\n\t\tthis.resize(); \r\n\t}\r\n\r\n\t///Set the \r\n\tpublic setTimelineProgress(ratio: number, skipchecks: boolean = false): void {\r\n\t\t\r\n\t\tif (this._isBlankSpacer) {\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\t//Exit if ratio has not changed: \r\n\t\tif (!skipchecks) {\r\n\t\t\tif (ratio === this._progress || this._projectActive) {\r\n\t\t\t\treturn; \r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tif (this._exploreProgressRatio > 0 && !this.hitAreaMouseDown) {\r\n\t\t\tthis._exploreProgressRatio = Math.max(0, this._exploreProgressRatio - 0.05);\r\n\t\t\tthis._$exploreProgress.style.transform = `scaleX(${this._exploreProgressRatio})`;\r\n\t\t}\r\n\r\n\t\tthis._progress = ratio;\r\n\t\t\r\n\t\t//Update animation progress and set container visible: \r\n\t\tthis._animate(this._progress);\r\n\t\tthis._setContainerVisible(this._progress);\r\n\t\tthis._setCopyVisible(this._progress);\r\n\t\t\r\n\t}\r\n\r\n\tpublic resize(skipChanges: boolean = false): void {\r\n\r\n\t\tif (this._isBlankSpacer) {\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\t//Set the height and width refs: \r\n\t\tthis._innerWidth = window.innerWidth;\r\n\t\tthis._innerHeight = window.innerHeight;\r\n\r\n\t\t//Size the tile to fit layout and other dependant sizes: \r\n\t\tthis._resizeTile();\r\n\t\tthis._resizeMaskArea(skipChanges); \r\n\t\tthis._resizePartciles();\r\n\r\n\t\tthis._setContainerX(this._progress);\r\n\t\tthis._setContainerY();\r\n\t\tthis._setCopyX(); \r\n\t\tthis._setHitAreaPosition();\r\n\t\tthis._animate(this._progress);\r\n\r\n\t}\r\n\r\n\tpublic animateToProject(): void {\r\n\t\tthis._projectActive = true;\r\n\t\tthis._zoomToProject();\r\n\t\tDebugbase.DOM.removeClass(this._$copy, '-show');\r\n\t}\r\n\r\n\tpublic backFromProject(): void {\r\n\t\tthis._zoomFromProject();\r\n\t\tthis._timeouts.projectActive = setTimeout( () => this._projectActive = false, 1000);\r\n\t\tthis._timeouts.showDOM = setTimeout( () => Debugbase.DOM.addClass(this._$copy, '-show'), 500);\t\t\r\n\t}\r\n\r\n\t/** Flag mouse/touch down for hit area */\r\n\tpublic mouseDown(cords: any): void {\r\n\t\tif (this._$hitarea) {\r\n\t\t\tthis._$hitarea.startMouseDown(cords);\r\n\t\t}\r\n\r\n\t}\r\n\r\n\tpublic mouseUp(): void {\r\n\t\tif (this._$hitarea) {\r\n\t\t\tthis._$hitarea.mouseUp();\r\n\t\t}\r\n\t}\r\n\r\n\t/** Flag mouse move for hit area */\r\n\tpublic updateMouseCords(cords: any): void {\r\n\t\tif (this._$hitarea.mouseIsDown) {\r\n\t\t\tthis._$hitarea.updateMouseCords(cords);\r\n\t\t}\r\n\t}\r\n\r\n\t//Reset methods -------------------------------------------------------------\r\n\t\r\n\t/** All transitions in never show timeline item so just need one to reset to default state: */\r\n\tpublic reset(): void {\r\n\t\tDebugbase.DOM.removeClass(this._$copy, '-show');\r\n\t}\r\n\r\n\t//-----------------------------------------------------------------------------\r\n\r\n\tpublic hideForProject(): void {\r\n\t\tthis._hiddenForProject = true;\r\n\t\tgsap.TweenMax.to(this._$container, 0.2, {alpha: 0, onComplete: () => this._$container.visible = false, ease: gsap.Power0.easeNone });\r\n\t}\r\n\r\n\t/** Reset deep settings on the tile. Called after a user moves away from project using deeplink methods (NAV, logom, etc) */\r\n\tpublic resetForProject(): void {\r\n\t\t\r\n\t\tthis._hiddenForProject = false;\r\n\t\tthis._$container.visible  = true;\r\n\t\tgsap.TweenMax.set(this._$container, {alpha: 1});\r\n\r\n\t\t//HAck, animate the project to set the animation state...\r\n\t\tif (this._projectActive) {\r\n\t\t\tthis._zoomFromProject();\r\n\t\t}\r\n\t\tthis._projectActive = false;\r\n\r\n\t}\r\n\r\n\tpublic showFromProject(): void {\r\n\t\tthis._hiddenForProject = false;\r\n\t\tthis._$container.visible = true,\r\n\t\tgsap.TweenMax.to(this._$container, 0.4, {alpha: 1, delay: 0.4, ease: gsap.Power0.easeNone });\r\n\t}\r\n\r\n\tpublic setVelocityRotation(rotation: number): void {\r\n\r\n\t\tif (this._isBlankSpacer) {\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tthis._velocityRotation = rotation;\r\n\r\n\t}\r\n\r\n\t//private \r\n\t//-------------------------------------------------------------\r\n\t//-------------------------------------------------------------\r\n\t//-------------------------------------------------------------\r\n\t//-------------------------------------------------------------\r\n\r\n\t//The tile has a 'virtual' size. This can be seen by setting _displayBackgroundGuide to true\r\n\tprivate _resizeTile(): void {\r\n\r\n\t\t//Set width / height to limits \r\n\t\t//TODO - may need to be keept to fixed ratio \r\n\t\tthis._width = (this.WIDTH_RATIO * this._innerWidth < this.MAX_WIDTH) ? this.WIDTH_RATIO * this._innerWidth : this.MAX_WIDTH;\r\n\t\tthis._height = (this.HEIGHT_RATIO * this._innerHeight < this.MAX_HEIGHT) ? this.HEIGHT_RATIO * this._innerHeight : this.MAX_HEIGHT;\r\n\r\n\t\tif ( Debugbase.system.isSmallDevice ) {\r\n\t\t\tthis._width  = this._innerWidth * 1.5;\r\n\t\t}\r\n\r\n\t\tif (this._displayBackgroundGuide && this._$bgGraphicGuide) {\r\n\t\t\tthis._renderBackgroundGuide();\r\n\t\t}\r\n\r\n\t}\r\n\r\n\t//Set the availble mask area on the tile \r\n\t//Sizes differently at breakpoints to allow for mobile / desktop \r\n\tprivate _resizeMaskArea(skipChanges: boolean = false): void {\r\n\r\n\t\t//Assume desktop size, 60% width:\r\n\t\tlet wR = 0.6;\r\n\t\tlet hR = 1.0; \r\n\t\t\r\n\t\t//On mobile then switch to a portriat layout on \r\n\t\tif (Debugbase.system.isPortraitDevice) {\r\n\t\t\twR = 1.0;\r\n\t\t\thR = 0.6;\r\n\t\t}\r\n\r\n\t\tthis._maskArea = {\r\n\t\t\twidth: this._width * wR,\r\n\t\t\theight: this._height * hR\r\n\t\t};\r\n\r\n\t\tthis._maskedimage.resize(this._maskArea, skipChanges);\r\n\r\n\t}\r\n\r\n\t//Resize the partciles relative to the image: \r\n\tprivate _resizePartciles(): void {\r\n\r\n\t\tlet imageDisplayScale: number  = this._maskedimage.getDisplayScale();\r\n\t\tlet currentImageSize: Size = this._maskedimage.getMaskSizes();\r\n\r\n\t\t//Correct the image size to allow for scale: \r\n\t\tcurrentImageSize.width *= imageDisplayScale;\r\n\t\tcurrentImageSize.height *= imageDisplayScale;\r\n\r\n\t\tthis._particles.forEach( (particle) => {\r\n\t\t\tparticle.resize(imageDisplayScale, currentImageSize, this._maskArea);\r\n\t\t});\r\n\r\n\t}\r\n\r\n\t//Add the tile container to PIXI stage:\r\n\tprivate _createContainer(): void {\r\n\t\t\r\n\t\tthis._$container = new PIXI.Container();\r\n\t\t//this._$container.interactive = false;\r\n\t\t//this._$container.interactiveChildren = false;\r\n\t\tthis._$container.visible = false;\r\n\t\tthis._$workContainer.addChild( this._$container );\r\n\r\n\t\tif (this._displayBackgroundGuide) {\r\n\t\t\tthis._$bgGraphicGuide = new PIXI.Graphics();\r\n\t\t\tthis._$container.addChild(this._$bgGraphicGuide);\r\n\t\t\tthis._renderBackgroundGuide();\r\n\t\t}\r\n\r\n\t\tthis._$workContainer.visible = true;\r\n\r\n\t}\r\n\r\n\t//Render the background guide to size of tile: \r\n\tprivate _renderBackgroundGuide(): void {\r\n\t\t//let colours = [0x9b59b6, 0xf1c40f, 0xe74c3c, 0x9b59b6];\r\n\t\tlet colours = [0x333333,0x333333,0x333333,0x333333,0x333333,0x333333,0x333333,0x333333];\r\n\t\tthis._$bgGraphicGuide.clear();\r\n\t\tthis._$bgGraphicGuide.beginFill(colours[this._index]); // Purple\r\n\t\t// Draw a rectangle\r\n\t\tthis._$bgGraphicGuide.drawRect(60, 100, this._width, this._height - 220); // drawRect(x, y, width, height)\r\n\t\tthis._$bgGraphicGuide.endFill();\r\n\t\tthis._$bgGraphicGuide.alpha = 0.4;\r\n\t}\r\n\r\n\t//Add the masked image to stage. Handles it's own timeline and exit timeline\r\n\tprivate _createMaskedImage(): void {\r\n\r\n\t\tlet config: WorkTileImageConfig = {};\r\n\t\tthis._maskedimage = new WorkTileImagePixi(this._$pixi, this._$container, config);\r\n\t\tthis._maskedimage.setTint(this._data.tint);\r\n\t\tthis._maskedimage.setTextures({\r\n\t\t\t'image': this._spritesheets.backgrounds.textures[this._data.image],\r\n\t\t\t'mask': this._spritesheets.particles.textures['mask.png'],\r\n\t\t\t//'mask': this._spritesheets.particles.textures['mask-square.png'],\r\n\t\t\t'bevel': this._spritesheets.particles.textures['bevel.png'],\r\n\t\t\t'black': this._spritesheets.particles.textures['black.png'],\r\n\t\t\t'glow': this._spritesheets.particles.textures['glow.png'],\r\n\t\t});\r\n\t\tthis._maskedimage.create();\r\n\t\r\n\t}\r\n\r\n\t/** Add the masked image to stage. Handles it's own timeline and exit timeline. Pass depth to create layering */\r\n\tprivate _createParticles(depth: number = 1): void {\r\n\r\n\t\tthis._data.particles.forEach( (particle: ProjectParticleJSONModel) => {\r\n\r\n\t\t\tif ( depth === particle.depth) {\r\n\t\t\t\t\r\n\t\t\t\tlet config: WorkTileParticleConfig = {\r\n\t\t\t\t\ttexture:  this._spritesheets.particles.textures[particle.texture],\r\n\t\t\t\t\txOrg: particle.x,\r\n\t\t\t\t\tyOrg: particle.y,\r\n\t\t\t\t\tspeed:  particle.speed,\r\n\t\t\t\t\tautoScale: particle.autoScale,\r\n\t\t\t\t\tautoRotate: particle.autoRotate,\r\n\t\t\t\t\tautoAlpha: particle.autoAlpha,\r\n\t\t\t\t};\r\n\r\n\t\t\t\tif (particle.leftY) {\r\n\t\t\t\t\tconfig.leftY = particle.leftY;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif (particle.rightY) {\r\n\t\t\t\t\tconfig.rightY = particle.rightY;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tlet particlePixi = new WorkTileParticlePixi(this._$pixi, this._$container, config);\r\n\t\t\t\tthis._particles.push(particlePixi);\r\n\r\n\t\t\t}\r\n\t\t\r\n\t\t});\r\n\r\n\t}\r\n\r\n\tprivate _animate(progres: number): void {\r\n\t\t\r\n\t\tif (this._$container.visible) {\r\n\t\t\t\r\n\t\t\t//Move the cotainer left to right <--------->\r\n\t\t\tthis._setContainerX(progres);\r\n\t\t\tthis._setCopyX();\r\n\t\t\tthis._setHitAreaPosition();\r\n\r\n\t\t\t//Update the inner elements of the tile so they can handle their own motion/scale/alpha: \r\n\t\t\tlet progressContained: number  =  Debugbase.math.constrain(progres, 0, 1.0) ;\r\n\t\t\tthis._maskedimage.update(progressContained, this._velocityRotation);\r\n\t\t\tthis._particles.forEach( (particle) => {particle.update(progressContained); } );\r\n\r\n\t\t\tif(this._$bgGraphicGuide) {\r\n\t\t\t\tthis._$bgGraphicGuide.scale.y = 1 - (Math.abs(0.5 - progressContained) * 2);\r\n\t\t\t\tthis._$bgGraphicGuide.y = 300 * (1 - this._$bgGraphicGuide.scale.y);\r\n\t\t\t}\r\n\r\n\t\t\t//\t\tthis._$bgGraphicGuide\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\tprivate _setContainerVisible(progress: number): void {\r\n\r\n\t\tif (this._hiddenForProject) {\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tif (this._$container.visible && (progress < -0.2 || progress > 1.4 ) ) {\r\n\t\t\tthis._$container.visible = false;\r\n\t\t} else if (!this._$container.visible && (progress >= -0.2 && progress <= 1.4 ) ) {\r\n\t\t\tthis._$container.visible = true;\r\n\t\t}\r\n\r\n\t}\r\n\r\n\r\n\t//Create the main slide timeline\r\n\t//------------------------------------------------------------\r\n\r\n\t//Because of sizing / design issues position the main continer with pixel rather than percetages: \r\n\t//At 0.0 it will be off left but showing ident \r\n\t//At ~-0.1 it will hidden fully \r\n\t//At 0.5 there will be no transform applied and will be middle of screen\r\n\t//At 1 it will be off right but showing ident \r\n\t///At ~1.1 it will be off right hidden\r\n\tprivate _setContainerX(progress: number): void {\r\n\t\tthis._$container.x = Debugbase.math.getRangeRatio(progress, -1 * this._width, this._innerWidth);\r\n\t}\r\n\r\n\tprivate _setContainerY(): void {\r\n\t\tthis._$container.y = (Debugbase.system.isPortraitDevice) ? 270 : ((this._innerHeight - 60) - this._height) / 2;\r\n\t}\r\n\r\n\t//Set in the copy visible: \r\n\tprivate _setCopyVisible(processProgress: number): void {\r\n\t\tif (this._copyVisible && (processProgress < 0.25 || processProgress > 0.65 ) ) {\r\n\t\t\tthis._copyVisible = false; \r\n\t\t\tDebugbase.DOM.removeClass(this._$copy, '-show');\r\n\t\t\tthis._setCopyDisplay('none', 400);\r\n\t\t} else if (!this._copyVisible && (processProgress >= 0.25 && processProgress <= 0.65 ) ) {\r\n\t\t\tthis._copyVisible = true; \r\n\t\t\tDebugbase.DOM.addClass(this._$copy, '-show');\r\n\t\t\tthis._setCopyDisplay('block', 0);\r\n\t\t}\r\n\r\n\t}\r\n\r\n\t//Move the copy in sync with the container: \r\n\tprivate _setCopyX(): void {\r\n\t\tthis._copyX = (Debugbase.system.isPortraitDevice)  ?  40 :  this._$container.x + (this._width * 0.63) ;\r\n\t\tif (this._$container.visible && this._copyX < this._innerWidth + 100 && this._copyX > -400) {\r\n\t\t\tthis._copyY =  (Debugbase.system.isPortraitDevice) ?  '0%' : '-50%';\r\n\t\t\tthis._$copy.style.transform = `translateX(${this._copyX}px) translateY(${this._copyY})`;\r\n\t\t}\r\n\t}\r\n\r\n\t//Set the display state on a timer to allow transition (Having it on page creates redraws layers)\r\n\tprivate _setCopyDisplay(display: string, time: number): void {\r\n\t\t\r\n\t\tclearTimeout(this._hitCopyInt);\r\n\r\n\t\tif (time === 0) {\r\n\t\t\tthis._$copy.style.display = display;\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tthis._hitCopyInt = setTimeout(() => {\r\n\t\t\tthis._$copy.style.display = display;\r\n\t\t}, time);\r\n\t\t\r\n\t}\r\n\r\n\t/** Set hit area position */\r\n\tprivate _setHitAreaPosition(): void {\r\n\r\n\t\tif (!this._$hitarea) {\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tthis._hitX = (!Debugbase.system.isPortraitDevice)  ? this._$container.x + (this._width * 0.30) : this._$container.x + (this._width * 0.5);\r\n\t\tthis._hitY =  (!Debugbase.system.isPortraitDevice) ? '69%' : '59%';\r\n\t\tthis._$hitarea.setPosition(this._hitX, this._hitY, this._maskedimage.getActualScale());\r\n\r\n\t}\r\n\r\n\tprivate _zoomToProject(instant: boolean = false) {\r\n\r\n\t\tlet config: ZoomConfig = this._getZoomConfig();\r\n\t\tlet tileTime: number = (instant) ? 0.0 : 0.8;\r\n\r\n\t\tthis._zoomTween = gsap.TweenMax.to(this._$container, tileTime, \r\n\t\t\t{pixi: {x: config.tileX, y: config.tileY}, \r\n\t\t\tease: gsap.Power3.easeInOut,  \r\n\t\t\tdelay: 0\r\n\t\t} );\r\n\r\n\t\tthis._maskedimage.zoomToProject(instant, config);\r\n\r\n\t\tthis._particles.forEach( (particle) => {\r\n\t\t\tparticle.zoomToProject();\r\n\t\t} );\r\n\r\n\t\t//Save to the pixi controller the sizes of the image, they are needed to match the full screen video on the project\r\n\t\t//Debugbase.math.getBestFitScale(this._maskedimage.getImageSizes(),  {width: this._innerWidth, height: this._innerHeight}), \r\n\t\tlet imageSizes = this._maskedimage.getImageSizes();\r\n\t\t\r\n\t\tthis._pixi.setProjectHeaderSize({\r\n\t\t\twidth: config.imageScale * imageSizes.width,\r\n\t\t\theight: config.imageScale * imageSizes.height,\r\n\t\t});\r\n\r\n\t}\r\n\r\n\t//Zoom back from the project on exit press: \r\n\tprivate _zoomFromProject(): void {\r\n\t\t\r\n\t\tthis._zoomTween.reverse();\r\n\t\tthis._maskedimage.zoomFromProject();\r\n\r\n\t\tthis._particles.forEach( (particle) => {\r\n\t\t\tparticle.zoomFromProject();\r\n\t\t} );\r\n\r\n\t}\r\n\r\n\t//Get the config for a project zoom: \r\n\tprivate _getZoomConfig(): ZoomConfig {\r\n\r\n\t\tlet maskSizes: Size = this._maskedimage.getMaskSizes();\r\n\r\n\t\treturn {\r\n\t\t\ttileX: (this._innerWidth / 2) - (this._width / 2),\r\n\t\t\ttileY: (this._innerHeight / 2) - (this._height / 2),\r\n\t\t\timageX: (this._width / 2), \r\n\t\t\timageY: (this._height / 2), \r\n\t\t\t//Fit image to full scale and width: \r\n\t\t\timageScale: Debugbase.math.getBestFitScale(this._maskedimage.getImageSizes(),  {width: this._innerWidth, height: this._innerHeight}), \r\n\t\t\t//Mask width / height. Allow 5% extra for curve edge\r\n\t\t\tmaskScaleX: ( (this._innerWidth + (this._innerWidth * 0.05)) / maskSizes.width) , \r\n\t\t\tmaskScaleY: ( (this._innerHeight + (this._innerHeight * 0.05))  / maskSizes.height), \r\n\t\t};\r\n\r\n\t}\r\n\r\n\t/** Check copy is a valid element\r\n\t* @throws {Error} \r\n\t* @returns {boolean} \r\n\t*/\r\n\tprivate _testCopyIsValidElement(): boolean {\r\n\t\tif (!this._$copy) {\r\n\t\t\ttry {\r\n\t\t\t\tthrow new Error(`Work tile is not valid. Index = ${this._index}. Check HTML exsists in template` );\r\n\t\t\t} catch (e) {\r\n\t\t\t\tconsole.log(e);\r\n\t\t\t}\r\n\t\t\treturn false;\r\n\t\t}\r\n\r\n\t\treturn true;\r\n\t}\r\n\r\n}\r\n","import { injectable, inject} from 'inversify';\r\nimport { Logger, ComplexLogger } from 'app/contracts/Debug';\r\nimport { TYPES } from 'types';\r\n\r\n@injectable()\r\nexport class ComplexLoggerService implements Logger, ComplexLogger {\r\n\r\n\tpublic log(mgs: string) {\r\n\t\tconsole.log(mgs);\r\n\t}\r\n\r\n\tpublic logToString(mgs: any) {\r\n\t\tconsole.log('logToString ', mgs);\r\n\t}\r\n\r\n}\r\n","import { injectable, inject} from 'inversify';\r\nimport { Logger, ComplexLogger } from 'app/contracts/Debug';\r\nimport { TYPES } from 'types';\r\n\r\n@injectable()\r\nexport class LoggerService implements Logger {\r\n\r\n\t@inject(TYPES.ComplexLogger) private _complexLogger: ComplexLogger;\r\n\r\n\tpublic log(mgs: string) {\r\n\t\tthis._complexLogger.logToString(mgs);\r\n\t}\r\n\r\n}\r\n","//V1.0.0\r\n//Static singleton style \r\n//Creates and instance of the app and allows access to \r\n//Debugbase.state.set('project.title', 'Market Masters');\r\nimport {DebugbaseApp} from './DebugbaseApp';\r\nimport {RouteManager} from  'debugbase/managers/RouteManager';\r\nimport {StateManager} from  'debugbase/managers/StateManager';\r\nimport {ModuleManager} from  'debugbase/managers/ModuleManager';\r\nimport {BehaviourManager} from  'debugbase/managers/BehaviourManager';\r\nimport {ControllerManager} from 'debugbase/managers/ControllerManager';\r\n\r\nimport {SystemHelper} from  'debugbase/helper/SystemHelper';\r\nimport {DOMHelper} from  'debugbase/helper/DOMHelper';\r\nimport {StringHelper} from  'debugbase/helper/StringHelper';\r\nimport {MathHelper} from  'debugbase/helper/MathHelper';\r\nimport {FrameworkHelper} from  'debugbase/helper/FrameworkHelper';\r\n\r\nexport class Debugbase {\r\n\r\n\tpublic static app: DebugbaseApp; \r\n\r\n\tpublic static get controller( ): ControllerManager {\r\n\t\treturn Debugbase.app.controller; \r\n\t}\r\n\r\n\tpublic static get route(): RouteManager {\r\n\t\treturn Debugbase.app.route; \r\n\t}\r\n\r\n\tpublic static get state(): StateManager {\r\n\t\treturn Debugbase.app.state;\r\n\t}\r\n\r\n\tpublic static get module(): ModuleManager {\r\n\t\treturn Debugbase.app.module; \r\n\t}\r\n\r\n\tpublic static get behaviour( ): BehaviourManager {\r\n\t\treturn Debugbase.app.behaviour; \r\n\t}\r\n\r\n\tpublic static get DOM( ): DOMHelper {\r\n\t\treturn Debugbase.app.DOM; \r\n\t}\r\n\r\n\tpublic static get string( ): StringHelper {\r\n\t\treturn Debugbase.app.string; \r\n\t}\r\n\r\n\tpublic static get math( ): MathHelper {\r\n\t\treturn Debugbase.app.math; \r\n\t}\r\n\r\n\tpublic static get framework( ): FrameworkHelper {\r\n\t\treturn Debugbase.app.framework; \r\n\t}\r\n\r\n\tpublic static get system( ): SystemHelper {\r\n\t\treturn Debugbase.app.system; \r\n\t}\r\n\r\n\tpublic static init(): void {\r\n\t\tDebugbase.app.init();\r\n\t}\r\n\r\n}\r\n\r\nif (!Debugbase.app ) {\r\n\tDebugbase.app = new DebugbaseApp();\r\n}\r\n","//V1.0.0\r\n//Instance of a debugbase app \r\n//Creates instances of the main helpers and \r\nimport 'reflect-metadata';\r\nimport {ControllerManager} from 'debugbase/managers/ControllerManager';\r\nimport {RouteManager} from  'debugbase/managers/RouteManager';\r\nimport {StateManager} from  'debugbase/managers/StateManager';\r\nimport {ModuleManager} from  'debugbase/managers/ModuleManager';\r\nimport {BehaviourManager} from  'debugbase/managers/BehaviourManager';\r\n//import {EventsManager} from  'debugbase/managers/EventsManager';\r\n\r\nimport {SystemHelper} from  'debugbase/helper/SystemHelper';\r\nimport {DOMHelper} from  'debugbase/helper/DOMHelper';\r\nimport {StringHelper} from  'debugbase/helper/StringHelper';\r\nimport {MathHelper} from  'debugbase/helper/MathHelper';\r\nimport {FrameworkHelper} from  'debugbase/helper/FrameworkHelper';\r\n\r\nimport {Events} from 'debugbase/events/Events';\r\n\r\nimport { iocContainer } from 'inversify.config';\r\nimport { Logger } from 'app/contracts/debug/Logger';\r\nimport { TYPES } from 'types';\r\n\r\nexport class DebugbaseApp {\r\n\r\n\tprivate _controllerManager: ControllerManager;\r\n\tprivate _routeManager: RouteManager;\r\n\tprivate _moduleManager: ModuleManager;\r\n\tprivate _stateManager: StateManager;\r\n\tprivate _behaviourManager: BehaviourManager;\r\n\r\n\tprivate _systemHelper: SystemHelper;\r\n\tprivate _domHelper: DOMHelper;\r\n\tprivate _stringHelper: StringHelper;\r\n\tprivate _mathHelper: MathHelper;\r\n\tprivate _frameworkHelper: FrameworkHelper;\r\n\t//private _eventsManager: EventsManager;\r\n\r\n\tprivate _LoggerService: Logger;\r\n\r\n\tcount: number = 0;\r\n\r\n\tconstructor() {\r\n\t\tEvents.init();\r\n\t\tthis._createContainer();\r\n\t\tthis._createManagers();\r\n\t\tthis._addListeners();\r\n\t}\r\n\r\n\tpublic init(): void {\r\n\t\tthis._controllerManager.init();\r\n\t\tthis._routeManager.init();\r\n\t}\r\n\r\n\tpublic get controller( ): ControllerManager {\r\n\t\treturn this._controllerManager; \r\n\t}\r\n\r\n\tpublic get route( ): RouteManager {\r\n\t\treturn this._routeManager; \r\n\t}\r\n\r\n\tpublic get state( ): StateManager {\r\n\t\treturn this._stateManager; \r\n\t}\r\n\r\n\tpublic get behaviour( ): BehaviourManager {\r\n\t\treturn this._behaviourManager; \r\n\t}\r\n\r\n\tpublic get module( ): ModuleManager {\r\n\t\treturn this._moduleManager; \r\n\t}\r\n\r\n\tpublic get DOM(): DOMHelper {\r\n\t\treturn this._domHelper;\r\n\t}\r\n\r\n\tpublic get string(): StringHelper {\r\n\t\treturn this._stringHelper;\r\n\t}\r\n\r\n\tpublic get math(): MathHelper {\r\n\t\treturn this._mathHelper;\r\n\t}\r\n\r\n\tpublic get framework(): FrameworkHelper {\r\n\t\treturn this._frameworkHelper;\r\n\t}\r\n\r\n\tpublic get system(): SystemHelper {\r\n\t\treturn this._systemHelper;\r\n\t}\r\n\r\n\tprivate _createManagers(): void {\r\n\r\n\t\tthis._controllerManager = new ControllerManager();\r\n\t\tthis._routeManager = new RouteManager();\r\n\t\tthis._routeManager.controllerManager = this._controllerManager;\r\n\t\tthis._stateManager = new StateManager();\r\n\t\tthis._moduleManager = new ModuleManager();\r\n\t\tthis._behaviourManager = new BehaviourManager();\r\n\r\n\t\tthis._systemHelper = new SystemHelper();\r\n\t\tthis._stringHelper = new StringHelper();\r\n\t\tthis._mathHelper = new MathHelper();\r\n\t\t//this._eventsManager = new EventsManager();\r\n\t\tthis._domHelper = new DOMHelper();\r\n\t\tthis._frameworkHelper = new FrameworkHelper();\r\n\t}\r\n\r\n\t//Add high level listeners: \r\n\tprivate _addListeners(): void {\r\n\t\tEvents.ready(this._onDOMReady.bind(this));\r\n\t\tEvents.tick(this._onTick.bind(this));\r\n\t\tEvents.DOMUpdate(this._onDOMUpdate.bind(this));\r\n\t\tEvents.scroll(this._onScroll.bind(this));\r\n\t\tEvents.resize(this._onResize.bind(this));\r\n\t}\r\n\r\n\t//Heartbeat ticker: \r\n\tprivate _onTick(): void {\r\n\t\tthis._moduleManager.tick();\r\n\t\tthis._controllerManager.tick();\r\n\t}\r\n\r\n\tprivate _onDOMReady(): void {\r\n\t\tthis._controllerManager.DOMReady();\r\n\t\tthis._moduleManager.DOMReady();\r\n\t\t//this._behaviourManager.DOMReady();\r\n\t}\r\n\r\n\tprivate _onDOMUpdate(): void {\r\n\t\tthis._controllerManager.DOMUpdated();\r\n\t\tthis._moduleManager.DOMUpdated();\r\n\t\t//this._behaviourManager.DOMUpdated();\r\n\t}\r\n\r\n\tprivate _onScroll(y: number): void {\r\n\t\tthis._domHelper.scroll(y);\r\n\t\tthis._controllerManager.scroll(y);\r\n\t\tthis._moduleManager.scroll(y);\r\n\t\t//this._behaviourManager.scroll(y);\r\n\t}\r\n\r\n\tprivate _onResize(sizes): void {\r\n\t\tthis._systemHelper.resize();\r\n\t\tthis._domHelper.resize(sizes);\r\n\t\tthis._controllerManager.resize(sizes);\r\n\t\tthis._moduleManager.resize(sizes);\r\n\t\t//this._behaviourManager.resize(sizes);\r\n\t}\r\n\r\n\tprivate _createContainer(): void {\r\n\t\tthis._LoggerService = iocContainer.get<Logger>(TYPES.Logger);\r\n\t\tthis._LoggerService.log('Hello');\r\n\t}\r\n\r\n}\r\n","//v1.0 \r\n//AbstractController that controllers can extend to get key functionality \r\nimport {Debugbase} from '../Debugbase';\r\nimport {StateManager} from  'debugbase/managers/StateManager';\r\nimport {ModuleManager} from  'debugbase/managers/ModuleManager';\r\n\r\nimport {SystemHelper} from  'debugbase/helper/SystemHelper';\r\nimport {DOMHelper} from  'debugbase/helper/DOMHelper';\r\nimport {MathHelper} from  'debugbase/helper/MathHelper';\r\nimport {Events} from 'debugbase/events/Events';\r\n\r\nexport abstract class Controller {\r\n\r\n\tpublic id: string; \r\n\tpublic global: boolean = false;\r\n\tpublic containerSelector;\r\n\tpublic DOMIsReady: boolean = false;\r\n\r\n\tprotected container: Element;\r\n\tprotected app: Debugbase;\r\n\tprotected state: StateManager;\r\n\tprotected module: ModuleManager;\r\n\tprotected DOM: DOMHelper;\r\n\tprotected math: MathHelper;\r\n\tprotected events: Events;\r\n\tprotected system: SystemHelper;\r\n\r\n\t//public tags: Array<string>; \r\n\tconstructor(id: string) {\r\n\t\tthis.app = Debugbase;\r\n\t\tthis.id = id;\r\n\t\tthis.state = Debugbase.state;\r\n\t\tthis.DOM = Debugbase.DOM;\r\n\t\tthis.math = Debugbase.math;\r\n\t\tthis.module = Debugbase.module;\r\n\t\tthis.system = Debugbase.system;\r\n\t}\r\n\r\n\t//Public \r\n\t//--------------------------------------------------------------\r\n\t//--------------------------------------------------------------\r\n\t\r\n\t//Triggered when the DOM is ready:\r\n\tpublic init(params?: any): void {};\r\n\tpublic DOMReady(): void {};\r\n\tpublic DOMUpdated(): void {};\r\n\tpublic modulesMounted(): void {}; \r\n\tpublic resize(): void {}; \r\n\tpublic scroll(windowY: number): void {};\r\n\t\r\n\tpublic reset(previouState?, isDeeplink: boolean = false): void {};\t\t\r\n\tpublic show(previouState?, isDeeplink: boolean = false): void {};\t\t\r\n\tpublic hide(nextState?): void {};\t\r\n\r\n\tpublic tick(): void {};\r\n\tpublic pause(): void {};\r\n\tpublic unpause(): void {};\r\n\r\n\tpublic DOMReadyCore(): void {\r\n\t\tif (this.containerSelector) {\r\n\t\t\tthis.container =  document.querySelector(this.containerSelector);\r\n\t\t}\r\n\t\tthis.DOMIsReady = true;\r\n\t\tthis.DOMReady();\r\n\t}\r\n\r\n\tpublic destory(): void {\r\n\t\tthis.id = null;\r\n\t\tthis.app = null;\r\n\t\tthis.state = null;\r\n\t\tthis.module = null;\r\n\t}\r\n\r\n\t//Protected \r\n\t//--------------------------------------------------------------\r\n\t//--------------------------------------------------------------\r\n\r\n\t//Allows other controllers to get refernces to other controllers\r\n\t//Allow any so controllers can just be instance of anything: \r\n\tprotected get(controllerId: string): Controller | any {\t\t\r\n\t\treturn Debugbase.controller.get(controllerId);\r\n\t}\r\n\r\n\tprotected all(): Array<Controller> | Array<any> {\r\n\t\t//return Debugbase.controller.all();\r\n\t\treturn null;\r\n\t}\r\n\r\n}\r\n","export abstract class DebugEvent {\r\n\r\n\tprotected static eventName: string;\r\n\r\n\tconstructor (parameters: any = null) {\r\n\t\tfor (let i in parameters) {\r\n\t\t\tthis[i] = parameters[i];\r\n\t\t}\r\n\t}\r\n\r\n\t/** \r\n\t* Get event name from the child item ('this' can used get static values in Typescript)\r\n\t* @return {string} eventName\r\n\t*/\r\n\tget eventNameFromStatic(): string {\r\n\t\treturn this.constructor['eventName'];\r\n\t}\r\n\r\n}\r\n","import {Debugbase} from '../Debugbase';\r\nimport {Events} from  'debugbase/events/Events';\r\nimport {CoreEvents} from  'debugbase/events/CoreEvents';\r\n\r\nimport {SystemHelper} from  'debugbase/helper/SystemHelper';\r\nimport {StateManager} from  'debugbase/managers/StateManager';\r\nimport {MathHelper} from  'debugbase/helper/MathHelper';\r\nimport {DOMHelper} from  'debugbase/helper/DOMHelper';\r\n\r\nexport abstract class Module {\r\n\r\n\tpublic id: string;\r\n\tpublic tag: string;\r\n\tpublic $container: Element; \r\n\tpublic moduleName: string;\r\n\tpublic mounted: boolean = false;\r\n\tpublic destroyed:  boolean\t= false;\r\n\tpublic removed: boolean = false;\r\n\tpublic active: boolean = true; \r\n\tpublic config: any = {};\r\n\r\n\tprotected state: StateManager;\r\n\tprotected math: MathHelper;\r\n\tprotected DOM: DOMHelper;\r\n\tprotected system: SystemHelper;\r\n\t\r\n\tconstructor() {\r\n\t\tthis.state = Debugbase.state;\r\n\t\tthis.math = Debugbase.math;\r\n\t\tthis.DOM = Debugbase.DOM;\r\n\t\tthis.system = Debugbase.system;\r\n\t} \r\n\r\n\tpublic create(): void { }\r\n\tpublic tick (): void {}\r\n\tpublic DOMReady(): void{}\r\n\r\n\r\n\tpublic destroy(): void {\t\t\r\n\t\tthis.state = null;\r\n\t\tthis.DOM = null;\r\n\t\tthis.system = null;\r\n\t\tthis.math = null;\r\n\t}\r\n\r\n\tpublic scroll(windowY: number) {\r\n\r\n\t}\r\n\r\n\tpublic resize(sizes: any) {\r\n\t\t\r\n\t}\r\n\r\n\t//Convert an elements attributes to \r\n\tprotected attributesToConfig(prefix: string, item: any = null, element: Element = null): void {\r\n\r\n\t\tif (!element && this.$container) {\r\n\t\t\telement = this.$container;\r\n\t\t}\r\n\r\n\t\tif (!item) {\r\n\t\t\titem = this;\r\n\t\t}\r\n\r\n\t\tif (!element) {\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t}\r\n\r\n\tprivate _onDOMReady(): void {\r\n\t\tthis.attributesToConfig(this.moduleName);\r\n\t\tthis.DOMReady();\r\n\t\tthis._onMounted();\r\n\t}\r\n\r\n\tprivate _onMounted(): void{}\r\n\r\n}\r\n","export class CoreEvents {\r\n\t\r\n\tpublic static readonly READY = 'READY';\r\n\tpublic static readonly SCROLL = 'SCROLL';\r\n\tpublic static readonly RESIZE = 'RESIZE';\r\n\tpublic static readonly TICK = 'TICK';\r\n\tpublic static readonly DOM_READY = 'DOM_READY';\r\n\tpublic static readonly DOM_UPDATED = 'DOM_UPDATED';\r\n\tpublic static readonly MODULE_MOUNTED = 'MODULE_MOUNTED';\r\n\tpublic static readonly MODULES_MOUNTED = 'MODULES_MOUNTED';\r\n\tpublic static readonly MODULE_DESTOYED = 'MODULE_DESTOYED';\r\n\tpublic static readonly BEHAVIOUR_MOUNTED = 'BEHAVIOUR_MOUNTED';\r\n\r\n}\r\n","import {on, off} from 'delegated-events';\r\n\r\nenum  SelectorTypes { STRING, ELEMENT, NODE_LIST}\r\nexport type SelectorElement = string | Element  | Document | Window | NodeListOf<Element>;\r\n\r\nexport class EventListener {\r\n\t\r\n\tpublic selectorType: SelectorTypes = null;\r\n\t//public guid: string;\r\n\t//public priorty: number; \r\n\t//public preventDefault: boolean = false;\r\n\tprivate _actionAsString: string;\r\n\tpublic id: number;\r\n\r\n\tconstructor (public type: string, public action: EventListenerOrEventListenerObject | Function, public selector: SelectorElement = null, settings: any = null) {\r\n\t\t\r\n\t\t//If an Event on an actual element like a click then \r\n\t\tif (this.selector !== null) {\r\n\t\t\tthis.selectorType  = this._getSelectorType(this.selector);\r\n\t\t\tthis._on();\r\n\t\t} \r\n\r\n\t\tif (this.action) {\r\n\t\t\tthis._actionAsString = this.action.toString();\r\n\t\t}\r\n\r\n\t}\r\n\r\n\tpublic destroy(): void {\r\n\t\t\r\n\t\tif (this.selectorType !== null) {\r\n\t\t\tthis._off();\r\n\t\t} \r\n\r\n\t\tthis.type = null;\r\n\t\tthis.selector = null;\r\n\t\tthis.action = null;\r\n\t\tthis._actionAsString = null;\r\n\t}\r\n\r\n\tpublic dispatch(data: any = null, settings: any = null): void {\r\n\t\t\t\t\r\n\t\tif (settings && settings.delay) {\r\n\t\t\tsetTimeout( () => (this.action as Function)(data),  settings.delay * 1000);\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\t//Hit the callback straight away: \r\n\t\t(this.action as Function)(data);\r\n\r\n\t}\r\n\r\n\tpublic match(type: string, selector: SelectorElement = null, action: EventListenerOrEventListenerObject | Function = null): boolean {\r\n\r\n\t\tlet listenerMatch: boolean = true; \r\n\t\t//let stamp: string = `${type}${selector.toString()}${action.toString()}`;\r\n\t\t//if (action && action.toString() !== this._actionAsString) {\r\n\t\tif (action && action !== this.action) {\t\r\n\t\t\tlistenerMatch = false;\r\n\t\t} \r\n\t\t\r\n\t\tif ( this.type === type && selector === this.selector && listenerMatch) {\r\n\t\t\treturn true;\r\n\t\t}\r\n\r\n\t\treturn false;\r\n\r\n\t}\r\n\r\n\t//Private methods \r\n\t//-------------------------------------------------------------------------------------------\r\n\t//-------------------------------------------------------------------------------------------\r\n\t//-------------------------------------------------------------------------------------------\r\n\t//-------------------------------------------------------------------------------------------\r\n\r\n\tprivate _on(): void {\r\n\r\n\t\tif (this.selectorType === SelectorTypes.STRING) {\r\n\t\t\ton(this.type, this.selector, this.action);\r\n\t\t} else if (this.selectorType === SelectorTypes.ELEMENT) {\r\n\t\t\t(this.selector as Element).addEventListener(this.type, (this.action as EventListenerOrEventListenerObject));  \r\n\t\t} else if (this.selectorType === SelectorTypes.NODE_LIST) { \r\n\t\t\t(this.selector as NodeListOf<Element>).forEach((item: Element) => {\r\n\t\t\t\titem.addEventListener(this.type, (this.action as EventListenerOrEventListenerObject) );\r\n\t\t\t});\r\n\t\t}\r\n\r\n\t}\r\n\r\n\tprivate _off(): void {\r\n\r\n\t\tif (this.selectorType === SelectorTypes.STRING) {\r\n\t\t\toff(this.type, this.selector, this.action);\r\n\t\t} else if (this.selectorType === SelectorTypes.ELEMENT) {\r\n\t\t\t(this.selector as Element).removeEventListener(this.type, (this.action as EventListenerOrEventListenerObject) );  \r\n\t\t} else if (this.selectorType === SelectorTypes.NODE_LIST) { \r\n\t\t\t(this.selector as NodeListOf<Element>).forEach((item: Element) => {\r\n\t\t\t\titem.removeEventListener(this.type, (this.action as EventListenerOrEventListenerObject) );\r\n\t\t\t});\r\n\t\t}\r\n\r\n\t}\r\n\r\n\tprivate _getSelectorType(selector: SelectorElement): SelectorTypes {\r\n\t\r\n\t\tif (typeof selector === 'string' || selector instanceof String) {\r\n\t\t\treturn SelectorTypes.STRING;\r\n\t\t} else if (selector instanceof Element || selector instanceof Document || selector instanceof Window) {\r\n\t\t\treturn SelectorTypes.ELEMENT;\r\n\t\t}\r\n\r\n\t\treturn SelectorTypes.NODE_LIST;\r\n\r\n\t}\r\n\r\n}\r\n","//v1.0 \r\nimport {EventListener, SelectorElement} from './EventListener';\r\nimport {CoreEvents} from './CoreEvents';\r\nimport * as fastdom from 'fastdom';\r\nimport {DebugEvent} from 'debugbase/abstract/DebugEvent';\r\n\r\nexport class Events {\r\n\r\n\tprivate static _listeners: Array <EventListener> = [];\r\n\tprivate static _idCount: number = 1;\r\n\r\n\tpublic static init(): void {\r\n\t\tEvents._addCoreListeners();\r\n\t}\r\n\r\n\t//set and event listener \r\n\t//Can be created in 2 forms\r\n\t//1 = on(\"click\", \".ui-button\", (e: MouseEvent) => {...})\r\n\t//2 = on(\"PAGE_LOAD\", (data: any) => {...} )\r\n\r\n\tpublic static on(type: string, selector: SelectorElement, action: EventListenerOrEventListenerObject): number;\r\n\tpublic static on(type: string, action: Function): number; \r\n\tpublic static on(type: any, action: Function): number; \r\n\tpublic static on(\r\n\t\ttype: string | any, \r\n\t\tselectorOrAction: SelectorElement | Function, \r\n\t\taction: EventListenerOrEventListenerObject | Function = null): number {\r\n\r\n\t\tlet typeAsString: string;\r\n \r\n\t\t//If an event then pull the eventname value from the class / instace:\r\n\t\tif ( !(typeof type === 'string') ) {\r\n\t\t\tlet typeAsEvent: any = (type as any);\r\n\t\t\ttypeAsString = typeAsEvent.eventName || typeAsEvent.eventNameFromStatic; \r\n\t\t\tEvents._checkValidEvent(typeAsEvent);\r\n\t\t} else {\r\n\t\t\ttypeAsString = type;\r\n\t\t}\r\n\r\n\t\tlet selectorElement = null;\r\n\r\n\t\tif (action === null) {\r\n\t\t\taction = (selectorOrAction as Function);\r\n\t\t} else {\r\n\t\t\tselectorElement = (selectorOrAction as SelectorElement);\r\n\t\t}\r\n\r\n\t\tif (action !== undefined && Events.match(typeAsString, selectorElement, action).length === 0) {\r\n\t\t\tlet listener = new EventListener(typeAsString, action, selectorElement);\r\n\t\t\tlistener.id = this._idCount;\r\n\t\t\tEvents._listeners.push(listener);\r\n\t\t\tthis._idCount++;\r\n\t\t\treturn listener.id;\r\n\t\t} \r\n\r\n\t\treturn null;\r\n\r\n\t}\r\n\r\n\tpublic static off(type: string, selector: SelectorElement, action: EventListenerOrEventListenerObject): void;\r\n\tpublic static off(type: string, action: Function): void; \r\n\tpublic static off(type: any, action: Function): void; \r\n\r\n\tpublic static off(\r\n\t\ttype: string | any, \r\n\t\tselectorOrAction: SelectorElement | Function, \r\n\t\taction: EventListenerOrEventListenerObject | Function = null): void {\r\n\r\n\t\tlet typeAsString: string;\r\n\r\n\t\t//If an event then pull the eventname value from the class / instace:\r\n\t\tif ( !(typeof type === 'string') ) {\r\n\t\t\tlet typeAsEvent: any = (type as any);\r\n\t\t\ttypeAsString = typeAsEvent.eventName || typeAsEvent.eventNameFromStatic; \r\n\t\t\tEvents._checkValidEvent(typeAsEvent);\r\n\t\t} else {\r\n\t\t\ttypeAsString = type;\r\n\t\t}\r\n\r\n\t\tlet selectorElement = null;\r\n\r\n\t\tif (action === null) {\r\n\t\t\taction = (selectorOrAction as Function);\r\n\t\t} else {\r\n\t\t\tselectorElement = (selectorOrAction as SelectorElement);\r\n\t\t}\r\n\t\t\r\n\t\tlet matches = Events.match(typeAsString, selectorElement, action);\r\n\r\n\t\tfor (let i = 0; i < matches.length; i++) {\r\n\t\t\tmatches[i].destroy();\r\n\t\t}\r\n\r\n\t\tEvents._purge();\r\n\r\n\t}\r\n\r\n\tpublic static offById(...ids: Array<number>): void {\r\n\t\tfor (let i = 0; i < Events._listeners.length; i++) {\r\n\t\t\tif (ids.indexOf(Events._listeners[i].id) !== -1) {\r\n\t\t\t\tEvents._listeners[i].destroy();\r\n\t\t\t}\r\n\t\t}\r\n\t\tEvents._purge();\r\n\t}\r\n\r\n\tpublic static dispatch(event: string | any, data: any = null, settings: any = null): void {\r\n\t\t\r\n\t\tlet typeAsString: string;\r\n\t\tlet dataAsAny: any;\r\n\r\n\t\t//If an event then pull the eventname value from the class / instace:\r\n\t\tif ( !(typeof event === 'string') ) {\r\n\t\t\t\r\n\t\t\tlet typeAsEvent: any = (event as any);\r\n\t\t\ttypeAsString = typeAsEvent.eventName || typeAsEvent.eventNameFromStatic; \r\n\t\t\tdataAsAny = typeAsEvent;\r\n\t\t\tEvents._checkValidEvent(typeAsEvent);\r\n\r\n\t\t\t//Switch settings with data (as the event contains the params for the event)\r\n\t\t\tsettings = data;\r\n\r\n\t\t} else {\r\n\t\t\ttypeAsString = event as string;\r\n\t\t\tdataAsAny = data;\r\n\t\t}\r\n\r\n\t\tvar matches: EventListener[] = this.match(typeAsString, null);\r\n\t\tmatches.forEach(function(match: EventListener) {\r\n\t\t\tmatch.dispatch(dataAsAny, settings);\r\n\t\t});\t\r\n\r\n\t}\r\n\r\n\tpublic static match(type: string, selector: SelectorElement = null, action: EventListenerOrEventListenerObject | Function = null): Array <EventListener> {\r\n\r\n\t\treturn  Events._listeners.filter( \r\n\t\t\tlistener => listener.match(type, selector, action) \r\n\t\t);\r\n\t}\r\n\r\n\tpublic static ready(callback: Function): void {\r\n\t\tEvents.on(CoreEvents.READY, callback);\r\n\t}\r\n\r\n\tpublic static tick(callback: Function): void {\r\n\t\tEvents.on(CoreEvents.TICK, callback);\r\n\t}\r\n\r\n\tpublic static DOMUpdate(callback: Function): void {\r\n\t\tEvents.on(CoreEvents.DOM_UPDATED, callback);\r\n\t}\r\n\r\n\tstatic scroll(callback: Function): void  {\r\n\t\tEvents.on(CoreEvents.SCROLL, callback);\r\n\t}\r\n\r\n\tstatic resize (callback: Function): void {\r\n\t\tEvents.on(CoreEvents.RESIZE, callback);\r\n\t}\r\n\r\n\t//Private methods \r\n\t//-------------------------------------------------------------------------------------------\r\n\t//-------------------------------------------------------------------------------------------\r\n\t//-------------------------------------------------------------------------------------------\r\n\t//-------------------------------------------------------------------------------------------\r\n\tprivate static _addCoreListeners(): void {\r\n\t\tthis._ready();\r\n\t\tthis._scroll();\r\n\t\tthis._resize();\r\n\t\tthis._tick();\r\n\t}\r\n\r\n\tprivate static _ready(): void {\r\n\t\tdocument.onreadystatechange =  () => {\r\n\t\t\tif (document.readyState === 'interactive') {\r\n\t\t\t\tEvents.dispatch(CoreEvents.READY);\r\n\t\t\t\t//Destroy ready listeners: \r\n\t\t\t\tEvents.match(CoreEvents.READY).forEach( (listener: EventListener) => listener.destroy() );\r\n\t\t\t\t//Purge:\r\n\t\t\t\tEvents._purge();\r\n\t\t\t}\r\n\t\t};\r\n\t}\r\n\r\n\tprivate static _scroll(): void {\r\n\t\t\r\n\t\tlet scrollTicking = false;\r\n\t\tlet scrollY = 0;\r\n\t\t\r\n\t\twindow.addEventListener('scroll', (e) => {\r\n\r\n\t\t\tfastdom.mutate(() => {scrollY = window.scrollY; });\r\n\r\n\t\t\tif (!scrollTicking) {\r\n\t\t\t\twindow.requestAnimationFrame(() => {\r\n\t\t\t\t\tEvents.dispatch(CoreEvents.SCROLL, scrollY);\r\n\t\t\t\t\tscrollTicking = false;\r\n\t\t\t\t});\r\n\t\t\t\tscrollTicking = true;\r\n\t\t\t}\r\n\r\n\t\t}); \r\n\r\n\t}\r\n\r\n\tprivate static _resize(): void {\r\n\r\n\t\tlet queId = null;\r\n\r\n\t\twindow.addEventListener('resize', (e) => {\r\n\t\t\tfastdom.clear(queId); \r\n\t\t\tqueId = fastdom.mutate(() => {\r\n\t\t\t\tEvents.dispatch(CoreEvents.RESIZE, {width: window.innerWidth, height: window.innerHeight});\r\n\t\t\t\tqueId = null;\r\n\t\t\t});\r\n\t\t}); \r\n\r\n\t}\r\n\r\n\tprivate static _tick(): void {\r\n\t\twindow.requestAnimationFrame(this._dotick.bind(this));\r\n\t}\r\n\r\n\tprivate static _dotick(): void {\r\n\t\tEvents.dispatch(CoreEvents.TICK);\t\r\n\t\twindow.requestAnimationFrame(this._dotick.bind(this));\r\n\t}\r\n\r\n\tprivate static _purge(): void {\r\n\t\tEvents._listeners = Events._listeners.filter(listener => listener.type);\r\n\t}\r\n\r\n\t/** \r\n\t* Check a valid event setup (by checking has eventName set)\r\n\t* @param {DebugEvent} event\r\n\t* @throws {Error} \r\n\t*/\r\n\tprivate static _checkValidEvent(event: any): void {\r\n\r\n\t\tlet eventName: string = event.eventName || event.eventNameFromStatic;\r\n\t\tif (!eventName || eventName === '') {\r\n\t\t\ttry {\r\n\t\t\t\tlet name: string =  event.name || event.constructor.name;\r\n\t\t\t\tthrow new Error(`Event class ${(name)} has no static 'eventName' set`);\r\n\t\t\t} catch (e) {\r\n\t\t\t\tconsole.log(e);\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n}\r\n","//v1.0.0\r\n//jquery transition\r\n//Also implements fastdom to split read/write operations \r\n\r\n//import {DebugHelper} from 'debugbase/debug/DebugHelper';\r\n\r\nimport * as fastdom from 'fastdom';\r\n\r\nexport class DOMHelper {\r\n\r\n\tpublic innerHeight: number;\r\n\tpublic innerWidth: number;\r\n\tpublic scrollY: number; \r\n\r\n\tconstructor() {\r\n\t\tthis._measureCore();\r\n\t\t//fastdom.catch = (error) => {\r\n\t \t\t// Do something if you want\r\n\t \t//\tconsole.log(\"error = \" + error);\r\n\t\t//};\t\r\n\t}\r\n\r\n\tpublic setAttribute( element: Element, name: string, value: string): void {\r\n\t\telement.setAttribute(name, value);\r\n\t}\r\n\r\n\tpublic removeAttributte(element: Element, name: string): void {\r\n\t\telement.removeAttribute(name);\r\n\t}\r\n\r\n\tpublic getAttribute(element: Element | EventTarget, attrName: string): string {\r\n\t\tif ( !element || !attrName) {\r\n\t\t\t//DebugHelper.throw(`Null element set no attr set. attrName = ${attrName}`);\r\n\t\t\treturn;\r\n\t\t}\r\n\t\treturn (element as Element).getAttribute (attrName);\r\n\t}\r\n\r\n\tpublic getAttributes(element: Element | EventTarget): any {\r\n\t\t\r\n\t\tif ( !element ) {\r\n\t\t\t//DebugHelper.throw('Null element set.');\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tlet attr = {};\r\n\t\tfor (let i = 0; i < (element as Element).attributes.length; i++) {\r\n\t\t\tattr[(element as Element).attributes[i].name] = (element as Element).attributes[i].value;\r\n\t\t}\r\n\t\treturn attr;\r\n\t}\r\n\t\r\n\t//Set config to \r\n\t//TODO - should be a standard Rectangle or Size class\r\n\tpublic resize(rect: any): void {\r\n\t\tthis.innerHeight = rect.width;\r\n\t\tthis.innerWidth = rect.height;\r\n\t}\r\n\r\n\tpublic scroll(y: number): void {\r\n\t\tthis.scrollY = y;\r\n\t}\r\n\r\n\tpublic setHTML(element: HTMLElement, html: string, complete: Function = null): void {\r\n\r\n\t\tif (!element || !html) {\r\n\t\t\t//DebugHelper.throw(`No element or html set`);\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tfastdom.mutate(() => {\r\n\t\t\telement.innerHTML = html; \r\n\t\t\tif (complete) {\r\n\t\t\t\tcomplete();\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n\r\n\tpublic setText(element: HTMLElement, text: string): void {\r\n\r\n\t\tif (!element || !text) {\r\n\t\t\t//DebugHelper.throw(`No element or text set`);\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tfastdom.mutate(() => {element.innerText = text; });\r\n\t}\r\n\r\n\tpublic append(element:  HTMLElement | Element, addElement: (HTMLElement | string), complete: Function = null): void {\r\n\t\t\r\n\t\tif (!addElement) {\r\n\t\t\t//DebugHelper.throw('Append has no element to add.');\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tif (typeof addElement === 'string' ) {\r\n\t\t\tfastdom.mutate(() => {\r\n\t\t\t\telement.insertAdjacentHTML( 'beforeend', (addElement as string) );\r\n\t\t\t\tif (complete) {\r\n\t\t\t\t\tcomplete();\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t} else {\r\n\t\t\tfastdom.mutate(() => {\r\n\t\t\t\telement.appendChild( (addElement as HTMLElement));\r\n\t\t\t\tif (complete) {\r\n\t\t\t\t\tcomplete();\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t}\r\n\r\n\t}\r\n\r\n\tpublic removeElement(element:  HTMLElement | Element, complete: Function = null): void {\r\n\t\t\r\n\t\tif ( !element ) {\r\n\t\t\t//DebugHelper.throw('Null element set.');\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tfastdom.mutate(() => {\r\n\t\t\telement.parentNode.removeChild(element); \r\n\t\t\tif (complete) {\r\n\t\t\t\tcomplete();\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t}\r\n\r\n\tpublic addClass(element: HTMLElement | Element, className: string) {\r\n\r\n\t\tif ( !element ) {\r\n\t\t\t//DebugHelper.throw('Null element set.');\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tfastdom.mutate(() => {\r\n\t\t\tif (element.classList) {\r\n\t\t\t\telement.classList.add(className);\r\n\t\t\t} else  {\r\n\t\t\t\telement.className += ' ' + className;\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n\r\n\tpublic removeClass(element: HTMLElement | Element, className: string) {\r\n\t\t\r\n\t\tif ( !element || (!className || className === '') ) {\r\n\t\t\t//DebugHelper.throw('Null element or no classname set.');\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tfastdom.mutate(() => {\r\n\r\n\t\t\tif (element.classList) {\r\n\t\t\t\telement.classList.remove(className);\r\n\t\t\t} else  {\r\n\t\t\t\telement.className = element.className.replace(' ' + className, '');\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n\r\n\tpublic toggleClass(element: HTMLElement | Element, className: string, add: boolean = true) {\r\n\t\t\r\n\t\tif ( !element || (!className || className === '') ) {\r\n\t\t\t//DebugHelper.throw('Null element or no classname set.');\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tif (add) {\r\n\t\t\tthis.addClass(element, className);\r\n\t\t} else {\r\n\t\t\tthis.removeClass(element, className);\r\n\t\t}\r\n\t}\r\n\r\n\tpublic que(callback: Function): any {\r\n\t\treturn fastdom.mutate(() => {\r\n\t\t\tcallback();\r\n\t\t});\r\n\t}\r\n\r\n\tpublic clearQue(id: any): void {\r\n\t\tfastdom.clear(id);\r\n\t}\r\n\r\n\tpublic hasClass(element: HTMLElement | Element, className: string): boolean {\r\n\t\treturn element.classList.contains(className);\r\n\t}\r\n\r\n\tpublic parent(element: HTMLElement | Element): Node {\r\n\t\treturn element.parentNode;\r\n\t} \r\n\r\n\tpublic contains(element: HTMLElement | Element, scope: HTMLElement | Element = null): boolean {\r\n\r\n\t\tif (scope === null) {\r\n\t\t\tscope = document.body;\r\n\t\t}\r\n\r\n\t\treturn scope.contains(element);\r\n\r\n\t}\r\n\r\n\tpublic sizes(element: HTMLElement | Element,  callback: Function): void {\r\n\r\n\t\tfastdom.measure(() => {\r\n\t\t\tvar rect: ClientRect = element.getBoundingClientRect();\r\n\t\t\tcallback({\r\n\t\t\t\tposition: {left: (element as HTMLElement).offsetLeft, top: (element as HTMLElement).offsetTop},\r\n\t\t\t\trect: rect,\r\n\t\t\t\twidth: rect.width,\r\n\t\t\t\theight: rect.height\r\n\t\t\t});\r\n\t\t});\r\n\r\n\t}\r\n\r\n\tprivate _measureCore(): void {\r\n\t\tfastdom.measure(() => {\r\n\t\t\tthis.innerHeight = window.innerHeight;\r\n\t\t\tthis.innerWidth = window.innerWidth;\r\n\t\t});\r\n\t}\r\n\r\n}\r\n","import {Debugbase} from './../Debugbase';\r\n\r\ninterface Configurable {\r\n\tconfig: any; \r\n}\r\n\r\nexport class FrameworkHelper {\r\n\r\n\t//Fairly cpu itensive \r\n\tpublic getParsedAttributes(element: Element): any {\r\n\r\n\t\tvar attr = Debugbase.DOM.getAttributes(element);\r\n\t\t\r\n\t\tfor (var i in attr) {\r\n\t\t\tattr[i] = Debugbase.string.convert(attr[i]);\r\n\t\t}\r\n\r\n\t\treturn attr;\r\n\r\n\t}\r\n\r\n\tpublic attributesToConfig(instance: Configurable, attributes: any, match = null): void {\r\n\t\t\r\n\t\tlet name: string; \r\n\t\tlet i: string;\r\n\t\tlet matches: boolean;\r\n\t\tlet clean: string;\r\n\r\n\t\tfor (i in attributes) {\r\n\r\n\t\t\tmatches = true; \r\n\t\t\tif (match && !Debugbase.string.contains(i, match)) {\r\n\t\t\t\tmatches = false; \r\n\t\t\t}\r\n\r\n\t\t\tif (matches) {\r\n\t\t\t\tclean =  Debugbase.string.remove(i, match + '-');\r\n\t\t\t\tname = Debugbase.string.snakeToCamelCase(clean);\r\n\t\t\t\tinstance.config[name] = attributes[i];\t\r\n\t\t\t}\r\n\r\n\t\t}\r\n\t\t\r\n\t}\r\n\r\n\t\r\n\r\n}\r\n","export interface Size {\r\n\twidth: number;\r\n\theight: number;\r\n}\r\n\r\nexport interface Point {\r\n\tx: number;\r\n\ty: number;\r\n}\r\n\r\nexport class MathHelper {\r\n\r\n\tprivate _distance: number;\r\n\tprivate _distanceX: number;\r\n\tprivate _distanceY: number;\r\n\r\n\tpublic get distanceX() : number {\r\n\t\treturn this._distanceX;\r\n\t}\r\n\r\n\tpublic get distanceY() : number {\r\n\t\treturn this._distanceY;\r\n\t}\r\n\r\n\t//https://stackoverflow.com/questions/42110701/how-to-calculate-percentage-between-the-range-of-two-values-a-third-value-is-in\r\n\tpublic mapBetween(currentNum: number, minAllowed: number, maxAllowed: number, min: number, max: number): number {\r\n\t\treturn (maxAllowed - minAllowed) * (currentNum - min) / (max - min) + minAllowed;\r\n\t}\r\n\r\n\tpublic getInbetween(value: number, bottom_value: number, top_value: number) : number {\r\n\t\tlet range = top_value - bottom_value;\r\n\t\tlet percent = (value - bottom_value) / range;\r\n\t\treturn percent;\r\n\t}\r\n\r\n\tpublic constrain(value: number, min: number, max: number): number {\r\n\t\tif (value > max) {\r\n\t\t\tvalue = max;\r\n\t\t} else if (value < min) {\r\n\t\t\tvalue = min;\r\n\t\t}\r\n\t\treturn value;\r\n\t}\r\n\r\n\t//Get a ratio value between two values by passing a ratio\r\n\t//i.e between -1.2 and 2 \r\n\t///getRangeRatio(0.4, -1.2, 2);\r\n\tpublic getRangeRatio(ratio: number, lowerValue: number, topValue: number) : number {\r\n\t\tlet range: number = topValue - lowerValue;\r\n\t\treturn lowerValue + (ratio * range);\r\n\t}  \r\n\r\n\t//fit scale\r\n\r\n\t//Get the scale an item should be to fit into a space: \r\n\tpublic getBestFitScale(imageDimensions: Size, containerDimensions: Size): number {\r\n\t\t\r\n\t\tlet scale = 1.0; \r\n\t\tlet aspectRatio = imageDimensions.width / imageDimensions.height;\r\n\t\tlet targetRatio = containerDimensions.width / containerDimensions.height;\r\n\r\n\t\tif (targetRatio > aspectRatio) {\r\n\t\t\tscale =  containerDimensions.width / imageDimensions.width;\r\n\t\t} else {\r\n\t\t\tscale =  containerDimensions.height / imageDimensions.height;\r\n\t\t}\r\n\r\n\t\treturn scale; \r\n\t\r\n\t}\r\n\r\n\t/** Emulate CSS cover logic */\r\n\tpublic getCoverSize(imageDimensions: Size, containerDimensions: Size): any {\r\n\t\t\r\n\t\tlet originalRatios = {\r\n\t\t  width: containerDimensions.width / imageDimensions.width,\r\n\t\t  height: containerDimensions.height / imageDimensions.height\r\n\t\t};\r\n\r\n\t\t// formula for cover:\r\n\t\tlet coverRatio = Math.max(originalRatios.width, originalRatios.height); \r\n\r\n\t\t// result:\r\n\t\treturn {\r\n\t\t\twidth: imageDimensions.width * coverRatio,\r\n\t\t\theight: imageDimensions.height * coverRatio\r\n\t\t };\r\n\t\t\r\n\t}\r\n\r\n\tpublic distance(point1: Point, point2: Point): number {\r\n\t\tthis._distanceX = point1.x - point2.x;\r\n\t\tthis._distanceY = point1.y - point2.y;\r\n\t\treturn  Math.sqrt((this._distanceX * this._distanceX) + (this._distanceY * this._distanceY));\r\n\t}\r\n\r\n}\r\n","export class StringHelper {\r\n\r\n\tpublic snakeToCamelCase(str: string): string {\r\n\t\treturn str.replace(/(\\-\\w)/g, function(m) { return m[1].toUpperCase(); });\r\n\t}\r\n\r\n\tpublic snakeToClassName(str: string): string {\r\n\t\treturn this.capitalizeFirstLetter( this.snakeToCamelCase(str) );\r\n\t}\r\n\r\n\tpublic capitalizeFirstLetter(str: string): string {\r\n\t\treturn str.charAt(0).toUpperCase() + str.slice(1);\r\n\t}\r\n\r\n\tpublic contains(str: string, check: string, start: number = 0): boolean {\r\n\t\treturn (str.indexOf(check, start) !== -1);\r\n\t}\r\n\r\n\tpublic remove(str: string, remove: string) {\r\n\t\tvar re = new RegExp(this._escapeRegExp(remove), 'g');\r\n\t\treturn str.replace(re, '');\r\n\t}\r\n\r\n\tpublic isNumeric(str: string | number): boolean {\r\n\t\treturn !isNaN(parseFloat( str as string )) && isFinite( str as number );\r\n\t}\r\n\r\n\t//Convert string to number or boolean \r\n\tpublic convert(str: string, convertBlankStringToBoolean: boolean = true): string | number | boolean {\r\n\t\t\r\n\t\tlet converted: string | number | boolean = str;\r\n\r\n\t\t//If a blank string then most likely a boolean i.e created by attribute-name\r\n\t\tif ( (convertBlankStringToBoolean && str === '') || str.toLowerCase() === 'true') {\r\n\t\t\tconverted = true;\r\n\t\t} else if (str.toLowerCase() === 'false') {\r\n\t\t\tconverted = false; \r\n\t\t} else if (this.isNumeric(str) ) {\r\n\t\t\tconverted =  parseFloat(str);\r\n\t\t}\r\n\t\treturn converted;\r\n\r\n\t}\r\n\r\n\tpublic template(str: string, map: any): string {\r\n\t\tfor (var i in map) {\r\n            var re  = new RegExp('%%' + i + '%%', 'g');\r\n            str  = str.replace(re, map[i]); \r\n        }\r\n        return str; \r\n\t}\r\n\r\n\tprivate _escapeRegExp(str: string) {\r\n\t\treturn str.replace(/[-[\\]{}()*+?.,\\\\^$|#\\s]/g, '\\\\$&');\r\n\t}\r\n\r\n\r\n}\r\n","export class SystemHelper {\r\n\r\n\tpublic cordsFromTouch: boolean = false;\r\n\r\n\tprivate _innerWidth: number;\r\n\tprivate _innerHeight: number;\r\n\r\n\tprivate _isPortraitDevice: boolean;\r\n\tprivate _isSmallDevice: boolean;\r\n\r\n\tconstructor() {\r\n\t\tthis.resize();\r\n\t}\r\n\r\n\tpublic get innerWidth(): number {\r\n\t\treturn  this._innerWidth;\r\n\t}\r\n\r\n\tpublic get innerHeight(): number {\r\n\t\treturn  this._innerHeight;\r\n\t}\r\n\r\n\tpublic get isPortraitDevice(): boolean {\r\n\t\treturn  this._isPortraitDevice;\r\n\t}\r\n\r\n\tpublic get isSmallDevice(): boolean {\r\n\t\treturn  this._isSmallDevice;\r\n\t}\r\n\r\n\tpublic resize(): void {\r\n\t\tthis._innerWidth = window.innerWidth;\r\n\t\tthis._innerHeight = window.innerHeight;\r\n\t\tthis._isPortraitDevice = (window.innerWidth < 1000 && window.innerWidth < window.innerHeight);\r\n\t\tthis._isSmallDevice  = (window.innerWidth < 800);\r\n\t}\r\n\r\n}\r\n","//v1.0 - Dataloader is proxy for AXIOM. \r\n//All loaders that need AJAX / Form post style stuff should use this\r\nimport {Loader} from './Loader';\r\nimport Axios from 'axios';\r\nimport Promise from 'promise-polyfill';\r\n\r\nexport abstract class DataLoader extends Loader {\r\n\r\n\tpublic url;\r\n\tpublic method: string = 'GET';\r\n\tpublic data: any = null;\r\n\r\n\tpublic load(): void {\r\n\t\tthis._load();\r\n\t}\r\n\r\n\t//protected \r\n\t//--------------------------------------------------------\r\n\t//--------------------------------------------------------\r\n\t//--------------------------------------------------------\r\n\t//--------------------------------------------------------\r\n\r\n\tprotected dataLoadComplete(data: any): void {\r\n\t\tthis.complete(data);\r\n\t}\r\n\r\n\t//private \r\n\t//--------------------------------------------------------\r\n\t//--------------------------------------------------------\r\n\t//--------------------------------------------------------\r\n\t//--------------------------------------------------------\r\n\r\n\tprivate get getParams(): any {\r\n\t\treturn (this.method === 'GET') ? this.data :  null;\r\n\t}\r\n\r\n\tprivate get postData(): any {\r\n\t\treturn (this.method !== 'GET') ? this.data :  null;\r\n\t}\r\n\r\n\t// Want to use async/await? Add the `async` keyword to your outer function/metho\r\n\tprivate _load() {\r\n\t\r\n\t\tAxios(({\r\n\t\t\tmethod: this.method,\r\n\t\t\turl: this.url,\r\n\t\t\tdata: this.postData,\r\n\t\t\tparams: this.getParams,\r\n\t\t\tonDownloadProgress: this.onProgress,\r\n\t\t} as any ))\r\n\t\t .then( (response) => {\r\n\t\t    this.dataLoadComplete(response);\r\n\t\t  })\r\n\t\t  .catch( (error) => {\r\n\t\t    this.error(error);\r\n\t\t  });\r\n\r\n\t}\r\n\r\n}\r\n","//v1.0 - HTML loader for loading HTML items in \r\nimport {DataLoader} from './DataLoader';\r\n\r\nexport class HTMLLoader extends DataLoader {\r\n\r\n\tpublic element: Element;\r\n\tpublic html: string;\r\n\r\n\tprotected dataLoadComplete(response: any): void {\r\n\t\t\r\n\t\tthis.html = response.data;\r\n\t\t\r\n\t\tif (this.element) {\r\n\t\t\tthis.element.innerHTML = this.html;\r\n\t\t}\r\n\r\n\t\tthis.complete(this.id);\r\n\r\n\t}\r\n\r\n}\r\n","//v1.0 - HTML loader for loading scripts in \r\nimport {Loader} from './Loader';\r\n\r\nexport class ImageLoader extends Loader {\t\r\n\r\n\tpublic element: NodeListOf<HTMLImageElement>;\r\n\r\n\tprotected loaded: number = 0;\r\n\r\n\tpublic load(): void {\r\n\t\tfor (var i = 0; i < this.element.length; i++) {\r\n\t\t\tthis._addListener(this.element[i]);\r\n\t\t}\r\n\t}\r\n\r\n\tpublic getTotalAssets() : number {\r\n\t\treturn (this.element) ? this.element.length : 0;\r\n\t}\r\n\r\n\tpublic getLoadedAssets() : number {\r\n\t\treturn this.loaded;\r\n\t}\r\n\r\n\t//private \r\n\t//--------------------------------------------------------\r\n\t//--------------------------------------------------------\r\n\t//--------------------------------------------------------\r\n\t//--------------------------------------------------------\r\n\t\r\n\tprotected onImgLoaded(img: any): void {\r\n\r\n\t\tthis.loaded++;\r\n\t\tthis.assetLoaded(img);\r\n\r\n\t\timg.removeEventListener('load', (e) => this._onImgLoaded(e.target));\r\n\t\timg.removeEventListener('error', (error) =>  this._onImgError(error));\r\n\r\n\t\tlet totalAssets = this.getTotalAssets();\r\n\t\tlet loadedAssets = this.getLoadedAssets();\r\n\t\tlet ratio = loadedAssets / totalAssets;\r\n\r\n\t\tthis.progress({\r\n\t\t\tid: this.id,\r\n\t\t\tratio: ratio, \r\n\t\t\ttotal: totalAssets,\r\n\t\t\tloaded: loadedAssets\r\n\t\t});\r\n\r\n\t\tif (totalAssets === loadedAssets) {\r\n\t\t\tthis.complete(this.id);\r\n\t\t}\r\n\r\n\t}\r\n\r\n\tprotected onImgError(error: any): void {\r\n\t\tthis.onError(error);\r\n\t}\r\n\r\n\tprotected _onImgLoaded(target: any): void {}\r\n\tprotected _onImgError(error: string): void {\r\n\t\t\r\n\t}\r\n\r\n\tprivate _addListener(img: HTMLImageElement): void {\r\n\t\tif (img.complete) {\r\n\t\t\tthis.onImgLoaded(img);\r\n\t\t} else {\r\n\t\t\timg.addEventListener('load', (e) => this.onImgLoaded(e.target));\r\n\t\t\timg.addEventListener('error', (error) =>  this.onImgError(error));\r\n\t\t}\r\n\t}\r\n\r\n\r\n\r\n}\r\n","export class InstanceLoader <T> {\r\n\t\r\n\tconstructor(private context: Object) {}\r\n\r\n\tgetInstance(name: string, ...args: any[]) : T {\r\n\t\tvar instance = Object.create(this.context[name].prototype);\r\n\t\tinstance.constructor.apply(instance, args);\r\n\t\treturn <T> instance;\r\n\t}\r\n}\r\n","//v1.0 - HTML loader for loading scripts in \r\nimport {DataLoader} from './DataLoader';\r\n\r\nexport class JSONLoader extends DataLoader {\t\r\n\t\r\n\tprotected onLoaderComplete(response: any): void {\r\n\r\n\t\r\n\t\tthis.complete(response);\r\n\t}\r\n\r\n\tprotected complete(data: any = null): void {\r\n\r\n\t\tthis._complete = true; \r\n\t\t\r\n\t\tif (this.onComplete) {\r\n\t\t\tthis.onComplete(this.id, data.data, this);\r\n\t\t}\r\n\r\n\t\tif (this.onGroupAssetComplete) {\r\n\t\t\tthis.onGroupAssetComplete(data, this);\r\n\t\t}\r\n\t}\r\n\r\n}\r\n","//v1.0 \r\n//Loader base class for all loaders \r\nexport interface ProgressObject {\r\n\tid: string;\r\n\tratio: number;\r\n\ttotal?: number;\r\n\tloaded?: number;\r\n}\r\n\r\nexport abstract class Loader {\r\n\r\n\tpublic id: string;\r\n\tpublic onProgress: Function;\r\n\tpublic onComplete: Function;\r\n\tpublic onError: Function;\r\n\tpublic onAssetLoaded: Function;\r\n\t\r\n\tprotected onGroupAssetComplete: Function;\r\n\tprotected onGroupError: Function;\r\n\r\n\tprotected _complete: boolean = false;\r\n\r\n\tpublic load(): void {}\r\n\r\n\tpublic destroy(): void {\r\n\r\n\t\treturn;\r\n\t\tthis.onProgress = null;\r\n\t\tthis.onComplete = null;\r\n\t\tthis.onError = null;\r\n\t\tthis.onGroupAssetComplete = null;\r\n\t\tthis.onGroupError = null;\r\n\t}\r\n\r\n\tpublic getTotalAssets(): number {\r\n\t\treturn 1;\r\n\t}\r\n\r\n\tpublic getLoadedAssets(): number {\r\n\t\treturn (this._complete) ? 1 : 0;\r\n\t}\r\n\r\n\t//LoaderGroup needs to manage callbacks on its own so it doesn't \r\n\tpublic setLoaderGroupCallbacks(assetComplete: Function, error: Function): void {\r\n\t\tthis.onGroupAssetComplete = assetComplete;\r\n\t\tthis.onGroupError = error;\r\n\t}\r\n\r\n\t//protected \r\n\t//--------------------------------------------------------\r\n\t//--------------------------------------------------------\r\n\t//--------------------------------------------------------\r\n\t//--------------------------------------------------------\r\n\r\n\tprotected complete(data: any = null): void {\r\n\t\tthis._complete = true; \r\n\t\tif (this.onComplete) {\r\n\t\t\tthis.onComplete(data, this);\r\n\t\t}\r\n\r\n\t\tif (this.onGroupAssetComplete) {\r\n\t\t\tthis.onGroupAssetComplete(data, this);\r\n\t\t}\r\n\t}\r\n\r\n\tprotected assetLoaded(data: any = null): void {\r\n\t\tif (this.onAssetLoaded) {\r\n\t\t\tthis.onAssetLoaded(data, this);\r\n\t\t}\r\n\t\tif (this.onGroupAssetComplete) {\r\n\t\t\tthis.onGroupAssetComplete(data, this);\r\n\t\t}\r\n\t}\r\n\r\n\tprotected progress(data : ProgressObject): void {\r\n\t\tif (this.onProgress) {\r\n\t\t\tthis.onProgress(data, this);\r\n\t\t}\r\n\t}\r\n\r\n\tprotected error(error: string): void {\r\n\t\tif (this.onError) {\r\n\t\t\tthis.onError(error, this);\r\n\t\t}\r\n\t\tif (this.onGroupError) {\r\n\t\t\tthis.onGroupError(error, this);\r\n\t\t}\r\n\t}\r\n\r\n}\r\n","//v1.0 \r\n//Loader group for grouping to together 1 or more Loaders\r\n//Useful for situations when a load of different things need to be loaded before it can be shown \r\nimport {Loader} from './Loader';\r\n\r\nexport class LoaderGroup {\r\n\r\n\tpublic id: string;\t\r\n\tpublic onComplete: Function;\r\n\tpublic onProgress: Function;\r\n\tpublic onError: Function;\r\n\r\n\tprivate _group : Array<Loader> = []; \r\n\r\n\tpublic add(...loaders: Loader[]): void {\r\n\t\tthis._group = this._group.concat(loaders);\r\n\t}\r\n\r\n\tpublic load(): void {\r\n\t\tfor (let i = 0; i < this._group.length; i++ ) {\r\n\t\t\tthis._group[i].setLoaderGroupCallbacks(\r\n\t\t\t\t() => this._onAssetComplete(),\r\n\t\t\t\t(error) => this._onError(error)\r\n\t\t\t);\r\n\t\t\tthis._group[i].load();\r\n\t\t}\r\n\t}\r\n\r\n\t//private \r\n\t//--------------------------------------------------------\r\n\t//--------------------------------------------------------\r\n\t//--------------------------------------------------------\r\n\t//--------------------------------------------------------\r\n\r\n\t//Single loader has completed \t\r\n\tprivate  _onAssetComplete( data: any = null ): void {\r\n\r\n\t\tlet totalAssets: number = this._getTotalAssets();\r\n\t\tlet loadedAssets: number  = this._getLoadedAssets();\r\n\t\tlet ratio = loadedAssets / totalAssets;\r\n\r\n\t\tif (this.onProgress) {\r\n\t\t\tthis.onProgress( {\r\n\t\t\t\tid: this.id,\r\n\t\t\t\tratio: ratio, \r\n\t\t\t\ttotal: totalAssets,\r\n\t\t\t\tloaded: loadedAssets\r\n\t\t\t});\r\n\t\t}\t\r\n\r\n\t\tif (totalAssets === loadedAssets) {\r\n\t\t\tthis._groupComplete();\r\n\t\t}\r\n\r\n\t}\r\n\r\n\t//The whole group has completed: \r\n\tprivate  _groupComplete(): void {\r\n\r\n\t\tif (this.onComplete) {\r\n\t\t\tthis.onComplete(this.id);\r\n\t\t}\r\n\r\n\t\tthis._destroy();\r\n\r\n\t}\r\n\r\n\t//On assets error: \r\n\tprivate  _onError(error: string): void {\r\n\t\tif (this.onError) {\r\n\t\t\tthis.onError(error);\r\n\t\t}\r\n\t}\r\n\r\n\t//Get total assets. This can be more than the amout of loaders as ImageLoader can have many images\r\n\tprivate _destroy(): void {\r\n\r\n\r\n\t\treturn;\r\n\t\tif (!this._group) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\t\r\n\t\tfor (var i = 0; i < this._group.length; i++) {\r\n\t\t\tthis._group[i].destroy();\r\n\t\t}\r\n\r\n\t\tthis._group = null;\r\n\r\n\t}\r\n\r\n\t//Get total assets in the whole group \r\n\tprivate _getTotalAssets(): number {\r\n\t\tlet count = 0; \r\n\t\tfor (let i = 0; i < this._group.length; i++ ) {\r\n\t\t\tcount += this._group[i].getTotalAssets();\r\n\t\t}\r\n\t\treturn count;\r\n\t}\r\n\r\n\t//Get total assets in the whole group \r\n\tprivate _getLoadedAssets(): number {\r\n\t\tlet count = 0; \r\n\t\tfor (let i = 0; i < this._group.length; i++ ) {\r\n\t\t\tcount += this._group[i].getLoadedAssets();\r\n\t\t}\r\n\t\treturn count;\r\n\t}\r\n\r\n}\r\n","//v1.0 - Pixi loader for loading PIXI resources into \r\n//import * as PIXI from 'pixi.js';\r\nimport {Loader} from './Loader';\r\n\r\nexport class PixiLoader extends Loader {\t\r\n\r\n\tpublic resources: Array < any > = [ {ref: 'spritesheet', path: '/img/work/spritesheetspritesheet.json'} ];\r\n\tpublic onResourcesReady: Function;\r\n\r\n\tprotected loaded: number = 0;\r\n\tprivate _loader: PIXI.loaders.Loader;\r\n\tprivate _pixicomplete: boolean = false;\r\n\r\n\t//Load all the resources via the built in PIXI loader:\r\n\tpublic load(): void {\r\n\t\t\r\n\t\tthis._loader  = new PIXI.loaders.Loader();\r\n\r\n\t\tthis.resources.forEach((resource) => {\r\n\t\t\tthis._loader.add(resource.ref, resource.path);\r\n\t\t});\r\n\t\t\r\n\t\tthis._loader.onLoad.add((loader, resources) =>  this.onResourceLoaded(loader, resources) );\r\n\t\tthis._loader.onComplete.add( (loader, resources) => this._onComplete(loader, resources) );\r\n\t\tthis._loader.onError.add((loader, data) => this._onError() ); // called once per errored file\r\n\t\tthis._loader.load();\r\n\t\r\n\t}\r\n\r\n\t//Check total assets \r\n\t//Spritesheets count for x2 assets as there is JSON and Image to load\r\n\tpublic getTotalAssets() : number {\r\n\t\tlet count = 0;\r\n\t\tfor ( var i = 0; i < this.resources.length; i++) {\r\n\t\t\tlet add: number = this.resources[i].isSpriteSheet ? 2 : 1;\r\n\t\t\tcount += add;\r\n\t\t}\r\n\t\treturn count;\r\n\t}\r\n\r\n\tpublic getLoadedAssets() : number {\r\n\t\treturn this.loaded;\r\n\t}\r\n\r\n\t//private \r\n\t//--------------------------------------------------------\r\n\t//--------------------------------------------------------\r\n\t//--------------------------------------------------------\r\n\t//--------------------------------------------------------\r\n\t\r\n\t//Single resource has loaded so update the progress: \r\n\tprotected onResourceLoaded(loader: PIXI.loaders.Loader, data: any ): void {\r\n\r\n\t\tlet totalAssets = this.getTotalAssets();\r\n\t\tthis.loaded = Math.round( (loader.progress / 100) * totalAssets);\r\n\r\n\t\tlet loadedAssets = this.getLoadedAssets();\r\n\t\tlet ratio = loadedAssets / totalAssets;\r\n\r\n\t\tthis.progress({\r\n\t\t\tid: this.id,\r\n\t\t\tratio: ratio, \r\n\t\t\ttotal: totalAssets,\r\n\t\t\tloaded: loadedAssets\r\n\t\t});\r\n\r\n\t}\r\n\r\n\t//Loader is 100% complete so flag complete \r\n\tprivate _onComplete(loader, resources): void {\r\n\r\n\t\tif (this._pixicomplete) {\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tthis._pixicomplete = true;\r\n\r\n\t\tthis.complete(this.id);\r\n\t\tif (this.onResourcesReady) {\r\n\t\t\tthis.onResourcesReady(this.id, resources);\r\n\t\t}\r\n\t}\r\n\t\r\n\t//Error callback\r\n\tprivate _onError(): void {\r\n\t\tthis.error(`PIXI LOADING ERROR LOADER ID = ${this.id}}`);\r\n\t}\r\n\r\n}\r\n","import {ControllerManager} from './ControllerManager';\r\n\r\ninterface RouteConfig {\r\n\tpath: string; \r\n\tcontroller: string; \r\n\tfunction?: string; \r\n}\r\n\r\nexport class BehaviourManager {\r\n\r\n}\r\n","//v1.0.0 create and manage all controllers\r\n//v1.0.1 added DOMReady / DOMUpdated functions \r\nimport {Controller} from 'debugbase/abstract/Controller';\r\nimport {Events} from 'debugbase/events/Events';\r\nimport {CoreEvents} from 'debugbase/events/CoreEvents';\r\n\r\ninterface ControllerConfig {\r\n\tinstance: Controller | any; \r\n\tglobal?: boolean; \r\n\tselector?: string;\r\n}\r\n\r\nexport class ControllerManager {\r\n\r\n\tprivate _controllers: Array<Controller> = [];\r\n\r\n\tpublic init() {\r\n\r\n\t\t//Loop through all the controllers. \r\n\t\t//If they are global then they can be started up straight away\r\n\t\tfor (let i = 0; i < this._controllers.length; i++) {\r\n\t\t\tif ( this._controllers[i].global ) {\r\n\t\t\t\tthis._controllers[i].init();\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tEvents.on(CoreEvents.MODULES_MOUNTED, this._onModulesMounted.bind(this));\r\n\r\n\t}\r\n\r\n\tpublic add(...controllersConfig: Array<ControllerConfig>) {\r\n\t\tfor (let i = 0; i < controllersConfig.length; i++) {\r\n\t\r\n\t\t\tif (controllersConfig[i].global ) {\r\n\t\t\t\tcontrollersConfig[i].instance.global = true; \r\n\t\t\t}\r\n\t\t\tif (controllersConfig[i].selector ) {\r\n\t\t\t\tcontrollersConfig[i].instance.containerSelector = controllersConfig[i].selector; \r\n\t\t\t}\r\n\r\n\t\t\tthis._controllers.push(controllersConfig[i].instance);\r\n\t\t}\t\r\n\t\r\n\t}\r\n\r\n\tpublic get(id: string): Controller {\r\n\r\n\t\tfor (let i = 0; i < this._controllers.length; i++) {\r\n\t\t\tif (this._controllers[i].id.toLowerCase() === id.toLowerCase()) {\r\n\t\t\t\treturn this._controllers[i];\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\treturn null;\r\n\t}\r\n\r\n\tpublic DOMReady(): void {\r\n\r\n\t\tthis._controllers.forEach((controller) => {\r\n\t\t\tif (controller.DOMReady) {\r\n\t\t\t\tcontroller.DOMReadyCore();\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n\r\n\tpublic DOMUpdated(): void {\r\n\t\tthis._controllers.forEach((controller) => {\r\n\t\t\tif (controller.DOMUpdated) {\r\n\t\t\t\tcontroller.DOMUpdated();\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n\r\n\tpublic scroll(windowY: number): void {\r\n\t\tthis._controllers.forEach((controller) => {\r\n\t\t\tif (controller.scroll) {\r\n\t\t\t\tcontroller.scroll(windowY);\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n\r\n\tpublic resize(sizes: any): void {\r\n\t\t\tthis._controllers.forEach((controller) => {\r\n\t\t\tif (controller.resize) {\r\n\t\t\t\tcontroller.resize();\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n\r\n\tpublic tick(): void {\r\n\t\tthis._controllers.forEach((controllerInstance: Controller) => {\r\n\t\t\tif (controllerInstance.tick) {\r\n\t\t\t\tcontrollerInstance.tick();\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n\r\n\tprivate _onModulesMounted(): void {\r\n\t\tthis._controllers.forEach((controller) => {\r\n\t\t\tif (controller.modulesMounted) {\r\n\t\t\t\tcontroller.modulesMounted();\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n\r\n}\r\n","import { Debugbase } from 'debugbase/Debugbase';\r\nimport { Module } from 'debugbase/abstract/Module';\r\nimport { InstanceLoader } from 'debugbase/loader/InstanceLoader';\r\nimport { Events } from 'debugbase/events/Events';\r\nimport { CoreEvents } from 'debugbase/events/CoreEvents';\r\n\r\nenum ClearType { DESTROY, REMOVE }\r\n\r\ninterface RouteConfig {\r\n\tpath: string;\r\n\tcontroller: string;\r\n\tfunction?: string;\r\n}\r\n\r\nexport class ModuleManager {\r\n\r\n\tprivate _modules: Module[] = [];\t\t\t\t\t\t\t//All active modules\r\n\tprivate _instanceLoader: InstanceLoader<Module>;\t\t\t//To load module instances saved to window scope\r\n\tprivate _created: Module[];  \t\t\t\t\t\t\t\t//Object modules created at runtime and pushed in via Debugbase.module.create();\r\n\tprivate _purgeQueId: any;\r\n\tprivate _autoCreateQueId: any;\r\n\r\n\tpublic create(): void {\r\n\r\n\t}\r\n\r\n\tpublic get(id: string): Module {\r\n\t\treturn this._getModuleById(id);\r\n\t}\r\n\r\n\tpublic getByTag(tag: string): Array <Module> {\r\n\t\treturn this._getModulesByTag(tag);\r\n\t}\r\n\r\n\tpublic getByModuleName(name: string): Array <Module> {\r\n\t\treturn this._getByModuleName(name);\r\n\t}\r\n\r\n\tpublic remove(id: string): void {\r\n\t\tthis._clearById(id, ClearType.REMOVE);\r\n\t}\r\n\r\n\tpublic destoryByTag(tag: string): void {\r\n\t\tthis._clearByTag(tag);\r\n\t\tthis._purge();\r\n\t}\r\n\r\n\tpublic destroy(id: string): void {\r\n\t\tthis._clearById(id, ClearType.DESTROY);\r\n\t}\r\n\r\n\tpublic DOMReady(): void {\r\n\t\tthis._queAutoCreate();\r\n\t}\r\n\r\n\tpublic DOMUpdated(): void {\r\n\t\tthis._quePurge();\r\n\t\tthis._queAutoCreate();\r\n\t}\r\n\r\n\tpublic tick(): void {\r\n\t\tthis._modules.forEach((moduleInstance: Module) => {\r\n\t\t\tif (moduleInstance.tick) {\r\n\t\t\t\tmoduleInstance.tick();\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n\r\n\tpublic scroll(windowY: number): void {\r\n\t\tthis._modules.forEach((moduleInstance: Module) => {\r\n\t\t\tif (moduleInstance.scroll) {\r\n\t\t\t\tmoduleInstance.scroll(windowY);\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n\r\n\tpublic resize(sizes: any): void {\r\n\t\tthis._modules.forEach((moduleInstance: Module) => {\r\n\t\t\tif (moduleInstance.resize) {\r\n\t\t\t\tmoduleInstance.resize(sizes);\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n\r\n\tpublic createModulesInTarget($target: HTMLElement): void {\r\n\t\tthis._createModulesInTarget($target);\r\n\t}\r\n\r\n\t//private \r\n\t//--------------------------------------------------\r\n\tprivate _getModuleById(id: string): Module {\r\n\t\tfor (let i = 0; i < this._modules.length; i++) {\r\n\t\t\tif (this._modules[i].id === id) {\r\n\t\t\t\treturn this._modules[i];\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn null;\r\n\t}\r\n\r\n\tprivate _getModulesByTag(tag: string): Array<Module> {\r\n\t\treturn this._modules.filter( (moduleItem) => moduleItem.tag === tag );\r\n\t}\r\n\r\n\tprivate _getByModuleName(name: string): Array<Module> {\r\n\t\treturn this._modules.filter( (moduleItem) => moduleItem.moduleName === name );\r\n\t}\r\n\r\n\tprivate _queAutoCreate(): void {\r\n\t\tDebugbase.DOM.clearQue(this._autoCreateQueId);\r\n\t\tthis._autoCreateQueId = Debugbase.DOM.que(this._autoCreateModules.bind(this));\r\n\t}\r\n\r\n\t//Grab any module that haven't been created\r\n\t//Create modules are assigned the m-mounted=\"true\" attribute and stop being selected again\r\n\tprivate _autoCreateModules(target: any = document): void {\r\n\r\n\t\t//Create a dyamic instance loader on the window.Debugbase scope: \r\n\t\tif (!this._instanceLoader) {\r\n\t\t\tthis._instanceLoader = new InstanceLoader<Module>((window as any).DebugbaseModules);\r\n\t\t}\r\n\t\t\r\n\t\tthis._createModulesInTarget(document);\r\n\r\n\t\tEvents.dispatch(CoreEvents.MODULES_MOUNTED);\r\n\r\n\t}\r\n\r\n\tprivate _createModulesInTarget(target: any): void {\r\n\t\t\r\n\t\tlet modules: NodeListOf<Element> = target.querySelectorAll('[m]:not([m-mounted=\\'true\\'])');\r\n\t\r\n\t\tmodules.forEach((moduleElement: Element) => {\r\n\t\t\t\r\n\t\t\ttry {\r\n\t\t\t\tthis._createModule(moduleElement);\r\n\t\t\t} catch (e) {\r\n\t\t\t\tconsole.log('MODULE LOAD ERROR !!!!!!!!!!!!!!!!!!!!!!', moduleElement, e);\r\n\t\t\t}\r\n\r\n\t\t});\r\n\t}\r\n\r\n\t//Create a single module to push into the the \r\n\t//This is a special case (Like behaviours) where modules classes are set to set window.scope and create at runtime\r\n\t//So those classes need to be imported to app or relevant scope\r\n\tprivate _createModule(element: Element): void {\r\n\r\n\t\t//Get a list of attbuites parsed into numbers/booleans/strings: \r\n\t\tlet attributes: any = Debugbase.framework.getParsedAttributes(element);\r\n\r\n\t\t//Create the instance: \r\n\t\tlet instance: Module = this._getInstance(attributes.m);\r\n\t\tinstance.$container = element;\r\n\t\tinstance.id = element.getAttribute('id');\r\n\r\n\t\tif (attributes['m-tag']) {\r\n\t\t\tinstance.tag = attributes['m-tag'];\r\n\t\t}\r\n\r\n\t\tDebugbase.framework.attributesToConfig(instance, attributes, attributes.m);\r\n\t\tinstance.moduleName = attributes.m;\r\n\t\tinstance.create();\r\n\r\n\t\t//Flag mounted:  \r\n\t\tinstance.mounted = true;\r\n\t\tDebugbase.DOM.setAttribute(element, 'm-mounted', 'true');\r\n\r\n\t\t//Add to stack: \r\n\t\tthis._modules.push(instance);\r\n\r\n\t}\r\n\r\n\tprivate _quePurge(): void {\r\n\t\tDebugbase.DOM.clearQue(this._purgeQueId);\r\n\t\tthis._purgeQueId = Debugbase.DOM.que(this._purge.bind(this));\r\n\t}\r\n\r\n\tprivate _purge(): void {\r\n\r\n\t\tlet i = 0;\r\n\r\n\t\twhile (i < this._modules.length) {\r\n\r\n\t\t\t//Check if module removed/missing but not destroyed: \r\n\t\t\tif (!this._modules[i].destroyed && this._isRemoved(this._modules[i])) {\r\n\t\t\t\tthis._destroyModule(this._modules[i]);\r\n\t\t\t}\r\n\r\n\t\t\tif (this._modules[i].destroyed) {\r\n\t\t\t\tEvents.dispatch(CoreEvents.MODULE_DESTOYED, this._modules[i].id);\r\n\t\t\t\tthis._modules.splice(i, 1);\r\n\t\t\t} else {\r\n\t\t\t\ti++;\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\tprivate _getInstance(moduleName: string): Module {\r\n\t\tlet className: string = Debugbase.string.snakeToClassName(moduleName);\r\n\t\tconsole.log('className', className);\r\n\t\t\r\n\t\treturn this._instanceLoader.getInstance(className);\r\n\t}\r\n\r\n\tprivate _isRemoved(moduleInstance: Module): boolean {\r\n\r\n\t\treturn (moduleInstance.removed || !Debugbase.DOM.contains(moduleInstance.$container));\r\n\t}\r\n\r\n\tprivate _clearById(id: string, type: ClearType): void {\r\n\r\n\t\tlet module = this._getModuleById(id);\r\n\t\tif (!module) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\t//Remove OR destroy module: \r\n\t\tif (type === ClearType.DESTROY) {\r\n\t\t\tthis._destroyModule(module);\r\n\t\t} else {\r\n\t\t\tthis._removeModule(module);\r\n\t\t}\r\n\r\n\t\t//Remove (Que asnc so it only happens once no matter how much its called): \r\n\t\tthis._quePurge();\r\n\t}\r\n\r\n\tprivate _clearByTag(tag: string): void {\r\n\t\tthis._getModulesByTag(tag).forEach( (item) => this._destroyModule(item) );\r\n\t}\r\n\r\n\tprivate _removeModule(moduleInstance: Module): void {\r\n\r\n\t\tif (!moduleInstance.$container) {\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tmoduleInstance.removed = true;\r\n\t\tDebugbase.DOM.removeElement(moduleInstance.$container);\r\n\t\tDebugbase.DOM.removeAttributte(moduleInstance.$container, 'm');\r\n\t\tDebugbase.DOM.removeAttributte(moduleInstance.$container, 'm-mouted');\r\n\t\tmoduleInstance.$container = null;\r\n\r\n\t\tif (!moduleInstance.destroyed) {\r\n\t\t\tthis._destroyModule(moduleInstance);\r\n\t\t}\r\n\r\n\t}\r\n\r\n\tprivate _destroyModule(moduleInstance: Module): void {\r\n\t\tconsole.log('Destroy Module', moduleInstance);\r\n\t\tmoduleInstance.destroy();\r\n\t\tmoduleInstance.active = false;\r\n\t\tmoduleInstance.$container = null;\r\n\t\tmoduleInstance.destroyed = true;\r\n\t}\r\n\r\n}\r\n\r\nif ('NodeList' in window && !NodeList.prototype.forEach) {\r\n    NodeList.prototype.forEach = function (callback, thisArg) {\r\n      thisArg = thisArg || window;\r\n      for (var i = 0; i < this.length; i++) {\r\n        callback.call(thisArg, this[i], i, this);\r\n      }\r\n    };\r\n  }\r\n","import * as Navigo from 'navigo';\r\nimport {ControllerManager} from './ControllerManager';\r\n\r\ninterface RouteConfig {\r\n\tpath: string; \r\n\tcontroller: string; \r\n\tfunction?: string; \r\n}\r\n\r\nexport class RouteManager {\r\n\r\n\tpublic openingRouteOnly: boolean = true;\r\n\r\n\tprivate _routes: RouteConfig[] = [];\r\n\tprivate _controllerManager: ControllerManager; \r\n\r\n\tpublic set controllerManager(manager: ControllerManager) {\r\n\t\tthis._controllerManager = manager;\r\n\t}\r\n\r\n\tpublic set(routes: RouteConfig[]): void {\r\n\t\tthis._routes = routes;\r\n\t}\r\n\r\n\tpublic init() : void {\r\n\t\tif (this._routes.length) {\r\n\t\t\tthis._createRouter();\r\n\t\t}\r\n\t}\r\n\r\n\tprivate _createRouter() {\r\n\t\r\n\t\tlet router = new Navigo(null);\r\n\r\n\t\tvar navigoRoutes = {};\r\n\t\r\n\t\tfor (let i = 0; i < this._routes.length; i++ ) {\r\n\t\t\t\r\n\t\t\tlet url = this._routes[i].path;\r\n\t\t\tlet controller =  this._controllerManager.get(this._routes[i].controller);\r\n\t\t\tlet func = (this._routes[i].function) ? this._routes[i].function : 'init';\r\n\r\n\t\t\tnavigoRoutes[url] = (params = null, query = null) => {\r\n\t\t\t\tcontroller[func](params);\r\n\t\t\t\t//Only want to route first load:\r\n\t\t\t\tif ( this.openingRouteOnly ) {\r\n\t\t\t\t\t(router as any).pause();\r\n\t\t\t\t}\r\n\t\t\t};\r\n\t\t\t\r\n\t\t}\r\n\r\n\t\t(router as any).notFound(function (query) {\r\n  \t\t\tconsole.log(\"ROUTE NOT FOUND----\");\r\n\t\t});\r\n\r\n\t\t(router as any) \r\n\t\t\t.on(navigoRoutes)\r\n\t\t\t.resolve();\r\n\t}\r\n\r\n}\r\n\r\n","//StateManager. Hold states, broadcast changes and update binded elements\r\n//1.0 \r\n\r\n//Centralised state/model holder\r\n//Update DOM values automatically \r\n//<h1 s='project-title' s-set s-created>Market Masters</h1>\r\n//Broadcast events when state is changed \r\n//Events.state('project-title', this.animateProjectTitle.bind(this))\r\n//Manually set binding \r\n//state.create(id)\r\n//state.bind(id, elementSeletor / Elements)\r\n\r\nimport {State} from 'debugbase/state/State';\r\n\r\nexport class StateManager {\r\n\r\n\tprivate _states: Array<State> = [];\t\t\t//States\r\n\tprivate _refs: any = {}; \t\t\t\t\t//Refs for direct access to states \r\n\t\r\n\t//Direct access data objects (quicker than string)\r\n\tpublic get data(): any {\r\n\t\treturn this._refs;\r\n\t}\r\n\r\n\tpublic set(id: string, value: any): any {\r\n\t\treturn null;\r\n\t\treturn this._getById(id).setValue(value);\r\n\t}\r\n\r\n\tpublic get(id: string): any {\r\n\t\treturn null;\r\n\t\treturn this._getById(id).getValue();\r\n\t}\r\n\r\n\tpublic DOMReady(): void {\r\n\t\t//this._createAutoStateBinds();\r\n\t}\r\n\r\n\tpublic DOMUpdated(): void {\r\n\t\t//this._createAutoStateBinds();\r\n\t}\r\n\r\n\tpublic bind(id: string, $target: Element, setHTMLFromState: boolean): void {\r\n\t\tthis._getById(id).bind($target, setHTMLFromState);\t\r\n\t}\r\n\r\n\t//private \r\n\t//------------------------------------------------------------\r\n\t//------------------------------------------------------------\r\n\t//------------------------------------------------------------\r\n\t//------------------------------------------------------------\r\n\r\n\tprivate _getById(id): State {\r\n\r\n\t\tfor (var i = 0; i < this._states.length; i++) {\r\n\t\t\tif (this._states[i].config.id === id) {\r\n\t\t\t\treturn this._states[i];\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\treturn this._createState(id);\r\n\r\n\t}\r\n\r\n\t//Select all states in the HTML: \r\n\t//<h1 s='project-title' s-created></h1>\r\n\t/*private  _createAutoStateBinds(): void {\r\n\t\t\r\n\t\tvar $targets = $('[s]');\r\n\t\tvar id, instance;\r\n\t\t\r\n\t\t$targets.each(function(index) {\r\n\t\t\tid = $(this).data('s');\r\n\t\t\tinstance = this.get(id);\r\n\t\t\tinstance.config = FrameworkTools.createConfig($(this), instance, 's-{prop}'');\r\n\t\t\tinstance.props.$target = $(this);\r\n\t\t\tinstance.init();\r\n\t\t});\r\n\r\n\t}\r\n\t*/\r\n\r\n\tprivate _createState(id: string): State {\r\n\t\tthis._refs[id] = this._states[this._states.length - 1];\r\n\t\treturn this._refs[id];\r\n\t}\r\n\r\n}\r\n\r\n","export class GA {\r\n\tpublic static event(eventCategory: string, eventAction: string, eventLabel: string = null, eventValue: any = null): void {\r\n\t\t(window as any).ga('send', 'event', eventCategory, eventAction, eventLabel, eventValue);\r\n\t}\r\n}\r\n","import {InertiaDrag, Point} from 'debugbase/util/InertiaDrag';\r\nimport {Debugbase} from 'debugbase/Debugbase';\r\n//import {TweenMax, Power3, Power0} from 'gsap';\r\n\r\ninterface Breakpoint {\r\n\tratio: number;\r\n\tlower: number;\r\n\tupper: number; \r\n}\r\n\r\nexport enum axisType {X, Y}\r\n\r\nexport class DragBreakpoints {\r\n\r\n\tpublic easePower: number = 10.0; \r\n\tpublic releaseEasePower: number = 15.0;\r\n\tpublic onSnap: Function; \r\n\tpublic onTick: Function;\r\n\tpublic onStartDrag: Function;\r\n\tpublic onStopDrag: Function;\r\n\tpublic axis: axisType = axisType.X;\r\n\t//public tolerance: number = 1200;\r\n\tpublic forceSnap: boolean = true;\r\n\r\n\tprivate _active: boolean = false;\r\n\tprivate _progress: number = 0; \r\n\tprivate _targetProgress: number = 0; \r\n\tprivate _breakpoints: Array<Breakpoint> = [];\r\n\tprivate _breakpointShare: number;\r\n\tprivate _breakpointIndex: number = 0; \r\n\tprivate _inertiaDrag: InertiaDrag;\r\n\tprivate _tweening: boolean;\r\n\tprivate _snapping: boolean;\r\n\tprivate _easePower: number = 10;\r\n\r\n\tprivate _virtualWidth: number = 2000;\t\t\t\t\t//Fake width to allow\r\n\tprivate _dragToMoveRatio: number = 0.25;\t\t\t\t\t//User needs to move 25% of the screen to do a full move across\t\t\t\t\t\t\t\t\r\n\tprivate _overflowZoneTolerence: number = 0.05;\t\t\t//If drag is started  \r\n\tprivate _overflowAmount: number = 0.04;\r\n\tprivate _overflowZoneActive: boolean = false;\r\n\r\n\tprivate _defaultConstraints: any = {min: 0, max: 1};\r\n\tprivate _constraints: any = {min: 0, max: 1};\r\n\r\n\t//Thershold settings. \r\n\tprivate _requiresThreshold: boolean;\r\n\tprivate _thresholdReached: boolean;\r\n\tprivate _thresholdTolerence: number;\r\n\tprivate _thresholdCount: number;\r\n\r\n\tconstructor (count: number, public loop: boolean = false, startIndex: number = 0, public snap: boolean = true, $target: Element = null) {\r\n\t\tthis._breakpointShare = 1.0 / count;\r\n\t\tthis._breakpointIndex = startIndex;\r\n\t\tthis._createBreakpoints(count);\r\n\t\tthis._addInertiaDrag($target);\r\n\t}\t\r\n\r\n\tpublic setActive(active: boolean): void {\r\n\t\r\n\t\tif (!this._active && active) {\r\n\t\t\twindow.requestAnimationFrame(this._tick.bind(this));\r\n\t\t}\r\n\r\n\t\tthis._active = active;\r\n\t\tthis._inertiaDrag.setActive(this._active);\r\n\r\n\t}\r\n\r\n\t/** Set the imaginary width of the container being moved. I.E x3 screen width */\r\n\tpublic setVirtualWidth(width: number): void {\r\n\t\tthis._virtualWidth = width;\r\n\t}\r\n\r\n\t/** Set the ratio on mouch the user needs to move to drag the screen. I smaller number means more responsive */\r\n\tpublic setDragToMoveRatio(ratio: number): void {\r\n\t\tthis._dragToMoveRatio = ratio;\r\n\t}\r\n\r\n\t/** Set default contrains of drag action. Useful to stop early like on Work section */\r\n\tpublic setConstraints(min: number = 0, max: number = 1): void {\r\n\t\tthis._defaultConstraints = {\r\n\t\t\tmin: min,\r\n\t\t\tmax: max\r\n\t\t};\r\n\t}\r\n\r\n\t//** Override the progress */\r\n\tpublic setProgress(ratio: number): void {\r\n\t\tthis._breakpointIndex = 0;\r\n\t\t//this._progress = this._targetProgress = (ratio * this.tolerance);\r\n\t\tthis._progress = this._targetProgress = ratio;\r\n\t}\r\n\r\n\t//**Set a new target. Usefull to animate */\r\n\tpublic setTarget(ratio: number): void {\r\n\t\t//this._targetProgress = ratio * this.tolerance;\r\n\t\tthis._targetProgress = ratio;\r\n\t}\r\n\r\n\t//Force the index from external event \r\n\tpublic setIndex(index: number): void {\r\n\t\tthis._snap(index, false);\r\n\t}\r\n\r\n\t//Set the require move thershold as a ratio of total amount \r\n\tpublic setStartThreshold(thershold: number): void {\r\n\t\tthis._thresholdTolerence = thershold;\r\n\t\tthis._requiresThreshold = (this._thresholdTolerence > 0);\r\n\t}\r\n\r\n\t//Create the breakpoints: \r\n\tprivate _createBreakpoints(count: number): void {\r\n\t\tif (this.loop) {\r\n\t\t\tthis._createLoopBreakPoints(count);\r\n\t\t} else {\r\n\t\t\tthis._createNonLoopBreakPoints(count);\r\n\t\t}\r\n\r\n\t}\r\n\r\n\tprivate _createLoopBreakPoints(count: number): void {\r\n\r\n\t\tlet ratio, lower, upper: number;\r\n\t\tratio = 0.0;\r\n\t\t// -0. | 0.0 | 0.125 |   \r\n\r\n\t\tfor (let i = 0; i < count; i++) {\r\n\r\n\t\t\tthis._breakpoints.push({\r\n\t\t\t\tratio: ratio,\r\n\t\t\t\tupper: ratio + (this._breakpointShare / 2),\r\n\t\t\t\tlower: ratio - (this._breakpointShare / 2), \r\n\t\t\t});\r\n\r\n\t\t\tratio += this._breakpointShare;\r\n\t\t}\r\n\r\n\t\tthis._breakpoints.push({\r\n\t\t\t\tratio: 1.0,\r\n\t\t\t\tupper: 1.0 + (this._breakpointShare / 2),\r\n\t\t\t\tlower: 1.0 - (this._breakpointShare / 2), \r\n\t\t});\r\n\r\n\t}\r\n\r\n\tprivate _createNonLoopBreakPoints(count: number): void {\r\n\r\n\t\tlet ratio, lower, upper: number;\r\n\r\n\t\tfor (let i = 0; i < count; i++) {\r\n\r\n\t\t\tif (i === 0) {\r\n\t\t\t\tratio = 0; \r\n\t\t\t\tlower = 0;\r\n\t\t\t\tupper = this._breakpointShare;\r\n\t\t\t} else if ( i === count - 1) {\r\n\t\t\t\tratio = 1.0; \r\n\t\t\t\tlower = 1.0 - this._breakpointShare;\r\n\t\t\t\tupper = 1.0;\r\n\t\t\t} else {\r\n\t\t\t\tratio =  (i * this._breakpointShare) + (this._breakpointShare / 2);\r\n\t\t\t\tlower = ratio - (this._breakpointShare / 2);\r\n\t\t\t\tupper = ratio + (this._breakpointShare / 2);\r\n\t\t\t}\r\n\r\n\t\t\tthis._breakpoints.push({\r\n\t\t\t\tratio: ratio,\r\n\t\t\t\tupper: upper,\r\n\t\t\t\tlower: lower\r\n\t\t\t});\r\n\t\t\r\n\t\t}\r\n\r\n\t}\r\n\r\n\tprivate _addInertiaDrag($target: Element = null): void {\r\n\t\tthis._inertiaDrag = new InertiaDrag($target);\r\n\t\t//this._inertiaDrag.axis = (this.axis === axisType.X) ? 'x' : 'y';\r\n\t\tthis._inertiaDrag.simulate = true; \r\n\t\tthis._inertiaDrag.simulateSteps = 60; \r\n\t\tthis._inertiaDrag.stepAfterRelease = false;\r\n\t\tthis._inertiaDrag.onPress = this._onInertiaDragPress.bind(this);\r\n\t\tthis._inertiaDrag.onStep = this._onInertiaDragStep.bind(this);\r\n\t\tthis._inertiaDrag.onRelease = this._onInertiaDragRelease.bind(this);\r\n\t\t\r\n\t}\r\n\r\n\tprivate _onInertiaDragPress(): void {\r\n\r\n\t\tif (!this._active) {\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tthis._thresholdReached = false;\r\n\t\tthis._thresholdCount = 0;\r\n\t\tthis._testInOverflowZone();\r\n\t\tthis.onStartDrag();\r\n\t}\r\n\r\n\tprivate _onInertiaDragStep(stepProgress: Point): void {\r\n\r\n\t\tif (!this._active) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\t\r\n\t\t//Reset Ease power \r\n\t\tthis._easePower = this.easePower;\r\n\t\tlet increaseRatio: number = -1 * this._getMoveRatio(stepProgress);\r\n\r\n\t\t//If a drag thershold is required to start. This required when there is also paging scrolling as it's too senstive with out some sort of tolerence \r\n\t\tif (this._requiresThreshold && !this._thresholdReached) {\r\n\t\t\t\r\n\t\t\tthis._thresholdCount += increaseRatio;\r\n\t\t\t\r\n\t\t\t//Check if the thershold is lower than required value\r\n\t\t\tif ( Math.abs( this._thresholdCount ) < this._thresholdTolerence) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\t//Made it past the check for this mouse down so allow the user to drag sideways \r\n\t\t\t//TODO should it now try and prevent default on touch move???\r\n\t\t\tthis._thresholdReached = true;\r\n\r\n\t\t}\r\n\r\n\t\tthis._increaseProgress(increaseRatio);\r\n\t\r\n\t}\r\n\r\n\tprivate _increaseProgress(increaseRatio: number): void {\r\n\r\n\t\tthis._targetProgress = Debugbase.math.constrain(\r\n\t\t\tthis._targetProgress + increaseRatio,\r\n\t\t\tthis._constraints.min, \r\n\t\t\tthis._constraints.max\r\n\t\t);\r\n\r\n\t}\r\n\r\n\t//Tick function, manages setting progress: \r\n\tprivate _tick(): void {\r\n\r\n\t\t//When not using Tweenmax to tween to snap then use stand inernia\r\n\t\tif (!this._tweening) {\r\n\t\t\tthis._progress = this._progress + ((this._targetProgress - this._progress ) / this._easePower );\r\n\t\t}\r\n\r\n\t\t//Snap as soon as thersold is crossed\r\n\t\tif (!this._snapping) {\r\n\t\t\t\r\n\t\t\tlet snapbreakPointIndex: number = this._getBreakpoint(this._progress);\r\n\t\t\tif (snapbreakPointIndex !== this._breakpointIndex) {\r\n\t\t\t\r\n\t\t\t\tthis._breakpointIndex = snapbreakPointIndex;\r\n\r\n\t\t\t\tif (this.forceSnap) {\r\n\t\t\t\t\tthis._inertiaDrag.forceStop();\r\n\t\t\t\t\tthis._snap(this._breakpointIndex);\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tthis.onTick(this._progress);\r\n\r\n\t\tif (this._overflowZoneActive) {\r\n\t\t\tthis._testInOverflowZone();\r\n\t\t}\r\n\r\n\t\tif (this._active) {\r\n\t\t\twindow.requestAnimationFrame(this._tick.bind(this));\r\n\t\t}\r\n\r\n\t}\r\n\r\n\t//User has release mouse, check what needs to be snapped to: \r\n\tprivate _onInertiaDragRelease(simuatedProgress: Point): void {\r\n\r\n\t\tthis._overflowZoneActive = false;\r\n\t\tthis._setConstraints();\r\n\t\tthis._constrain();\r\n\r\n\t\tif (this.onStopDrag) {\r\n\t\t\tthis.onStopDrag();\r\n\t\t}\r\n\r\n\t\tif (!this.snap) {\r\n\t\t\tsetTimeout(() => this._inertiaDrag.setActive(true), 300);\r\n\t\t\tsetTimeout(() => this._snapping = false, 600);\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tlet increaseRatio = this._getMoveRatio(simuatedProgress);\r\n\t\tlet finalProgress: number  = Debugbase.math.constrain(this._targetProgress - increaseRatio, 0, 1);\r\n\r\n\t\tlet snapbreakPointIndex: number = this._getBreakpoint(finalProgress);\r\n\t\tif (snapbreakPointIndex > this._breakpointIndex) {\r\n\t\t\tsnapbreakPointIndex = this._breakpointIndex + 1;\r\n\t\t} else if (snapbreakPointIndex <  this._breakpointIndex) {\r\n\t\t\tsnapbreakPointIndex = this._breakpointIndex - 1;\r\n\t\t}\r\n\r\n\t\tthis._snap(snapbreakPointIndex);\r\n\r\n\t}\r\n\r\n\t/** Get swipe move ratio. By comparing to width of container. */\r\n\tprivate _getMoveRatio(point: Point): number {\r\n\t\tlet increase = (this.axis === axisType.X) ? point.x : point.y;\r\n\t\treturn  increase / (this._virtualWidth * this._dragToMoveRatio);\r\n\t}\r\n\r\n\t/** Snap to point: */\r\n\tprivate _snap(snapIndex: number, broadcastEvent: boolean  = true): void {\r\n\r\n\t\tif (!this._active) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\t\r\n\t\tthis._snapping = true;\r\n\t\tthis._easePower = this.releaseEasePower;\r\n\t\tthis._breakpointIndex = snapIndex;\r\n\t\tthis._targetProgress = this._breakpoints[this._breakpointIndex].ratio;\r\n\r\n\t\tif (broadcastEvent) {\r\n\t\t\tthis.onSnap( this._breakpointIndex );\r\n\t\t}\r\n\t\r\n\t\tsetTimeout(() => this._inertiaDrag.setActive(true), 300);\r\n\t\tsetTimeout(() => this._snapping = false, 600);\r\n\r\n\t} \r\n\r\n\t//Get the breakpoint for a ratio: \r\n\tprivate _getBreakpoint(ratio: number): number  {\r\n\t\tfor (var i = 0; i < this._breakpoints.length; i++) {\r\n\t\t\tif (ratio >= this._breakpoints[i].lower  && ratio <= this._breakpoints[i].upper) {\r\n\t\t\t\treturn i;\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\t/** Test if drag is starting in overflow zone */\r\n\tprivate _testInOverflowZone(): void {\r\n\t\tlet lower = this._defaultConstraints.min + this._overflowZoneTolerence;\r\n\t\tlet upper = this._defaultConstraints.max - this._overflowZoneTolerence;\r\n\t\tthis._overflowZoneActive = (this._progress < lower || this._progress > upper);\r\n\t\tthis._setConstraints();\r\n\t}\r\n\r\n\t/** Set the constraints for the amount the drag is allowed to progress to */\r\n\tprivate _setConstraints(): void {\r\n\t\t\r\n\t\tif (this._overflowZoneActive) {\r\n\t\t\tthis._constraints.min = this._defaultConstraints.min - this._overflowAmount;\r\n\t\t\tthis._constraints.max = this._defaultConstraints.max + this._overflowAmount;\r\n\t\t\treturn;\r\n\t\t} \r\n\r\n\t\tthis._constraints.min = this._defaultConstraints.min;\r\n\t\tthis._constraints.max = this._defaultConstraints.max;\r\n\r\n\t}\r\n\r\n\t/** Constrain the values to meaningful */\r\n\tprivate _constrain(): void {\r\n\t  \tthis._targetProgress  = Debugbase.math.constrain(this._targetProgress, this._constraints.min, this._constraints.max);\r\n\t}\r\n\r\n}\r\n","//v1.0.0 - Drag controller to \r\nimport { Events } from 'debugbase/events/Events';\r\n\r\n// \r\n// ProgressTimeline.js\r\n// \r\n\r\nconst FRICTION_COEFF = 0.96;\r\n\r\nexport interface Point {\r\n  x: number;\r\n  y: number;\r\n}\r\n\r\nexport class InertiaDrag {\r\n\r\n    public disableOnRelease: boolean  = true;\r\n    public friction: number = 0.96;\r\n    public axis: string = 'both';\r\n    public simulate: boolean = false;\r\n    public simulateSteps: number = 60;\r\n    public stepAfterRelease: boolean = true;\r\n    public onPress: Function = null; \r\n    public onStep: Function = null;\r\n    public onRelease: Function = null;\r\n\r\n    private _active: boolean = false;\r\n    private _stopFlag: boolean = false;\r\n    private mouse: Point;\r\n    private previous: Point;\r\n    private position: Point;\r\n    private velocity: Point;\r\n    private dragging: boolean;\r\n    private $container: any;\r\n\r\n    private _fireStep: boolean;\r\n\r\n    public static readonly STEP: string = 'STEP';\r\n\r\n    constructor($target: Element | HTMLElement | Window) {\r\n      this._active = false;\r\n      //this.$container = document.querySelector( selector );\r\n      this.$container =  $target || window;\r\n      //this.bounds =  this.$container.getBoundingClientRect();\r\n      this.position = { x: 0, y: 0 };\r\n      this.previous = { x: 0, y: 0 };\r\n      this.mouse = { x: 0, y: 0 };\r\n      this.velocity = { x: 0, y: 0 };\r\n      this.dragging = false;\r\n      this._addEvents();\r\n      this._step();\r\n    }\r\n\r\n\r\n  public setActive(active: boolean): void {\r\n    if (!this._active && active) {\r\n      this._active = true;\r\n      requestAnimationFrame(this._step.bind(this));\r\n    }\r\n    this._active = active;\r\n  }\r\n\r\n  public forceStop(): void {\r\n    this.dragging = this._active = false;\r\n    this._stopFlag =  true;\r\n  }\r\n\r\n  private _addEvents(): void {\r\n\r\n    this.$container.addEventListener('mousedown', (e) => {\r\n\r\n       if (!this._active) {\r\n          return;\r\n      }\r\n\r\n      this._stopFlag = false;\r\n      this.position.x = this.previous.x = this.mouse.x = e.pageX;\r\n      this.position.y = this.previous.y = this.mouse.y = e.pageY;\r\n      this.dragging = true;\r\n\r\n      if (this.onPress) {\r\n          this.onPress();\r\n      }\r\n\r\n    });\r\n\r\n    this.$container.addEventListener('touchstart', (e: TouchEvent) => {\r\n       if (!this._active) {\r\n          return;\r\n      }\r\n\r\n   \r\n      this._stopFlag = false;\r\n      this.position.x = this.previous.x = this.mouse.x = e.touches[0].pageX;\r\n      this.position.y = this.previous.y = this.mouse.y = e.touches[0].pageY;\r\n      this.dragging = true;\r\n\r\n      if (this.onPress) {\r\n          this.onPress();\r\n      }\r\n    });\r\n\r\n     this.$container.addEventListener('touchmove', (e) => {\r\n          \r\n      if (!this._active || this._stopFlag) {\r\n          return;\r\n      }\r\n\r\n      this.mouse.x = e.touches[0].clientX;\r\n      this.mouse.y = e.touches[0].clientY;\r\n\r\n\r\n    });\r\n\r\n   //$(window).on('mouseup', () => {\r\n   Events.on('mouseup', window, () => {\r\n\r\n      if (!this._active  || this._stopFlag) {\r\n          return;\r\n      }\r\n      this.dragging = false;\r\n      let simulatedSteps: Point = this._simulateSteps();\r\n\r\n      if (this.onRelease) {\r\n        this.onRelease(simulatedSteps);\r\n      }\r\n      if (this.disableOnRelease) {\r\n        this._active = false;\r\n      }\r\n\r\n    });\r\n\r\n    Events.on('touchend', window, () => {\r\n\r\n      if (!this._active  || this._stopFlag) {\r\n          return;\r\n      }\r\n      this.dragging = false;\r\n      let simulatedSteps: Point = {x: 0, y: 0};\r\n\r\n      if (this.onRelease) {\r\n        this.onRelease(simulatedSteps);\r\n      }\r\n      if (this.disableOnRelease) {\r\n        this._active = false;\r\n      }\r\n\r\n    });\r\n\r\n    Events.on('mousemove', window, (event: any) => {\r\n      if (!this._active || this._stopFlag) {\r\n          return;\r\n      }\r\n      this.mouse.x = event.clientX;\r\n      this.mouse.y = event.clientY;\r\n    });\r\n\r\n  }\r\n\r\n    private _step() {\r\n\r\n      if (this._active) {\r\n          requestAnimationFrame(this._step.bind(this));\r\n      }\r\n\r\n      if (!this._active ||  this._stopFlag) {\r\n        return;\r\n      }\r\n\r\n    if (this.dragging) {\r\n\r\n      this.previous.x = this.position.x;\r\n      this.previous.y = this.position.y;\r\n\r\n      this.position.x = this.mouse.x;\r\n      this.position.y = this.mouse.y;\r\n\r\n      this.velocity.x = (this.position.x - this.previous.x);\r\n      this.velocity.y = (this.position.y - this.previous.y);\r\n\r\n    } else {\r\n\r\n      this.position.x += this.velocity.x;\r\n      this.position.y += this.velocity.y;\r\n\r\n      this.velocity.x *= this.friction;\r\n      this.velocity.y *= this.friction;\r\n\r\n    }\r\n\r\n    this._fireStep = true; \r\n\r\n    if (this.velocity.x === 0 && this.velocity.y === 0) {\r\n       this._fireStep = false; \r\n    } else if (!this.dragging && !this.stepAfterRelease) {\r\n       this._fireStep = false; \r\n    }\r\n\r\n  \r\n\r\n    if (this._fireStep) {\r\n      this.onStep({\r\n        x: this.velocity.x,\r\n        y: this.velocity.y,\r\n      });\r\n    }\r\n\r\n  }\r\n\r\n  //After the user has released mouse simulates release to see where it wouyld het \r\n  private _simulateSteps(): Point {\r\n\r\n      if (!this.simulate || this.simulateSteps === 0) {\r\n        return {x: 0, y: 0};\r\n      }\r\n\r\n      let tempPosition: Point = {x: 0, y: 0};\r\n      let tempVelocity: Point = {x: this.velocity.x, y: this.velocity.y};\r\n\r\n      for (let i = 0; i < this.simulateSteps; i++) {\r\n         tempPosition.x += tempVelocity.x;\r\n         tempPosition.y += tempVelocity.y;\r\n         tempVelocity.x *= this.friction;\r\n         tempVelocity.y *= this.friction;\r\n      }\r\n\r\n       return tempPosition;\r\n\r\n  }\r\n\r\n} \r\n","import {Debugbase} from 'debugbase/Debugbase';\r\n\r\n//Load all the controllers \r\nimport {AppController} from 'app/controller/AppController';\r\nimport {PixiController} from 'app/controller/PixiController';\r\nimport {PreloadController} from 'app/controller/PreloadController';\r\nimport {UIController} from 'app/controller/UIController';\r\nimport {NavMenuController} from 'app/controller/NavMenuController';\r\nimport {MouseController} from 'app/controller/MouseController';\r\nimport {BackgroundController} from 'app/controller/BackgroundController';\r\nimport {HomeController} from 'app/controller/HomeController';\r\nimport {WorkController} from 'app/controller/WorkController';\r\nimport {ProjectController} from 'app/controller/ProjectController';\r\nimport {InfoController} from 'app/controller/InfoController';\r\nimport {ScrollbarController} from 'app/controller/ScrollbarController';\r\nimport {HistoryController} from 'app/controller/HistoryController';\r\nimport {Events} from 'debugbase/events/Events';\r\nimport 'module.imports';\r\n\r\n//Controller needs to \r\n//1.) Load all app controllers \r\n//2.) Decide what needs to run as core \r\n//3.) Decide what needs to run as \r\n\r\nDebugbase.controller.add(\r\n\t//Global and UI:\r\n\t{instance: new PixiController('Pixi'), global: true},\r\n\t{instance: new AppController('App'), global: true},\r\n\t{instance: new PreloadController('Preload'), global: true, selector: '.preload'},\r\n\t{instance: new UIController('UI'), global: true, selector: '.ui'},\r\n\t{instance: new NavMenuController('NavMenu'), global: true, selector: '.navmenu'},\r\n\t{instance: new HistoryController('History'), global: true},\r\n\t{instance: new MouseController('Mouse'), global: true, selector: 'body'},\r\n\t{instance: new ScrollbarController('Scrollbar'), global: true, selector: '.scrollbar'},\r\n\t{instance: new BackgroundController('Background'), global: true},\r\n\t//Main views: \r\n\t{instance: new HomeController('Home'), selector: '.home'},\r\n\t{instance: new WorkController('Screens'), selector: '.work.-screens'},\r\n\t{instance: new WorkController('Spaces'), selector: '.work.-spaces'},\r\n\t{instance: new ProjectController('Project'), selector: '.project'},\r\n\t{instance: new InfoController('Info'), selector: '.info'}\r\n);\r\n\r\nDebugbase.route.set([\r\n\t{path: '/', controller: 'Home'},\r\n\t{path: 'screens', controller: 'Screens', function: 'screens'}, \r\n\t{path: 'spaces', controller: 'Spaces', function: 'spaces'}, \r\n\t{path: 'screens/:project', controller: 'Project', function: 'screens'}, \r\n\t{path: 'spaces/:project', controller: 'Project', function: 'spaces'}, \r\n\t{path: 'about', controller: 'Info', function: 'about'},\r\n\t{path: 'studio', controller: 'Info', function: 'studio'},\r\n\t{path: 'jobs', controller: 'Info', function: 'jobs'},\r\n\t{path: 'contact', controller: 'Info', function: 'contact'},\r\n]);\r\n\r\nDebugbase.init();\r\n","import { Container } from 'inversify';\r\nimport { TYPES } from './types';\r\nimport { Logger, ComplexLogger } from 'app/contracts/Debug';\r\nimport { LoggerService } from 'app/services/debug/LoggerService';\r\nimport { ComplexLoggerService } from 'app/services/debug/ComplexLoggerService';\r\n\r\nconst iocContainer = new Container();\r\niocContainer.bind<Logger>(TYPES.Logger).to(LoggerService);\r\niocContainer.bind<ComplexLogger>(TYPES.ComplexLogger).to(ComplexLoggerService);\r\nexport { iocContainer };\r\n","import {ParallaxGroup} from 'debugbase/module/parallax/ParallaxGroup';\r\nimport {LoaderGraphic} from 'app/module/global/LoaderGraphic';\r\nimport {Paging} from 'app/module/global/Paging';\r\nimport {DragPanel} from 'app/module/global/DragPanel';\r\nimport {HitArea} from 'app/module/global/HitArea';\r\nimport {VideoSwitch} from 'app/module/project/VideoSwitch';\r\nimport {GoogleMap} from 'app/module/info/GoogleMap';\r\nimport {LazyLoadImage} from 'app/module/media/LazyLoadImage';\r\nimport {LoadMore} from 'app/module/widget/LoadMore';\r\n\r\ndeclare global {  \r\n\tnamespace DebugbaseModules {\r\n\t\t//ParallaxGroup\r\n\t\t//export type ParallaxGroupModule = ParallaxGroup;\r\n\t\t//export const ParallaxGroupModule: typeof ParallaxGroup;\r\n\t\t//LoaderGraphic\r\n\t\texport type LoaderGroupModule = LoaderGraphic;\r\n\t\texport const LoaderGroupModule: typeof LoaderGraphic;\r\n\t\t//Paging blocks\r\n\t\texport type PagingModule = Paging;\r\n\t\texport const PagingModule: typeof Paging;\r\n\t\t//Side Drag panel (In projects)\r\n\t\texport type DragPanelModule = DragPanel;\r\n\t\texport const DragPanelModule: typeof DragPanel;\r\n\t\t//Hitarea (For invisible / cancelable touch events on the tiles)\r\n\t\texport type HitAreaModule = HitArea;\r\n\t\texport const HitAreaModule: typeof HitArea;\r\n\t\t//Video switch, for loading mobile / desktop dynamically \r\n\t\texport type VideoSwitchModule = VideoSwitch;\r\n\t\texport const VideoSwitchModule: typeof VideoSwitch;\r\n\t\t//Google maps on info page:\r\n\t\texport type GoogleMapModule = GoogleMap;\r\n\t\texport const GoogleMapModule: typeof GoogleMap;\r\n\t\t//LazyLoadImage \r\n\t\texport type LazyLoadImageModule = LazyLoadImage;\r\n\t\texport const LazyLoadImageModule: typeof LazyLoadImage;\r\n\t\t//LoadMore \r\n\t\texport type LoadMoreModule = LoadMore;\r\n\t\texport const LoadMoreModule: typeof LoadMore;\r\n\t\t\r\n\t}\r\n}\r\n\r\n(<any>window).DebugbaseModules = { \r\n\t//ParallaxGroup: ParallaxGroup,\r\n\tLoaderGraphic: LoaderGraphic,\r\n\tPaging: Paging,\r\n\tDragPanel: DragPanel,\r\n\tHitArea: HitArea,\r\n\tVideoSwitch: VideoSwitch,\r\n\tGoogleMap: GoogleMap, \r\n\tLazyLoadImage: LazyLoadImage,\r\n\tLoadMore: LoadMore\r\n};\r\n","const TYPES = {\r\n    Logger: Symbol.for('Logger'),\r\n    ComplexLogger:  Symbol.for('ComplexLogger')\r\n};\r\nexport { TYPES };\r\n"],"sourceRoot":""}